(self.webpackChunkcbioportal_frontend=self.webpackChunkcbioportal_frontend||[]).push([[706],{92955:(t,e,n)=>{"use strict";n.d(e,{L:()=>j,Z:()=>R});var o=n(88034),r=n(27808),i=n(78566),a=n(95920),l=n(79280),s=n(5985),u=n.n(s),p=n(89551),c=n(57930),h=n.n(c),f=n(49572),d=n(63443),y=n(3563),m=n(62524),v=n(65587),b=n(5933),g=n(74785),O=n(76127),x=n.n(O),w=n(4259),k=n(24999),T=n(26942);function E(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function S(){return(S=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t}).apply(this,arguments)}function C(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function P(t){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function D(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function M(t,e){return(M=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _(t){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var j,A=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===("undefined"==typeof Reflect?"undefined":_(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},V=function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function a(t){try{s(o.next(t))}catch(t){i(t)}}function l(t){try{s(o.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,l)}s((o=o.apply(t,e||[])).next())}))};!function(t){t.TOOLTIP="tooltip",t.CHART="chart"}(j||(j={}));var L=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=function(t,e){return!e||"object"!==_(e)&&"function"!=typeof e?D(t):e}(this,P(e).call(this,t)),Object.defineProperty(D(n),"tooltipModel",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(D(n),"scatterFilter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(D(n),"highlightedCurve",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(D(n),"sliderValue",{enumerable:!0,configurable:!0,writable:!0,value:n.getInitialSliderValue()}),Object.defineProperty(D(n),"isTooltipHovered",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(D(n),"tooltipCounter",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(D(n),"svgContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(D(n),"styleOptsDefaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{width:900,height:500,padding:{top:20,bottom:50,left:60,right:20},tooltipXOffset:20,tooltipYOffset:-47,axis:{x:{axisLabel:{padding:35},grid:{opacity:0}},y:{axisLabel:{padding:45,fill:"black"},grid:{opacity:0}}},pValue:{x:610,y:30,textAnchor:"start"},legend:{x:600,y:50}}}),Object.defineProperty(D(n),"events",{enumerable:!0,configurable:!0,writable:!0,value:[{target:"data",eventHandlers:{onMouseOver:function(){return[{target:"data",mutation:function(t){return n.tooltipModel=t,n.tooltipCounter++,{active:!0}}}]},onMouseOut:function(){return[{target:"data",mutation:function(){return V(D(n),void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,p._)(100);case 2:return this.isTooltipHovered||1!==this.tooltipCounter||(this.tooltipModel=null),this.tooltipCounter--,t.abrupt("return",{active:!1});case 5:case"end":return t.stop()}}),t,this)})))}}]}}}]}),(0,i.makeObservable)(D(n)),n.tooltipMouseEnter=n.tooltipMouseEnter.bind(D(n)),n.tooltipMouseLeave=n.tooltipMouseLeave.bind(D(n)),n}var n,r,s;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&M(t,e)}(e,t),n=e,(r=[{key:"getInitialSliderValue",value:function(){return(0,T.Ib)().survival_initial_x_axis_limit?Math.min((0,T.Ib)().survival_initial_x_axis_limit,this.maximumDataMonthValue):this.maximumDataMonthValue}},{key:"toSVGDOMNode",value:function(){return(0,g.cJ)(this.svgContainer.firstChild,{legendGroupSelector:".survivalChartDownloadLegend",selectorToHide:".survivalChartLegendHideForDownload"})}},{key:"tooltipMouseEnter",value:function(){this.isTooltipHovered=!0}},{key:"tooltipMouseLeave",value:function(){this.isTooltipHovered=!1,this.tooltipModel=null}},{key:"getSvg",value:function(){return this.toSVGDOMNode()}},{key:"getData",value:function(){var t=[],e=!0,n=!1,o=void 0;try{for(var r,i=this.analysisGroupsWithData[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var a=r.value;t.push({scatterData:(0,d.Nc)(this.props.sortedGroupedSurvivals[a.value],this.survivalSummaries[a.value].map((function(t){return t.survivalFunctionEstimate})),a.value),title:void 0!==a.name?a.name:a.value})}}catch(t){n=!0,o=t}finally{try{e||null==i.return||i.return()}finally{if(n)throw o}}return(0,d.b1)(t,this.props.title)}},{key:"hoverCircleFillOpacity",value:function(t,e){return e||this.isTooltipHovered&&this.tooltipModel&&this.tooltipModel.datum.studyId===t.studyId&&this.tooltipModel.datum.patientId===t.patientId?.3:0}},{key:"getAxisTickCount",value:function(t){return 5*Math.ceil(t/200)}},{key:"onSliderChange",value:function(t){this.sliderValue=t}},{key:"onSliderTextChange",value:function(t){this.sliderValue=Number.parseFloat(t)}},{key:"render",value:function(){return 0===h().flatten(h().values(this.props.sortedGroupedSurvivals)).length?o.createElement("div",{className:"alert alert-info"},"No data to plot."):o.createElement("div",{style:{position:"relative"}},this.props.legendLocation===j.TOOLTIP?o.createElement(v.ZD,{mouseLeaveDelay:.2,placement:"rightBottom",overlay:this.chartTooltip},this.chart):this.chart,this.tooltipModel&&o.createElement(l.Popover,S({arrowOffsetTop:56,className:x()("cbioportal-frontend","cbioTooltip",u().Tooltip),positionLeft:this.tooltipModel.x+this.styleOpts.tooltipXOffset},{container:this},{positionTop:this.tooltipModel.y+this.styleOpts.tooltipYOffset,onMouseEnter:this.tooltipMouseEnter,onMouseLeave:this.tooltipMouseLeave}),o.createElement("div",null,"Patient ID:"," ",o.createElement("a",{href:(0,m.WU)(this.tooltipModel.datum.studyId,this.tooltipModel.datum.patientId),target:"_blank"},this.tooltipModel.datum.patientId),o.createElement("br",null),!!this.props.showCurveInTooltip&&["Curve: ".concat(this.tooltipModel.datum.group),o.createElement("br",null)],this.props.yLabelTooltip,":"," ",this.tooltipModel.datum.y.toFixed(2),"%",o.createElement("br",null),this.tooltipModel.datum.status?this.props.xLabelWithEventTooltip:this.props.xLabelWithoutEventTooltip,": ",this.tooltipModel.datum.x.toFixed(2)," months"," ",this.tooltipModel.datum.status?"":"(censored)",o.createElement("br",null),this.props.analysisClinicalAttribute&&o.createElement("span",null,this.props.analysisClinicalAttribute.displayName,":"," ",this.props.patientToAnalysisGroups[this.tooltipModel.datum.uniquePatientKey]))),this.props.showTable&&o.createElement("table",{className:"table table-striped",style:{marginTop:20,width:"100%"}},o.createElement("tbody",null,o.createElement("tr",null,o.createElement("td",null),o.createElement("td",null,this.props.totalCasesHeader),o.createElement("td",null,this.props.statusCasesHeader),o.createElement("td",null,this.props.medianMonthsHeader)),this.tableRows)))}},{key:"styleOpts",get:function(){var t=h().merge({},this.styleOptsDefaultProps,this.props.styleOpts);return t.padding.right=this.props.legendLocation===j.CHART?300:t.padding.right,this.props.styleOpts&&this.props.styleOpts.legend&&void 0!==this.props.styleOpts.legend.x||(t.legend.x=t.width-t.padding.right),t}},{key:"downSamplingDenominators",get:function(){return{x:this.styleOpts.width-this.styleOpts.padding.left-this.styleOpts.padding.right,y:this.styleOpts.height-this.styleOpts.padding.top-this.styleOpts.padding.bottom}}},{key:"survivalSummaries",get:function(){return h().mapValues(this.props.sortedGroupedSurvivals,(function(t){return(0,d.i4)(t)}))}},{key:"unfilteredScatterData",get:function(){var t=this;return h().mapValues(this.props.sortedGroupedSurvivals,(function(e,n){var o=t.survivalSummaries[n],r=t.analysisGroupsMap[n].name;return{numOfCases:e.length,line:(0,d.aH)(e,o.map((function(t){return t.survivalFunctionEstimate}))),scatterWithOpacity:(0,d.tI)(e,o.map((function(t){return t.survivalFunctionEstimate})),r),scatter:(0,d.Nc)(e,o.map((function(t){return t.survivalFunctionEstimate})),r)}}))}},{key:"scatterData",get:function(){return(0,d.Ag)(this.unfilteredScatterData,this.scatterFilter,{xDenominator:this.downSamplingDenominators.x,yDenominator:this.downSamplingDenominators.y,threshold:1e3})}},{key:"analysisGroupsMap",get:function(){return h().keyBy(this.props.analysisGroups,(function(t){return t.value}))}},{key:"logRankTestPVal",get:function(){var t=this;return this.analysisGroupsWithData.length>1&&h().every(this.analysisGroupsWithData,(function(e){return t.props.sortedGroupedSurvivals[e.value].length>10}))?k.M.apply(void 0,E(this.analysisGroupsWithData.map((function(e){return t.props.sortedGroupedSurvivals[e.value]})))):null}},{key:"victoryLegendData",get:function(){var t=[];if(this.props.legendLocation===j.CHART){var e=!0,n=!1,o=void 0;try{for(var r,i=this.analysisGroupsWithData[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var a=r.value;t.push({name:a.legendText||a.name||a.value,symbol:{fill:a.color,strokeOpacity:0,type:"square",size:6}})}}catch(t){n=!0,o=t}finally{try{e||null==i.return||i.return()}finally{if(n)throw o}}}return t}},{key:"showPValueText",get:function(){return!h().isNil(this.props.pValue)}},{key:"pValue",get:function(){var t=this,e=h().some(this.props.analysisGroups,(function(e){return t.props.sortedGroupedSurvivals[e.value].length<10}));return!(0,T.Ib)().survival_show_p_q_values_in_survival_type_table&&e?"N/A (<10 cases in a group)":(0,y.C)(this.props.pValue,3,.01)}},{key:"pValueText",get:function(){return o.createElement(f.VictoryLabel,{x:this.styleOpts.pValue.x,y:this.styleOpts.pValue.y,style:v.Ln,textAnchor:this.styleOpts.pValue.textAnchor,text:"Logrank Test P-Value: ".concat(this.pValue)})}},{key:"legendDataForDownload",get:function(){var t=this.analysisGroupsWithData.map((function(t){return{name:t.name?t.name:t.value,symbol:{fill:t.color,strokeOpacity:0,type:"square",size:6}}}));return this.props.naPatientsHiddenInSurvival&&t.push({name:"* Patients with NA for any of the selected attributes are excluded",symbol:{opacity:0}}),t}},{key:"analysisGroupsWithData",get:function(){var t=this,e=this.props.analysisGroups;return e=e.filter((function(e){return e.value in t.scatterData&&t.scatterData[e.value].numOfCases>0}))}},{key:"scattersAndLines",get:function(){var t=this,e=this.analysisGroupsWithData,n=(e=h().sortBy(e,(function(e){return t.highlightedCurve===e.value?1:0}))).map((function(e){return o.createElement(f.VictoryLine,{key:e.value,interpolation:"stepAfter",data:t.scatterData[e.value].line,style:{data:{stroke:e.color,strokeWidth:t.highlightedCurve===e.value?4:1,fill:"#000000",fillOpacity:0}}})})),r=e.map((function(e){return o.createElement(f.VictoryScatter,{key:e.value,data:t.scatterData[e.value].scatterWithOpacity,symbol:"plus",style:{data:{fill:e.color,opacity:function(t){return t.opacity}}},size:3})})),i=e.map((function(e){return o.createElement(f.VictoryScatter,{key:e.value,data:t.scatterData[e.value].scatter,symbol:"circle",style:{data:{fill:e.color,fillOpacity:t.hoverCircleFillOpacity}},size:10,events:t.events})}));return n.concat(r).concat(i)}},{key:"legendForDownload",get:function(){var t=h().cloneDeep(v.Nv);return t.legend.style.data={type:"square",size:5,strokeWidth:0,stroke:"black"},o.createElement(f.VictoryLegend,{x:0,y:this.styleOpts.height+1,style:Object.assign(Object.assign({},t.legend.style),{title:{fontWeight:"bold"}}),title:this.props.title,rowGutter:-10,data:this.legendDataForDownload,groupComponent:o.createElement("g",{className:"survivalChartDownloadLegend"})})}},{key:"xAxisTickCount",get:function(){return this.props.xAxisTickCount||this.getAxisTickCount(this.showLegend?this.styleOpts.legend.x:this.styleOpts.width)}},{key:"showLegend",get:function(){return this.victoryLegendData.length>0}},{key:"maximumDataMonthValue",get:function(){return h().chain(this.props.sortedGroupedSurvivals).map((function(t){return t[t.length-1].months})).max().ceil().value()}},{key:"chart",get:function(){var t=this;return o.createElement("div",{className:this.props.className,"data-test":"SurvivalChart"},this.props.showDownloadButtons&&o.createElement(v.t_,{dontFade:!0,filename:this.props.fileName,buttons:["SVG","PNG","PDF","Data"],getSvg:this.getSvg,getData:this.getData,style:{position:"absolute",zIndex:10,right:10},type:"button"}),this.props.showSlider&&o.createElement("div",{className:"small",style:{display:"flex",alignItems:"center",marginLeft:60}},o.createElement("span",null,"X-Axis Max:"),o.createElement("div",{className:"RangeSliderContainer",style:{width:300,marginLeft:10,marginRight:10}},o.createElement(a.default,{min:0,max:this.maximumDataMonthValue,value:this.sliderValue,onChange:this.onSliderChange,tooltip:!1,step:1})),o.createElement(v.m1,{className:u().XmaxNumberInput,value:this.sliderValue.toString(),setValue:this.onSliderTextChange,numericOnly:!0}),o.createElement("span",null,(0,v._6)("Month",this.sliderValue)," Survival")),o.createElement(f.VictoryChart,{containerComponent:o.createElement(f.VictoryZoomContainer,{responsive:!1,disable:!0,zoomDomain:this.props.showSlider?{x:[0,this.sliderValue]}:void 0,onZoomDomainChange:h().debounce((function(e){t.scatterFilter=e}),1e3),containerRef:function(e){return t.svgContainer=e}}),height:this.styleOpts.height,width:this.styleOpts.width,padding:this.styleOpts.padding,theme:v.Nv,domainPadding:{x:[10,50],y:[20,20]}},o.createElement(f.VictoryAxis,{style:this.styleOpts.axis.x,crossAxis:!1,tickCount:this.xAxisTickCount,label:this.props.xAxisLabel}),o.createElement(f.VictoryAxis,{label:this.props.yAxisLabel,dependentAxis:!0,tickFormat:function(t){return"".concat(t,"%")},tickCount:this.props.yAxisTickCount,style:this.styleOpts.axis.y,domain:[0,100],crossAxis:!1}),this.scattersAndLines,this.showLegend&&o.createElement(f.VictoryLegend,{x:this.styleOpts.legend.x,y:this.styleOpts.legend.y,data:this.victoryLegendData,labelComponent:this.props.legendLabelComponent||o.createElement(w.Z,{dy:"0.3em",maxWidth:256}),groupComponent:o.createElement("g",{className:"survivalChartLegendHideForDownload"})}),this.legendForDownload,this.showPValueText&&this.pValueText))}},{key:"chartTooltip",get:function(){var t=this;return o.createElement("div",{style:{maxWidth:250}},this.analysisGroupsWithData.map((function(e){return o.createElement("span",{key:e.value,style:{display:"inline-block",marginRight:12,fontWeight:t.highlightedCurve===e.value?"bold":"initial",cursor:"pointer"},onClick:function(){t.highlightedCurve=t.highlightedCurve===e.value?"":e.value}},o.createElement("div",{style:{width:10,height:10,display:"inline-block",backgroundColor:e.color,marginRight:5}}),e.name?e.name:e.value)})),this.props.showNaPatientsHiddenToggle&&o.createElement("div",{className:"checkbox"},o.createElement("label",null,o.createElement("input",{type:"checkbox",checked:this.props.naPatientsHiddenInSurvival,onClick:this.props.toggleSurvivalHideNAPatients})," ","Exclude patients with NA for any of the selected attributes.")))}},{key:"tableRows",get:function(){var t=this;return this.props.analysisGroups.map((function(e){return o.createElement("tr",null,o.createElement("td",null,e.name?e.name:e.value),(0,d.fy)(t.props.sortedGroupedSurvivals[e.value],t.survivalSummaries[e.value]).map((function(t){return o.createElement("td",null,o.createElement("b",null,t))})))}))}}])&&C(n.prototype,r),s&&C(n,s),e}(o.Component);Object.defineProperty(L,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{showTable:!0,showSlider:!0,legendLocation:j.CHART,showNaPatientsHiddenToggle:!1,showDownloadButtons:!0,yAxisTickCount:11}}),A([i.observable.ref],L.prototype,"tooltipModel",void 0),A([i.observable],L.prototype,"scatterFilter",void 0),A([i.observable],L.prototype,"highlightedCurve",void 0),A([i.observable],L.prototype,"sliderValue",void 0),A([i.computed],L.prototype,"styleOpts",null),A([i.computed],L.prototype,"downSamplingDenominators",null),A([i.computed],L.prototype,"survivalSummaries",null),A([i.computed],L.prototype,"unfilteredScatterData",null),A([i.computed],L.prototype,"scatterData",null),A([i.computed],L.prototype,"analysisGroupsMap",null),A([i.computed],L.prototype,"logRankTestPVal",null),A([i.computed],L.prototype,"victoryLegendData",null),A([i.computed],L.prototype,"legendDataForDownload",null),A([b.default],L.prototype,"getSvg",null),A([b.default],L.prototype,"getData",null),A([b.default],L.prototype,"hoverCircleFillOpacity",null),A([i.computed],L.prototype,"analysisGroupsWithData",null),A([i.computed],L.prototype,"scattersAndLines",null),A([i.computed],L.prototype,"legendForDownload",null),A([i.computed],L.prototype,"xAxisTickCount",null),A([i.computed],L.prototype,"showLegend",null),A([i.computed],L.prototype,"maximumDataMonthValue",null),A([i.action.bound],L.prototype,"onSliderChange",null),A([i.action.bound],L.prototype,"onSliderTextChange",null),A([i.computed],L.prototype,"chart",null),A([i.computed],L.prototype,"chartTooltip",null),A([i.computed],L.prototype,"tableRows",null);const R=L=A([r.observer],L)},24999:(t,e,n)=>{"use strict";n.d(e,{M:()=>O});var o=n(57930),r=n.n(o);function i(t,e){for(var n,o=0,r=t.length;o<r;)switch(e(t[n=Math.floor((o+r)/2)],n)){case 1:r=n;break;case-1:o=n+1;break;case 0:return n}}var a=n(61581),l=n.n(a),s=n(94039);function u(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var p=n.n(s)()(),c=(p.Vector,p.Matrix),h=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"deathEvents",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"deathsByMonth",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"censorEvents",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"censorsByMonth",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.deathEvents=r().sortBy(e.filter((function(t){return t.status})),(function(t){return t.months})),this.deathsByMonth=r().groupBy(this.deathEvents,(function(t){return t.months})),this.censorEvents=r().sortBy(e.filter((function(t){return!t.status})),(function(t){return t.months})),this.censorsByMonth=r().groupBy(this.censorEvents,(function(t){return t.months}))}var e,n,o;return e=t,(n=[{key:"getTotalEventsAtStartOf",value:function(t,e){return 0===t.length||e<=t[0].months?0:i(t,(function(n,o){return n.months<e?o===t.length-1||t[o+1].months>=e?0:-1:1}))+1}},{key:"getTotalDeathsAtStartOf",value:function(t){return this.getTotalEventsAtStartOf(this.deathEvents,t)}},{key:"getTotalCensorsAtStartOf",value:function(t){return this.getTotalEventsAtStartOf(this.censorEvents,t)}},{key:"getDeathsExactlyAt",value:function(t){return(this.deathsByMonth[t]||[]).length}},{key:"getCensorsExactlyAt",value:function(t){return(this.censorsByMonth[t]||[]).length}},{key:"getTotalAtRiskAtStartOf",value:function(t){return this.events.length-this.getTotalDeathsAtStartOf(t)-this.getTotalCensorsAtStartOf(t)}}])&&u(e.prototype,n),o&&u(e,o),t}(),f=r().map,d=r().sortBy,y=r().groupBy,m=r().reduce,v=r().last,b=r().filter;function g(t,e,n){var o,i,a,s,u,p,h,g,O,x,w,k=null,T=[],E=[],S=[];for(r().each(e,(function(e,o){var i,a,l,s,u,p,c,h={tte:e,ev:n[o]},g=(i=t,a=h.ev,l=d(f(h.tte,(function(t,e){return{tte:t,ev:a[e]}})),"tte"),s=r().uniq(f(l,"tte")),u=y(l,(function(t){return t.tte})),p=m(s,(function(t,e){var n=u[e],o=v(t)||{n:l.length,e:0},r=b(n,(function(t){return t.ev}));return t.push({n:o.n-o.e,e:n.length,d:r.length,t:n[0].tte}),t}),[]),c=[],i=i.filter((function(t){return!!t.d})),{expected:m(i,(function(t,e){var n=r().find(p,(function(t){return t.t===e.t||t.t>e.t}));if(n){var o=n.n*e.rate;return c.push(n),t+o}return t}),0),observed:b(a,(function(t){return 1===t})).length,dataByTimeTable:c,timeNumber:c.length});g.expected&&(T.push(g),E.push(g.observed-g.expected))})),i=T.length-1,a=0;a<T.length;a++)for(S.push([]),s=0;s<T.length;s++)S[a].push(0);for(a=0;a<T.length;a++)for(s=a;s<T.length;s++)for(u=0;u<t.length;u++)g=t[u].n,w=t[u].d,u<T[a].timeNumber&&u<T[s].timeNumber&&(O=T[a].dataByTimeTable[u].n,x=T[s].dataByTimeTable[u].n,a!==s&&1!==g?(S[a][s]-=w*O*x*(g-w)/(g*g*(g-1)),S[s][a]=S[a][s]):1!==g&&(S[a][a]+=w*O*(g-O)*(g-w)/(g*g*(g-1))));for(p=E.slice(0,E.length-1),h=S.slice(0,S.length-1),a=0;a<h.length;a++)h[a]=h[a].slice(0,h[a].length-1);var C=h.slice(0,h.length);for(a=0;a<h.length;a++)C[a]=h[a].slice(0,h[a].length);if(i>0){var P=new c([p]),D=new c([p]).trans(),M=new c(l().inv(C));o=P.dot(M).dot(D).data[0][0],k=1-l().chisquare.cdf(o,i)}return{dof:i,KM_stats:o,pValue:k}}function O(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var o=r().sortBy(r().flatten(e),(function(t){return t.months})),i=new h(o),a=e.map((function(t){return r().sortBy(t,(function(t){return t.months}))})),l=a.map((function(t){return t.map((function(t){return t.months}))})),s=a.map((function(t){return t.map((function(t){return+t.status}))})),u=r().uniqBy(o,(function(t){return t.months})).map((function(t){return{t:t.months,d:i.getDeathsExactlyAt(t.months),n:i.getTotalAtRiskAtStartOf(t.months),rate:i.getDeathsExactlyAt(t.months)/i.getTotalAtRiskAtStartOf(t.months)}})).filter((function(t){return t.d>0}));return g(u,l,s).pValue}},12758:(t,e,n)=>{"use strict";n.d(e,{Z:()=>f});var o=n(88034),r=n(27808);function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function l(t,e){return!e||"object"!==p(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function p(t){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var c=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===("undefined"==typeof Reflect?"undefined":p(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},h=function(t){function e(){return i(this,e),l(this,s(e).apply(this,arguments))}var n,r,p;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(e,t),n=e,(r=[{key:"render",value:function(){return o.createElement("div",{className:"checkbox",style:Object.assign({display:"flex",alignItems:"center"},this.props.style)},o.createElement("label",null,o.createElement("input",{type:"checkbox",value:this.props.value,checked:this.props.checked,onClick:this.props.onClick,style:{marginTop:1}})),"function"==typeof this.props.label?this.props.label():this.props.label)}}])&&a(n.prototype,r),p&&a(n,p),e}(o.Component);const f=h=c([r.observer],h)},4259:(t,e,n)=>{"use strict";n.d(e,{Z:()=>k});var o=n(88034),r=n(27808),i=n(78566),a=n(5933),l=n(79280),s=n(76127),u=n.n(s),p=n(5985),c=n.n(p),h=n(65587),f=n(22071);function d(){return(d=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t}).apply(this,arguments)}function y(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function m(t){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function v(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function b(t,e){return(b=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function g(t){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var O=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===("undefined"==typeof Reflect?"undefined":g(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},x=function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(t);r<o.length;r++)e.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(n[o[r]]=t[o[r]])}return n},w=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=function(t,e){return!e||"object"!==g(e)&&"function"!=typeof e?v(t):e}(this,m(e).call(this,t)),Object.defineProperty(v(n),"mousePosition",{enumerable:!0,configurable:!0,writable:!0,value:{x:0,y:0}}),Object.defineProperty(v(n),"tooltipOpen",{enumerable:!0,configurable:!0,writable:!0,value:!1}),(0,i.makeObservable)(v(n)),n}var n,r,a;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&b(t,e)}(e,t),n=e,(r=[{key:"onMouseOver",value:function(){this.tooltipOpen=!0}},{key:"onMouseOut",value:function(){this.tooltipOpen=!1}},{key:"onMouseMove",value:function(t){this.mousePosition.x=t.pageX,this.mousePosition.y=t.pageY}},{key:"render",value:function(){var t=this.props,e=(t.text,t.maxWidth,t.datum,t.suffix,t.tooltip,t.prefixTspans,t.alwaysShowTooltip,t.renderTruncatedText,t.transform),n=t.tooltipPlacement,r=t.textRef,i=x(t,["text","maxWidth","datum","suffix","tooltip","prefixTspans","alwaysShowTooltip","renderTruncatedText","transform","tooltipPlacement","textRef"]),a=void 0;return e&&void 0!==this.props.x&&void 0!==this.props.y&&(a=e(this.props.x,this.props.y)),o.createElement(o.Fragment,null,o.createElement("text",d({onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut,onMouseMove:this.onMouseMove,ref:r,transform:a},i),this.props.prefixTspans,this.truncatedText),(this.textReport.isTruncated||this.props.alwaysShowTooltip)&&this.tooltipOpen&&o.createElement(f.Z,{isOpened:!0,node:document.body},o.createElement(l.Popover,{arrowOffsetTop:17,className:u()("cbioportal-frontend","cbioTooltip",c().Tooltip),positionLeft:this.mousePosition.x+("left"===n?-8:8),positionTop:this.mousePosition.y-17,style:{transform:"left"===n?"translate(-100%,0%)":void 0},placement:n},this.tooltipElt)))}},{key:"tooltipElt",get:function(){return this.props.tooltip?this.props.tooltip(this.props.datum):o.createElement("span",null,this.props.text)}},{key:"fontFamily",get:function(){var t="Arial";return this.props.style&&this.props.style.fontFamily&&(t=this.props.style.fontFamily.split(", ")[0]),t}},{key:"fontSize",get:function(){var t="13px";return this.props.style&&this.props.style.fontSize&&(t=this.props.style.fontSize+"px"),t}},{key:"textReport",get:function(){return(0,h.xY)(this.props.text||"",this.props.maxWidth,this.fontFamily,this.fontSize)}},{key:"truncatedText",get:function(){return this.props.renderTruncatedText?this.props.renderTruncatedText(this.textReport.text):o.createElement("tspan",null,this.textReport.text)}}])&&y(n.prototype,r),a&&y(n,a),e}(o.Component);Object.defineProperty(w,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{maxWidth:100,suffix:"..."}}),O([i.observable],w.prototype,"mousePosition",void 0),O([i.observable],w.prototype,"tooltipOpen",void 0),O([i.computed],w.prototype,"tooltipElt",null),O([i.action.bound],w.prototype,"onMouseOver",null),O([i.action.bound],w.prototype,"onMouseOut",null),O([a.default],w.prototype,"onMouseMove",null),O([i.computed],w.prototype,"fontFamily",null),O([i.computed],w.prototype,"fontSize",null),O([i.computed],w.prototype,"textReport",null),O([i.computed],w.prototype,"truncatedText",null);const k=w=O([r.observer],w)},89551:(t,e,n)=>{"use strict";function o(t){return new Promise((function(e){return setTimeout(e,t)}))}function r(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2e3;return new Promise((function(o){var r=0,i=setInterval((function(){if(r+=e,t())clearInterval(i),o();else if(r>n)throw clearInterval(i),new Error("sleepUntil timeout")}),e)}))}n.d(e,{_:()=>o,C:()=>r})},5985:t=>{t.exports={portalWidth:"styles-module__portalWidth__1kueS",framedImage:"styles-module__framedImage__1ndwn",SurvivalTable:"styles-module__SurvivalTable__2NKCT",Tooltip:"styles-module__Tooltip__1I-Ty",NotAvailable:"styles-module__NotAvailable__1Zx5R",XmaxNumberInput:"styles-module__XmaxNumberInput__SQsf6"}}}]);