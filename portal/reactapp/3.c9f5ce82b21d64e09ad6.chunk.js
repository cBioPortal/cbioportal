(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{787:function(e,t,r){e.exports={portalWidth:"styles-module__portalWidth__1P_Zv",framedImage:"styles-module__framedImage__1iqVk",QueryAndDownloadTabs:"styles-module__QueryAndDownloadTabs__ivykJ",QueryContainer:"styles-module__QueryContainer__2cy7B",forkedButtons:"styles-module__forkedButtons__2ctM7",errorMessage:"styles-module__errorMessage__32yZg",oqlMessage:"styles-module__oqlMessage__3xhe8",CancerStudySelector:"styles-module__CancerStudySelector__1FU50",MolecularProfileSelector:"styles-module__MolecularProfileSelector__rlomm",DataTypePrioritySelector:"styles-module__DataTypePrioritySelector__1_VUf",CaseSetSelector:"styles-module__CaseSetSelector__YteFo",StudySelection:"styles-module__StudySelection__3booh",GeneSetSelector:"styles-module__GeneSetSelector__2DY1b",icon:"styles-module__icon__1E8Oh",geneCount:"styles-module__geneCount__3cB9u",SelectedStudiesWindow:"styles-module__SelectedStudiesWindow__NAG6X",CancerStudySelectorHeader:"styles-module__CancerStudySelectorHeader__D2N40",selectAll:"styles-module__selectAll__sQO_b",noData:"styles-module__noData__3J5xx",selectedCount:"styles-module__selectedCount__TRoaE",selectionsExist:"styles-module__selectionsExist__1icpM",cancerStudySelectorBody:"styles-module__cancerStudySelectorBody__2BfDm",cancerTypeListContainer:"styles-module__cancerTypeListContainer__rnSbV",cancerStudyListContainer:"styles-module__cancerStudyListContainer__356jB",cancerTypeList:"styles-module__cancerTypeList__ouFgb",cancerTypeListItemLabel:"styles-module__cancerTypeListItemLabel__31N8Y",cancerTypeListItemCount:"styles-module__cancerTypeListItemCount__1HB2c",selectable:"styles-module__selectable__3NCiW",selected:"styles-module__selected__Zy9_9",matchingNodeText:"styles-module__matchingNodeText__3lV9e",nonMatchingNodeText:"styles-module__nonMatchingNodeText__1l5PU",containsSelectedStudies:"styles-module__containsSelectedStudies__20v-B",searchTextInput:"styles-module__searchTextInput__1VIxV",group:"styles-module__group__Cs8DR",zScore:"styles-module__zScore__23rtN",infoIcon:"styles-module__infoIcon__zMiog",profileName:"styles-module__profileName__1fbIy",DataTypePriorityLabel:"styles-module__DataTypePriorityLabel__21k9z",radioRow:"styles-module__radioRow__1G_fF",buttonRow:"styles-module__buttonRow__51RtG",geneSet:"styles-module__geneSet__Ra6KD",notEmpty:"styles-module__notEmpty__23mDp",GeneSymbolValidator:"styles-module__GeneSymbolValidator__ZK8rf",pendingMessage:"styles-module__pendingMessage__2jgIM",oqlNotice:"styles-module__oqlNotice__1tycm",validBubble:"styles-module__validBubble__QCGq3",invalidBubble:"styles-module__invalidBubble__1gB6Z",suggestionBubble:"styles-module__suggestionBubble__aRL1R",noChoiceLabel:"styles-module__noChoiceLabel__2GF5_",singleChoiceLabel:"styles-module__singleChoiceLabel__2wdqL",multiChoiceLabel:"styles-module__multiChoiceLabel__19sFa",MutSigGeneSelectorWindow:"styles-module__MutSigGeneSelectorWindow__1Uiku",MutSigGeneSelector:"styles-module__MutSigGeneSelector__25hKH",selectionColumnHeader:"styles-module__selectionColumnHeader__2MSUO",selectionColumnCell:"styles-module__selectionColumnCell__3RJ8f",selectButton:"styles-module__selectButton__2dXHK",GisticGeneSelectorWindow:"styles-module__GisticGeneSelectorWindow__1J2UG",GisticGeneSelector:"styles-module__GisticGeneSelector__U5Lb9",header:"styles-module__header__3cqyY",amp:"styles-module__amp__1zeIe",del:"styles-module__del__1_otl",gisticTable:"styles-module__gisticTable__2fquv",GisticGeneToggles:"styles-module__GisticGeneToggles__1aR6k",someGenes:"styles-module__someGenes__J-RhD",moreGenes:"styles-module__moreGenes__2gVF_",geneToggle:"styles-module__geneToggle__EGiaB",simulateHovered:"styles-module__simulateHovered__3IL_G",notSelected:"styles-module__notSelected__3-Rmx",showMoreLess:"styles-module__showMoreLess__3Ef4J",GenesetsSelectorWindow:"styles-module__GenesetsSelectorWindow__NTbph",GenesetsFormGroup:"styles-module__GenesetsFormGroup__1uJYh",GenesetsVolcanoSelectorWindow:"styles-module__GenesetsVolcanoSelectorWindow__w4nHP",GenesetsSelectionArea:"styles-module__GenesetsSelectionArea__3ebp-",transposeDataMatrix:"styles-module__transposeDataMatrix__YP_NR",submitRow:"styles-module__submitRow__k2sC8",genomeSpace:"styles-module__genomeSpace__2augo",tooltip:"styles-module__tooltip__ux3KI",learnOql:"styles-module__learnOql__1Aj5I",quickSelect:"styles-module__quickSelect__3ZhaC",studyName:"styles-module__studyName__2iQkr"}},788:function(e,t,r){"use strict";var n=r(1),i=r(13),o=r(2);function a(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var u="tissue",l="My Virtual Studies",c="Studies",d=function(){function e(t){var r,i,o,s=this,d=t.cancerTypes,p=void 0===d?[]:d,f=t.studies,y=void 0===f?[]:f,h=t.priorityStudies,m=void 0===h?{}:h,g=t.virtualStudies,v=void 0===g?[]:g,S=t.maxTreeDepth,b=void 0===S?0:S;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rootCancerType={clinicalTrialKeywords:"",dedicatedColor:"",name:"All",parent:"",shortName:"All",cancerTypeId:u},this.virtualStudyCategory={clinicalTrialKeywords:"",dedicatedColor:"",name:l,parent:u,shortName:l,cancerTypeId:l,alwaysVisible:!0},this.physicalStudyCategory={clinicalTrialKeywords:"",dedicatedColor:"",name:c,parent:u,shortName:c,cancerTypeId:c,alwaysVisible:!0},this.priorityCategories=[],this.map_node_meta=new Map,this.map_cancerTypeId_cancerType=new Map,this.map_studyId_cancerStudy=new Map,p=e.sortNodes(p);var _=v.map(function(e){if(e.data)return{allSampleCount:n.sumBy(e.data.studies,function(e){return e.samples.length}),studyId:e.id,name:e.data.name,description:e.data.description,cancerTypeId:l}}).filter(function(e){return e});for(var I in m)this.priorityCategories.push({clinicalTrialKeywords:"",dedicatedColor:"",name:I,parent:u,shortName:I,cancerTypeId:I});0===b&&v.length>0&&(y=n.map(y,function(e){return e.cancerTypeId=s.physicalStudyCategory.cancerTypeId,e}));for(var T=0,w=[p=[this.virtualStudyCategory,this.physicalStudyCategory].concat(a(this.priorityCategories),[this.rootCancerType],a(p)),y=e.sortNodes([].concat(a(_),a(y)))];T<w.length;T++){r=w[T];var P=!0,k=!1,E=void 0;try{for(var O,C=r[Symbol.iterator]();!(P=(O=C.next()).done);P=!0){i=O.value;var x=r==p;x?this.map_cancerTypeId_cancerType.set(i.cancerTypeId,i):this.map_studyId_cancerStudy.set(i.studyId,i);var R=x?i.name:[i.name,i.description].join("\n");this.map_node_meta.set(i,{isCancerType:x,isPriorityCategory:!1,priorityCategories:[],childCancerTypes:[],childStudies:[],descendantStudies:[],descendantCancerTypes:[],ancestors:[],siblings:[],searchTerms:R})}}catch(e){k=!0,E=e}finally{try{P||null==C.return||C.return()}finally{if(k)throw E}}}var A=!0,N=!1,M=void 0;try{for(var L,G=this.priorityCategories[Symbol.iterator]();!(A=(L=G.next()).done);A=!0){var V=L.value;(o=this.map_node_meta.get(V)).isPriorityCategory=!0;var j=!0,D=!1,Q=void 0;try{for(var q,B=m[V.cancerTypeId][Symbol.iterator]();!(j=(q=B.next()).done);j=!0){var F=q.value,U=this.map_studyId_cancerStudy.get(F);if(U)o.childStudies.push(U),o.descendantStudies.push(U),this.map_node_meta.get(U).priorityCategories.push(V)}}catch(e){D=!0,Q=e}finally{try{j||null==B.return||B.return()}finally{if(D)throw Q}}}}catch(e){N=!0,M=e}finally{try{A||null==G.return||G.return()}finally{if(N)throw M}}for(var H=0,W=[p,y];H<W.length;H++){r=W[H];var Y=!0,z=!1,X=void 0;try{for(var Z,J=r[Symbol.iterator]();!(Y=(Z=J.next()).done);Y=!0){i=Z.value,o=this.map_node_meta.get(i);var K=void 0;if(o.isCancerType){var $=i.alwaysVisible;K=this.map_cancerTypeId_cancerType.get(i.parent),$&&K&&(K.alwaysVisible=$)}else K=this.map_cancerTypeId_cancerType.get(i.cancerTypeId);var ee=K&&this.map_node_meta.get(K);for(ee&&(o.isCancerType?ee.childCancerTypes.push(i):ee.childStudies.push(i));K&&ee;)o.ancestors.push(K),o.isCancerType?ee.descendantCancerTypes.push(i):ee.descendantStudies.push(i),ee=(K=this.map_cancerTypeId_cancerType.get(K.parent))&&this.map_node_meta.get(K);var te=[].concat(a(o.ancestors),a(o.priorityCategories)).map(function(e){return e.name});o.searchTerms=[o.searchTerms].concat(a(te)).join("\n")}}catch(e){z=!0,X=e}finally{try{Y||null==J.return||J.return()}finally{if(z)throw X}}}var re=!0,ne=!1,ie=void 0;try{for(var oe,ae=y[Symbol.iterator]();!(re=(oe=ae.next()).done);re=!0){i=oe.value;var se=(o=this.map_node_meta.get(i)).ancestors[o.ancestors.length-2];if(se){var ue=this.map_node_meta.get(se);o.siblings=ue.descendantStudies}}}catch(e){ne=!0,ie=e}finally{try{re||null==ae.return||ae.return()}finally{if(ne)throw ie}}}var t,r,i;return t=e,i=[{key:"sortNodes",value:function(e){return n.sortBy(e,function(e){return e.name})}}],(r=null)&&s(t.prototype,r),i&&s(t,i),e}(),p=r(3),f=r(38),y=r(31),h=r(46),m=r(152),g=r.n(m),v=r(8),S=r(832),b=r(102),_=r.n(b),I=r(18),T=r(842),w=function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{u(n.next(e))}catch(e){o(e)}}function s(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}u((n=n.apply(e,t||[])).next())})};function P(e,t,r){return w(this,void 0,void 0,regeneratorRuntime.mark(function i(){var o,a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return o=n.chunk(e,r),a=o.map(t),i.t0=n,i.next=5,Promise.all(a);case 5:return i.t1=i.sent,i.abrupt("return",i.t0.flatten.call(i.t0,i.t1));case 7:case"end":return i.stop()}},i)}))}var k=r(11);function E(e){var t=e.selectableSelectedStudyIds,r=e.asyncCustomCaseSet.result.map(function(e){return e.studyId+":"+e.sampleId}).join("+"),n=e.getSelectedProfileIdFromMolecularAlterationType("MUTATION_EXTENDED");e.alterationTypesInOQL.haveMutInQuery&&!n&&e.defaultMutationProfile&&(n=e.defaultMutationProfile.molecularProfileId);var i=e.getSelectedProfileIdFromMolecularAlterationType("COPY_NUMBER_ALTERATION");e.alterationTypesInOQL.haveCnaInQuery&&!i&&e.defaultCnaProfile&&(i=e.defaultCnaProfile.molecularProfileId);var o=e.getSelectedProfileIdFromMolecularAlterationType("MRNA_EXPRESSION");e.alterationTypesInOQL.haveMrnaInQuery&&!o&&e.defaultMrnaProfile&&(o=e.defaultMrnaProfile.molecularProfileId);var a=e.getSelectedProfileIdFromMolecularAlterationType("PROTEIN_LEVEL");e.alterationTypesInOQL.haveProtInQuery&&!a&&e.defaultProtProfile&&(a=e.defaultProtProfile.molecularProfileId);var s={genetic_profile_ids_PROFILE_MUTATION_EXTENDED:n,genetic_profile_ids_PROFILE_COPY_NUMBER_ALTERATION:i,genetic_profile_ids_PROFILE_MRNA_EXPRESSION:o,genetic_profile_ids_PROFILE_METHYLATION:e.getSelectedProfileIdFromMolecularAlterationType("METHYLATION")||e.getSelectedProfileIdFromMolecularAlterationType("METHYLATION_BINARY"),genetic_profile_ids_PROFILE_PROTEIN_EXPRESSION:a,genetic_profile_ids_PROFILE_GENESET_SCORE:e.getSelectedProfileIdFromMolecularAlterationType("GENESET_SCORE"),genetic_profile_ids_PROFILE_GENERIC_ASSAY:e.getSelectedProfileIdFromMolecularAlterationType("GENERIC_ASSAY"),cancer_study_id:1===t.length?t[0]:"all",cancer_study_list:void 0,Z_SCORE_THRESHOLD:e.zScoreThreshold,RPPA_SCORE_THRESHOLD:e.rppaScoreThreshold,data_priority:e.dataTypePriorityCode,profileFilter:e.dataTypePriorityCode,case_set_id:e.selectedSampleListId||"-1",case_ids:r,gene_list:ae(e.geneQuery)||" ",geneset_list:ae(e.genesetQuery)||" ",tab_index:e.forDownloadTab?"tab_download":"tab_visualize",transpose_matrix:e.transposeDataMatrix?"on":void 0,Action:"Submit"};return 1!==t.length&&(s.cancer_study_list=t.join(",")),{query:s}}function O(e){var t=!1,r=!1,n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var u=a.value;if(u.showProfileInAnalysisTab){switch(u.molecularAlterationType){case k.a.MUTATION_EXTENDED:t=!0;break;case k.a.COPY_NUMBER_ALTERATION:r=!0}if(t&&r)break}}}catch(e){i=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}return{mutation:t,cna:r}}function C(e,t,r){var i={},o={},a={},s={},u={},l={},c={},d={};n.each(e,function(e){switch(e.category){case"all_cases_with_mutation_and_cna_data":a[e.studyId]=n.keyBy(e.sampleIds);break;case"all_cases_with_mutation_data":i[e.studyId]=n.keyBy(e.sampleIds);break;case"all_cases_with_cna_data":o[e.studyId]=n.keyBy(e.sampleIds);break;case"all_cases_in_study":s[e.studyId]=n.keyBy(e.sampleIds);break;default:e.sampleListId===e.studyId+"_all"&&(s[e.studyId]=n.keyBy(e.sampleIds))}});var p=n.map(r,function(e){return e.id}),f=t.filter(function(e){return!n.includes(p,e)});return n.forEach(f,function(e){u[e]=i[e]||{},l[e]=o[e]||{},c[e]=a[e]||{},d[e]=s[e]||{}}),n.forEach(r,function(e){n.forEach(e.data.studies,function(e){n.includes(f,e.id)||(u[e.id]=u[e.id]||{},l[e.id]=l[e.id]||{},c[e.id]=c[e.id]||{},d[e.id]=d[e.id]||{},n.forEach(e.samples,function(t){i[e.id]&&i[e.id][t]&&(u[e.id][t]=t),o[e.id]&&o[e.id][t]&&(l[e.id][t]=t),a[e.id]&&a[e.id][t]&&(c[e.id][t]=t),s[e.id]&&s[e.id][t]&&(d[e.id][t]=t)}))})}),{w_mut:n.reduce(u,function(e,t){return e+Object.keys(t).length},0),w_cna:n.reduce(l,function(e,t){return e+Object.keys(t).length},0),w_mut_cna:n.reduce(c,function(e,t){return e+Object.keys(t).length},0),all:n.reduce(d,function(e,t){return e+Object.keys(t).length},0)}}var x=r(41);function R(e){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A(e,t){return!t||"object"!==R(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function N(e){return(N=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function M(e,t){return(M=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var L=function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{u(n.next(e))}catch(e){o(e)}}function s(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}u((n=n.apply(e,t||[])).next())})};function G(e){return e}function V(e,t){return t}function j(e){return L(this,void 0,void 0,regeneratorRuntime.mark(function t(){var r,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.a.fetchMolecularProfilesUsingPOST({molecularProfileFilter:{studyIds:e}});case 2:return r=t.sent,o=n.groupBy(r,function(e){return e.studyId}),t.abrupt("return",e.map(function(e){return{data:[o[e]||[]],meta:e}}));case 5:case"end":return t.stop()}},t)}))}var D=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),A(this,N(t).call(this,G,V,j))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&M(e,t)}(t,x["a"]),t}(),Q=r(21),q=r(122);function B(e){var t=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;n.has(u,"genesets")&&u.genesets.forEach(function(e){return t.push(e)})}}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return t}var F=r(104);function U(e){return(U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function H(e,t){return!t||"object"!==U(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function W(e){return(W=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Y(e,t){return(Y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var z=function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{u(n.next(e))}catch(e){o(e)}}function s(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}u((n=n.apply(e,t||[])).next())})};var X=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),H(this,W(t).call(this,function(e){return{invoke:function(){return function(e){return z(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.a.getAllSampleListsInStudyUsingGET({studyId:e,projection:"DETAILED"});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t)}))}(e)}}},function(e){return e}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Y(e,t)}(t,F["a"]),t}();var Z=r(234),J=r(173);function K(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function $(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function te(e){return(te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r.d(t,"a",function(){return ie}),r.d(t,"e",function(){return ae}),r.d(t,"b",function(){return se}),r.d(t,"c",function(){return le}),r.d(t,"d",function(){return ce});var re=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":te(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},ne=function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{u(n.next(e))}catch(e){o(e)}}function s(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}u((n=n.apply(e,t||[])).next())})},ie="-1";function oe(e){return Number.isInteger(Number(e))}function ae(e){return e.trim().replace(/^\s+|\s+$/g,"").replace(/[ \+]+/g," ").toUpperCase()}var se,ue=["searchText","selectableSelectedStudyIds","dataTypePriority","selectedProfileIds","zScoreThreshold","rppaScoreThreshold","selectedSampleListId","caseIds","caseIdsMode","geneQuery","genesetQuery"];!function(e){e[e.Unfocused=0]="Unfocused",e[e.ShouldFocus=1]="ShouldFocus",e[e.Focused=2]="Focused"}(se||(se={}));var le=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.studiesHaveChangedSinceInitialization=!1,this.deletedVirtualStudies=[],this.forDownloadTab=!1,this.transposeDataMatrix=!1,this.searchText="",this._allSelectedStudyIds=o.observable.map(),this._defaultSelectedIds=o.observable.map(),this.dataTypePriority={mutation:!0,cna:!0},this._selectedProfileIds=void 0,this.zScoreThreshold="2.0",this.rppaScoreThreshold="2.0",this._selectedSampleListId=void 0,this.caseIds="",this._defaultStudySampleMap={},this._caseIdsMode="sample",this._geneQuery="",this.rawGenesetQuery="",this.geneQueryErrorDisplayStatus=se.Unfocused,this.genesetQueryErrorDisplayStatus=se.Unfocused,this.showMutSigPopup=!1,this.showGisticPopup=!1,this.showGenesetsHierarchyPopup=!1,this.showGenesetsVolcanoPopup=!1,this.priorityStudies=v.a.parseConfigFormat(v.b.serverConfig.priority_studies),this.showSelectedStudiesOnly=!1,this.selectedCancerTypeIds=[],this.clickAgainToDeselectSingle=!0,this.searchExampleMessage="",this.volcanoPlotSelectedPercentile={label:"75%",value:"75"},this._maxTreeDepth=parseInt(v.b.serverConfig.skin_query_max_tree_depth,10),this.cancerTypes=Object(p.T)({invoke:function(){return ne(r,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",i.a.getAllCancerTypesUsingGET({}).then(function(e){return e.filter(function(e){return"null"!==e.parent})}));case 1:case"end":return e.stop()}},e)}))}},[]),this.cancerStudies=Object(p.T)(i.a.getAllStudiesUsingGET({projection:"SUMMARY"}),[]),this.cancerStudyIdsSet=Object(p.T)({await:function(){return[r.cancerStudies]},invoke:function(){return ne(r,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(p.Z)(this.cancerStudies.result.map(function(e){return e.studyId})));case 1:case"end":return e.stop()}},e,this)}))},default:{}}),this.physicalStudiesIdsSet=Object(p.T)({await:function(){return[r.cancerStudies]},invoke:function(){return ne(r,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.cancerStudies.result.reduce(function(e,t){return e[t.studyId]=[t.studyId],e},{}));case 1:case"end":return e.stop()}},e,this)}))},default:{}}),this.virtualStudiesIdsSet=Object(p.T)({await:function(){return[r.userVirtualStudies]},invoke:function(){return ne(r,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.userVirtualStudies.result.reduce(function(e,t){return e[t.id]=[t.id],e},{}));case 1:case"end":return e.stop()}},e,this)}))},default:{}}),this.sharedQueriedStudiesSet=Object(p.T)({await:function(){return[r.physicalStudiesIdsSet,r.virtualStudiesIdsSet]},invoke:function(){return ne(r,void 0,void 0,regeneratorRuntime.mark(function e(){var t,r,i,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.physicalStudiesIdsSet.result,r=this.virtualStudiesIdsSet.result,i=Object.assign({},t,r),o=this._defaultSelectedIds.keys().filter(function(e){return!i[e]}),a={},e.next=7,Promise.all(o.map(function(e){return new Promise(function(r,i){q.a.getVirtualStudy(e).then(function(i){var o=i.data.studies.map(function(e){return e.id}),s=o.filter(function(e){return!t[e]});n.isEmpty(s)&&(a[e]=o),r()}).catch(function(){r()})})}));case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}},e,this)}))},default:{}}),this.physicalStudiesSet=Object(p.T)({await:function(){return[r.cancerStudies]},invoke:function(){return ne(r,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.cancerStudies.result.reduce(function(e,t){return e[t.studyId]=t,e},{}));case 1:case"end":return e.stop()}},e,this)}))},default:{}}),this.userVirtualStudies=Object(p.T)(function(){return ne(r,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!v.a.sessionServiceIsEnabled()||!this.userLoggedIn){e.next=13;break}return e.prev=1,e.next=4,q.a.getUserVirtualStudies();case 4:return t=e.sent,e.abrupt("return",t);case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",[]);case 11:e.next=14;break;case 13:return e.abrupt("return",[]);case 14:case"end":return e.stop()}},e,this,[[1,8]])}))},[]),this.userVirtualStudiesSet=Object(p.T)({await:function(){return[r.userVirtualStudies]},invoke:function(){return ne(r,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.userVirtualStudies.result.reduce(function(e,t){return e[t.id]=t,e},{}));case 1:case"end":return e.stop()}},e,this)}))},default:{}}),this.sharedVirtualStudiesSet=Object(p.T)({await:function(){return[r.physicalStudiesSet,r.userVirtualStudiesSet]},invoke:function(){return ne(r,void 0,void 0,regeneratorRuntime.mark(function e(){var t,r,i,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.physicalStudiesSet.result,r=this.userVirtualStudiesSet.result,i=Object.assign([],Object.keys(t),Object.keys(r)),o=this._defaultSelectedIds.keys().filter(function(e){return!n.includes(i,e)}),a={},e.next=7,Promise.all(o.map(function(e){return new Promise(function(r,n){q.a.getVirtualStudy(e).then(function(n){0===n.data.studies.map(function(e){return e.id}).filter(function(e){return!t[e]}).length&&(a[e]=n),r()}).catch(function(){r()})})}));case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}},e,this)}))},default:{}}),this.selectedStudyToSampleSet=Object(p.T)({await:function(){return[r.userVirtualStudiesSet,r.sharedVirtualStudiesSet]},invoke:function(){return ne(r,void 0,void 0,regeneratorRuntime.mark(function e(){var t,r,o,a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},r=n.filter(this.allSelectedStudyIds,function(e){return a.physicalStudiesSet.result[e]}),this._allSelectedStudyIds.keys().length===r.length){e.next=9;break}return e.next=5,Promise.all(n.map(r,function(e){return i.a.getAllSamplesInStudyUsingGET({studyId:e}).then(function(r){t[e]=Object(p.Z)(r.map(function(e){return e.sampleId}))})}));case 5:o=Object.assign(Object.assign({},this.userVirtualStudiesSet.result),this.sharedVirtualStudiesSet.result),this._allSelectedStudyIds.keys().forEach(function(e){o[e]&&o[e].data.studies.forEach(function(e){void 0===t[e.id]&&(t[e.id]=Object(p.Z)(e.samples))})}),e.next=10;break;case 9:r.forEach(function(e){t[e]={}});case 10:return e.abrupt("return",t);case 11:case"end":return e.stop()}},e,this)}))},default:{}}),this.selectableStudiesSet=Object(p.T)({await:function(){return[r.physicalStudiesSet,r.selectedStudyToSampleSet]},invoke:function(){return ne(r,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={},n.each(this.physicalStudiesSet.result,function(e,r){t[r]=[r]}),n.each(this.userVirtualStudiesSet.result,function(e,r){t[r]=[r]}),n.each(this.sharedVirtualStudiesSet.result,function(e,r){t[r]=e.data.studies.map(function(e){return e.id})}),e.abrupt("return",t);case 5:case"end":return e.stop()}},e,this)}))},default:{},onResult:function(){if(r.selectedSampleListId!==ie){var e=r.sharedVirtualStudiesSet.result,t=n.filter(r._allSelectedStudyIds.keys(),function(t){return void 0!==e[t]});if(n.isEmpty(t))r.caseIds="";else{var i=r._defaultStudySampleMap;(void 0===i||n.isEmpty(i))&&(i=n.reduce(r.selectedStudyToSampleSet.result,function(e,t,r){return e[r]=n.keys(t),e},{})),n.some(i,function(e){return e.length>0})&&r.setCaseIds(i)}}}}),this.unknownStudyIds=Object(p.T)({await:function(){return[r.selectableStudiesSet]},invoke:function(){return ne(r,void 0,void 0,regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.selectableStudiesSet.result,r=this._allSelectedStudyIds.keys(),e.abrupt("return",r.filter(function(e){return!(e in t)}));case 3:case"end":return e.stop()}},e,this)}))},default:[]}),this.molecularProfiles=Object(p.T)({invoke:function(){return ne(r,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(1!==this.physicalStudyIdsInSelection.length){e.next=6;break}return e.next=3,i.a.getAllMolecularProfilesInStudyUsingGET({studyId:this.physicalStudyIdsInSelection[0]});case 3:return e.abrupt("return",e.sent);case 6:return e.abrupt("return",[]);case 7:case"end":return e.stop()}},e,this)}))},default:[],onResult:function(){r.initiallySelected.profileIds&&!r.studiesHaveChangedSinceInitialization||(r._selectedProfileIds=void 0)}}),this.molecularProfilesInSelectedStudies=Object(p.T)({invoke:function(){return ne(r,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.molecularProfilesInStudyCache.getPromise(this.physicalStudyIdsInSelection,!0);case 2:return t=e.sent,e.abrupt("return",n.flatten(t.map(function(e){return e.data?e.data:[]})));case 4:case"end":return e.stop()}},e,this)}))},default:[]}),this.sampleListInSelectedStudies=Object(p.T)({await:function(){return r.physicalStudyIdsInSelection.map(function(e){return r.sampleListsInStudyCache.get(e)})},invoke:function(){return ne(r,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.reduce(this.physicalStudyIdsInSelection,function(e,r){var i=t.sampleListsInStudyCache.get(r).result;return n.isUndefined(i)||(e=e.concat(i)),e},[]));case 1:case"end":return e.stop()}},e,this)}))},default:[],onResult:function(){r.initiallySelected.sampleListId&&!r.studiesHaveChangedSinceInitialization||(r._selectedSampleListId=void 0)}}),this.profileAvailability=Object(p.T)({await:function(){return[r.molecularProfilesInSelectedStudies]},invoke:function(){return Promise.resolve(O(r.molecularProfilesInSelectedStudies.result))},default:{mutation:!1,cna:!1},onResult:function(){r.initiallySelected.sampleListId&&!r.studiesHaveChangedSinceInitialization||(r.dataTypePriority=O(r.molecularProfilesInSelectedStudies.result))}}),this.profiledSamplesCount=Object(p.T)({await:function(){return[r.sampleListInSelectedStudies]},invoke:function(){return ne(r,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",C(this.sampleListInSelectedStudies.result,this.selectableSelectedStudyIds,this.selectedVirtualStudies));case 1:case"end":return e.stop()}},e,this)}))},default:{w_mut:0,w_cna:0,w_mut_cna:0,all:0}}),this.sampleLists=Object(p.T)({invoke:function(){return ne(r,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isSingleNonVirtualStudySelected){e.next=2;break}return e.abrupt("return",[]);case 2:return this.sampleListsInStudyCache.get(this.selectableSelectedStudyIds[0]).result,e.next=5,this.sampleListsInStudyCache.get(this.selectableSelectedStudyIds[0]).result;case 5:return t=e.sent,e.abrupt("return",n.sortBy(t,function(e){return e.name}));case 7:case"end":return e.stop()}},e,this)}))},default:[],onResult:function(){r.initiallySelected.sampleListId&&!r.studiesHaveChangedSinceInitialization||(r._selectedSampleListId=void 0)}}),this.mutSigForSingleStudy=Object(p.T)({invoke:function(){return ne(r,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isSingleNonVirtualStudySelected){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,y.a.getSignificantlyMutatedGenesUsingGET({studyId:this.selectableSelectedStudyIds[0]});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}))},default:[]}),this.gisticForSingleStudy=Object(p.T)({invoke:function(){return ne(r,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isSingleNonVirtualStudySelected){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,y.a.getSignificantCopyNumberRegionsUsingGET({studyId:this.selectableSelectedStudyIds[0]});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}))},default:[]}),this.genes=Object(p.T)({invoke:function(){return r.invokeGenesLater(r.geneIds)},default:{found:[],suggestions:[]}}),this.genesets=Object(p.T)({invoke:function(){return r.invokeGenesetsLater(r.genesetIds)},default:{found:[],invalid:[]}}),this.invokeGenesLater=Object(f.debounceAsync)(function(e){return ne(r,void 0,void 0,regeneratorRuntime.mark(function t(){var r,o,a,s,u,l,c,d,p,f,y=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.partition(n.uniq(e),oe),o=$(r,2),a=o[0],s=o[1],u=function(){return ne(y,void 0,void 0,regeneratorRuntime.mark(function e(){var t,r,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.length){e.next=6;break}return e.next=3,i.a.fetchGenesUsingPOST({geneIdType:"ENTREZ_GENE_ID",geneIds:a});case 3:t=e.sent,e.next=7;break;case 6:t=[];case 7:return r=n.difference(a,t.map(function(e){return e.entrezGeneId+""})),o=r.map(function(e){return{alias:e,genes:[]}}),s=t.map(function(e){return{alias:e.entrezGeneId+"",genes:[e]}}),u=[].concat(K(o),K(s)),e.abrupt("return",{found:t,suggestions:u});case 12:case"end":return e.stop()}},e)}))},l=function(){return ne(y,void 0,void 0,regeneratorRuntime.mark(function e(){var t,r,o,a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!s.length){e.next=6;break}return e.next=3,i.a.fetchGenesUsingPOST({geneIdType:"HUGO_GENE_SYMBOL",geneIds:s});case 3:t=e.sent,e.next=7;break;case 6:t=[];case 7:return r=n.difference(s,t.map(function(e){return e.hugoGeneSymbol})),e.next=10,Promise.all(r.map(function(e){return a.getGeneSuggestions(e)}));case 10:return o=e.sent,e.abrupt("return",{found:t,suggestions:o});case 12:case"end":return e.stop()}},e)}))},t.next=5,Promise.all([u(),l()]);case 5:return c=t.sent,d=$(c,2),p=d[0],f=d[1],t.abrupt("return",{found:[].concat(K(p.found),K(f.found)),suggestions:[].concat(K(p.suggestions),K(f.suggestions))});case 10:case"end":return t.stop()}},t)}))},500),this.invokeGenesetsLater=Object(f.debounceAsync)(function(e){return ne(r,void 0,void 0,regeneratorRuntime.mark(function t(){var r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.length>0)){t.next=8;break}return t.next=3,y.a.fetchGenesetsUsingPOST({genesetIds:e});case 3:return r=t.sent,i=n.difference(e,r.map(function(e){return e.genesetId})),t.abrupt("return",{found:r,invalid:i});case 8:return t.abrupt("return",Promise.resolve({found:[],invalid:[]}));case 9:case"end":return t.stop()}},t)}))},500),this.asyncCustomCaseSet=Object(p.T)({invoke:function(){return ne(r,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.selectedSampleListId===ie&&0!==this.caseIds.trim().length){e.next=2;break}return e.abrupt("return",[]);case 2:return e.abrupt("return",this.invokeCustomCaseSetLater({isVirtualStudySelected:this.isVirtualStudySelected,caseIds:this.caseIds,caseIdsMode:this.caseIdsMode}));case 3:case"end":return e.stop()}},e,this)}))},default:[]}),this.invokeCustomCaseSetLater=Object(f.debounceAsync)(function(e){return ne(r,void 0,void 0,regeneratorRuntime.mark(function t(){var r,o,a,s,u,l,c,d,f,y,h,m,g,v,S,b,_,I,T,w,k,E,O,C,x,R,A=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r="",this.isSingleNonVirtualStudySelected&&(r=this.selectableSelectedStudyIds[0]),o=e.caseIds.trim().split(/\s+/g),a=Object(p.Z)(this.physicalStudyIdsInSelection),s=o.map(function(e){var t=e.split(":");if(1===t.length){if(r)return{id:e,study:r};throw new Error("No study specified for ".concat(A.caseIdsMode," id: ").concat(e,", and more than one study selected for query."))}if(2===t.length){var n=t[0],i=t[1];if(!a[n]){var o="";throw A.isVirtualStudySelected&&(o=", nor part of a selected Saved Study"),new Error("Study ".concat(n," is not selected").concat(o,"."))}return{id:i,study:n}}throw new Error("Input error for entity: ".concat(e,"."))}),u=Object(p.X)(s.map(function(e){return"".concat(e.study,":").concat(e.id)})),l=[],c={},d=[],"sample"!==e.caseIdsMode){t.next=37;break}if(!(f=s.map(function(e){return{studyId:e.study,sampleId:e.id}})).length){t.next=35;break}return t.next=14,P(f,function(e){return i.a.fetchSamplesUsingPOST({sampleFilter:{sampleIdentifiers:e},projection:"SUMMARY"})},990);case 14:for(y=t.sent,y=n.sortBy(y,function(e){return u["".concat(e.studyId,":").concat(e.sampleId)]}),h=!0,m=!1,g=void 0,t.prev=19,v=y[Symbol.iterator]();!(h=(S=v.next()).done);h=!0)b=S.value,l.push({studyId:b.studyId,sampleId:b.sampleId}),c["".concat(b.studyId,":").concat(b.sampleId)]=!0;t.next=27;break;case 23:t.prev=23,t.t0=t.catch(19),m=!0,g=t.t0;case 27:t.prev=27,t.prev=28,h||null==v.return||v.return();case 30:if(t.prev=30,!m){t.next=33;break}throw g;case 33:return t.finish(30);case 34:return t.finish(27);case 35:t.next=61;break;case 37:return _=s.map(function(e){return A.getSamplesForStudyAndPatient(e.study,e.id)}),t.next=40,Promise.all(_);case 40:for(I=t.sent,I=n.sortBy(I,function(e){return u["".concat(e.studyId,":").concat(e.patientId)]}),T=!0,w=!1,k=void 0,t.prev=45,E=I[Symbol.iterator]();!(T=(O=E.next()).done);T=!0)C=O.value,C.studyId,C.patientId,x=C.samples,!C.error&&x.length&&(l=l.concat(x.map(function(e){return c["".concat(e.studyId,":").concat(e.patientId)]=!0,{studyId:e.studyId,sampleId:e.sampleId}})));t.next=53;break;case 49:t.prev=49,t.t1=t.catch(45),w=!0,k=t.t1;case 53:t.prev=53,t.prev=54,T||null==E.return||E.return();case 56:if(t.prev=56,!w){t.next=59;break}throw k;case 59:return t.finish(56);case 60:return t.finish(53);case 61:if(d=d.concat(s.filter(function(e){return!c["".concat(e.study,":").concat(e.id)]})),R=this.selectedStudyToSampleSet.result,l.forEach(function(e){R[e.studyId]&&!n.isEmpty(R[e.studyId])&&(R[e.studyId][e.sampleId]||d.push({id:e.sampleId,study:e.studyId}))}),!d.length){t.next=70;break}if(!this.isSingleNonVirtualStudySelected){t.next=69;break}throw new Error("Invalid ".concat(e.caseIdsMode).concat(d.length>1?"s":""," for the selected cancer study: ").concat(d.map(function(e){return e.id}).join(", ")));case 69:throw new Error("Invalid (study, ".concat(e.caseIdsMode,") pair").concat(d.length>1?"s":"",": ").concat(d.map(function(e){return"(".concat(e.study,", ").concat(e.id,")")}).join(", "),"\n\t\t\t\t\t\t"));case 70:return t.abrupt("return",l);case 71:case"end":return t.stop()}},t,this,[[19,23,27,35],[28,,30,34],[45,49,53,61],[54,,56,60]])}))},500),this.studyListLogic=new T.b(this),this.hierarchyData=Object(p.T)({invoke:function(){return ne(r,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Q.X)(this.getFilteredProfiles("GENESET_SCORE")[0].molecularProfileId,Number(this.volcanoPlotSelectedPercentile.value),0,1,this.defaultSelectedSampleListId);case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}},e,this)}))}}),this.volcanoPlotTableData=Object(p.T)({await:function(){return[r.hierarchyData]},invoke:function(){return ne(r,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",B(this.hierarchyData.result));case 1:case"end":return e.stop()}},e,this)}))}}),this.map_genesets_selected_volcano=new o.ObservableMap,this.dict_molecularAlterationType_filenameSuffix={MUTATION_EXTENDED:"mutations",COPY_NUMBER_ALTERATION:"cna",MRNA_EXPRESSION:"mrna",METHYLATION:"methylation",METHYLATION_BINARY:"methylation",PROTEIN_LEVEL:"rppa"},this.asyncUrlParams=Object(p.T)({await:function(){return[r.asyncCustomCaseSet]},invoke:function(){return ne(r,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",E(this));case 1:case"end":return e.stop()}},e,this)}))}}),this.initiallySelected={profileIds:!1,sampleListId:!1},this.initialize(t)}var t,r,a;return t=e,(r=[{key:"initialize",value:function(e){var t=this;Object(f.labelMobxPromises)(this),e&&this.setParamsFromUrl(e);var r=localStorage.getItem("legacyStudySubmission");if(localStorage.removeItem("legacyStudySubmission"),r)try{this.setParamsFromLocalStorage(JSON.parse(r))}catch(e){throw"error parseing/setting legacyStudySubmission"}Object(o.reaction)(function(){return t.allSelectedStudyIds},function(){t.studiesHaveChangedSinceInitialization=!0})}},{key:"deleteVirtualStudy",value:function(e){var t=this;q.a.deleteVirtualStudy(e).then(Object(o.action)(function(){t.deletedVirtualStudies.push(e),-1!==t.selectableSelectedStudyIds.indexOf(e)&&(t.selectableSelectedStudyIds=n.difference(t.selectableSelectedStudyIds,[e]))}),Object(o.action)(function(e){}))}},{key:"restoreVirtualStudy",value:function(e){var t=this;q.a.addVirtualStudy(e).then(Object(o.action)(function(){t.deletedVirtualStudies=t.deletedVirtualStudies.filter(function(t){return t!==e})}),Object(o.action)(function(e){}))}},{key:"setStudyIdSelected",value:function(e,t){if(this.forDownloadTab){var r={};t&&(r[e]=t),this._allSelectedStudyIds=o.observable.map(r)}else t?this._allSelectedStudyIds.set(e,!0):this._allSelectedStudyIds.delete(e)}},{key:"setCaseIds",value:function(e){this.selectedSampleListId=ie,this.caseIdsMode="sample",this.caseIds=n.flatten(Object.keys(e).map(function(t){return e[t].map(function(e){return"".concat(t,":").concat(e)})})).join("\n")}},{key:"getGeneSuggestions",value:function(e){return ne(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=e,t.next=3,i.a.getAllGenesUsingGET({alias:e});case 3:return t.t1=t.sent,t.abrupt("return",{alias:t.t0,genes:t.t1});case 5:case"end":return t.stop()}},t)}))}},{key:"getSamplesForStudyAndPatient",value:function(e,t){return i.a.getAllSamplesOfPatientInStudyUsingGET({studyId:e,patientId:t}).then(function(r){return{studyId:e,patientId:t,samples:r,error:void 0}},function(r){return{studyId:e,patientId:t,samples:[],error:r}})}},{key:"isVirtualStudy",value:function(e){return!this.cancerStudyIdsSet.result[e]}},{key:"isDeletedVirtualStudy",value:function(e){return!!(this.isVirtualStudy(e)&&this.deletedVirtualStudies.indexOf(e)>-1)}},{key:"isSingleStudySelected",value:function(e){if(1!==this.selectableSelectedStudyIds.length)return!1;var t=this.selectableSelectedStudyIds[0];return this.isVirtualStudy(t)===e}},{key:"calculateDataTypePriorityCode",value:function(e){var t=e.mutation,r=e.cna;return t&&r?"0":t?"1":r?"2":"0"}},{key:"getFilteredProfiles",value:function(e){var t=this;return this.molecularProfiles.result.filter(function(r){return r.molecularAlterationType==e&&(r.showProfileInAnalysisTab||t.forDownloadTab)})}},{key:"isProfileSelected",value:function(e){return n.includes(this.selectedProfileIds,e)}},{key:"getSelectedProfileIdFromMolecularAlterationType",value:function(e,t){var r=!0,n=!1,i=void 0;try{for(var o,a=(t||this.selectedProfileIds)[Symbol.iterator]();!(r=(o=a.next()).done);r=!0){var s=o.value,u=this.dict_molecularProfileId_molecularProfile[s];if(u&&u.molecularAlterationType===e)return u.molecularProfileId}}catch(e){n=!0,i=e}finally{try{r||null==a.return||a.return()}finally{if(n)throw i}}return""}},{key:"sanitizeQueryParams",value:function(e){return e?decodeURIComponent(e).replace(/\+/g,"\n"):""}},{key:"setParamsFromUrl",value:function(e){var t;"string"==typeof e?t=_.a.parse(e,!0).query:t=e;var r=[t.genetic_profile_ids_PROFILE_MUTATION_EXTENDED,t.genetic_profile_ids_PROFILE_COPY_NUMBER_ALTERATION,t.genetic_profile_ids_PROFILE_MRNA_EXPRESSION,t.genetic_profile_ids_PROFILE_METHYLATION,t.genetic_profile_ids_PROFILE_PROTEIN_EXPRESSION,t.genetic_profile_ids_PROFILE_GENESET_SCORE,t.genetic_profile_ids_PROFILE_GENERIC_ASSAY],i=t.cancer_study_list?t.cancer_study_list.split(","):t.cancer_study_id?[t.cancer_study_id]:[];this.selectableSelectedStudyIds=i,this._defaultSelectedIds=o.observable.map(Object(p.Z)(i)),this._selectedProfileIds=r.every(function(e){return void 0===e})?void 0:r.filter(n.identity),this.zScoreThreshold=t.Z_SCORE_THRESHOLD||"2.0",this.rppaScoreThreshold=t.RPPA_SCORE_THRESHOLD||"2.0",this.dataTypePriorityCode=t.data_priority||t.profileFilter||"0",this.selectedSampleListId=t.case_set_id?t.case_set_id.toString():"",this.caseIds=this.sanitizeQueryParams(t.case_ids),this.caseIdsMode="sample",this.geneQuery=ae(decodeURIComponent(t.gene_list||"")),this.genesetQuery=ae(decodeURIComponent(t[Z.a.geneset_list]||"")),this.forDownloadTab="tab_download"===t.tab_index,this.initiallySelected.profileIds=!0,this.initiallySelected.sampleListId=!0}},{key:"setParamsFromLocalStorage",value:function(e){var t=e.case_ids;if(t&&e.case_set_id==ie&&(this.selectedSampleListId=ie,this.caseIdsMode="sample",this.caseIds=t.replace(/\+/g,"\n"),this.initiallySelected.sampleListId=!0),e.cancer_study_list){var r=!0,n=!1,i=void 0;try{for(var o,a=e.cancer_study_list.split(",")[Symbol.iterator]();!(r=(o=a.next()).done);r=!0){var s=o.value;"null"!==s&&(this.setStudyIdSelected(s,!0),this._defaultSelectedIds.set(s,!0))}}catch(e){n=!0,i=e}finally{try{r||null==a.return||a.return()}finally{if(n)throw i}}}}},{key:"selectCancerType",value:function(e,t){var r=e.cancerTypeId;t?n.includes(this.selectedCancerTypeIds,r)?this.selectedCancerTypeIds=n.difference(this.selectedCancerTypeIds,[r]):this.selectedCancerTypeIds=n.union(this.selectedCancerTypeIds,[r]):this.clickAgainToDeselectSingle&&n.isEqual(Object(o.toJS)(this.selectedCancerTypeIds),[r])?this.selectedCancerTypeIds=[]:this.selectedCancerTypeIds=[r]}},{key:"setSearchText",value:function(e){this.clearSelectedCancerType(),this.searchText=e}},{key:"clearSelectedCancerType",value:function(){this.selectedCancerTypeIds=[]}},{key:"selectMolecularProfile",value:function(e,t){var r=this.getFilteredProfiles(e.molecularAlterationType).map(function(e){return e.molecularProfileId});if(this.forDownloadTab)this._selectedProfileIds=[e.molecularProfileId];else{var i=n.difference(this.selectedProfileIds,r);this._selectedProfileIds=t?n.union(i,[e.molecularProfileId]):i}}},{key:"replaceGene",value:function(e,t){this.geneQuery=ae(this.geneQuery.toUpperCase().replace(new RegExp("\\b".concat(e.toUpperCase(),"\\b"),"g"),function(){return t.toUpperCase()}))}},{key:"replaceGeneset",value:function(e,t){this.genesetQuery=ae(this.genesetQuery.toUpperCase().replace(new RegExp("\\b".concat(e.toUpperCase(),"\\b"),"g"),function(){return t.toUpperCase()}))}},{key:"applyGeneSelection",value:function(e){var t=$(n.partition(e.keys(),function(t){return e.get(t)}),2),r=t[0],i=t[1];r=n.difference(r,this.geneIds),i=n.intersection(i,this.geneIds);var o=!0,a=!1,s=void 0;try{for(var u,l=i[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var c=u.value;this.replaceGene(c,"")}}catch(e){a=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(a)throw s}}this.geneQuery=ae([this.geneQuery].concat(K(r)).join(" "))}},{key:"addToGenesetSelection",value:function(e){var t=$(n.partition(e.keys(),function(t){return e.get(t)}),2),r=t[0],i=(t[1],n.union(r,this.genesetIds).join(" "));this.genesetQuery=ae(i)}},{key:"applyGenesetSelection",value:function(e){var t=$(n.partition(e.keys(),function(t){return e.get(t)}),2),r=t[0],i=t[1],o=this.genesetQuery;if(r.length>0){var a=[],s=!0,u=!1,l=void 0;try{for(var c,d=r[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var p=c.value;a.push(p)}}catch(e){u=!0,l=e}finally{try{s||null==d.return||d.return()}finally{if(u)throw l}}o=a.join(" ")}if(i.length>0){var f=o.split(" "),y=!0,h=!1,m=void 0;try{for(var g,v=i[Symbol.iterator]();!(y=(g=v.next()).done);y=!0){var S=g.value,b=!0,_=!1,I=void 0;try{for(var T,w=f[Symbol.iterator]();!(b=(T=w.next()).done);b=!0){var P=T.value;if(S===P){var k=f.indexOf(P);k>=0&&f.splice(k,1)}}}catch(e){_=!0,I=e}finally{try{b||null==w.return||w.return()}finally{if(_)throw I}}}}catch(e){h=!0,m=e}finally{try{y||null==v.return||v.return()}finally{if(h)throw m}}o=f.join(" ")}o=ae(o),this.genesetQuery=o}},{key:"submit",value:function(){if(this.oql.error)return this.geneQueryErrorDisplayStatus=se.ShouldFocus,this.genesetQueryErrorDisplayStatus=se.ShouldFocus,!1;if(!this.submitEnabled||!this.asyncUrlParams.isComplete)return!1;var e=this.asyncUrlParams.result;return this.forDownloadTab?function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"post",i=document.createElement("form"),o=n;"smart"===n&&(o=Object(I.b)(e,t).length>1800?"post":"get"),i.setAttribute("method",o),i.setAttribute("action",e),r&&i.setAttribute("target",r);for(var a=0,s=Object.keys(t);a<s.length;a++){var u=s[a],l=document.createElement("input");l.setAttribute("type","hidden"),l.setAttribute("name",u),l.setAttribute("value",t[u]),i.appendChild(l)}document.body.appendChild(i),i.submit()}(Object(I.b)("data_download"),e.query,void 0,"smart"):this.singlePageAppSubmitRoutine(e.query),!0}},{key:"openSummary",value:function(){this.summaryEnabled&&Object(I.E)(this.selectableSelectedStudyIds)}},{key:"virtualStudiesMap",get:function(){return n.keyBy(this.userVirtualStudies.result,function(e){return e.id})}},{key:"selectedVirtualStudies",get:function(){var e=this;return n.reduce(this.selectableSelectedStudies,function(t,r){return e.isVirtualStudy(r.studyId)&&void 0!==e.virtualStudiesMap&&e.virtualStudiesMap[r.studyId]&&t.push(e.virtualStudiesMap[r.studyId]),t},[])}},{key:"physicalStudyIdsInSelection",get:function(){var e={},t=!0,r=!1,n=void 0;try{for(var i,o=this.selectableSelectedStudyIds[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value,s=this.virtualStudiesMap[a];s?s.data.studies.forEach(function(t){return e[t.id]=!0}):e[a]=!0}}catch(e){r=!0,n=e}finally{try{t||null==o.return||o.return()}finally{if(r)throw n}}return Object.keys(e)}},{key:"stateToSerialize",get:function(){return n.pick(this,ue)}},{key:"onlyOneReferenceGenome",get:function(){return 1===n.uniq(this.selectableSelectedStudies.map(function(e){return e.referenceGenome})).length}},{key:"allSelectedStudyIds",get:function(){return this._allSelectedStudyIds.keys()}},{key:"selectableSelectedStudyIds",get:function(){var e=this._allSelectedStudyIds.keys(),t=this.selectableStudiesSet.result;return e=e.reduce(function(e,r){return t[r]?e.concat(t[r]):e},[]),e=n.uniq(e),this.forDownloadTab?e.slice(-1):e},set:function(e){this._allSelectedStudyIds=o.observable.map(Object(p.Z)(e))}},{key:"defaultSelectedIds",get:function(){return this._defaultSelectedIds}},{key:"selectedProfileIds",get:function(){var e,t=this;if(void 0!==this._selectedProfileIds)e=this._selectedProfileIds;else{e=[];for(var r=0,n=["MUTATION_EXTENDED","COPY_NUMBER_ALTERATION"];r<n.length;r++){var i=n[r],o=this.getFilteredProfiles(i);o.length&&e.push(o[0].molecularProfileId)}}return this.forDownloadTab?e.slice(0,1):e.filter(function(e){var r=t.dict_molecularProfileId_molecularProfile[e];return r&&r.showProfileInAnalysisTab})},set:function(e){this._selectedProfileIds=e}},{key:"selectedSampleListId",get:function(){return void 0!==this._selectedSampleListId?this._selectedSampleListId:this.defaultSelectedSampleListId},set:function(e){this._selectedSampleListId=e}},{key:"caseIdsMode",get:function(){return this.selectedSampleListId===ie?this._caseIdsMode:"sample"},set:function(e){this._caseIdsMode=e}},{key:"geneQuery",get:function(){return this._geneQuery},set:function(e){this.geneQueryErrorDisplayStatus=se.Unfocused,this._geneQuery=e}},{key:"genesetQuery",get:function(){return this.rawGenesetQuery.toUpperCase()},set:function(e){this.genesetQueryErrorDisplayStatus=se.Unfocused,this.rawGenesetQuery=e}},{key:"maxTreeDepth",get:function(){return this.forDownloadTab&&this._maxTreeDepth>0?1:this._maxTreeDepth},set:function(e){this._maxTreeDepth=e}},{key:"userLoggedIn",get:function(){return Object(p.C)().globalStores.appStore.isLoggedIn}},{key:"treeData",get:function(){return new d({cancerTypes:this.cancerTypes.result,studies:this.cancerStudies.result,priorityStudies:this.priorityStudies,virtualStudies:this.forDownloadTab?[]:this.userVirtualStudies.result,maxTreeDepth:this.maxTreeDepth})}},{key:"selectedCancerTypes",get:function(){var e=this;return this.selectedCancerTypeIds.map(function(t){return e.treeData.map_cancerTypeId_cancerType.get(t)}).filter(n.identity)}},{key:"selectableSelectedStudies",get:function(){var e=this;return this.selectableSelectedStudyIds.map(function(t){return e.treeData.map_studyId_cancerStudy.get(t)}).filter(n.identity)}},{key:"isSingleVirtualStudySelected",get:function(){return this.isSingleStudySelected(!0)}},{key:"isSingleNonVirtualStudySelected",get:function(){return this.isSingleStudySelected(!1)}},{key:"isMultipleNonVirtualStudiesSelected",get:function(){var e=this;return this.selectableSelectedStudyIds.filter(function(t){return!e.isVirtualStudy(t)}).length>1}},{key:"getOverlappingStudiesMap",get:function(){var e,t,r=(e=this.selectableSelectedStudies,t=n.reduce(e,function(e,t){if(/_tcga/.test(t.studyId)){var r=t.studyId.replace(/(_\d\d\d\d|_pub|(_pub\d\d\d\d)|_pan_can_atlas_\d\d\d\d)$/g,"");r&&(r in e?e[r].push(t):e[r]=[t])}return e},{}),n.filter(t,function(e){return e.length>1}));return n.chain(r).flatten().keyBy(function(e){return e.studyId}).value()}},{key:"isVirtualStudySelected",get:function(){var e=!1,t=!0,r=!1,n=void 0;try{for(var i,o=this.selectableSelectedStudyIds[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;if(this.virtualStudiesMap[a]){e=!0;break}}}catch(e){r=!0,n=e}finally{try{t||null==o.return||o.return()}finally{if(r)throw n}}return e}},{key:"isVirtualStudyQuery",get:function(){return 0!==this.selectableSelectedStudyIds.length&&(this.selectableSelectedStudyIds.length>1||this.isSingleVirtualStudySelected)}},{key:"dataTypePriorityCode",set:function(e){switch(e){default:case"0":this.dataTypePriority={mutation:!0,cna:!0};break;case"1":this.dataTypePriority={mutation:!0,cna:!1};break;case"2":this.dataTypePriority={mutation:!1,cna:!0}}},get:function(){return this.calculateDataTypePriorityCode(this.dataTypePriority)}},{key:"dict_molecularProfileId_molecularProfile",get:function(){return n.keyBy(this.molecularProfiles.result,function(e){return e.molecularProfileId})}},{key:"isGenesetProfileSelected",get:function(){var e=!1;if(this.getFilteredProfiles("GENESET_SCORE")[0])for(var t in this.selectedProfileIds)this.selectedProfileIds[t]===this.getFilteredProfiles("GENESET_SCORE")[0].molecularProfileId&&(e=!0);return e}},{key:"defaultProfilesForOql",get:function(){if(this.molecularProfilesInSelectedStudies.isComplete)return Object(Q.V)(this.molecularProfilesInSelectedStudies.result)}},{key:"defaultMutationProfile",get:function(){return this.defaultProfilesForOql&&this.defaultProfilesForOql[k.a.MUTATION_EXTENDED]}},{key:"defaultCnaProfile",get:function(){return this.defaultProfilesForOql&&this.defaultProfilesForOql[k.a.COPY_NUMBER_ALTERATION]}},{key:"defaultMrnaProfile",get:function(){return this.defaultProfilesForOql&&this.defaultProfilesForOql[k.a.MRNA_EXPRESSION]}},{key:"defaultProtProfile",get:function(){return this.defaultProfilesForOql&&this.defaultProfilesForOql[k.a.PROTEIN_LEVEL]}},{key:"defaultSelectedSampleListId",get:function(){if(this.isVirtualStudyQuery)return"all";if(1===this.selectableSelectedStudyIds.length){var e=this.selectableSelectedStudyIds[0],t=this.getSelectedProfileIdFromMolecularAlterationType("MUTATION_EXTENDED"),r=this.getSelectedProfileIdFromMolecularAlterationType("COPY_NUMBER_ALTERATION"),n=this.getSelectedProfileIdFromMolecularAlterationType("MRNA_EXPRESSION"),i=this.getSelectedProfileIdFromMolecularAlterationType("PROTEIN_LEVEL"),o=e+"_all";return t&&r&&!n&&!i?o=e+"_cnaseq":!t||r||n||i?t||!r||n||i?t||r||!n||i?(t||r)&&n&&!i?o=e+"_3way_complete":t||r||n||!i||(o=e+"_rppa"):this.isProfileSelected(e+"_mrna_median_Zscores")?o=e+"_mrna":this.isProfileSelected(e+"_rna_seq_mrna_median_Zscores")?o=e+"_rna_seq_mrna":this.isProfileSelected(e+"_rna_seq_v2_mrna_median_Zscores")&&(o=e+"_rna_seq_v2_mrna"):o=e+"_cna":o=e+"_sequenced",this.dict_sampleListId_sampleList[o]||(o===e+"_cnaseq"?o=e+"_cna_seq":o===e+"_3way_complete"&&(o=e+"_complete")),this.dict_sampleListId_sampleList[o]||(o=e+"_all"),o}}},{key:"dict_sampleListId_sampleList",get:function(){return n.keyBy(this.sampleLists.result,function(e){return e.sampleListId})}},{key:"oql",get:function(){try{return{query:this.geneQuery?Object(h.g)(this.geneQuery.trim().toUpperCase()):[],error:void 0}}catch(i){if("SyntaxError"!==i.name)return{query:[],error:{start:0,end:0,message:"Unexpected ".concat(i)}};var e,t,r,n=i.location.start.offset;return n===this.geneQuery.length?(e="after",t=n-1,r=n):0===n?(e="before",t=n,r=n+1):(e="at",t=n,r=n+1),{query:[],error:{start:t,end:r,message:"OQL syntax error ".concat(e," selected character; please fix and submit again.")}}}}},{key:"geneIds",get:function(){try{return this.oql.query.map(function(e){return e.gene})}catch(e){return[]}}},{key:"genesetIdsQuery",get:function(){try{return{query:this.genesetQuery?this.genesetQuery.split(/[ \n]+/):[],error:void 0}}catch(i){if("SyntaxError"!==i.name)return{query:[],error:{start:0,end:0,message:"Unexpected ".concat(i)}};var e,t,r,n=i.location.start.offset;return n===this.geneQuery.length?(e="after",t=n-1,r=n):0===n?(e="before",t=n,r=n+1):(e="at",t=n,r=n+1),{query:[],error:{start:t,end:r,message:"OQL syntax error ".concat(e," selected character; please fix and submit again.")}}}}},{key:"genesetIds",get:function(){return this.genesetIdsQuery.query}},{key:"minYVolcanoPlot",get:function(){return this.volcanoPlotTableData.result&&(e=this.volcanoPlotTableData.result).length>0?n.minBy(e,function(e){return e.representativePvalue}).representativePvalue:void 0;var e}},{key:"volcanoPlotGraphData",get:function(){return this.volcanoPlotTableData.result?(e=this.volcanoPlotTableData.result,t=this.map_genesets_selected_volcano,e.length>0?e.map(function(e){var r=e.representativeScore,n=e.representativePvalue,i=e.name;return{x:r,y:-Math.log(n)/Math.log(10),fill:t.get(i)?"tomato":"3786C2"}}):void 0):void 0;var e,t}},{key:"submitEnabled",get:function(){return!this.submitError&&(this.genes.isComplete||this.genesets.isComplete)&&this.asyncUrlParams.isComplete||!!this.oql.error||!!this.genesetIdsQuery.error}},{key:"summaryEnabled",get:function(){return this.selectableSelectedStudyIds.length>0}},{key:"hasSelectedStudies",get:function(){return this.selectableSelectedStudyIds.length>0}},{key:"oqlMessages",get:function(){return Object(Q.Y)(this.oql.query)}},{key:"approxSampleCount",get:function(){var e=this.selectedSampleListId;if(!e)return this.profiledSamplesCount.result.all;if(e===ie)return this.caseIds?Math.max(this.caseIds.trim().split(/\s+/g).length,1):1;var t=this.sampleLists.result.find(function(t){return t.sampleListId===e});return t?t.sampleCount:e in this.profiledSamplesCount.result?this.profiledSamplesCount.result[e]:this.profiledSamplesCount.result.all}},{key:"isQueryLimitReached",get:function(){return this.oql.query.length*this.approxSampleCount>v.b.serverConfig.query_product_limit}},{key:"geneLimit",get:function(){return Math.floor(v.b.serverConfig.query_product_limit/this.approxSampleCount)}},{key:"isMixedReferenceGenome",get:function(){var e=this;if(this.physicalStudyIdsInSelection&&this.physicalStudiesSet.result){var t=n.map(this.physicalStudyIdsInSelection,function(t){return e.physicalStudiesSet.result[t]});return Object(J.c)(t)}}},{key:"alterationTypesInOQL",get:function(){return Object(Q.T)(this.oql.query)}},{key:"submitError",get:function(){if(!this.selectableSelectedStudyIds.length)return"Please select one or more cancer studies.";if(this.isSingleNonVirtualStudySelected){if(!this.selectedProfileIds.length)return"Please select one or more molecular profiles.";if(this.alterationTypesInOQL.haveMutInQuery&&!this.defaultMutationProfile)return"Mutation data query specified in OQL, but no mutation profile is available for the selected study.";if(this.alterationTypesInOQL.haveCnaInQuery&&!this.defaultCnaProfile)return"CNA data query specified in OQL, but no CNA profile is available in the selected study.";if(this.alterationTypesInOQL.haveMrnaInQuery&&!this.defaultMrnaProfile)return"mRNA expression data query specified in OQL, but no mRNA profile is available in the selected study.";if(this.alterationTypesInOQL.haveProtInQuery&&!this.defaultProtProfile)return"Protein level data query specified in OQL, but no protein level profile is available in the selected study."}else if(!this.dataTypePriority.mutation&&!this.dataTypePriority.cna)return"Please select one or more molecular profiles.";if(this.selectableSelectedStudyIds.length&&this.selectedSampleListId===ie){if(this.asyncCustomCaseSet.isComplete&&!this.asyncCustomCaseSet.result.length)return"Please enter at least one ID in your custom case set.";if(this.asyncCustomCaseSet.error)return"Error in custom case set."}else{if(this.alterationTypesInOQL.haveMrnaInQuery&&this.selectableSelectedStudyIds.length>1)return"Expression filtering in the gene list (the EXP command) is not supported when doing cross cancer queries.";if(this.alterationTypesInOQL.haveProtInQuery&&this.selectableSelectedStudyIds.length>1)return"Protein level filtering in the gene list (the PROT command) is not supported when doing cross cancer queries."}if(0!==this.selectedProfileIds.length){if(1===this.selectedProfileIds.length){if(this.isGenesetProfileSelected){if(!this.genesetQuery.length&&!this.oql.query.length)return"Please enter one or more gene symbols and gene sets.";if(!this.genesetQuery.length)return"Please enter one or more gene sets or deselect gene set profiles.";if(!this.oql.query.length)return"Please enter one or more gene symbols."}else if(!this.oql.query.length)return"Please enter one or more gene symbols."}else if(this.isGenesetProfileSelected){if(!this.genesetQuery.length&&!this.oql.query.length)return"Please enter one or more gene symbols and gene sets.";if(!this.oql.query.length)return"Please enter one or more gene symbols."}else if(!this.oql.query.length)return"Please enter one or more gene symbols."}else if(!this.oql.query.length)return"Please enter one or more gene symbols.";if(this.isQueryLimitReached)return"Please limit your queries to ".concat(this.geneLimit," genes or fewer.");if(this.genes.result.suggestions.length)return"Please edit the gene symbols.";var e=n.groupBy(this.genes.result.found,function(e){return e.hugoGeneSymbol});return n.some(e,function(e){return e.length>1})?"Please edit the gene symbols.":void 0}},{key:"downloadDataFilename",get:function(){var e=1===this.selectableSelectedStudyIds.length&&this.treeData.map_studyId_cancerStudy.get(this.selectableSelectedStudyIds[0]),t=this.dict_molecularProfileId_molecularProfile[this.selectedProfileIds[0]];if(!this.forDownloadTab||!e||!t)return"cbioportal-data.txt";var r=this.dict_molecularAlterationType_filenameSuffix[t.molecularAlterationType]||t.molecularAlterationType.toLowerCase();return"cbioportal-".concat(e.studyId,"-").concat(r,".txt")}},{key:"molecularProfilesInStudyCache",get:function(){return new D}},{key:"sampleListsInStudyCache",get:function(){return new X}}])&&ee(t.prototype,r),a&&ee(t,a),e}();re([o.observable],le.prototype,"studiesHaveChangedSinceInitialization",void 0),re([o.observable],le.prototype,"deletedVirtualStudies",void 0),re([o.computed],le.prototype,"virtualStudiesMap",null),re([o.computed],le.prototype,"selectedVirtualStudies",null),re([o.computed],le.prototype,"physicalStudyIdsInSelection",null),re([o.computed],le.prototype,"stateToSerialize",null),re([o.computed],le.prototype,"onlyOneReferenceGenome",null),re([o.observable],le.prototype,"forDownloadTab",void 0),re([o.observable],le.prototype,"transposeDataMatrix",void 0),re([o.observable],le.prototype,"searchText",void 0),re([o.observable],le.prototype,"_allSelectedStudyIds",void 0),re([o.computed],le.prototype,"allSelectedStudyIds",null),re([o.computed],le.prototype,"selectableSelectedStudyIds",null),re([o.action],le.prototype,"setStudyIdSelected",null),re([o.computed],le.prototype,"defaultSelectedIds",null),re([o.observable],le.prototype,"dataTypePriority",void 0),re([o.observable.ref],le.prototype,"_selectedProfileIds",void 0),re([o.computed],le.prototype,"selectedProfileIds",null),re([o.observable],le.prototype,"zScoreThreshold",void 0),re([o.observable],le.prototype,"rppaScoreThreshold",void 0),re([o.observable],le.prototype,"_selectedSampleListId",void 0),re([o.computed],le.prototype,"selectedSampleListId",null),re([o.observable],le.prototype,"caseIds",void 0),re([o.observable],le.prototype,"_defaultStudySampleMap",void 0),re([o.observable],le.prototype,"_caseIdsMode",void 0),re([o.computed],le.prototype,"caseIdsMode",null),re([o.observable],le.prototype,"_geneQuery",void 0),re([o.observable],le.prototype,"rawGenesetQuery",void 0),re([o.observable],le.prototype,"geneQueryErrorDisplayStatus",void 0),re([o.observable],le.prototype,"genesetQueryErrorDisplayStatus",void 0),re([o.observable],le.prototype,"showMutSigPopup",void 0),re([o.observable],le.prototype,"showGisticPopup",void 0),re([o.observable],le.prototype,"showGenesetsHierarchyPopup",void 0),re([o.observable],le.prototype,"showGenesetsVolcanoPopup",void 0),re([o.observable],le.prototype,"priorityStudies",void 0),re([o.observable],le.prototype,"showSelectedStudiesOnly",void 0),re([o.observable.shallow],le.prototype,"selectedCancerTypeIds",void 0),re([o.observable],le.prototype,"clickAgainToDeselectSingle",void 0),re([o.observable],le.prototype,"searchExampleMessage",void 0),re([o.observable],le.prototype,"volcanoPlotSelectedPercentile",void 0),re([o.observable],le.prototype,"_maxTreeDepth",void 0),re([o.computed],le.prototype,"maxTreeDepth",null),re([o.computed],le.prototype,"userLoggedIn",null),re([o.action],le.prototype,"setCaseIds",null),re([g.a],le.prototype,"getGeneSuggestions",null),re([g.a],le.prototype,"getSamplesForStudyAndPatient",null),re([f.cached],le.prototype,"treeData",null),re([o.computed],le.prototype,"selectedCancerTypes",null),re([o.computed],le.prototype,"selectableSelectedStudies",null),re([o.computed],le.prototype,"isSingleVirtualStudySelected",null),re([o.computed],le.prototype,"isSingleNonVirtualStudySelected",null),re([o.computed],le.prototype,"isMultipleNonVirtualStudiesSelected",null),re([o.computed],le.prototype,"getOverlappingStudiesMap",null),re([o.computed],le.prototype,"isVirtualStudySelected",null),re([o.computed],le.prototype,"isVirtualStudyQuery",null),re([o.computed],le.prototype,"dataTypePriorityCode",null),re([o.computed],le.prototype,"dict_molecularProfileId_molecularProfile",null),re([o.computed],le.prototype,"defaultProfilesForOql",null),re([o.computed],le.prototype,"defaultMutationProfile",null),re([o.computed],le.prototype,"defaultCnaProfile",null),re([o.computed],le.prototype,"defaultMrnaProfile",null),re([o.computed],le.prototype,"defaultProtProfile",null),re([o.computed],le.prototype,"defaultSelectedSampleListId",null),re([o.computed],le.prototype,"dict_sampleListId_sampleList",null),re([o.computed],le.prototype,"oql",null),re([o.computed],le.prototype,"geneIds",null),re([o.computed],le.prototype,"genesetIdsQuery",null),re([o.computed],le.prototype,"genesetIds",null),re([o.computed],le.prototype,"minYVolcanoPlot",null),re([o.observable],le.prototype,"map_genesets_selected_volcano",void 0),re([o.computed],le.prototype,"volcanoPlotGraphData",null),re([o.computed],le.prototype,"submitEnabled",null),re([o.computed],le.prototype,"summaryEnabled",null),re([o.computed],le.prototype,"hasSelectedStudies",null),re([o.computed],le.prototype,"oqlMessages",null),re([o.computed],le.prototype,"approxSampleCount",null),re([o.computed],le.prototype,"isQueryLimitReached",null),re([o.computed],le.prototype,"geneLimit",null),re([o.computed],le.prototype,"isMixedReferenceGenome",null),re([o.computed],le.prototype,"alterationTypesInOQL",null),re([o.computed],le.prototype,"submitError",null),re([o.computed],le.prototype,"downloadDataFilename",null),re([o.action],le.prototype,"setParamsFromUrl",null),re([o.action],le.prototype,"setParamsFromLocalStorage",null),re([o.action],le.prototype,"selectCancerType",null),re([o.action],le.prototype,"setSearchText",null),re([o.action],le.prototype,"clearSelectedCancerType",null),re([o.action],le.prototype,"selectMolecularProfile",null),re([o.action],le.prototype,"replaceGene",null),re([o.action],le.prototype,"replaceGeneset",null),re([o.action],le.prototype,"applyGeneSelection",null),re([o.action],le.prototype,"addToGenesetSelection",null),re([o.action],le.prototype,"applyGenesetSelection",null),re([o.action],le.prototype,"submit",null),re([o.action],le.prototype,"openSummary",null),re([f.cached],le.prototype,"molecularProfilesInStudyCache",null),re([f.cached],le.prototype,"sampleListsInStudyCache",null);var ce=Object(S.a)(le)},792:function(e,t,r){"use strict";r.d(t,"a",function(){return I}),r.d(t,"b",function(){return T});var n=r(0),i=r(1),o=r(5),a=r.n(o),s=(r(828),r(6)),u=r(66),l=r(2),c=r(9),d=r(819);function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function y(e,t,r){return t&&f(e.prototype,t),r&&f(e,r),e}function h(e,t){return!t||"object"!==S(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function S(e){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var b=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":S(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},_=function(e){function t(){var e;return p(this,t),(e=h(this,m(t).apply(this,arguments))).renderedOnce=!1,e}return g(t,n["Component"]),y(t,[{key:"render",value:function(){var e=this;return this.renderedOnce||setTimeout(function(){return e.renderedOnce=!0}),n.createElement("div",{className:this.props.className},this.renderedOnce&&this.props.children,!this.renderedOnce&&(this.props.loadingState||null))}}]),t}();b([l.observable],_.prototype,"renderedOnce",void 0),_=b([c.observer],_);var I=function(e){function t(){return p(this,t),h(this,m(t).apply(this,arguments))}return g(t,n["Component"]),y(t,[{key:"componentDidMount",value:function(){this.props.onTabDidMount&&this.props.onTabDidMount(this.div)}},{key:"componentWillUnmount",value:function(){this.props.onTabUnmount&&this.props.onTabUnmount(this.div)}},{key:"assignRef",value:function(e){this.div=e}},{key:"render",value:function(){var e=this;return n.createElement("div",{ref:function(t){return e.div=t},className:a()({"msk-tab":!0,hiddenByPosition:!!this.props.inactive},this.props.className)},this.props.children)}}]),t}();b([s.default],I.prototype,"assignRef",null);var T=function(e){function t(e){var r;return p(this,t),(r=h(this,m(t).call(this,e))).shownTabs=[],r.tabRefs=[],r.tabIdToNavTabWidth={},r.needToRecomputeNavTabWidths=!0,r.tabClickHandlers=Object(d.a)(function(e,t){e.preventDefault(),r.setActiveTab(t.id,t.datum)}),r.state={currentPage:1,pageBreaks:[]},r}return g(t,n["Component"]),y(t,[{key:"cloneTab",value:function(e,t,r){return r?n.cloneElement(e,{inactive:t},this.props.loadingComponent):n.cloneElement(e,{inactive:t})}},{key:"setActiveTab",value:function(e,t){this.props.onTabClick&&this.props.onTabClick(e,t)}},{key:"navTabsRefHandler",value:function(e){this.navTabsRef=e}},{key:"tabRefHandler",value:function(e,t){e&&t&&this.tabRefs.push({id:e,element:t})}},{key:"nextPage",value:function(){this.setState({currentPage:this.state.currentPage+1})}},{key:"prevPage",value:function(){this.setState({currentPage:this.state.currentPage-1})}},{key:"render",value:function(){var e=this;if(this.props.children&&n.Children.count(this.props.children)){var t,r=this.props.children,o=n.Children.toArray(r),s=e.props.activeTabId&&i.some(o,function(t){return t.props.id===e.props.activeTabId})?e.props.activeTabId:o[0].props.id;return t=i.reduce(o,function(t,r){return r.props.hide||(r.props.id===s?(e.shownTabs.push(r.props.id),t.push(e.cloneTab(r,!1))):(!1===r.props.unmountOnHide||void 0===r.props.unmountOnHide&&!1===e.props.unmountOnHide)&&i.includes(e.shownTabs,r.props.id)&&t.push(e.cloneTab(r,!0))),t},[]),n.createElement("div",{id:this.props.id?this.props.id:"",className:a()("msk-tabs","posRelative",this.props.className)},this.navTabs(r,s),n.createElement(_,{className:"tab-content",loadingState:n.createElement(u.a,{isLoading:!0,center:!0,size:"big"})},t))}return null}},{key:"navTabs",value:function(e,t){this.tabRefs=[];var r=this.tabPages(e,t),i=this.state.pageBreaks.length+1,o=this.state.currentPage>1?n.createElement("li",{key:"prevPage",style:{cursor:"pointer"}},n.createElement("a",{onClick:this.prevPage.bind(this)},n.createElement("i",{className:"fa fa-chevron-left",style:this.props.arrowStyle}))):null,s=this.state.currentPage<i?n.createElement("li",{key:"nextPage",style:{cursor:"pointer"}},n.createElement("a",{onClick:this.nextPage.bind(this)},n.createElement("i",{className:"fa fa-chevron-right",style:this.props.arrowStyle}))):null,u=this.props.tabButtonStyle||"tabs";return n.createElement("ul",{ref:this.navTabsRefHandler.bind(this),className:a()("nav","nav-".concat(u))},o,r[this.state.currentPage-1],s)}},{key:"tabPages",value:function(e,t){var r=this,i=[[]],o=1;return n.Children.forEach(e,function(e){if(e&&!e.props.hide){var s=t===e.props.id?"active":"";r.props.getPaginationWidth&&r.state.pageBreaks.length>0&&r.state.pageBreaks[o-1]===e.props.id&&(i[++o-1]=[]);var u=null;if(e.props.onClickClose){var l=e.props.onClickClose;u=n.createElement("div",{className:"closeButton",onClick:function(t){t.stopPropagation(),l(e.props.id)}},n.createElement("i",{className:"fa fa-md fa-times-circle"}))}i[o-1].push(n.createElement("li",{key:e.props.id,style:{cursor:"pointer"},ref:r.tabRefHandler.bind(r,e.props.id),className:s},n.createElement("a",{className:a()("tabAnchor","tabAnchor_".concat(e.props.id),e.props.anchorClassName),onClick:r.tabClickHandlers(e.props),href:r.props.getTabHref&&r.props.getTabHref(e.props.id),style:e.props.anchorStyle},e.props.linkText,u)))}}),i}},{key:"componentWillReceiveProps",value:function(e){i.isEqual(t.getVisibleTabIds(e.children),t.getVisibleTabIds(this.props.children))||(this.needToRecomputeNavTabWidths=!0)}},{key:"componentDidMount",value:function(){var e=this;this.computeNavTabWidths(),this.needToRecomputeNavTabWidths=!1,this.widthReaction=Object(l.autorun)(function(){e.props.getPaginationWidth&&(e.props.getPaginationWidth(),e.initPaging())})}},{key:"componentWillUnmount",value:function(){this.widthReaction()}},{key:"componentDidUpdate",value:function(){this.needToRecomputeNavTabWidths&&(this.computeNavTabWidths(),this.needToRecomputeNavTabWidths=!1,this.initPaging())}},{key:"computeNavTabWidths",value:function(){var e=this;i.each(this.tabRefs,function(t){e.tabIdToNavTabWidth[t.id]=t.element.offsetWidth}),window.test=this.tabIdToNavTabWidth}},{key:"initPaging",value:function(){if(this.props.getPaginationWidth){var e=this.findPageBreaks(),t=this.findCurrentPage(e);this.setState({currentPage:t,pageBreaks:e})}}},{key:"findCurrentPage",value:function(e){var t=this,r=1,n=!1;return this.props.activeTabId&&e.length>0&&i.each(this.tabRefs,function(i){if(i.id===e[r-1]&&r++,i.id===t.props.activeTabId)return n=!0,!1}),n?r:1}},{key:"findPageBreaks",value:function(){var e=this,t=[];if(this.needToRecomputeNavTabWidths)return[];var r=this.props.getPaginationWidth&&this.props.getPaginationWidth()||0;if(r>0){var i=0;n.Children.forEach(this.props.children,function(n,o){if(n&&n.props.id in e.tabIdToNavTabWidth&&(i+=e.tabIdToNavTabWidth[n.props.id],0!==o)){i>r-50&&(t.push(n.props.id),i=e.tabIdToNavTabWidth[n.props.id])}})}return t}}],[{key:"getVisibleTabIds",value:function(e){return n.Children.map(e,function(e){return e&&!e.props.hide?e.props.id:null}).filter(function(e){return null!==e})}}]),t}();T.defaultProps={unmountOnHide:!0,loadingComponent:n.createElement(u.a,{isLoading:!0,center:!0,size:"big"})},b([s.default],T.prototype,"initPaging",null)},803:function(e,t,r){"use strict";var n=r(0),i=r(1),o=r(9),a=r(5),s=r.n(a),u=r(822),l=r.n(u),c=r(787),d=r.n(c),p=r(2),f=r(788),y=r(46);function h(e){try{return{query:e?Object(y.g)(e.trim().toUpperCase()):[],error:void 0}}catch(o){if("SyntaxError"!==o.name)return{query:[],error:{start:0,end:0,message:"Unexpected ".concat(o)}};var t,r,n,i=o.location.start.offset;return i===e.length?(t="after",r=i-1,n=i):0===i?(t="before",r=i,n=i+1):(t="at",r=i,n=i+1),{query:[],error:{start:r,end:n,message:"OQL syntax error ".concat(t," selected character; please fix and submit again.")}}}}r(830);var m=r(3),g=r(13),v=r(152),S=r.n(v),b=r(794),_=r.n(b),I=r(15);function T(e){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function P(e,t){return!t||"object"!==T(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var O=function(e){if(0==e.genes.length){return n.createElement("div",{className:l.a.suggestionBubble,title:"Could not find gene symbol. Click to remove it from the gene list.",onClick:function(){return e.replaceGene(e.alias,"")}},n.createElement(_.a,{className:l.a.icon,name:"times-circle"}),n.createElement("span",{className:l.a.noChoiceLabel},e.alias))}if(1==e.genes.length){var t=e.genes[0].hugoGeneSymbol,r="'".concat(e.alias,"' is a synonym for '").concat(t,"'. Click here to replace it with the official symbol.");return n.createElement("div",{className:l.a.suggestionBubble,title:r,onClick:function(){return e.replaceGene(e.alias,t)}},n.createElement(_.a,{className:l.a.icon,name:"question"}),n.createElement("span",{className:l.a.singleChoiceLabel},e.alias),n.createElement("span",null,": ".concat(t)))}var i="Ambiguous gene symbol. Click on one of the alternatives to replace it.",o=e.genes.map(function(e){return{label:e.hugoGeneSymbol,value:e.hugoGeneSymbol}});return n.createElement("div",{className:l.a.suggestionBubble,title:i},n.createElement(_.a,{className:l.a.icon,name:"question"}),n.createElement("span",{className:l.a.multiChoiceLabel},e.alias),n.createElement("span",null,":"," "),n.createElement(I.DropdownButton,{bsStyle:i.toLowerCase(),bsSize:"xsmall",title:"Select symbol",id:"geneReplace_".concat(e.alias)},o.map(function(t,r){return n.createElement(I.MenuItem,{onClick:function(){e.replaceGene(e.alias,t.value)},eventKey:r+1},t.label)})))},C=function(e){if(e.oql instanceof Error)return n.createElement("div",{className:l.a.GeneSymbolValidator},n.createElement("span",{className:l.a.errorMessage},"Cannot validate gene symbols because of invalid OQL.","  ",n.createElement("a",{className:"underline",onMouseDown:function(t){t.preventDefault(),e.highlightError()}},"Click to highlight error")));if(0===e.oql.query.length)return null;if(!e.errorMessageOnly&&e.validatingGenes)return n.createElement("div",{className:l.a.GeneSymbolValidator},n.createElement("span",{className:l.a.pendingMessage},"Validating gene symbols..."));if(e.genes instanceof Error)return n.createElement("div",{className:l.a.GeneSymbolValidator},n.createElement("span",{className:l.a.pendingMessage},"Unable to validate gene symbols."));if(e.genes.suggestions.length>0)return n.createElement("div",{className:l.a.GeneSymbolValidator},n.createElement("div",{className:l.a.invalidBubble,title:"Please edit the gene symbols."},n.createElement(_.a,{className:l.a.icon,name:"exclamation-circle"}),n.createElement("span",null,"Invalid gene symbols.")),e.genes.suggestions.map(function(t,r){return n.createElement(O,{key:r,genes:t.genes,alias:t.alias,replaceGene:e.replaceGene})}));var t,r,o,a=i.groupBy(e.genes.found,function(e){return e.hugoGeneSymbol}),u=i.reduce(a,function(e,t,r){return t.length>1&&e.push(r),e},[]);return u.length>0?n.createElement("div",{className:l.a.GeneSymbolValidator},n.createElement("div",{className:l.a.invalidBubble,title:"Please edit the gene symbols."},n.createElement(_.a,{className:l.a.icon,name:"exclamation-circle"}),n.createElement("span",null,"The portal does not currently support the following gene(s):")),u.map(function(t,r){return n.createElement(O,{key:r,genes:[],alias:t,replaceGene:e.replaceGene})})):e.errorMessageOnly?null:n.createElement("div",{className:s()(l.a.GeneSymbolValidator,(t={},r=l.a.nowrap,o=!e.wrapTheContent,r in t?Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[r]=o,t))},n.createElement("div",{className:l.a.validBubble,title:"You can now submit the list."},n.createElement(_.a,{className:l.a.icon,name:"check-circle"}),n.createElement("span",null,"All gene symbols are valid.")))},x=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),P(this,k(t).apply(this,arguments))}var r,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}(t,n["Component"]),r=t,(i=[{key:"render",value:function(){return this.props.children?n.createElement("div",{id:"wideGeneBoxValidationStatus"},this.props.children):n.createElement("div",{id:"geneBoxValidationStatus"},n.createElement(C,this.props))}}])&&w(r.prototype,i),o&&w(r,o),t}();function R(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function A(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function N(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function M(e){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function L(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function G(e,t){return(G=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function V(e){return(V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var j=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":V(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},D=function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{u(n.next(e))}catch(e){o(e)}}function s(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}u((n=n.apply(e,t||[])).next())})};function Q(e){return Number.isInteger(Number(e))}var q=function(e){function t(){var e,r,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,n=M(t).apply(this,arguments),(e=!n||"object"!==V(n)&&"function"!=typeof n?L(r):n).genes=Object(m.T)({invoke:function(){return D(L(e),void 0,void 0,regeneratorRuntime.mark(function e(){var t,r,n,o,a,s,u,l,c,d,p=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.geneIds.length){e.next=2;break}return e.abrupt("return",{found:[],suggestions:[]});case 2:return t=i.partition(i.uniq(this.geneIds),Q),r=A(t,2),n=r[0],o=r[1],a=function(){return D(p,void 0,void 0,regeneratorRuntime.mark(function e(){var t,r,o,a,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.length){e.next=6;break}return e.next=3,g.a.fetchGenesUsingPOST({geneIdType:"ENTREZ_GENE_ID",geneIds:n});case 3:t=e.sent,e.next=7;break;case 6:t=[];case 7:return r=i.difference(n,t.map(function(e){return e.entrezGeneId+""})),o=r.map(function(e){return{alias:e,genes:[]}}),a=t.map(function(e){return{alias:e.entrezGeneId+"",genes:[e]}}),s=[].concat(R(o),R(a)),e.abrupt("return",{found:t,suggestions:s});case 12:case"end":return e.stop()}},e)}))},s=function(){return D(p,void 0,void 0,regeneratorRuntime.mark(function e(){var t,r,n,a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.length){e.next=6;break}return e.next=3,g.a.fetchGenesUsingPOST({geneIdType:"HUGO_GENE_SYMBOL",geneIds:o});case 3:t=e.sent,e.next=7;break;case 6:t=[];case 7:return r=i.difference(o,t.map(function(e){return e.hugoGeneSymbol})),e.next=10,Promise.all(r.map(function(e){return a.getGeneSuggestions(e)}));case 10:return n=e.sent,e.abrupt("return",{found:t,suggestions:n});case 12:case"end":return e.stop()}},e)}))},e.next=7,Promise.all([a(),s()]);case 7:return u=e.sent,l=A(u,2),c=l[0],d=l[1],e.abrupt("return",{found:[].concat(R(c.found),R(d.found)),suggestions:[].concat(R(c.suggestions),R(d.suggestions))});case 12:case"end":return e.stop()}},e,this)}))},onResult:function(t){e.props.afterValidation&&e.props.afterValidation(0===t.suggestions.length,e.genes.result,e.oql)},default:{found:[],suggestions:[]}}),e}var r,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&G(e,t)}(t,n["Component"]),r=t,(o=[{key:"getGeneSuggestions",value:function(e){return D(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=e,t.next=3,g.a.getAllGenesUsingGET({alias:e});case 3:return t.t1=t.sent,t.abrupt("return",{alias:t.t0,genes:t.t1});case 5:case"end":return t.stop()}},t)}))}},{key:"render",value:function(){var e=this;return this.props.skipGeneValidation&&this.props.afterValidation&&this.props.afterValidation(!0,{found:[],suggestions:[]},this.oql),n.createElement(x,{genes:this.props.skipGeneValidation?{found:[],suggestions:[]}:this.genes.isError?new Error("ERROR"):this.genes.result,highlightError:function(){e.props.highlightError&&e.props.highlightError(e.oql)},oql:this.oqlOrError,validatingGenes:!this.props.skipGeneValidation&&this.genes.isPending,errorMessageOnly:this.props.errorMessageOnly,wrapTheContent:this.props.wrap,replaceGene:this.props.replaceGene},this.props.children)}},{key:"oql",get:function(){return h(this.props.geneQuery)}},{key:"geneIds",get:function(){return this.oql.error?[]:this.oql.query.map(function(e){return e.gene})}},{key:"oqlOrError",get:function(){return this.oql.error?new Error("OQL error at character ".concat(this.oql.error.start)):this.oql}}])&&N(r.prototype,o),a&&N(r,a),t}();q.defaultProps={errorMessageOnly:!1},j([S.a],q.prototype,"getGeneSuggestions",null),j([p.computed],q.prototype,"oql",null),j([p.computed],q.prototype,"geneIds",null),j([p.computed],q.prototype,"oqlOrError",null);var B=q=j([o.observer],q),F=r(6),U=r(35),H=r.n(U);function W(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Y(e,t){return!t||"object"!==Z(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function z(e){return(z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function X(e,t){return(X=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Z(e){return(Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r.d(t,"a",function(){return J});var J,K=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":Z(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};!function(e){e[e.DEFAULT=0]="DEFAULT",e[e.STUDY_VIEW_PAGE=1]="STUDY_VIEW_PAGE",e[e.ONCOPRINT_HEATMAP=2]="ONCOPRINT_HEATMAP"}(J||(J={}));var $=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=Y(this,z(t).call(this,e))).currentTextAreaValue="",r._geneQuery="",r.geneQueryIsValid=!0,r.queryToBeValidated="",r.isFocused=!1,r.skipGenesValidation=!1,r.updateQueryToBeValidateDebounce=i.debounce(function(){r.queryToBeValidated=r.currentTextAreaValue,r.skipGenesValidation=!1,""===r.currentTextAreaValue&&(r.geneQuery="",r.props.callback&&r.props.callback(h(""),{found:[],suggestions:[]},r.geneQuery))},500),r.geneQuery=r.props.inputGeneQuery||"",r.queryToBeValidated=r.geneQuery,r.props.validateInputGeneQuery||(r.skipGenesValidation=!0),r.textAreaRef=n.createRef(),r}var r,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&X(e,t)}(t,n["Component"]),r=t,(o=[{key:"componentDidMount",value:function(){var e=this;this.disposers=[Object(p.reaction)(function(){return e.props.inputGeneQuery},function(t){(t||"").toUpperCase()!==e.geneQuery.toUpperCase()&&(e.props.validateInputGeneQuery||(e.skipGenesValidation=!0),e.geneQuery=(t||"").trim(),e.queryToBeValidated=e.geneQuery),e.updateTextAreaRefValue()}),Object(p.reaction)(function(){return e.showFullText},function(){e.updateTextAreaRefValue()})]}},{key:"componentWillUnmount",value:function(){var e=!0,t=!1,r=void 0;try{for(var n,i=this.disposers[Symbol.iterator]();!(e=(n=i.next()).done);e=!0){(0,n.value)()}}catch(e){t=!0,r=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw r}}}},{key:"updateGeneQuery",value:function(e){this.geneQuery=e,this.queryToBeValidated=e,this.isFocused=!0,this.updateTextAreaRefValue()}},{key:"getTextAreaValue",value:function(){return this.showFullText?this.geneQuery:this.getFocusOutValue()}},{key:"updateTextAreaRefValue",value:function(){this.textAreaRef.current.value=this.getTextAreaValue()}},{key:"getFocusOutValue",value:function(){return function(e){var t="";if(e.length>0){t=e[0];for(var r=1;r<e.length;r++){if(t.length>13||t.length+e[r].length>13){t+=" and "+(e.length-r)+" more";break}t+=" "+e[r]}}return t}(h(this.geneQuery).query.map(function(e){return e.gene}))}},{key:"afterGeneSymbolValidation",value:function(e,t,r){this.geneQueryIsValid=e,this.props.callback&&this.props.callback(r,t,this.geneQuery)}},{key:"highlightError",value:function(e){this.textAreaRef.current.focus(),this.textAreaRef.current.setSelectionRange(e.error.start,e.error.end)}},{key:"onChange",value:function(e){this.currentTextAreaValue=e.currentTarget.value,this.geneQuery=this.currentTextAreaValue,this.updateQueryToBeValidateDebounce()}},{key:"onFocus",value:function(){this.isFocused=!0}},{key:"onBlur",value:function(){this.isFocused=!1}},{key:"replaceGene",value:function(e,t){var r=Object(f.e)(this.getTextAreaValue().toUpperCase().replace(new RegExp("\\b".concat(e.toUpperCase(),"\\b"),"g"),function(){return t.toUpperCase()}));this.updateGeneQuery(r)}},{key:"render",value:function(){return n.createElement("div",{className:l.a.genesSelection},n.createElement("div",{className:l.a.topRow},n.createElement("textarea",{ref:this.textAreaRef,onFocus:this.onFocus,onBlur:this.onBlur,className:s()(this.textAreaClasses),rows:5,cols:80,placeholder:this.promptText,title:this.promptText,defaultValue:this.getTextAreaValue(),onChange:this.onChange,"data-test":"geneSet",style:{height:this.props.textAreaHeight}}),this.props.submitButton),n.createElement("div",{className:"oqlValidationContainer"},n.createElement(B,{focus:this.props.focus,geneQuery:this.queryToBeValidated,skipGeneValidation:this.skipGenesValidation,updateGeneQuery:this.updateGeneQuery,afterValidation:this.afterGeneSymbolValidation,replaceGene:this.replaceGene,errorMessageOnly:this.props.location===J.STUDY_VIEW_PAGE,highlightError:this.highlightError},this.props.children)),n.createElement("div",null,this.showErrorsAndMessages&&this.props.error&&n.createElement("span",{className:d.a.errorMessage,"data-test":"oqlErrorMessage"},this.props.error),this.showErrorsAndMessages&&this.props.messages&&this.props.messages.map(function(e){return n.createElement("span",{className:d.a.oqlMessage},n.createElement("i",{className:"fa fa-info-circle",style:{marginRight:5}}),e)})))}},{key:"geneQuery",get:function(){return this.queryStore?this.queryStore.geneQuery:this._geneQuery},set:function(e){this.queryStore?this.queryStore.geneQuery=e:this._geneQuery=e}},{key:"textAreaClasses",get:function(){var e=[];switch(this.props.location){case J.STUDY_VIEW_PAGE:e.push(l.a.studyView),!this.isFocused&&this.geneQueryIsValid||e.push(l.a.studyViewFocus);break;case J.ONCOPRINT_HEATMAP:e.push(l.a.oncoprintHeatmap);break;default:e.push(l.a.default)}return this.geneQuery||e.push(l.a.empty),e}},{key:"showFullText",get:function(){return!this.geneQueryIsValid||this.isFocused||this.props.location!==J.STUDY_VIEW_PAGE}},{key:"promptText",get:function(){return this.props.textBoxPrompt?this.props.textBoxPrompt:"Click gene symbols below or enter here"}},{key:"showErrorsAndMessages",get:function(){return this.props.location!==J.STUDY_VIEW_PAGE||this.isFocused}}])&&W(r.prototype,o),a&&W(r,a),t}();$.defaultProps={validateInputGeneQuery:!0},K([p.observable],$.prototype,"_geneQuery",void 0),K([p.computed],$.prototype,"geneQuery",null),K([p.observable],$.prototype,"geneQueryIsValid",void 0),K([p.observable],$.prototype,"queryToBeValidated",void 0),K([p.observable],$.prototype,"isFocused",void 0),K([p.observable],$.prototype,"skipGenesValidation",void 0),K([F.default,p.action],$.prototype,"updateGeneQuery",null),K([F.default,p.action],$.prototype,"updateTextAreaRefValue",null),K([p.computed],$.prototype,"textAreaClasses",null),K([p.computed],$.prototype,"showFullText",null),K([F.default,p.action],$.prototype,"afterGeneSymbolValidation",null),K([F.default],$.prototype,"highlightError",null),K([p.computed],$.prototype,"promptText",null),K([H.a],$.prototype,"onChange",null),K([H.a],$.prototype,"onFocus",null),K([H.a],$.prototype,"onBlur",null),K([H.a],$.prototype,"replaceGene",null),K([p.computed],$.prototype,"showErrorsAndMessages",null),$=K([o.observer],$);t.b=$},819:function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.inputToKey=t,this.inputToOutput=r,this.memo={}}var t,r,i;return t=e,(r=[{key:"get",value:function(e){var t=this.inputToKey(e);return this.memo[t]=this.memo[t]||this.inputToOutput(e),this.memo[t]}},{key:"has",value:function(e){return this.inputToKey(e)in this.memo}}])&&n(t.prototype,r),i&&n(t,i),e}();function o(e){return JSON.stringify(e,Object.keys(e).sort())}function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o,r=new i(t,function(t){return function(r){return e(r,t)}});return function(e){return r.get(e)}}r.d(t,"a",function(){return a})},822:function(e,t,r){e.exports={portalWidth:"styles-module__portalWidth__3xfuL",framedImage:"styles-module__framedImage__3MWaq",validationBubbleBase:"styles-module__validationBubbleBase__1bQNI",genesSelection:"styles-module__genesSelection__17BpH",GeneSymbolValidator:"styles-module__GeneSymbolValidator__1K2q1",validBubble:"styles-module__validBubble__2iAqd",invalidBubble:"styles-module__invalidBubble__3Hs4P",suggestionBubble:"styles-module__suggestionBubble__1TnzN",topRow:"styles-module__topRow__2F7H0",default:"styles-module__default__3ZAms",oncoprintHeatmap:"styles-module__oncoprintHeatmap__lvPrO",studyView:"styles-module__studyView__3TtjM",studyViewFocus:"styles-module__studyViewFocus__1CfEf",nowrap:"styles-module__nowrap__1GVDf",icon:"styles-module__icon__2RDD6",pendingMessage:"styles-module__pendingMessage__1gVAe",oqlNotice:"styles-module__oqlNotice__3naFJ",errorMessage:"styles-module__errorMessage__3pZ_v",noChoiceLabel:"styles-module__noChoiceLabel__2sdit",singleChoiceLabel:"styles-module__singleChoiceLabel__178JA",multiChoiceLabel:"styles-module__multiChoiceLabel__1PPmp"}},828:function(e,t,r){},832:function(e,t,r){"use strict";r.d(t,"b",function(){return p}),r.d(t,"a",function(){return f});var n=r(0),i=r(872),o=r.n(i);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){return function(t,r,n){return r in t&&t[r]instanceof e?null:new Error("Expecting ".concat(n," to receive {").concat(JSON.stringify(r),": ").concat(e.name,"} from context"))}}function p(e){return o()({store:d(e)},function(e){return{store:e.store}})}function f(e){var t;return(t=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),u(this,l(t).apply(this,arguments))}var r,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(t,n["Component"]),r=t,(i=[{key:"store",get:function(){return this.context.store}}])&&s(r.prototype,i),o&&s(r,o),t}()).contextTypes={store:d(e)},t}},842:function(e,t,r){"use strict";var n=r(1),i=r(2);function o(e,t){return t.toLowerCase().indexOf(e.toLowerCase())>-1}function a(e,t,r){r||(r=o);var n=!1,i=!1,a=!1,s=!0,u=!1,l=void 0;try{for(var c,d=e[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){if("not"!==c.value.type){i=!0;break}}}catch(e){u=!0,l=e}finally{try{s||null==d.return||d.return()}finally{if(u)throw l}}i||(n=!0);var p=!0,f=!1,y=void 0;try{for(var h,m=e[Symbol.iterator]();!(p=(h=m.next()).done);p=!0){var g=h.value;if("not"===g.type){if(r(g.data,t)){n=!1,a=!0;break}}else if("and"===g.type){i=!0;var v=!0,S=!0,b=!1,_=void 0;try{for(var I,T=g.data[Symbol.iterator]();!(S=(I=T.next()).done);S=!0){var w=I.value;v=v&&r(w,t)}}catch(e){b=!0,_=e}finally{try{S||null==T.return||T.return()}finally{if(b)throw _}}n=n||v}}}catch(e){f=!0,y=e}finally{try{p||null==m.return||m.return()}finally{if(f)throw y}}return{match:n,forced:a}}var s=r(38),u=r(8),l=r(152),c=r.n(l);function d(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function h(e,t,r){return t&&y(e.prototype,t),r&&y(e,r),e}function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r.d(t,"a",function(){return v}),r.d(t,"b",function(){return S});var g=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":m(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},v="pan_can_atlas",S=function(){function e(t){f(this,e),this.store=t}return h(e,[{key:"getMetadata",value:function(e){return this.store.treeData.map_node_meta.get(e)}},{key:"cancerTypeContainsSelectedStudies",value:function(e){var t=this.getMetadata(e).descendantStudies;return n.intersection(this.store.selectableSelectedStudies,t).length>0}},{key:"getDepth",value:function(e){return this.getMetadata(e).ancestors.length}},{key:"isHighlighted",value:function(e){return!!this.store.searchText&&!!this.map_node_filterBySearchText.get(e)}},{key:"map_node_filterByDepth",get:function(){var e=new Map,t=!0,r=!1,n=void 0;try{for(var i,o=this.store.treeData.map_node_meta.entries()[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=p(i.value,2),s=a[0],u=a[1],l=!0;u.isCancerType&&(!u.descendantStudies.length||u.ancestors.length>this.store.maxTreeDepth&&!s.alwaysVisible)&&(l=!1),e.set(s,l)}}catch(e){r=!0,n=e}finally{try{t||null==o.return||o.return()}finally{if(r)throw n}}return e}},{key:"map_node_filterBySearchText",get:function(){var e=function(e){e=e.toLowerCase().trim().split(/\s+/g).join(" ");for(var t,r,n=[],i=0;i<e.length;)'"'===e[i]?-1===(r=e.indexOf('"',i+1))?(n.push(e.substring(i+1)),i=e.length):(n.push(e.substring(i+1,r)),i=r+1):" "===e[i]?i+=1:"-"===e[i]?(n.push("-"),i+=1):-1===(t=e.indexOf(" ",i))?(n.push(e.substring(i)),i=e.length):(n.push(e.substring(i,t)),i=t+1);var o,a,s=[];for(i=0;i<n.length;)"-"===n[i]?(i<n.length-1&&s.push({type:"not",data:n[i+1]}),i+=2):(o=n.indexOf("or",i),a=n.indexOf("-",i),-1===o&&-1===a?(s.push({type:"and",data:n.slice(i)}),i=n.length):-1===o&&a>0?(s.push({type:"and",data:n.slice(i,a)}),i=a):o>0&&-1===a?(s.push({type:"and",data:n.slice(i,o)}),i=o+1):o<a?(s.push({type:"and",data:n.slice(i,o)}),i=o+1):(s.push({type:"and",data:n.slice(i,a)}),i=a));return s}(this.store.searchText),t=new Map,r=!0,n=!1,i=void 0;try{for(var o,s=this.store.treeData.map_node_meta.entries()[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=p(o.value,2),l=u[0],c=(b=u[1]).searchTerms;l.hasOwnProperty("studyId")&&(c+=l.studyId?l.studyId:""),t.set(l,a(e,c))}}catch(e){n=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(n)throw i}}var f=new Map,y=!0,h=!1,m=void 0;try{for(var g,v=this.store.treeData.map_node_meta.entries()[Symbol.iterator]();!(y=(g=v.next()).done);y=!0){var S=p(g.value,2),b=(l=S[0],S[1]);if(!f.has(l)){for(var _=!1,I=0,T=[l].concat(d(b.ancestors),d(b.priorityCategories));I<T.length;I++){var w=T[I],P=t.get(w);if(!P.match&&P.forced){_=!1;break}_=_||P.match}if(f.set(l,_),_&&!b.isCancerType)for(var k=0,E=[b.ancestors,b.priorityCategories];k<E.length;k++){var O=E[k],C=!0,x=!1,R=void 0;try{for(var A,N=O[Symbol.iterator]();!(C=(A=N.next()).done);C=!0){var M=A.value;f.set(M,!0)}}catch(e){x=!0,R=e}finally{try{C||null==N.return||N.return()}finally{if(x)throw R}}}}}}catch(e){h=!0,m=e}finally{try{y||null==v.return||v.return()}finally{if(h)throw m}}return f}},{key:"map_node_filterBySelectedCancerTypes",get:function(){var e=new Map;if(this.store.selectedCancerTypes.length){var t=!0,r=!1,n=void 0;try{for(var i,o=this.store.selectedCancerTypes[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value,s=this.getMetadata(a);e.set(a,!0);for(var u=0,l=[s.ancestors,s.descendantCancerTypes,s.descendantStudies];u<l.length;u++){var c=l[u],d=!0,p=!1,f=void 0;try{for(var y,h=c[Symbol.iterator]();!(d=(y=h.next()).done);d=!0){var m=y.value;e.set(m,!0)}}catch(e){p=!0,f=e}finally{try{d||null==h.return||h.return()}finally{if(p)throw f}}}}}catch(e){r=!0,n=e}finally{try{t||null==o.return||o.return()}finally{if(r)throw n}}}else{var g=!0,v=!1,S=void 0;try{for(var b,_=this.store.treeData.map_node_meta.keys()[Symbol.iterator]();!(g=(b=_.next()).done);g=!0){var I=b.value;e.set(I,!0)}}catch(e){v=!0,S=e}finally{try{g||null==_.return||_.return()}finally{if(v)throw S}}}return e}},{key:"map_node_filterBySelectedStudies",get:function(){var e=new Map;if(this.store.selectableSelectedStudies.length){var t=!0,r=!1,n=void 0;try{for(var i,o=this.store.selectableSelectedStudies[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value,s=this.store.treeData.map_node_meta.get(a);e.set(a,!0);for(var u=0,l=[s.descendantStudies,s.ancestors,s.priorityCategories];u<l.length;u++){var c=l[u],d=!0,p=!1,f=void 0;try{for(var y,h=c[Symbol.iterator]();!(d=(y=h.next()).done);d=!0){var m=y.value;e.set(m,!0)}}catch(e){p=!0,f=e}finally{try{d||null==h.return||h.return()}finally{if(p)throw f}}}}}catch(e){r=!0,n=e}finally{try{t||null==o.return||o.return()}finally{if(r)throw n}}}return e}},{key:"mainView",get:function(){return new b(this.store,[this.map_node_filterByDepth,this.map_node_filterBySearchText,this.map_node_filterBySelectedCancerTypes])}},{key:"cancerTypeListView",get:function(){return new b(this.store,[this.map_node_filterByDepth,this.map_node_filterBySearchText])}},{key:"selectedStudiesView",get:function(){var e=this;return new b(this.store,[this.map_node_filterByDepth,this.map_node_filterBySelectedStudies,{get:function(t){return!e.getMetadata(t).isPriorityCategory}}])}}]),e}();g([s.cached],S.prototype,"map_node_filterByDepth",null),g([s.cached],S.prototype,"map_node_filterBySearchText",null),g([s.cached],S.prototype,"map_node_filterBySelectedCancerTypes",null),g([s.cached],S.prototype,"map_node_filterBySelectedStudies",null),g([i.computed],S.prototype,"mainView",null),g([i.computed],S.prototype,"cancerTypeListView",null),g([i.computed],S.prototype,"selectedStudiesView",null);var b=function(){function e(t,r){var n=this;f(this,e),this.store=t,this.filters=r,this.nodeFilter=function(e){return n.filters.every(function(t){return!!t.get(e)})}}return h(e,[{key:"getMetadata",value:function(e){return this.store.treeData.map_node_meta.get(e)}},{key:"getChildCancerTypes",value:function(e,t){var r=this.getMetadata(e);return(r.ancestors.length<this.store.maxTreeDepth||!t&&e.alwaysVisible?r.childCancerTypes:[]).filter(this.nodeFilter)}},{key:"getChildCancerStudies",value:function(e){var t=this.getMetadata(e),r=[];if(t.ancestors.length<this.store.maxTreeDepth)r=t.childStudies;else if(r=t.descendantStudies,e.alwaysVisible){var i=n.chain(t.descendantCancerTypes).filter(function(e){return e.alwaysVisible}).map(function(e){return e.cancerTypeId}).value();r=n.filter(r,function(e){return!i.includes(e.cancerTypeId)})}return r.filter(this.nodeFilter)}},{key:"getDescendantCancerStudies",value:function(e){return this.getMetadata(e).descendantStudies.filter(this.nodeFilter)}},{key:"getCheckboxProps",value:function(e){var t=this;if(this.getMetadata(e).isCancerType){var r=(this.store.selectableSelectedStudyIds||[]).map(function(e){return t.store.treeData.map_studyId_cancerStudy.get(e)}),i=this.getDescendantCancerStudies(e),o=n.intersection(i,r),a=o.length>0;return{checked:a,indeterminate:a&&o.length!=i.length}}var s=e;return{checked:!!this.store.selectableSelectedStudyIds.find(function(e){return e==s.studyId}),disabled:this.store.isDeletedVirtualStudy(s.studyId)}}},{key:"isCheckBoxDisabled",value:function(e){if(this.getMetadata(e).isCancerType)return!1;var t=e;return!!this.store.isDeletedVirtualStudy(t.studyId)}},{key:"clearAllSelection",value:function(){this.store.selectableSelectedStudyIds=[]}},{key:"onCheck",value:function(e,t){var r;this.getMetadata(e).isCancerType?this.store.forDownloadTab||(r=this.getDescendantCancerStudies(e).map(function(e){return e.studyId})):r=[e.studyId],r&&this.handleCheckboxStudyIds(r,t)}},{key:"getSelectionReport",value:function(){var e=this,t=this.store.selectableSelectedStudyIds||[],r=t.map(function(t){return e.store.treeData.map_studyId_cancerStudy.get(t)}),i=this.getDescendantCancerStudies(this.store.treeData.rootCancerType);return{selectableSelectedStudyIds:t,selectableSelectedStudies:r,shownStudies:i,shownAndSelectedStudies:n.intersection(i,r)}}},{key:"quickSelectButtons",value:function(e){if(!e)return{};try{return u.a.parseConfigFormat(e)}catch(e){return{}}}},{key:"toggleAllFiltered",value:function(){var e=this,t=this.getSelectionReport(),r=(t.selectableSelectedStudyIds,t.selectableSelectedStudies,t.shownStudies),i=t.shownAndSelectedStudies,o=[];o=r.length===i.length?n.without.apply(n,[this.store.selectableSelectedStudyIds].concat(d(r.map(function(e){return e.studyId})))):n.union(this.store.selectableSelectedStudyIds,r.map(function(e){return e.studyId})),this.store.selectableSelectedStudyIds=o.filter(function(t){return!n.includes(e.store.deletedVirtualStudies,t)})}},{key:"selectAllMatchingStudies",value:function(e){var t=this.getSelectionReport(),r=(t.selectableSelectedStudyIds,t.selectableSelectedStudies,t.shownStudies);t.shownAndSelectedStudies;this.store.selectableSelectedStudyIds=r.map(function(e){return e.studyId}).filter(function(t){return n.isArray(e)?e.includes(t):t.includes(e)})}},{key:"handleCheckboxStudyIds",value:function(e,t){var r=this,i=this.store.selectableSelectedStudyIds;i=t?n.union(i,e):n.difference(i,e),this.store.selectableSelectedStudyIds=i.filter(function(e){return!n.includes(r.store.deletedVirtualStudies,e)})}},{key:"isFiltered",get:function(){return this.store.selectedCancerTypeIds.length>0||this.store.searchText.length>0}}]),e}();g([i.action],b.prototype,"clearAllSelection",null),g([i.action],b.prototype,"onCheck",null),g([i.computed],b.prototype,"isFiltered",null),g([c.a],b.prototype,"quickSelectButtons",null),g([i.action],b.prototype,"toggleAllFiltered",null),g([i.action],b.prototype,"selectAllMatchingStudies",null)}}]);