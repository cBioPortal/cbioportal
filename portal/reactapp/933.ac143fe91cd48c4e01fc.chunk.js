(self.webpackChunkcbioportal_frontend=self.webpackChunkcbioportal_frontend||[]).push([[933],{5630:(e,t,o)=>{"use strict";o.r(t),o.d(t,{StudyResultsSummary:()=>gl,default:()=>Cl});var n=o(88034),r=o(57930),i=o.n(r),a=o(27808),s=o(21015),l=o(78566),u=o(9586),c=o(96877),p=o(36903),d=o(6240),h=o(62524),f=o(72564),m=o(65587),y=o(59280),b=o(54721),g=o(5933),v=o(22680);function C(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){return!t||"object"!==k(t)&&"function"!=typeof t?E(e):t}function E(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function T(e){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function O(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&A(e,t)}function A(e,t){return(A=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function k(e){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var N=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},P=function(e,t,o,n){return new(o||(o=Promise))((function(r,i){function a(e){try{l(n.next(e))}catch(e){i(e)}}function s(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))},_=function(e){function t(){return S(this,t),w(this,T(t).apply(this,arguments))}return O(t,e),t}(d.ZP),R=function(e){function t(){var e;return S(this,t),e=w(this,T(t).apply(this,arguments)),Object.defineProperty(E(e),"columns",{enumerable:!0,configurable:!0,writable:!0,value:(0,m.$w)({invoke:function(){return P(E(e),void 0,void 0,regeneratorRuntime.mark((function e(){var t,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[Object.assign(Object.assign({},this.getDefaultColumnConfig("patientId","Patient ID")),{render:function(e){return n.createElement("a",{href:(0,h.WU)(e.studyId,e.patientId),target:"_blank"},e.patientId)}}),Object.assign(Object.assign({},this.getDefaultColumnConfig("sampleId","Sample ID")),{render:function(e){return n.createElement("a",{href:(0,h.Qk)(e.studyId,e.sampleId),target:"_blank"},e.sampleId)}})],void 0!==i().find(this.props.store.visibleAttributes,(function(e){return e.uniqueKey===f.h_.CANCER_STUDIES}))&&t.push(Object.assign({},this.getDefaultColumnConfig("studyId","Cancer Study"))),e.abrupt("return",i().reduce(this.props.store.visibleAttributes.sort(f.HD),(function(e,t,n){return void 0!==t.clinicalAttribute&&e.push(Object.assign(Object.assign({},o.getDefaultColumnConfig((0,f.PG)(t.clinicalAttribute),t.clinicalAttribute.displayName,t.clinicalAttribute.datatype===f.g.NUMBER)),{tooltip:(0,f.ZY)(t.clinicalAttribute.displayName,t.description?t.description:"",t.clinicalAttribute?t.clinicalAttribute.clinicalAttributeId:void 0)})),e}),t));case 3:case"end":return e.stop()}}),e,this)})))},default:[]})}),e}var o,r,a;return O(t,e),o=t,(r=[{key:"getDefaultColumnConfig",value:function(e,t,o){return{name:t||"",headerRender:function(e){return n.createElement("span",{"data-test":e},e)},render:function(t){return(0,m.CB)(t[e])?n.createElement("a",{href:t[e],target:"_blank"},t[e]):n.createElement("span",{"data-test":t[e]},t[e])},download:function(t){return t[e]||""},sortBy:function(t){return t[e]?o?parseFloat(t[e]):t[e]:null},filter:function(t,o,n){return(t[e]||"").toUpperCase().includes(n)}}}},{key:"getProgressItems",value:function(e){return[{label:"Loading clinical data"+(e>2?" - this can take several seconds":""),promises:[this.props.store.getDataForClinicalDataTab]}]}},{key:"render",value:function(){return n.createElement("span",{"data-test":"clinical-data-tab-content"},n.createElement(v.z,{offset:60},n.createElement(y.If,{condition:this.columns.isPending||this.props.store.getDataForClinicalDataTab.isPending},n.createElement(y.Then,null,n.createElement(p.Z,{isLoading:this.columns.isPending||this.props.store.getDataForClinicalDataTab.isPending,size:"big",center:!0},n.createElement(b.Z,{getItems:this.getProgressItems,show:this.columns.isPending||this.props.store.getDataForClinicalDataTab.isPending}))),n.createElement(y.Else,null,n.createElement(_,{initialItemsPerPage:20,showCopyDownload:!0,showColumnVisibility:!1,data:this.props.store.getDataForClinicalDataTab.result||[],columns:this.columns.result,copyDownloadProps:{showCopy:!1,downloadFilename:this.props.store.clinicalDataDownloadFilename}})))))}}])&&C(o.prototype,r),a&&C(o,a),t}(n.Component);N([g.default],R.prototype,"getProgressItems",null),R=N([a.observer],R);var M=o(14069),D=o(14406),I=o(2028),x=o.n(I),L=o(31821),j=o.n(L),G=o(70956),B=o.n(G),F=o(76127),V=o.n(F),U=o(63623),W=o(12758),q=o(79280);function K(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function H(e){return(H=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function z(e,t){return(z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function X(e){return(X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Q=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===("undefined"==typeof Reflect?"undefined":X(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Z=function(e){function t(e){var o;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=function(e,t){return!t||"object"!==X(t)&&"function"!=typeof t?Y(e):t}(this,H(t).call(this,e)),Object.defineProperty(Y(o),"binSeparator",{enumerable:!0,configurable:!0,writable:!0,value:","}),Object.defineProperty(Y(o),"currentBinsValue",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(Y(o),"defaultBinMethod",{enumerable:!0,configurable:!0,writable:!0,value:u.Ov.CUSTOM}),Object.defineProperty(Y(o),"defaultBinsGeneratorConfig",{enumerable:!0,configurable:!0,writable:!0,value:{binSize:0,anchorValue:0}}),(0,l.makeObservable)(Y(o)),o.props.currentBins){var n=i().sortBy(o.props.currentBins);o.currentBinsValue=n.join("".concat(o.binSeparator," "))}return o}var o,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&z(e,t)}(t,e),o=t,(r=[{key:"updateCurrentBinsValue",value:function(){var e=[];this.currentBinMethod===u.Ov.CUSTOM&&(e=i().sortBy(this.newStringBins.filter((function(e){return""!==e})).map((function(e){return Number(e.trim())}))),this.currentBinsValue=e.join("".concat(this.binSeparator," "))),this.props.onChangeBinsGeneratorConfig(this.props.chartMeta.uniqueKey,this.currentBinsGeneratorConfig.binSize,this.currentBinsGeneratorConfig.anchorValue),this.props.updateCustomBins(this.props.chartMeta.uniqueKey,e,this.currentBinMethod,this.currentBinsGeneratorConfig),this.props.onHide()}},{key:"changeBinsCheckbox",value:function(e){this.props.onChangeBinMethod(this.uniqueChartId,e)}},{key:"updateBinSize",value:function(e){i().isNumber(e)&&!i().isNaN(e)&&this.props.onChangeBinsGeneratorConfig(this.uniqueChartId,e,this.currentBinsGeneratorConfig.anchorValue)}},{key:"updateAnchorValue",value:function(e){i().isNumber(e)&&!i().isNaN(e)&&this.props.onChangeBinsGeneratorConfig(this.uniqueChartId,this.currentBinsGeneratorConfig.binSize,e)}},{key:"render",value:function(){var e=this;return n.createElement(q.Modal,{show:this.props.show,onHide:this.props.onHide,keyboard:!0},n.createElement(q.Modal.Header,{closeButton:!0},n.createElement(q.Modal.Title,null,"Custom Bins")),n.createElement(q.Modal.Body,null,n.createElement("div",null,n.createElement(q.FormGroup,null,n.createElement(q.Radio,{name:"radioGroup",defaultChecked:!0,checked:this.currentBinMethod===u.Ov.QUARTILE,onChange:function(t){return e.changeBinsCheckbox(u.Ov.QUARTILE)}},"Quartiles")),n.createElement(q.FormGroup,null,n.createElement(q.Radio,{name:"radioGroup",checked:this.currentBinMethod===u.Ov.MEDIAN,onChange:function(t){return e.changeBinsCheckbox(u.Ov.MEDIAN)}},"Median split")),n.createElement(q.FormGroup,null,n.createElement(q.Radio,{name:"radioGroup",checked:this.currentBinMethod===u.Ov.GENERATE,onChange:function(t){return e.changeBinsCheckbox(u.Ov.GENERATE)}},"Generate bins")),n.createElement(q.FormGroup,null,n.createElement(q.Radio,{name:"radioGroup",checked:this.currentBinMethod===u.Ov.CUSTOM,onChange:function(t){return e.changeBinsCheckbox(u.Ov.CUSTOM)}},"Custom bins"))),this.currentBinMethod===u.Ov.GENERATE&&n.createElement("div",null,n.createElement(q.FormGroup,null,n.createElement(q.ControlLabel,null,"Bin size")," ",n.createElement(q.FormControl,{type:"text",style:{width:70},"data-test":"bin-size-input",defaultValue:this.currentBinsGeneratorConfig.binSize,onChange:function(t){var o=Number(t.currentTarget.value);isNaN(o)?t.currentTarget.value="":e.updateBinSize(Number(o))}})),n.createElement(q.FormGroup,null,n.createElement(q.ControlLabel,null,"Min value")," ",n.createElement(q.FormControl,{type:"text",style:{width:70},"data-test":"anchorvalue-input",defaultValue:this.currentBinsGeneratorConfig.anchorValue,onChange:function(t){var o=Number(t.currentTarget.value);isNaN(o)?t.currentTarget.value="":e.updateAnchorValue(Number(o))}}))),this.currentBinMethod===u.Ov.CUSTOM&&n.createElement("div",null,n.createElement("p",null,"Please specify bin boundaries of the x axis"),n.createElement("textarea",{style:{resize:"none"},rows:5,"data-test":"custom-bins-textarea",value:this.currentBinsValue,className:"form-control input-sm",onChange:function(t){return e.currentBinsValue=t.currentTarget.value}})),!this.contentIsValid&&n.createElement("div",{className:"alert alert-danger",role:"alert",style:{marginTop:"10px",marginBottom:"0"}},"Invalid bins")),n.createElement(q.Modal.Footer,null,n.createElement("button",{className:"btn btn-primary btn-sm",onClick:this.updateCurrentBinsValue,disabled:!this.contentIsValid,style:{marginTop:"10px",marginBottom:"0"}},"Update")))}},{key:"currentBinMethod",get:function(){return this.props.store.chartsBinMethod[this.uniqueChartId]||this.defaultBinMethod}},{key:"currentBinsGeneratorConfig",get:function(){return this.props.store.chartsBinsGeneratorConfigs.get(this.uniqueChartId)||this.defaultBinsGeneratorConfig}},{key:"uniqueChartId",get:function(){return this.props.chartMeta.uniqueKey}},{key:"newStringBins",get:function(){return this.currentBinsValue.trim().split(this.binSeparator)}},{key:"contentIsValid",get:function(){return(0,f.VX)(this.newStringBins)}}])&&K(o.prototype,r),a&&K(o,a),t}(n.Component);Q([l.observable],Z.prototype,"currentBinsValue",void 0),Q([l.computed],Z.prototype,"currentBinMethod",null),Q([l.computed],Z.prototype,"currentBinsGeneratorConfig",null),Q([l.computed],Z.prototype,"uniqueChartId",null),Q([g.default],Z.prototype,"updateCurrentBinsValue",null),Q([l.computed],Z.prototype,"newStringBins",null),Q([l.computed],Z.prototype,"contentIsValid",null),Q([l.action],Z.prototype,"changeBinsCheckbox",null),Q([l.action],Z.prototype,"updateBinSize",null),Q([l.action],Z.prototype,"updateAnchorValue",null);const J=Z=Q([a.observer],Z);const $=function(e){var t=e.width,r=e.style,i=e.className;return n.createElement("img",{src:o(80440),className:i||"",style:Object.assign({width:t,border:"1px solid black",padding:2},r||{})})};var ee=o(8008);function te(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function oe(e){return(oe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ne(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function re(e,t){return(re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ie(e){return(ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ae=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===("undefined"==typeof Reflect?"undefined":ie(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},se=function(e){function t(e){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=function(e,t){return!t||"object"!==ie(t)&&"function"!=typeof t?ne(e):t}(this,oe(t).call(this,e)),Object.defineProperty(ne(o),"menuOpen",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(ne(o),"downloadSubmenuOpen",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(ne(o),"comparisonSubmenuOpen",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(ne(o),"showCustomBinModal",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(ne(o),"closeMenuTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),(0,l.makeObservable)(ne(o)),o}var o,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&re(e,t)}(t,e),o=t,(r=[{key:"openMenu",value:function(){this.menuOpen=!0,window.clearTimeout(this.closeMenuTimeout),this.closeMenuTimeout=void 0}},{key:"closeMenu",value:function(){var e=this;this.closeMenuTimeout||(this.closeMenuTimeout=window.setTimeout((function(){e.menuOpen=!1,e.closeMenuTimeout=void 0}),125))}},{key:"render",value:function(){return n.createElement("div",{className:V()(j().header,"chartHeader"),style:{position:"relative",height:"".concat(this.props.height,"px"),lineHeight:"".concat(this.props.height,"px")}},n.createElement("div",{className:V()(j().name,j().draggable)},!this.props.hideLabel&&n.createElement("span",{className:"chartTitle"},this.props.title)),this.active&&n.createElement("div",{className:V()(j().controls,"controls")},n.createElement("div",{className:"btn-group"},n.createElement(y.If,{condition:!!this.props.description},n.createElement(m.ZD,{mouseEnterDelay:0,trigger:["hover"],placement:this.tooltipPosition,align:this.tooltipAlign,overlay:(0,f.ZY)(this.props.title,this.props.description?this.props.description.description:"",this.props.chartMeta.uniqueKey),destroyTooltipOnHide:!0},n.createElement("div",{className:V()("btn btn-xs btn-default",j().item)},n.createElement("i",{className:V()("fa fa-xs fa-fw","fa-info-circle"),"aria-hidden":"true"})))),n.createElement(y.If,{condition:!!this.props.chartMeta.clinicalAttribute||!!this.props.chartMeta.description},n.createElement(m.ZD,{mouseEnterDelay:0,trigger:["hover"],placement:this.tooltipPosition,align:this.tooltipAlign,overlay:(0,f.ZY)(this.props.chartMeta.displayName,this.props.chartMeta.description,this.props.chartMeta.clinicalAttribute?this.props.chartMeta.clinicalAttribute.clinicalAttributeId:void 0),destroyTooltipOnHide:!0},n.createElement("div",{className:V()("btn btn-xs btn-default",j().item)},n.createElement("i",{className:V()("fa fa-xs fa-fw","fa-info-circle"),"aria-hidden":"true"})))),n.createElement(y.If,{condition:this.props.chartControls&&!!this.props.chartControls.showResetIcon},n.createElement(m.ZD,{placement:this.tooltipPosition,align:this.tooltipAlign,overlay:n.createElement("span",null,"Reset filters in chart"),destroyTooltipOnHide:!0},n.createElement("button",{className:V()("btn btn-xs btn-default",j().item),onClick:this.props.resetChart},n.createElement("i",{className:V()("fa fa-xs fa-fw","fa-undo",j().undo,j().clickable),"aria-hidden":"true"})))),n.createElement(m.ZD,{placement:this.tooltipPosition,align:this.tooltipAlign,overlay:n.createElement("span",null,"Delete chart")},n.createElement("button",{className:V()("btn btn-xs btn-default",j().item),"data-test":"deleteChart",onClick:this.props.deleteChart},n.createElement("i",{className:V()("fa fa-xs fa-fw","fa-times",j().clickable),"aria-hidden":"true"}))),this.menuItems.length>0&&n.createElement("div",{onMouseEnter:this.openMenu,onMouseLeave:this.closeMenu,"data-test":"chart-header-hamburger-icon",className:V()("dropdown btn-group",{show:this.menuOpen})},n.createElement("button",{className:V()("btn btn-xs btn-default dropdown-toggle",{active:this.menuOpen})},n.createElement("i",{className:V()("fa fa-xs fa-fw fa-bars")})),n.createElement("ul",{"data-test":"chart-header-hamburger-icon-menu",className:V()("dropdown-menu pull-right",{show:this.menuOpen}),style:{width:"190px"}},this.menuItems)))),this.active&&n.createElement("div",{style:{position:"absolute",top:2,right:2}}))}},{key:"fileName",get:function(){return this.props.chartMeta.displayName.replace(/[ \t]/g,"_")}},{key:"active",get:function(){return this.menuOpen||this.props.active}},{key:"comparisonButton",get:function(){var e,t,o,r=this;switch(this.props.chartType){case U.oV.BAR_CHART:return n.createElement("div",{className:V()("dropdown-item",j().dropdownHoverEffect),style:{display:"flex",justifyContent:"space-between",padding:"3px 20px"},onMouseEnter:function(){return r.comparisonSubmenuOpen=!0},onMouseLeave:function(){return r.comparisonSubmenuOpen=!1}},n.createElement("div",{style:{display:"flex",alignItems:"center"}},n.createElement($,{className:V()("fa fa-fw",j().menuItemIcon)}),n.createElement("span",null,"Compare Groups")),n.createElement("i",{className:"fa fa-xs fa-fw fa-caret-right",style:{lineHeight:"inherit"}}),this.comparisonSubmenuOpen&&n.createElement("ul",{className:V()("dropdown-menu",{show:this.comparisonSubmenuOpen}),style:{top:0,margin:"-6px 0",left:"left"===this.props.placement?-120:"100%",minWidth:120}},n.createElement("li",null,n.createElement("a",{className:"dropdown-item",onClick:function(){r.props.openComparisonPage({categorizationType:f.BX.QUARTILES})}},"Quartiles")),n.createElement("li",null,n.createElement("a",{className:"dropdown-item",onClick:function(){r.props.openComparisonPage({categorizationType:f.BX.MEDIAN})}},"Median")),n.createElement("li",null,n.createElement("a",{className:"dropdown-item",onClick:function(){return r.props.openComparisonPage({categorizationType:f.BX.BINS})}},"Current bins"))));case U.oV.MUTATED_GENES_TABLE:case U.oV.CNA_GENES_TABLE:case U.oV.STRUCTURAL_VARIANT_GENES_TABLE:case U.oV.SAMPLE_TREATMENT_GROUPS_TABLE:case U.oV.SAMPLE_TREATMENTS_TABLE:case U.oV.PATIENT_TREATMENT_GROUPS_TABLE:case U.oV.PATIENT_TREATMENTS_TABLE:return n.createElement("a",{className:V()("dropdown-item",(e={},t=j().disabledMenuItem,o=this.props.selectedRowsKeys.length<2,t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e)),onClick:function(){r.props.selectedRowsKeys.length>=2&&r.props.openComparisonPage((0,ee.AJ)(r.props.selectedRowsKeys,r.props.chartType))},style:{display:"flex",alignItems:"center"}},n.createElement($,{className:V()("fa fa-fw",j().menuItemIcon)}),"Compare Groups");default:return n.createElement("a",{className:"dropdown-item",onClick:function(){return r.props.openComparisonPage({})},style:{display:"flex",alignItems:"center"}},n.createElement($,{className:V()("fa fa-fw",j().menuItemIcon)}),"Compare Groups")}}},{key:"showDownload",get:function(){return this.props.chartControls&&this.props.downloadTypes&&this.props.downloadTypes.length>0&&!0===this.context.showDownloadControls}},{key:"menuItems",get:function(){var e=this,t=[];return this.props.chartControls&&this.props.chartControls.showLogScaleToggle&&this.props.toggleLogScale&&t.push(n.createElement("li",null,n.createElement("a",{className:"dropdown-item logScaleCheckbox",onClick:this.props.toggleLogScale},n.createElement(W.Z,{checked:!(!this.props.chartControls||!this.props.chartControls.logScaleChecked),label:n.createElement("span",{style:{marginTop:-3}},"Log Scale"),style:{marginTop:1,marginBottom:-3}})))),this.props.chartControls&&this.props.chartControls.showSwapAxes&&this.props.swapAxes&&t.push(n.createElement("li",null,n.createElement("a",{className:"dropdown-item","data-test":"swapAxes",onClick:this.props.swapAxes},n.createElement("i",{className:"fa fa-arrow-up"})," Swap Axes ",n.createElement("i",{className:"fa fa-arrow-down"})))),this.props.chartControls&&this.props.chartControls.showLogScaleXToggle&&this.props.toggleLogScaleX&&t.push(n.createElement("li",null,n.createElement("a",{className:"dropdown-item logScaleCheckbox",onClick:this.props.toggleLogScaleX},n.createElement(W.Z,{checked:!(!this.props.chartControls||!this.props.chartControls.logScaleXChecked),label:n.createElement("span",{style:{marginTop:-3}},"Log Scale X"),style:{marginTop:1,marginBottom:-3}})))),this.props.chartControls&&this.props.chartControls.showLogScaleYToggle&&this.props.toggleLogScaleY&&t.push(n.createElement("li",null,n.createElement("a",{className:"dropdown-item logScaleCheckbox",onClick:this.props.toggleLogScaleY},n.createElement(W.Z,{checked:!(!this.props.chartControls||!this.props.chartControls.logScaleYChecked),label:n.createElement("span",{style:{marginTop:-3}},"Log Scale Y"),style:{marginTop:1,marginBottom:-3}})))),this.props.chartControls&&this.props.chartControls.showViolinPlotToggle&&this.props.toggleViolinPlot&&t.push(n.createElement("li",null,n.createElement("a",{className:"dropdown-item violinCheckbox",onClick:this.props.toggleViolinPlot},n.createElement(W.Z,{checked:!(!this.props.chartControls||!this.props.chartControls.violinPlotChecked),label:n.createElement("span",{style:{marginTop:-3}},"Show Violin Plot"),style:{marginTop:1,marginBottom:-3}})))),this.props.chartControls&&this.props.chartControls.showBoxPlotToggle&&this.props.toggleBoxPlot&&t.push(n.createElement("li",null,n.createElement("a",{className:"dropdown-item violinCheckbox",onClick:this.props.toggleBoxPlot},n.createElement(W.Z,{checked:!(!this.props.chartControls||!this.props.chartControls.boxPlotChecked),label:n.createElement("span",{style:{marginTop:-3}},"Show Box Plot"),style:{marginTop:1,marginBottom:-3}})))),this.props.chartControls&&this.props.chartControls.showTableIcon&&t.push(n.createElement("li",null,n.createElement("a",{className:"dropdown-item",onClick:function(){return e.props.changeChartType(U.oV.TABLE)}},n.createElement("i",{className:V()("fa fa-xs fa-fw","fa-table",j().menuItemIcon),"aria-hidden":"true"}),"Show Table"))),this.props.chartControls&&this.props.chartControls.showPieIcon&&t.push(n.createElement("li",null,n.createElement("a",{className:"dropdown-item",onClick:function(){return e.props.changeChartType(U.oV.PIE_CHART)}},n.createElement("i",{className:V()("fa fa-xs fa-fw","fa-pie-chart",j().menuItemIcon),"aria-hidden":"true"}),"Show Pie"))),this.props.chartControls&&this.props.chartControls.showComparisonPageIcon&&t.push(n.createElement("li",{style:{position:"relative"}},this.comparisonButton)),this.props.chartType===U.oV.BAR_CHART&&(t.push(n.createElement("li",null,n.createElement("a",{className:"dropdown-item",onClick:function(){return e.showCustomBinModal=!0}},n.createElement("i",{className:V()("fa fa-xs fa-fw","fa-bar-chart",j().menuItemIcon),"aria-hidden":"true"}),"Custom Bins"),n.createElement(J,{show:this.showCustomBinModal,onHide:function(){return e.showCustomBinModal=!1},chartMeta:this.props.chartMeta,currentBins:this.props.store.getCurrentBins(this.props.chartMeta),updateCustomBins:this.props.store.updateCustomBins,onChangeBinMethod:this.props.store.updateBinMethod,onChangeBinsGeneratorConfig:this.props.store.updateGenerateBinsConfig,store:this.props.store}))),this.props.chartControls&&this.props.chartControls.showNAToggle&&this.props.toggleNAValue&&t.push(n.createElement("li",null,n.createElement("a",{className:"dropdown-item",onClick:this.props.toggleNAValue},n.createElement(W.Z,{checked:!(!this.props.chartControls||!this.props.chartControls.isShowNAChecked),label:n.createElement("span",{style:{marginTop:-3}},"Show NA"),style:{marginTop:1,marginBottom:-3}}))))),this.showDownload&&t.push(n.createElement("li",{style:{position:"relative"}},n.createElement("div",{className:V()("dropdown-item",j().dropdownHoverEffect),style:{display:"flex",justifyContent:"space-between",padding:"3px 20px"},onMouseEnter:function(){return e.downloadSubmenuOpen=!0},onMouseLeave:function(){return e.downloadSubmenuOpen=!1}},n.createElement("div",null,n.createElement("i",{className:V()("fa fa-xs","fa-download",j().menuItemIcon),"aria-hidden":"true"}),n.createElement("span",null,"Download")),n.createElement("i",{className:"fa fa-xs fa-fw fa-caret-right",style:{lineHeight:"inherit"}}),this.downloadSubmenuOpen&&n.createElement(m.t_,{filename:this.fileName,buttons:this.props.downloadTypes,getSvg:this.props.getSVG,getData:this.props.getData,type:"dropdown",className:V()({show:this.downloadSubmenuOpen}),style:{top:0,margin:"-6px 0",left:"left"===this.props.placement?-70:"100%",minWidth:70},dontFade:!0})))),t}},{key:"tooltipPosition",get:function(){return"left"==this.props.placement?"topRight":"top"}},{key:"tooltipAlign",get:function(){return"left"==this.props.placement?{offset:[0,-6]}:void 0}}])&&te(o.prototype,r),i&&te(o,i),t}(n.Component);ae([l.observable],se.prototype,"menuOpen",void 0),ae([l.observable],se.prototype,"downloadSubmenuOpen",void 0),ae([l.observable],se.prototype,"comparisonSubmenuOpen",void 0),ae([l.observable],se.prototype,"showCustomBinModal",void 0),ae([l.computed],se.prototype,"fileName",null),ae([l.action.bound],se.prototype,"openMenu",null),ae([l.action.bound],se.prototype,"closeMenu",null),ae([l.computed],se.prototype,"active",null),ae([l.computed],se.prototype,"comparisonButton",null),ae([l.computed],se.prototype,"showDownload",null),ae([l.computed],se.prototype,"menuItems",null),ae([l.computed],se.prototype,"tooltipPosition",null),ae([l.computed],se.prototype,"tooltipAlign",null),(se=ae([a.observer],se)).contextType=m.Il;var le=o(49572),ue=o(99666),ce=o(78448),pe=o(39594),de=o.n(pe);function he(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function fe(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function me(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ye(e,t){return!t||"object"!==Se(t)&&"function"!=typeof t?be(e):t}function be(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ge(e){return(ge=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ve(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ce(e,t)}function Ce(e,t){return(Ce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Se(e){return(Se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var we,Ee=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===("undefined"==typeof Reflect?"undefined":Se(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Te=function(e){function t(){return me(this,t),ye(this,ge(t).apply(this,arguments))}return ve(t,e),t}(ce.Z);!function(e){e.CATEGORY="Category",e.NUMBER="#",e.FREQ="Freq"}(we||(we={}));var Oe=function(e){function t(e){var o;return me(this,t),o=ye(this,ge(t).call(this,e)),Object.defineProperty(be(o),"sortBy",{enumerable:!0,configurable:!0,writable:!0,value:U.Qo}),Object.defineProperty(be(o),"sortDirection",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),(0,l.makeObservable)(be(o)),o}var o,r,a;return ve(t,e),o=t,(r=[{key:"onUserSelection",value:function(e){var t=(0,l.toJS)(this.props.filters);i().includes(t,e)?t=i().filter(t,(function(t){return t!==e})):t.push(e),this.props.onUserSelection(t)}},{key:"tooltipLabelMouseEnter",value:function(e){this.props.highlightedRow&&this.props.highlightedRow(e)}},{key:"tooltipLabelMouseLeave",value:function(){this.props.highlightedRow&&this.props.highlightedRow(void 0)}},{key:"addAll",value:function(e){this.props.onUserSelection(e.map((function(e){return e.value})))}},{key:"removeAll",value:function(e){var t=e.map((function(e){return e.value}));this.props.onUserSelection(this.props.filters.filter((function(e){return!t.includes(e)})))}},{key:"afterSorting",value:function(e,t){this.sortBy=e,this.sortDirection=t}},{key:"render",value:function(){return n.createElement(Te,{width:this.props.width,height:this.props.height,data:this.props.data||[],columns:this.columns,addAll:this.addAll,removeAll:this.removeAll,numberOfSelectedRows:this.props.filters.length,showAddRemoveAllButton:this.props.showAddRemoveAllButtons,extraButtons:this.extraButtons,sortBy:this.sortBy,sortDirection:this.sortDirection,afterSorting:this.afterSorting})}},{key:"columnsWidth",get:function(){var e,t=(0,f.C)(this.props.width-140);return he(e={},we.CATEGORY,t),he(e,we.NUMBER,80),he(e,we.FREQ,60),e}},{key:"cellMargin",get:function(){var e;return he(e={},we.CATEGORY,0),he(e,we.NUMBER,0===this.props.data.length?0:(0,f.mA)((this.columnsWidth[we.NUMBER]-10-((0,f.x2)(i().max(this.props.data.map((function(e){return e.count}))).toLocaleString())+20))/2)),he(e,we.FREQ,0===this.props.data.length?0:(0,f.mA)((0,f.pt)(this.columnsWidth[we.FREQ],i().sortBy(this.props.data,(function(e){return e.percentage}))[this.props.data.length-1].freq))),e}},{key:"firstColumnName",get:function(){return this.props.label?this.props.label:we.CATEGORY}},{key:"columns",get:function(){var e=this;return[{name:this.firstColumnName,render:function(t){return n.createElement("div",{className:de().labelContent,onMouseEnter:function(o){e.tooltipLabelMouseEnter(t.value)},onMouseLeave:e.tooltipLabelMouseLeave},n.createElement("svg",{width:"18",height:"12",className:de().labelContentSVG},n.createElement("g",null,n.createElement("rect",{x:"0",y:"0",width:"12",height:"12",fill:t.color}))),n.createElement(m.CQ,{text:t.value}))},headerRender:function(){var t={},o=e.firstColumnName;return e.props.label||(t.opacity=0,o="."),n.createElement(m.CQ,{style:t,text:o,hideTooltip:!0})},tooltip:(0,f.ZY)(this.firstColumnName,this.props.labelDescription?this.props.labelDescription:""),filter:function(e,t,o){return e.value.toUpperCase().includes(o)},sortBy:function(e){return e.value},defaultSortDirection:"asc",width:this.columnsWidth[we.CATEGORY]},{name:we.NUMBER,headerRender:function(){return n.createElement("div",{style:{marginLeft:e.cellMargin[we.NUMBER]}},"#")},render:function(t){return n.createElement(ue.Z,{checked:i().includes(e.props.filters,t.value),onChange:function(o){return e.onUserSelection(t.value)},labelProps:{style:{display:"flex",justifyContent:"space-between",marginLeft:e.cellMargin[we.NUMBER],marginRight:e.cellMargin[we.NUMBER]}},inputProps:{className:de().autoMarginCheckbox}},t.count.toLocaleString())},tooltip:n.createElement("span",null,"Number of"," ",this.props.patientAttribute?"patients":"samples"),filter:function(e,t){return e.count.toString().includes(t)},sortBy:function(e){return e.count},defaultSortDirection:"desc",width:this.columnsWidth[we.NUMBER]},{name:we.FREQ,headerRender:function(){return n.createElement("div",{style:{marginLeft:e.cellMargin[we.FREQ]}},"Freq")},render:function(t){return n.createElement("span",{style:{flexDirection:"row-reverse",display:"flex",marginRight:e.cellMargin[we.FREQ]}},t.freq)},tooltip:n.createElement("span",null,"Percentage of"," ",this.props.patientAttribute?"patients":"samples"),filter:function(e,t){return e.freq.includes(t)},sortBy:function(e){return e.percentage},defaultSortDirection:"desc",width:this.columnsWidth[we.FREQ]}]}},{key:"selectedClinicalValues",get:function(){var e=i().keyBy(this.props.filters);return this.props.data.filter((function(t){return t.value in e}))}},{key:"extraButtons",get:function(){var e=this;return this.props.openComparisonPage?[{content:n.createElement("div",{style:{display:"flex",alignItems:"center"}},n.createElement($,{width:16,style:{marginRight:5}}),"Compare"),onClick:this.props.openComparisonPage,isDisabled:function(){return 1===e.selectedClinicalValues.length}}]:[]}}])&&fe(o.prototype,r),a&&fe(o,a),t}(n.Component);Object.defineProperty(Oe,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{width:300,showAddRemoveAllButtons:!1}}),Ee([l.observable],Oe.prototype,"sortBy",void 0),Ee([l.observable],Oe.prototype,"sortDirection",void 0),Ee([l.computed],Oe.prototype,"columnsWidth",null),Ee([l.computed],Oe.prototype,"cellMargin",null),Ee([l.computed],Oe.prototype,"firstColumnName",null),Ee([l.computed],Oe.prototype,"columns",null),Ee([g.default],Oe.prototype,"onUserSelection",null),Ee([g.default],Oe.prototype,"tooltipLabelMouseEnter",null),Ee([g.default],Oe.prototype,"tooltipLabelMouseLeave",null),Ee([g.default],Oe.prototype,"addAll",null),Ee([g.default],Oe.prototype,"removeAll",null),Ee([l.action.bound],Oe.prototype,"afterSorting",null),Ee([l.computed],Oe.prototype,"selectedClinicalValues",null),Ee([l.computed],Oe.prototype,"extraButtons",null);const Ae=Oe=Ee([a.observer],Oe);var ke=o(75508),Ne=o(60138);function Pe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Re(e,t,o){return t&&_e(e.prototype,t),o&&_e(e,o),e}function Me(e,t){return!t||"object"!==je(t)&&"function"!=typeof t?Ie(e):t}function De(e){return(De=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ie(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xe(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Le(e,t)}function Le(e,t){return(Le=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function je(e){return(je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Ge=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===("undefined"==typeof Reflect?"undefined":je(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Be=function(e){function t(e){var o;return Pe(this,t),o=Me(this,De(t).call(this,e)),Object.defineProperty(Ie(o),"svg",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Ie(o),"isTooltipHovered",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Ie(o),"tooltipHighlightedRow",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),(0,l.makeObservable)(Ie(o)),o}return xe(t,e),Re(t,[{key:"onUserSelection",value:function(e){var t=(0,l.toJS)(this.filters);i().includes(t,e)?t=i().filter(t,(function(t){return t!==e})):t.push(e),this.props.onUserSelection(t)}},{key:"highlightedRow",value:function(e){this.tooltipHighlightedRow=e}},{key:"downloadData",value:function(){return this.props.data.map((function(e){return e.value+"\t"+e.count})).join("\n")}},{key:"toSVGDOMNode",value:function(){return(0,f.cJ)(this.svg,{legendGroupSelector:".studyViewPieChartLegend",chartGroupSelector:".studyViewPieChartGroup",centerLegend:!0})}},{key:"x",value:function(e){return e.value}},{key:"y",value:function(e){return e.count}},{key:"label",value:function(e){return e.count/this.totalCount>.5?e.count.toLocaleString():this.maxLength(e.count/this.totalCount,this.pieSliceRadius/3)<(0,m.mY)(e.count.toLocaleString(),m.Nv.axis.style.tickLabels.fontFamily,"".concat(m.Nv.axis.style.tickLabels.fontSize,"px"))?"":e.count.toLocaleString()}},{key:"maxLength",value:function(e,t){return Math.abs(Math.tan(Math.PI*e/2))*t*2}},{key:"render",value:function(){var e=this;return n.createElement(m.ZD,{placement:this.props.placement,overlay:n.createElement(Ae,{width:300,height:150,openComparisonPage:this.props.openComparisonPage,data:this.props.data,label:this.props.label,labelDescription:this.props.labelDescription,patientAttribute:this.props.patientAttribute,showAddRemoveAllButtons:!0,filters:this.filters,highlightedRow:this.highlightedRow,onUserSelection:this.props.onUserSelection}),destroyTooltipOnHide:!0,trigger:["hover"]},n.createElement("svg",{width:this.props.width,height:this.props.height,ref:function(t){return e.svg=t}},this.victoryPie,this.victoryLegend))}},{key:"filters",get:function(){var e=i().reduce(this.props.data,(function(e,t){return e[t.value.toLowerCase()]=t.value,e}),{});return this.props.filters.map((function(t){return e[t.toLowerCase()]||t}))}},{key:"userEvents",get:function(){return[{target:"data",eventHandlers:this.pieSliceOnClickEventHandlers},{target:"labels",eventHandlers:this.pieSliceOnClickEventHandlers}]}},{key:"pieSliceOnClickEventHandlers",get:function(){var e=this;return{onClick:function(){return[{target:"data",mutation:function(t){e.onUserSelection(t.datum.value)}}]}}}},{key:"totalCount",get:function(){return i().sumBy(this.props.data,(function(e){return e.count}))}},{key:"fill",get:function(){var e=this;return function(t){return i().isEmpty(e.filters)||i().includes(e.filters,t.value)?t.color:ke.pp}}},{key:"stroke",get:function(){var e=this;return function(t){return!i().isEmpty(e.filters)&&i().includes(e.filters,t.value)?"#cccccc":null}}},{key:"strokeWidth",get:function(){var e=this;return function(t){return!i().isEmpty(e.filters)&&i().includes(e.filters,t.value)?3:0}}},{key:"fillOpacity",get:function(){var e=this;return function(t){return i().isEmpty(e.filters)||i().includes(e.filters,t.value)?1:"0.5"}}},{key:"chartSize",get:function(){return Math.min(this.props.width,this.props.height)}},{key:"pieSliceRadius",get:function(){return(this.props.width>this.props.height?this.props.height:this.props.width)/2-U.$u.thresholds.piePadding}},{key:"victoryPie",get:function(){return n.createElement(le.VictoryPie,{standalone:!1,theme:m.Nv,containerComponent:n.createElement(le.VictoryContainer,{responsive:!1}),groupComponent:n.createElement("g",{className:"studyViewPieChartGroup",transform:"translate(0, -12)"}),width:this.props.width,height:this.chartSize,labelRadius:this.pieSliceRadius/3,radius:this.pieSliceRadius,labels:this.label,data:this.props.data,dataComponent:n.createElement(Ve,null),labelComponent:n.createElement(le.VictoryLabel,null),events:this.userEvents,style:{data:{fill:(0,Ne.Z)(this.fill,"#cccccc"),stroke:(0,Ne.Z)(this.stroke,"0x000000"),strokeWidth:(0,Ne.Z)(this.strokeWidth,0),fillOpacity:(0,Ne.Z)(this.fillOpacity,1),cursor:"pointer"},labels:{fill:"white",cursor:"pointer"}},x:this.x,y:this.y})}},{key:"victoryLegend",get:function(){var e=this,t=this.props.data.map((function(t){return{name:"".concat(t.value,": ").concat(t.count," (").concat((0,f.jJ)(100*t.count/e.totalCount),")")}})),o=this.props.data.map((function(e){return e.color})),r=i().cloneDeep(m.Nv);return r.legend.style.data={type:"square",size:5,strokeWidth:0,stroke:"black"},n.createElement(le.VictoryLegend,{standalone:!1,theme:r,colorScale:o,x:0,y:this.props.height+1,rowGutter:-10,title:this.props.label||"Legend",centerTitle:!0,style:{title:{fontWeight:"bold"}},data:t,groupComponent:n.createElement("g",{className:"studyViewPieChartLegend"})})}}]),t}(n.Component);Ge([l.computed],Be.prototype,"filters",null),Ge([g.default],Be.prototype,"onUserSelection",null),Ge([l.observable],Be.prototype,"isTooltipHovered",void 0),Ge([l.observable],Be.prototype,"tooltipHighlightedRow",void 0),Ge([l.action.bound],Be.prototype,"highlightedRow",null),Ge([l.computed],Be.prototype,"totalCount",null),Ge([l.computed],Be.prototype,"fill",null),Ge([l.computed],Be.prototype,"stroke",null),Ge([l.computed],Be.prototype,"strokeWidth",null),Ge([l.computed],Be.prototype,"fillOpacity",null),Ge([g.default],Be.prototype,"x",null),Ge([g.default],Be.prototype,"y",null),Ge([g.default],Be.prototype,"label",null),Ge([l.computed],Be.prototype,"chartSize",null),Ge([l.computed],Be.prototype,"pieSliceRadius",null),Ge([l.computed],Be.prototype,"victoryPie",null),Ge([l.computed],Be.prototype,"victoryLegend",null);const Fe=Be=Ge([a.observer],Be);var Ve=function(e){function t(){return Pe(this,t),Me(this,De(t).apply(this,arguments))}return xe(t,e),Re(t,[{key:"render",value:function(){var e=this.props;return n.createElement("g",null,n.createElement(le.Slice,this.props),n.createElement("title",null,"".concat(e.datum.value,":").concat(e.datum.count)))}}]),t}(n.Component),Ue=o(92955);function We(e){return(We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ke(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function He(e,t){return!t||"object"!==We(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ye(e){return(Ye=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ze(e,t){return(ze=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const Xe=function(e){function t(){return qe(this,t),He(this,Ye(t).apply(this,arguments))}var o,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ze(e,t)}(t,e),o=t,(r=[{key:"renderElements",value:function(e,t){var o=e.datum,r=e.active,i=e.inline,a=e.className,s=e.title,l=e.desc,u=e.events,c=this.getStyles(e),p=this.getHeight(e,"lineHeight"),d=e.textAnchor?le.Helpers.evaluateProp(e.textAnchor,o,r):"start",h=e.dx?le.Helpers.evaluateProp(e.dx,o,r):0,f=this.getDy(e,c,t,p),m=this.getTransform(e,c),y=void 0!==e.x?e.x:this.getPosition(e,"x"),b=void 0!==e.y?e.y:this.getPosition(e,"y"),g={x:i?void 0:e.x,dx:h,textAnchor:c[0].textAnchor||d,style:c[0],key:c[0].textAnchor||d},v=[];return t.length>1?(v.push(n.createElement("tspan",g,t[0])),v.push(n.createElement("tspan",{dy:-c[0].fontSize/2,style:Object.assign(Object.assign({},c[0]),{fontSize:.7*c[0].fontSize})},t[1]))):v.push(n.createElement("tspan",g,t[0])),n.cloneElement(e.textComponent,{dx:h,dy:f,x:y,y:b,events:u,transform:m,className:a,title:s,desc:l},v)}}])&&Ke(o.prototype,r),i&&Ke(o,i),t}(le.VictoryLabel);var Qe=o(15757),Ze=o(64577),Je=o(56066);function $e(e){return function(e){if(Array.isArray(e)){for(var t=0,o=new Array(e.length);t<e.length;t++)o[t]=e[t];return o}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function et(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function tt(e){return(tt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ot(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nt(e,t){return(nt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rt(e){return(rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var it=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===("undefined"==typeof Reflect?"undefined":rt(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};var at,st=((at=i().cloneDeep(m.Nv)).axis.style.tickLabels.fontSize*=.85,at),lt=function(e){function t(e){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=function(e,t){return!t||"object"!==rt(t)&&"function"!=typeof t?ot(e):t}(this,tt(t).call(this,e)),Object.defineProperty(ot(o),"svgContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(ot(o),"mousePosition",{enumerable:!0,configurable:!0,writable:!0,value:{x:0,y:0}}),Object.defineProperty(ot(o),"currentBarIndex",{enumerable:!0,configurable:!0,writable:!0,value:-1}),Object.defineProperty(ot(o),"toolTipModel",{enumerable:!0,configurable:!0,writable:!0,value:null}),(0,l.makeObservable)(ot(o)),o}var o,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nt(e,t)}(t,e),o=t,(r=[{key:"onSelection",value:function(e){var t=i().flatten(e.map((function(e){return e.data.map((function(e){return e.dataBin}))})));this.props.onUserSelection(t)}},{key:"toSVGDOMNode",value:function(){return this.svgContainer.firstChild}},{key:"onMouseMove",value:function(e){this.mousePosition={x:e.pageX,y:e.pageY}}},{key:"render",value:function(){var e=this;return n.createElement("div",{onMouseMove:this.onMouseMove},this.barData.length>0&&n.createElement(le.VictoryChart,{containerComponent:n.createElement(le.VictorySelectionContainer,{containerRef:function(t){return e.svgContainer=t},selectionDimension:"x",onSelection:this.onSelection}),style:{parent:{width:this.props.width,height:this.props.height}},height:this.props.height-this.bottomPadding,width:this.props.width,padding:{left:40,right:20,top:10,bottom:this.bottomPadding},theme:st},n.createElement(le.VictoryAxis,{tickValues:this.tickValuesBasedOnNA,tickFormat:function(t){return e.tickFormat[t-1]},domain:[0,this.maximumX],tickLabelComponent:n.createElement(Xe,null),style:{tickLabels:{angle:50,verticalAnchor:"start",textAnchor:"start"}}}),n.createElement(le.VictoryAxis,{dependentAxis:!0,tickFormat:function(e){return Number.isInteger(e)?e.toFixed(0):""}}),n.createElement(le.VictoryBar,{barRatio:this.barRatio,style:{data:{fill:function(t){return(0,f.En)(t.dataBin,e.props.filters)||0===e.props.filters.length?U.$u.colors.theme.primary:ke.pp}}},data:this.barDataBasedOnNA,events:this.barPlotEvents}),this.labelShowingNA),Je.createPortal(n.createElement(Qe.ZP,{mousePosition:this.mousePosition,windowWidth:Ze.Z.size.width,model:this.toolTipModel,totalBars:this.barData.length,currentBarIndex:this.currentBarIndex}),document.body))}},{key:"numericalBins",get:function(){return(0,f.Qq)(this.props.data)}},{key:"categoryBins",get:function(){return(0,f.GV)(this.props.data)}},{key:"numericalData",get:function(){return(0,f.D2)(this.numericalBins)}},{key:"categoricalData",get:function(){return(0,f.oy)(this.categoryBins,this.numericalTickFormat.length)}},{key:"numericalTickFormat",get:function(){return(0,f.Ob)(this.numericalBins).map((function(e){return e.includes("^")?e.split("^"):e}))}},{key:"barData",get:function(){return[].concat($e(this.numericalData),$e(this.categoricalData))}},{key:"barDataBasedOnNA",get:function(){return this.props.showNAChecked?this.barData:this.barData.filter(pt)}},{key:"categories",get:function(){return this.categoryBins.map((function(e){return void 0===e.specialValue?"".concat(e.start):e.specialValue}))}},{key:"tickValues",get:function(){for(var e=[],t=1;t<=this.numericalTickFormat.length+this.categories.length;t++)e.push(t);return e}},{key:"barDataWithNA",get:function(){return this.barData.filter(ct)}},{key:"numberOfNA",get:function(){return this.barDataWithNA.length}},{key:"tickValuesBasedOnNA",get:function(){return this.props.showNAChecked?this.tickValues:this.tickValues.slice(0,-this.numberOfNA)}},{key:"tickFormat",get:function(){return[].concat($e(this.numericalTickFormat),$e(this.categories))}},{key:"bottomPadding",get:function(){return(0,m.Zo)(st.axis.style.tickLabels.fontFamily,st.axis.style.tickLabels.fontSize,this.tickFormat,50,40,10)}},{key:"barRatio",get:function(){return((0,f._1)(this.numericalBins)?this.barDataBasedOnNA.length/(this.barDataBasedOnNA.length+1):1)*U.$u.thresholds.barRatio}},{key:"barPlotEvents",get:function(){var e=this;return[{target:"data",eventHandlers:{onMouseEnter:function(){return[{target:"data",mutation:function(t){e.currentBarIndex=t.datum.eventKey,e.toolTipModel={start:e.barData[e.currentBarIndex].dataBin.start,end:e.barData[e.currentBarIndex].dataBin.end,special:e.barData[e.currentBarIndex].dataBin.specialValue,sampleCount:t.datum.y}}}]},onMouseLeave:function(){return[{target:"data",mutation:function(){e.toolTipModel=null}}]}}}]}},{key:"maximumX",get:function(){return this.tickValuesBasedOnNA[this.tickValuesBasedOnNA.length-1]+1}},{key:"maximumY",get:function(){var e=this.barData.filter(pt);return Math.max.apply(Math,$e(e.map((function(e){return e.y}))))}},{key:"labelShowingNA",get:function(){if(!this.props.showNAChecked){var e=this.barDataWithNA.map((function(e){return e.dataBin.count})).join(", ");return n.createElement(le.VictoryLabel,{text:"NA: ".concat(e),textAnchor:"end",datum:{x:this.maximumX,y:this.maximumY},style:{fontFamily:st.axis.style.tickLabels.fontFamily,fontSize:st.axis.style.tickLabels.fontSize}})}return null}}])&&et(o.prototype,r),a&&et(o,a),t}(n.Component);it([l.observable.ref],lt.prototype,"mousePosition",void 0),it([l.observable],lt.prototype,"currentBarIndex",void 0),it([l.observable],lt.prototype,"toolTipModel",void 0),it([g.default],lt.prototype,"onSelection",null),it([l.computed],lt.prototype,"numericalBins",null),it([l.computed],lt.prototype,"categoryBins",null),it([l.computed],lt.prototype,"numericalData",null),it([l.computed],lt.prototype,"categoricalData",null),it([l.computed],lt.prototype,"numericalTickFormat",null),it([l.computed],lt.prototype,"barData",null),it([l.computed],lt.prototype,"barDataBasedOnNA",null),it([l.computed],lt.prototype,"categories",null),it([l.computed],lt.prototype,"tickValues",null),it([l.computed],lt.prototype,"barDataWithNA",null),it([l.computed],lt.prototype,"numberOfNA",null),it([l.computed],lt.prototype,"tickValuesBasedOnNA",null),it([l.computed],lt.prototype,"tickFormat",null),it([l.computed],lt.prototype,"bottomPadding",null),it([l.computed],lt.prototype,"barRatio",null),it([g.default],lt.prototype,"onMouseMove",null),it([l.computed],lt.prototype,"maximumX",null),it([l.computed],lt.prototype,"maximumY",null),it([l.computed],lt.prototype,"labelShowingNA",null);const ut=lt=it([a.observer],lt);var ct=function(e){return"NA"===e.dataBin.specialValue},pt=function(e){return!ct(e)},dt=o(24999);function ht(e){return function(e){if(Array.isArray(e)){for(var t=0,o=new Array(e.length);t<e.length;t++)o[t]=e[t];return o}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var ft=o(22045),mt=o(58839);function yt(){return(yt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}function bt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gt(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function vt(e,t,o){return t&&gt(e.prototype,t),o&&gt(e,o),e}function Ct(e,t){return!t||"object"!==Ot(t)&&"function"!=typeof t?St(e):t}function St(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wt(e){return(wt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Et(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tt(e,t)}function Tt(e,t){return(Tt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ot(e){return(Ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var At=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===("undefined"==typeof Reflect?"undefined":Ot(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},kt=function(e,t){var o={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(o[n[r]]=e[n[r]])}return o},Nt=function(e){function t(){return bt(this,t),Ct(this,wt(t).apply(this,arguments))}return Et(t,e),vt(t,[{key:"render",value:function(){var e=this.props,t=e.x,o=e.y,r=e.size,i=kt(e,["x","y","size"]);return n.createElement(le.Point,yt({x:t+r,y:o-r,size:r},i))}}]),t}(n.Component);var Pt=function(e){function t(e){var o;return bt(this,t),o=Ct(this,wt(t).call(this,e)),Object.defineProperty(St(o),"tooltipModel",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(St(o),"pointHovered",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(St(o),"mouseIsDown",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(St(o),"mouseEvents",{enumerable:!0,configurable:!0,writable:!0,value:(0,m.xX)(St(o))}),Object.defineProperty(St(o),"xAxis",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(St(o),"yAxis",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(St(o),"container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(St(o),"svg",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),(0,l.makeObservable)(St(o)),o}return Et(t,e),vt(t,[{key:"containerRef",value:function(e){this.container=e}},{key:"svgRef",value:function(e){this.svg=e,this.props.svgRef&&this.props.svgRef(this.svg)}},{key:"toSVGDOMNode",value:function(){return this.svg}},{key:"tickFormat",value:function(e,t,o){return(0,m.kQ)(e,o)}},{key:"onMouseDown",value:function(){this.mouseIsDown=!0}},{key:"onMouseUp",value:function(){this.mouseIsDown=!1}},{key:"onSelection",value:function(e,t){if(this.xAxis&&this.yAxis){var o=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,i=Number.NEGATIVE_INFINITY,a=!0,s=!1,l=void 0;try{for(var u,c=e[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var p=u.value,d=!0,h=!1,f=void 0;try{for(var m,y=p.data[Symbol.iterator]();!(d=(m=y.next()).done);d=!0){var b=m.value;o=Math.min(o,b.x),n=Math.min(n,b.y),r=Math.max(r,b.x),i=Math.max(i,b.y)}}catch(e){h=!0,f=e}finally{try{d||null==y.return||y.return()}finally{if(h)throw f}}}}catch(e){s=!0,l=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw l}}r+=this.props.xBinSize,i+=this.props.yBinSize,Math.abs(i-this.dataDomain.y[1])<5e-5&&(i+=1),Math.abs(r-1)<5e-5&&(r+=1),o=+o.toFixed(2),r=+r.toFixed(2),n=+n.toFixed(2),i=+i.toFixed(2),this.props.onSelection({xStart:o,xEnd:r,yStart:n,yEnd:i})}}},{key:"xAxisRef",value:function(e){this.xAxis=e}},{key:"yAxisRef",value:function(e){this.yAxis=e}},{key:"render",value:function(){var e=this;return n.createElement("div",null,this.data.length>0&&n.createElement("div",{style:{width:this.props.width,height:this.props.height,position:"relative"},ref:this.containerRef,onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp},n.createElement(le.VictoryChart,{theme:m.Nv,containerComponent:n.createElement(m.Z0,{onSelection:this.onSelection,containerRef:function(t){t&&e.svgRef(t.firstChild)},legend:this.legend&&this.legend.legend,gradient:this.legend&&this.legend.gradient}),width:this.props.width,height:this.props.height,standalone:!0,domainPadding:15,singleQuadrantDomainPadding:!1},this.title,n.createElement(le.VictoryAxis,{ref:this.xAxisRef,domain:this.plotDomain.x,orientation:"bottom",offsetY:50,crossAxis:!1,tickCount:8,tickFormat:this.tickFormat,axisLabelComponent:n.createElement(le.VictoryLabel,{dy:20,style:[{fontSize:12,fontFamily:"Arial"}]}),label:this.props.axisLabelX}),n.createElement(le.VictoryAxis,{ref:this.yAxisRef,domain:this.plotDomain.y,orientation:"left",offsetX:50,crossAxis:!1,tickCount:8,tickFormat:this.tickFormat,dependentAxis:!0,axisLabelComponent:n.createElement(le.VictoryLabel,{dy:-27,style:[{fontSize:12,fontFamily:"Arial"}]}),label:this.props.axisLabelY}),this.scatters),n.createElement("span",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(255,255,255,0.8)",display:this.props.isLoading?"block":"none"}})),!this.props.isLoading&&0===this.data.length&&n.createElement("div",{className:"alert alert-info",style:{marginTop:175}},"No data to plot."),n.createElement(p.Z,{isLoading:!!this.props.isLoading,style:{position:"absolute",top:"50%",left:"50%",marginLeft:-10}}),this.tooltipModel&&this.props.tooltip&&!this.mouseIsDown&&n.createElement(m.sO,{container:this.container,targetHovered:this.pointHovered,targetCoords:{x:this.tooltipModel.x,y:this.tooltipModel.y-3},overlay:this.props.tooltip(this.tooltipModel.datum)}))}},{key:"title",get:function(){return this.props.title?n.createElement(le.VictoryLabel,{style:{fontWeight:"bold",textAnchor:"middle"},x:this.props.width/2,y:"1.2em",text:this.props.title}):null}},{key:"plotDomain",get:function(){var e,t,o,n,r,i,a,s,l=[null===(t=null===(e=this.props.plotDomain)||void 0===e?void 0:e.x)||void 0===t?void 0:t.min,null===(n=null===(o=this.props.plotDomain)||void 0===o?void 0:o.x)||void 0===n?void 0:n.max],u=[null===(i=null===(r=this.props.plotDomain)||void 0===r?void 0:r.y)||void 0===i?void 0:i.min,null===(s=null===(a=this.props.plotDomain)||void 0===a?void 0:a.y)||void 0===s?void 0:s.max];return void 0===l[0]&&(l[0]=this.dataDomain.x[0]),void 0===l[1]&&(l[1]=this.dataDomain.x[1]),void 0===u[0]&&(u[0]=this.dataDomain.y[0]),void 0===u[1]&&(u[1]=this.dataDomain.y[1]),{x:l,y:u}}},{key:"dataDomain",get:function(){var e={x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY},t={x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},o=!0,n=!1,r=void 0;try{for(var i,a=this.data[Symbol.iterator]();!(o=(i=a.next()).done);o=!0){var s=i.value;e.x=Math.max(s.x+this.props.xBinSize,e.x),e.y=Math.max(s.y+this.props.yBinSize,e.y),t.x=Math.min(s.x,t.x),t.y=Math.min(s.y,t.y)}}catch(e){n=!0,r=e}finally{try{o||null==a.return||a.return()}finally{if(n)throw r}}return{x:[t.x,e.x],y:[t.y,e.y]}}},{key:"data",get:function(){return this.props.data.map((function(e){return Object.assign({},e,{x:e.binX,y:e.binY})}))}},{key:"plotComputations",get:function(){var e=Number.NEGATIVE_INFINITY,t=Number.POSITIVE_INFINITY,o=this.data,n=i().groupBy(o,(function(o){var n=o.count;return e=Math.max(n,e),t=Math.min(n,t),n}));t===e&&(t=1);var r,a,s,l=Math.log(e),u=Math.log(t),c=.75;return t===e?(r=function(){return 0},s=function(){return(0,ft.iA)(0)},a=null):(r=function(e){return(Math.log(e)-u)/(l-u)},a=function(e){return Math.exp(e*(l-u)/c+u)},s=function(e){return(0,ft.iA)(c*e)}),{selectedDataByAreaCount:n,unselectedDataByAreaCount:{},colorCoordToCount:a,colorCoordMax:c,countToSelectedColor:function(e){return s(r(e))},countToUnselectedColor:function(e){return"rgb(200,200,200)"},colorCoordToColor:s,countMax:e,countMin:t}}},{key:"numSamples",get:function(){return i().sumBy(this.data,(function(e){return e.count}))}},{key:"pearsonPValue",get:function(){return(0,mt.pG)(this.props.pearsonCorr,this.numSamples)}},{key:"spearmanPValue",get:function(){return(0,mt.pG)(this.props.spearmanCorr,this.numSamples)}},{key:"scatters",get:function(){var e=this;if(0===this.data.length)return[];for(var t=[],o=[{dataByAreaCount:this.plotComputations.selectedDataByAreaCount,countToColor:this.plotComputations.countToSelectedColor,size:3},{dataByAreaCount:this.plotComputations.unselectedDataByAreaCount,countToColor:this.plotComputations.countToUnselectedColor,size:2.5}],r=function(){var o=s[a];i().forEach(o.dataByAreaCount,(function(r,i){var a=o.countToColor(parseInt(i,10));t.push(n.createElement(le.VictoryScatter,{key:"".concat(i),style:{data:{fill:a,stroke:"black",strokeWidth:1,strokeOpacity:0}},size:o.size,symbol:"circle",data:r,events:e.mouseEvents,dataComponent:n.createElement(Nt,null)}))}))},a=0,s=o;a<s.length;a++)r();return t}},{key:"legend",get:function(){var e=this.plotComputations.colorCoordToCount;if(e){for(var t="legendGradient",o=[],r=0;r<30;r++)o.push(n.createElement("stop",{offset:"".concat((r/30*100).toFixed(0),"%"),stopColor:this.plotComputations.colorCoordToColor(r/30)}));var a,s=n.createElement("linearGradient",{id:t,key:t,x1:"0",y1:"1",x2:"0",y2:"0"},o),l=this.props.width-45,u=70,c=this.plotComputations.countMax-this.plotComputations.countMin>=2,p=c?68:38,d=n.createElement("rect",{fill:"url(#".concat(t,")"),x:l,y:u,width:10,height:p}),h=[n.createElement("text",{fontSize:11,x:l+10+4,y:u,dy:"1em"},this.plotComputations.countMax.toLocaleString()),n.createElement("text",{fontSize:11,x:l+10+4,y:u+p,dy:"-0.3em"},this.plotComputations.countMin.toLocaleString())],f=i().isNumber(this.props.pearsonCorr)?this.props.pearsonCorr.toFixed(4):this.props.pearsonCorr,m=i().isNumber(this.props.spearmanCorr)?this.props.spearmanCorr.toFixed(4):this.props.spearmanCorr;this.numSamples>2&&(a=[n.createElement("text",{fontSize:10,x:l-5,y:u+p+40,dy:"-0.3em"},"Pearson:"),n.createElement("text",{fontSize:10.5,x:l-5,y:u+p+55,dy:"-0.3em"},f),n.createElement("text",{fontSize:10.5,x:l-5,y:u+p+70,dy:"-0.3em"},"p=",this.pearsonPValue.toFixed(2)),n.createElement("text",{fontSize:10,x:l-5,y:u+p+100,dy:"-0.3em"},"Spearman:"),n.createElement("text",{fontSize:10.5,x:l-5,y:u+p+115,dy:"-0.3em"},m),n.createElement("text",{fontSize:10.5,x:l-5,y:u+p+130,dy:"-0.3em"},"p=",this.spearmanPValue.toFixed(2))]),c&&h.push(n.createElement("text",{fontSize:11,x:l+10+4,y:u+p/2,dy:"0.3em"},Math.round(e(.5)).toLocaleString()));var y=n.createElement("text",{fontSize:11,x:l,y:u,dy:"-0.5em",dx:"-12px"},"# samples");return{gradient:s,legend:n.createElement("g",null,y,d,h,a)}}return null}}]),t}(n.Component);At([l.observable],Pt.prototype,"tooltipModel",void 0),At([l.observable],Pt.prototype,"pointHovered",void 0),At([l.observable],Pt.prototype,"mouseIsDown",void 0),At([l.observable.ref],Pt.prototype,"container",void 0),At([g.default],Pt.prototype,"containerRef",null),At([g.default],Pt.prototype,"svgRef",null),At([l.computed],Pt.prototype,"plotDomain",null),At([l.computed],Pt.prototype,"dataDomain",null),At([g.default],Pt.prototype,"tickFormat",null),At([g.default],Pt.prototype,"onMouseDown",null),At([g.default],Pt.prototype,"onMouseUp",null),At([g.default],Pt.prototype,"onSelection",null),At([l.computed],Pt.prototype,"data",null),At([l.computed],Pt.prototype,"plotComputations",null),At([l.computed],Pt.prototype,"numSamples",null),At([l.computed],Pt.prototype,"pearsonPValue",null),At([l.computed],Pt.prototype,"spearmanPValue",null),At([l.computed],Pt.prototype,"scatters",null),At([l.computed],Pt.prototype,"legend",null),At([g.default],Pt.prototype,"xAxisRef",null),At([g.default],Pt.prototype,"yAxisRef",null);const _t=Pt=At([a.observer],Pt);var Rt=o(34974),Mt=o(58235),Dt=o(24892),It=o(80835);function xt(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Lt(e){return(Lt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function jt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Gt(e,t){return(Gt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Bt(e){return(Bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Ft=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===("undefined"==typeof Reflect?"undefined":Bt(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Vt=function(e){function t(e){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=function(e,t){return!t||"object"!==Bt(t)&&"function"!=typeof t?jt(e):t}(this,Lt(t).call(this,e)),Object.defineProperty(jt(o),"isVisible",{enumerable:!0,configurable:!0,writable:!0,value:!1}),(0,l.makeObservable)(jt(o)),o}var o,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gt(e,t)}(t,e),o=t,(r=[{key:"onVisibleChange",value:function(e){this.isVisible=e}},{key:"render",value:function(){var e=this,t=i().includes(this.props.selectedGenes,this.props.hugoGeneSymbol);return n.createElement(m.ZD,{placement:"left",disabled:!this.props.isCancerGene,overlay:(0,Mt.IE)(this.props.hugoGeneSymbol,t,this.props.isCancerGene,this.props.oncokbAnnotated,this.props.isOncogene,this.props.isTumorSuppressorGene),destroyTooltipOnHide:!0},n.createElement("div",{"data-test":"geneNameCell",className:V()(de().geneSymbol,de().displayFlex),onMouseEnter:function(){return e.onVisibleChange(!0)},onMouseLeave:function(){return e.onVisibleChange(!1)},onClick:function(){return e.props.onGeneSelect(e.props.hugoGeneSymbol)}},n.createElement(m.CQ,{text:this.props.hugoGeneSymbol,hideTooltip:this.props.isCancerGene}),n.createElement("span",{style:{marginLeft:5}},n.createElement(y.If,{condition:t},n.createElement(y.Then,null,n.createElement("i",{className:"fa fa-check-square-o"})),n.createElement(y.Else,null,n.createElement(y.If,{condition:this.isVisible},n.createElement("i",{className:"fa fa-square-o"}))))),n.createElement(y.If,{condition:!i().isUndefined(this.props.qValue)},n.createElement("span",{style:{marginLeft:2,marginTop:2}},n.createElement(y.If,{condition:this.props.tableType===Mt.Zh.MUTATION},n.createElement(y.Then,null,n.createElement(It.Z,{qValue:this.props.qValue})),n.createElement(y.Else,null,n.createElement(Dt.Z,{qValue:this.props.qValue})))))))}}])&&xt(o.prototype,r),a&&xt(o,a),t}(n.Component);function Ut(e){return(Ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qt(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Kt(e,t){return!t||"object"!==Ut(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ht(e){return(Ht=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Yt(e,t){return(Yt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Ft([l.observable],Vt.prototype,"isVisible",void 0),Ft([l.action.bound],Vt.prototype,"onVisibleChange",null),Vt=Ft([a.observer],Vt);var zt,Xt=function(e){function t(){return Wt(this,t),Kt(this,Ht(t).apply(this,arguments))}var o,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yt(e,t)}(t,e),o=t,(r=[{key:"render",value:function(){return n.createElement("div",{style:{marginLeft:this.props.cellMargin},className:de().displayFlex,"data-test":this.props.dataTest},this.props.showFilter&&n.createElement(m.ZD,{mouseEnterDelay:0,placement:"top",disabled:!this.props.overlay,overlay:this.props.overlay||null},n.createElement("div",{onClick:this.props.onClickCallback,className:de().displayFlex},n.createElement("span",{"data-test":"header-filter-icon",className:V()(de().cancerGeneIcon,de().displayFlex),style:{color:this.props.isFiltered?ke.ds:ke.LN}},n.createElement("i",{className:"fa fa-filter"})))),this.props.children)}}])&&qt(o.prototype,r),i&&qt(o,i),t}(n.Component);function Qt(e){return function(e){if(Array.isArray(e)){for(var t=0,o=new Array(e.length);t<e.length;t++)o[t]=e[t];return o}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Zt(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Jt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $t(e,t){return!t||"object"!==io(t)&&"function"!=typeof t?eo(e):t}function eo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function to(e){return(to=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function oo(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&no(e,t)}function no(e,t){return(no=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ro(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function io(e){return(io="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ao,so=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===("undefined"==typeof Reflect?"undefined":io(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};!function(e){e.GENE="Gene",e.MOLECULAR_PROFILE="Molecular Profile",e.CASE_LIST="Name",e.NUMBER_STRUCTURAL_VARIANTS="# SV",e.NUMBER_MUTATIONS="# Mut",e.CYTOBAND="Cytoband",e.CNA="CNA",e.NUMBER="#",e.FREQ="Freq"}(ao||(ao={}));var lo=(ro(zt={},ao.GENE,.35),ro(zt,ao.MOLECULAR_PROFILE,.6),ro(zt,ao.CASE_LIST,.6),ro(zt,ao.NUMBER_MUTATIONS,.25),ro(zt,ao.NUMBER_STRUCTURAL_VARIANTS,.2),ro(zt,ao.NUMBER,.25),ro(zt,ao.FREQ,.15),ro(zt,ao.CYTOBAND,.25),ro(zt,ao.CNA,.14),zt),uo=function(e){function t(){return Jt(this,t),$t(this,to(t).apply(this,arguments))}return oo(t,e),t}(ce.Z),co=function(e){function t(e,o){var r;return Jt(this,t),r=$t(this,to(t).call(this,e,o)),Object.defineProperty(eo(r),"sortBy",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(eo(r),"sortDirection",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(eo(r),"modalSettings",{enumerable:!0,configurable:!0,writable:!0,value:{modalOpen:!1,modalPanelName:""}}),Object.defineProperty(eo(r),"getDefaultColumnDefinition",{enumerable:!0,configurable:!0,writable:!0,value:function(e,t,o){var a;return(ro(a={},ao.GENE,{name:e,headerRender:function(){return n.createElement(Xt,{cellMargin:o,dataTest:"gene-column-header",className:de().displayFlex,showFilter:!!r.props.cancerGeneFilterEnabled,isFiltered:!!r.isFilteredByCancerGeneList,onClickCallback:r.toggleCancerGeneFilter},n.createElement("span",null,e))},render:function(e){return n.createElement(Vt,{tableType:r.props.tableType,selectedGenes:r.props.selectedGenes,hugoGeneSymbol:e.label,qValue:e.qValue,isCancerGene:e.isCancerGene,oncokbAnnotated:e.oncokbAnnotated,isOncogene:e.isOncokbOncogene,isTumorSuppressorGene:e.isOncokbTumorSuppressorGene,onGeneSelect:r.props.onGeneSelect})},sortBy:function(e){return e.label},defaultSortDirection:"asc",filter:function(e,t,o){return e.label.toUpperCase().includes(o)},width:t}),ro(a,ao.MOLECULAR_PROFILE,{name:e,headerRender:function(){return n.createElement("div",{style:{marginLeft:o},className:de().displayFlex,"data-test":"profile-column-header"},e)},render:function(e){return n.createElement("div",{className:de().labelContent},n.createElement(m.CQ,{text:e.label}))},sortBy:function(e){return e.label},defaultSortDirection:"asc",filter:function(e,t,o){return e.label.toUpperCase().includes(o)},width:t}),ro(a,ao.CASE_LIST,{name:e,headerRender:function(){return n.createElement("div",{style:{marginLeft:o},className:de().displayFlex,"data-test":"profile-column-header"},e)},render:function(e){return n.createElement("div",{className:de().labelContent},n.createElement(m.CQ,{text:e.label}))},sortBy:function(e){return e.label},defaultSortDirection:"asc",filter:function(e,t,o){return e.label.toUpperCase().includes(o)},width:t}),ro(a,ao.NUMBER,{name:e,tooltip:n.createElement("span",null,(0,Mt.gB)(r.props.tableType,!1)),headerRender:function(){return n.createElement(Xt,{cellMargin:o,dataTest:"number-column-header",className:de().displayFlex,showFilter:!!r.props.alterationFilterEnabled,isFiltered:!!r.props.filterAlterations},n.createElement("span",null,e))},render:function(e){return n.createElement(ue.Z,{checked:r.isChecked(e.uniqueKey),disabled:r.isDisabled(e.uniqueKey),onChange:function(t){return r.toggleSelectRow(e.uniqueKey)},labelProps:{style:{display:"flex",justifyContent:"space-between",marginLeft:o,marginRight:o}},inputProps:{className:de().autoMarginCheckbox}},n.createElement("span",{"data-test":"numberOfAlteredCasesText"},e.numberOfAlteredCases.toLocaleString()))},sortBy:function(e){return e.numberOfAlteredCases},defaultSortDirection:"desc",filter:function(e,t){return i().toString(e.numberOfAlteredCases).includes(t)},width:t}),ro(a,ao.FREQ,{name:e,tooltip:n.createElement("span",null,(0,Mt.gB)(r.props.tableType,!0)),headerRender:function(){return n.createElement("div",{style:{marginLeft:o}},"Freq")},render:function(e){return(0,Mt.$o)(r.props.tableType,e.numberOfProfiledCases,e.numberOfAlteredCases,e.matchingGenePanelIds||[],r.toggleModal,{marginLeft:o})},sortBy:function(e){return e.numberOfAlteredCases/e.numberOfProfiledCases*100},defaultSortDirection:"desc",filter:function(e,t){return i().toString((0,f.jJ)(e.numberOfAlteredCases/e.numberOfProfiledCases)).includes(t)},width:t}),ro(a,ao.NUMBER_MUTATIONS,{name:e,tooltip:n.createElement("span",null,"Total number of mutations"),headerRender:function(){return n.createElement("div",{style:{marginLeft:o}},ao.NUMBER_MUTATIONS)},render:function(e){return n.createElement("span",{"data-test":"numberOfAlterations",style:{flexDirection:"row-reverse",display:"flex",marginRight:o}},e.totalCount.toLocaleString())},sortBy:function(e){return e.totalCount},defaultSortDirection:"desc",filter:function(e,t){return i().toString(e.totalCount).includes(t)},width:t}),ro(a,ao.NUMBER_STRUCTURAL_VARIANTS,{name:e,tooltip:n.createElement("span",null,"Total number of structural variants"),headerRender:function(){return n.createElement("div",{style:{marginLeft:o}},ao.NUMBER_STRUCTURAL_VARIANTS)},render:function(e){return n.createElement("span",{"data-test":"numberOfAlterations",style:{flexDirection:"row-reverse",display:"flex",marginRight:o}},e.totalCount.toLocaleString())},sortBy:function(e){return e.totalCount},defaultSortDirection:"desc",filter:function(e,t){return i().toString(e.totalCount).includes(t)},width:t}),ro(a,ao.CNA,{name:ao.CNA,tooltip:n.createElement("span",null,"Copy number alteration, only amplifications and deep deletions are shown"),render:function(e){return n.createElement("span",{"data-test":"cnaCell",style:{color:(0,f.H8)((0,f.$9)(e.alteration)),fontWeight:"bold"}},(0,f.$9)(e.alteration))},sortBy:function(e){return e.alteration},defaultSortDirection:"asc",filter:function(e,t,o){return(0,f.$9)(e.alteration).includes(o)},width:t}),ro(a,ao.CYTOBAND,{name:ao.CYTOBAND,tooltip:n.createElement("span",null,"Cytoband"),render:function(e){return n.createElement("span",null,e.cytoband)},sortBy:function(e){return e.cytoband},defaultSortDirection:"asc",filter:function(e,t,o){return!i().isUndefined(e.cytoband)&&e.cytoband.toUpperCase().includes(o)},width:t}),a)[e]}}),Object.defineProperty(eo(r),"getDefaultCellMargin",{enumerable:!0,configurable:!0,writable:!0,value:function(e,t){var o;return(ro(o={},ao.GENE,0),ro(o,ao.MOLECULAR_PROFILE,0),ro(o,ao.CASE_LIST,0),ro(o,ao.NUMBER_MUTATIONS,(0,f.mA)((0,f.pt)(t,r.totalCountLocaleString))),ro(o,ao.NUMBER_STRUCTURAL_VARIANTS,(0,f.mA)((0,f.pt)(t,r.totalCountLocaleString))),ro(o,ao.NUMBER,(0,f.mA)((t-10-((0,f.x2)(r.alteredCasesLocaleString)+20))/2)),ro(o,ao.FREQ,(0,f.mA)((0,f.pt)(t,(0,f.jJ)(i().max(r.tableData.map((function(e){return e.numberOfAlteredCases/e.numberOfProfiledCases*100}))))))),ro(o,ao.CYTOBAND,0),ro(o,ao.CNA,0),o)[e]}}),Object.defineProperty(eo(r),"_selectionType",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),(0,l.makeObservable)(eo(r)),r.sortBy=r.props.defaultSortBy,r}var o,r,a;return oo(t,e),o=t,(r=[{key:"toggleModal",value:function(e){this.modalSettings.modalOpen=!this.modalSettings.modalOpen,this.modalSettings.modalOpen&&(this.modalSettings.modalPanelName=e)}},{key:"closeModal",value:function(){this.modalSettings.modalOpen=!this.modalSettings.modalOpen}},{key:"toggleCancerGeneFilter",value:function(e){e.stopPropagation(),this.props.onChangeCancerGeneFilter(!this.props.filterByCancerGenes)}},{key:"isChecked",value:function(e){return!!this.allSelectedRowsKeysSet[e]}},{key:"isDisabled",value:function(e){return i().some(this.preSelectedRowsKeys,(function(t){return t===e}))}},{key:"toggleSelectRow",value:function(e){var t=i().find(this.props.selectedRowsKeys,(function(t){return t===e}));i().isUndefined(t)?this.props.onChangeSelectedRows(this.props.selectedRowsKeys.concat([e])):this.props.onChangeSelectedRows(i().xorBy(this.props.selectedRowsKeys,[t]))}},{key:"afterSelectingRows",value:function(){this.selectionType===Mt.LY.UNION?this.props.onSubmitSelection([this.props.selectedRowsKeys]):this.props.onSubmitSelection(this.props.selectedRowsKeys.map((function(e){return[e]}))),this.props.onChangeSelectedRows([])}},{key:"toggleSelectionOperator",value:function(){(this._selectionType||this.selectionType)===Mt.LY.INTERSECTION?this._selectionType=Mt.LY.UNION:this._selectionType=Mt.LY.INTERSECTION,localStorage.setItem(this.props.tableType,this.selectionType)}},{key:"isSelectedRow",value:function(e){return this.isChecked(e.uniqueKey)}},{key:"selectedRowClassName",value:function(e){var t=this.filterKeyToIndexSet[e.uniqueKey];return void 0===t?this.props.filters.length%2==0?de().highlightedEvenRow:de().highlightedOddRow:t%2==0?de().highlightedEvenRow:de().highlightedOddRow}},{key:"afterSorting",value:function(e,t){this.sortBy=e,this.sortDirection=t}},{key:"render",value:function(){var e="".concat(this.props.tableType,"-table");return n.createElement("div",{"data-test":e,key:e},this.props.promise.isComplete&&n.createElement(uo,{width:this.props.width,height:this.props.height,data:this.selectableTableData,columns:this.tableColumns,isSelectedRow:this.isSelectedRow,afterSelectingRows:this.afterSelectingRows,defaultSelectionOperator:this.selectionType,toggleSelectionOperator:this.toggleSelectionOperator,extraButtons:this.props.extraButtons,sortBy:this.sortBy,sortDirection:this.sortDirection,afterSorting:this.afterSorting,fixedTopRowsData:this.preSelectedRows,highlightedRowClassName:this.selectedRowClassName,showSetOperationsButton:!0,numberOfSelectedRows:this.props.selectedRowsKeys.length}),this.props.genePanelCache?n.createElement(Rt.N,{show:this.modalSettings.modalOpen,genePanelCache:this.props.genePanelCache,panelName:this.modalSettings.modalPanelName,onHide:this.closeModal}):null)}},{key:"maxNumberTotalCount",get:function(){return i().max(this.tableData.map((function(e){return e.totalCount})))}},{key:"maxNumberAlteredCasesColumn",get:function(){return i().max(this.tableData.map((function(e){return e.numberOfAlteredCases})))}},{key:"totalCountLocaleString",get:function(){return void 0===this.maxNumberTotalCount?"":this.maxNumberTotalCount.toLocaleString()}},{key:"alteredCasesLocaleString",get:function(){return void 0===this.maxNumberAlteredCasesColumn?"":this.maxNumberAlteredCasesColumn.toLocaleString()}},{key:"columnsWidth",get:function(){var e=this;return i().reduce(this.props.columns,(function(t,o){return t[o.columnKey]=(0,f.C)((o.columnWidthRatio?o.columnWidthRatio:lo[o.columnKey])*e.props.width),t}),{})}},{key:"cellMargin",get:function(){var e=this;return i().reduce(this.props.columns,(function(t,o){return t[o.columnKey]=e.getDefaultCellMargin(o.columnKey,e.columnsWidth[o.columnKey]),t}),{})}},{key:"tableData",get:function(){return this.isFilteredByCancerGeneList?i().filter(this.props.promise.result,(function(e){return e.isCancerGene})):this.props.promise.result||[]}},{key:"flattenedFilters",get:function(){return i().flatMap(this.props.filters)}},{key:"selectableTableData",get:function(){var e=this;return 0===this.flattenedFilters.length?this.tableData:i().filter(this.tableData,(function(t){return!e.flattenedFilters.includes(t.uniqueKey)}))}},{key:"preSelectedRows",get:function(){var e=this;if(0===this.flattenedFilters.length)return[];var t=(0,m.ky)(this.flattenedFilters);return i().chain(this.tableData).filter((function(t){return e.flattenedFilters.includes(t.uniqueKey)})).sortBy((function(e){return(0,Ne.Z)(t[e.uniqueKey],Number.POSITIVE_INFINITY)})).value()}},{key:"preSelectedRowsKeys",get:function(){return this.preSelectedRows.map((function(e){return e.uniqueKey}))}},{key:"tableColumns",get:function(){var e=this;return this.props.columns.map((function(t){var o=e.getDefaultColumnDefinition(t.columnKey,e.columnsWidth[t.columnKey],e.cellMargin[t.columnKey]);return t.columnTooltip&&(o.tooltip=t.columnTooltip),o}))}},{key:"isFilteredByCancerGeneList",get:function(){return!!this.props.cancerGeneFilterEnabled&&this.props.filterByCancerGenes}},{key:"allSelectedRowsKeysSet",get:function(){return(0,m.cD)([].concat(Qt(this.props.selectedRowsKeys),Qt(this.preSelectedRowsKeys)))}},{key:"selectionType",get:function(){if(this._selectionType)return this._selectionType;switch((localStorage.getItem(this.props.tableType)||"").toUpperCase()){case Mt.LY.INTERSECTION:return Mt.LY.INTERSECTION;case Mt.LY.UNION:return Mt.LY.UNION;default:return this.props.tableType===Mt.Zh.DATA?Mt.LY.INTERSECTION:Mt.LY.UNION}}},{key:"filterKeyToIndexSet",get:function(){return i().reduce(this.props.filters,(function(e,t,o){return t.forEach((function(t){e[t]=o})),e}),{})}}])&&Zt(o.prototype,r),a&&Zt(o,a),t}(n.Component);Object.defineProperty(co,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{cancerGeneFilterEnabled:!1}}),so([l.observable],co.prototype,"sortBy",void 0),so([l.observable],co.prototype,"sortDirection",void 0),so([l.observable],co.prototype,"modalSettings",void 0),so([l.computed],co.prototype,"maxNumberTotalCount",null),so([l.computed],co.prototype,"maxNumberAlteredCasesColumn",null),so([l.computed],co.prototype,"totalCountLocaleString",null),so([l.computed],co.prototype,"alteredCasesLocaleString",null),so([l.computed],co.prototype,"columnsWidth",null),so([l.computed],co.prototype,"cellMargin",null),so([l.computed],co.prototype,"tableData",null),so([l.computed],co.prototype,"flattenedFilters",null),so([l.computed],co.prototype,"selectableTableData",null),so([l.computed],co.prototype,"preSelectedRows",null),so([l.computed],co.prototype,"preSelectedRowsKeys",null),so([l.computed],co.prototype,"tableColumns",null),so([l.action.bound],co.prototype,"toggleModal",null),so([l.action.bound],co.prototype,"closeModal",null),so([g.default],co.prototype,"toggleCancerGeneFilter",null),so([l.computed],co.prototype,"isFilteredByCancerGeneList",null),so([l.computed],co.prototype,"allSelectedRowsKeysSet",null),so([g.default],co.prototype,"isChecked",null),so([g.default],co.prototype,"isDisabled",null),so([l.action.bound],co.prototype,"toggleSelectRow",null),so([l.observable],co.prototype,"_selectionType",void 0),so([l.action.bound],co.prototype,"afterSelectingRows",null),so([l.computed],co.prototype,"selectionType",null),so([l.action.bound],co.prototype,"toggleSelectionOperator",null),so([g.default],co.prototype,"isSelectedRow",null),so([l.computed],co.prototype,"filterKeyToIndexSet",null),so([g.default],co.prototype,"selectedRowClassName",null),so([l.action.bound],co.prototype,"afterSorting",null),co=so([a.observer],co);var po=o(13441);function ho(e){return function(e){if(Array.isArray(e)){for(var t=0,o=new Array(e.length);t<e.length;t++)o[t]=e[t];return o}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function fo(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function mo(e){return(mo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bo(e,t){return(bo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function go(e){return(go="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var vo,Co=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===("undefined"==typeof Reflect?"undefined":go(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},So=function(e){function t(e){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=function(e,t){return!t||"object"!==go(t)&&"function"!=typeof t?yo(e):t}(this,mo(t).call(this,e)),Object.defineProperty(yo(o),"_selectionType",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(yo(o),"sortDirection",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(yo(o),"modalSettings",{enumerable:!0,configurable:!0,writable:!0,value:{modalOpen:!1,modalPanelName:""}}),(0,l.makeObservable)(yo(o)),o}var o,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bo(e,t)}(t,e),o=t,(n=[{key:"isDisabled",value:function(e){return i().some(this.preSelectedRowsKeys,(function(t){return t===e}))}},{key:"isChecked",value:function(e){return!!this.allSelectedRowsKeysSet[e]}},{key:"toggleModal",value:function(e){this.modalSettings.modalOpen=!this.modalSettings.modalOpen,this.modalSettings.modalOpen&&(this.modalSettings.modalPanelName=e)}},{key:"closeModal",value:function(){this.modalSettings.modalOpen=!this.modalSettings.modalOpen}},{key:"toggleSelectRow",value:function(e){var t=i().find(this.props.selectedRowsKeys,(function(t){return t===e}));i().isUndefined(t)?this.props.onChangeSelectedRows(this.props.selectedRowsKeys.concat([e])):this.props.onChangeSelectedRows(i().xorBy(this.props.selectedRowsKeys,[t]))}},{key:"afterSelectingRows",value:function(){this.selectionType===Mt.LY.UNION?this.props.onSubmitSelection([this.props.selectedRowsKeys]):this.props.onSubmitSelection(this.props.selectedRowsKeys.map((function(e){return[e]}))),this.props.onChangeSelectedRows([])}},{key:"toggleSelectionOperator",value:function(){(this._selectionType||this.selectionType)===Mt.LY.INTERSECTION?this._selectionType=Mt.LY.UNION:this._selectionType=Mt.LY.INTERSECTION,localStorage.setItem(this.props.tableType,this.selectionType)}},{key:"isSelectedRow",value:function(e){return this.isChecked((0,po.d6)(e))}},{key:"selectedRowClassName",value:function(e){var t=this.filterKeyToIndexSet[(0,po.d6)(e)];return void 0===t?this.props.filters.length%2==0?de().highlightedEvenRow:de().highlightedOddRow:t%2==0?de().highlightedEvenRow:de().highlightedOddRow}},{key:"flattenedFilters",get:function(){return i().flatMap(this.props.filters)}},{key:"allSelectedRowsKeysSet",get:function(){return(0,m.cD)([].concat(ho(this.props.selectedRowsKeys),ho(this.preSelectedRowsKeys)))}},{key:"filterKeyToIndexSet",get:function(){return i().reduce(this.props.filters,(function(e,t,o){return t.forEach((function(t){e[t]=o})),e}),{})}},{key:"selectionType",get:function(){if(this._selectionType)return this._selectionType;switch((localStorage.getItem(this.props.tableType)||"").toUpperCase()){case Mt.LY.INTERSECTION:return Mt.LY.INTERSECTION;case Mt.LY.UNION:default:return Mt.LY.UNION}}}])&&fo(o.prototype,n),r&&fo(o,r),t}(n.Component);function wo(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Eo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function To(e,t){return!t||"object"!==_o(t)&&"function"!=typeof t?Oo(e):t}function Oo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ao(e){return(Ao=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ko(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&No(e,t)}function No(e,t){return(No=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Po(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function _o(e){return(_o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Co([l.observable],So.prototype,"_selectionType",void 0),Co([l.observable],So.prototype,"sortDirection",void 0),Co([l.observable],So.prototype,"modalSettings",void 0),Co([l.computed],So.prototype,"flattenedFilters",null),Co([l.computed],So.prototype,"allSelectedRowsKeysSet",null),Co([l.computed],So.prototype,"filterKeyToIndexSet",null),Co([l.computed],So.prototype,"selectionType",null),Co([g.default],So.prototype,"isDisabled",null),Co([g.default],So.prototype,"isChecked",null),Co([l.action.bound],So.prototype,"toggleModal",null),Co([l.action.bound],So.prototype,"closeModal",null),Co([l.action.bound],So.prototype,"toggleSelectRow",null),Co([l.action.bound],So.prototype,"afterSelectingRows",null),Co([l.action.bound],So.prototype,"toggleSelectionOperator",null),Co([g.default],So.prototype,"isSelectedRow",null),Co([g.default],So.prototype,"selectedRowClassName",null);var Ro,Mo=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===("undefined"==typeof Reflect?"undefined":_o(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};!function(e){e.TREATMENT="Treatment",e.TIME="Pre / Post",e.COUNT="#"}(Ro||(Ro={}));var Do,Io=(Po(vo={},Ro.TREATMENT,.6),Po(vo,Ro.TIME,.3),Po(vo,Ro.COUNT,.2),vo),xo=function(e){function t(){return Eo(this,t),To(this,Ao(t).apply(this,arguments))}return ko(t,e),t}(ce.Z),Lo=function(e){function t(e){var o;return Eo(this,t),o=To(this,Ao(t).call(this,e)),Object.defineProperty(Oo(o),"sortBy",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Oo(o),"getDefaultColumnDefinition",{enumerable:!0,configurable:!0,writable:!0,value:function(e,t,r){var i;return(Po(i={},Ro.TREATMENT,{name:e,headerRender:function(){return n.createElement(po.ev,{margin:r,headerName:e})},render:function(e){return n.createElement(po.ao,{row:e})},sortBy:function(e){return e.treatment},defaultSortDirection:"asc",filter:po.CB,width:t}),Po(i,Ro.TIME,{name:e,headerRender:function(){return n.createElement(po.ev,{margin:r,headerName:e})},render:o.createTemporalRelationColumnCell,sortBy:function(e){return e.time},defaultSortDirection:"asc",filter:po.CB,width:t}),Po(i,Ro.COUNT,{tooltip:n.createElement("span",null,"Number of samples acquired before treatment or after/on treatment"),name:e,headerRender:function(){return n.createElement(po.ev,{margin:r,headerName:e})},render:function(e){return o.createNubmerColumnCell(e,28)},sortBy:function(e){return o.calculateMaxValueForTreatment(e)+(0,po.Yy)(e.time+e.treatment)},defaultSortDirection:"desc",filter:po.CB,width:t}),i)[e]}}),(0,l.makeObservable)(Oo(o)),o.sortBy=o.props.defaultSortBy,o}var o,r,a;return ko(t,e),o=t,(r=[{key:"createTemporalRelationColumnCell",value:function(e){return n.createElement("div",null,e.time)}},{key:"createNubmerColumnCell",value:function(e,t){var o=this;return n.createElement(ue.Z,{checked:this.isChecked((0,po.d6)(e)),disabled:this.isDisabled((0,po.d6)(e)),onChange:function(t){return o.toggleSelectRow((0,po.d6)(e))},labelProps:{style:{display:"flex",justifyContent:"space-between",marginLeft:0,marginRight:t}},inputProps:{className:de().autoMarginCheckbox}},n.createElement("span",null,e.count.toLocaleString()))}},{key:"calculateMaxValueForTreatment",value:function(e){var t=this.tableData.filter((function(t){return t.treatment==e.treatment})).sort((function(e,t){return t.count-e.count}));return 0==t.length?0:t[0].count}},{key:"afterSorting",value:function(e,t){this.sortBy=e,this.sortDirection=t}},{key:"render",value:function(){var e="".concat(this.props.tableType,"-table");return n.createElement("div",{"data-test":e,key:e},this.props.promise.isComplete&&n.createElement(xo,{width:this.props.width,height:this.props.height,data:this.selectableTableData,columns:this.tableColumns,isSelectedRow:this.isSelectedRow,afterSelectingRows:this.afterSelectingRows,defaultSelectionOperator:this.selectionType,toggleSelectionOperator:this.toggleSelectionOperator,extraButtons:this.props.extraButtons,sortBy:this.sortBy,sortDirection:this.sortDirection,afterSorting:this.afterSorting,fixedTopRowsData:this.preSelectedRows,highlightedRowClassName:this.selectedRowClassName,numberOfSelectedRows:this.props.selectedRowsKeys.length,showSetOperationsButton:!0}))}},{key:"columnsWidth",get:function(){var e=this;return i().reduce(this.props.columns,(function(t,o){return t[o.columnKey]=(0,f.C)((o.columnWidthRatio?o.columnWidthRatio:Io[o.columnKey])*e.props.width),t}),{})}},{key:"cellMargin",get:function(){return i().reduce(this.props.columns,(function(e,t){return e[t.columnKey]=0,e}),{})}},{key:"tableData",get:function(){return this.props.promise.result||[]}},{key:"selectableTableData",get:function(){var e=this;return 0===this.flattenedFilters.length?this.tableData:i().filter(this.tableData,(function(t){return!e.flattenedFilters.includes((0,po.d6)(t))}))}},{key:"preSelectedRows",get:function(){var e=this;if(0===this.flattenedFilters.length)return[];var t=(0,m.ky)(this.flattenedFilters);return i().chain(this.tableData).filter((function(t){return e.flattenedFilters.includes((0,po.d6)(t))})).sortBy((function(e){return(0,Ne.Z)(t[(0,po.d6)(e)],Number.POSITIVE_INFINITY)})).value()}},{key:"preSelectedRowsKeys",get:function(){return this.preSelectedRows.map((function(e){return(0,po.d6)(e)}))}},{key:"tableColumns",get:function(){var e=this;return this.props.columns.map((function(t){return e.getDefaultColumnDefinition(t.columnKey,e.columnsWidth[t.columnKey],e.cellMargin[t.columnKey])}))}}])&&wo(o.prototype,r),a&&wo(o,a),t}(So);function jo(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Go(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bo(e,t){return!t||"object"!==Ko(t)&&"function"!=typeof t?Fo(e):t}function Fo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vo(e){return(Vo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Uo(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wo(e,t)}function Wo(e,t){return(Wo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qo(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function Ko(e){return(Ko="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(Lo,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{cancerGeneFilterEnabled:!1}}),Mo([l.observable],Lo.prototype,"sortBy",void 0),Mo([l.computed],Lo.prototype,"columnsWidth",null),Mo([l.computed],Lo.prototype,"cellMargin",null),Mo([l.computed],Lo.prototype,"tableData",null),Mo([l.computed],Lo.prototype,"selectableTableData",null),Mo([l.computed],Lo.prototype,"preSelectedRows",null),Mo([l.computed],Lo.prototype,"preSelectedRowsKeys",null),Mo([l.computed],Lo.prototype,"tableColumns",null),Mo([l.action.bound],Lo.prototype,"afterSorting",null),Lo=Mo([a.observer],Lo);var Ho,Yo=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===("undefined"==typeof Reflect?"undefined":Ko(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};!function(e){e.TREATMENT="Treatment",e.COUNT="#"}(Ho||(Ho={}));var zo=(qo(Do={},Ho.TREATMENT,.8),qo(Do,Ho.COUNT,.2),Do),Xo=function(e){function t(){return Go(this,t),Bo(this,Vo(t).apply(this,arguments))}return Uo(t,e),t}(ce.Z),Qo=function(e){function t(e){var o;return Go(this,t),o=Bo(this,Vo(t).call(this,e)),Object.defineProperty(Fo(o),"sortBy",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Fo(o),"getDefaultColumnDefinition",{enumerable:!0,configurable:!0,writable:!0,value:function(e,t,r){var i;return(qo(i={},Ho.TREATMENT,{name:e,headerRender:function(){return n.createElement(po.ev,{margin:r,headerName:e})},render:function(e){return n.createElement(po.ao,{row:e})},sortBy:function(e){return e.treatment},defaultSortDirection:"asc",filter:po.CB,width:t}),qo(i,Ho.COUNT,{tooltip:n.createElement("span",null,"Number of patients treated"),name:e,headerRender:function(){return n.createElement(po.ev,{margin:r,headerName:e})},render:function(e){return o.createNubmerColumnCell(e,28)},sortBy:function(e){return e.count+(0,po.Yy)(e.treatment)},defaultSortDirection:"desc",filter:po.CB,width:t}),i)[e]}}),(0,l.makeObservable)(Fo(o)),o.sortBy=o.props.defaultSortBy,o}var o,r,a;return Uo(t,e),o=t,(r=[{key:"createNubmerColumnCell",value:function(e,t){var o=this;return n.createElement(ue.Z,{checked:this.isChecked((0,po.d6)(e)),disabled:this.isDisabled((0,po.d6)(e)),onChange:function(t){return o.toggleSelectRow((0,po.d6)(e))},labelProps:{style:{display:"flex",justifyContent:"space-between",marginLeft:0,marginRight:t}},inputProps:{className:de().autoMarginCheckbox}},n.createElement("span",null,e.count.toLocaleString()))}},{key:"afterSorting",value:function(e,t){this.sortBy=e,this.sortDirection=t}},{key:"render",value:function(){var e="".concat(this.props.tableType,"-table");return n.createElement("div",{"data-test":e,key:e},this.props.promise.isComplete&&n.createElement(Xo,{width:this.props.width,height:this.props.height,data:this.selectableTableData,columns:this.tableColumns,isSelectedRow:this.isSelectedRow,afterSelectingRows:this.afterSelectingRows,defaultSelectionOperator:this.selectionType,toggleSelectionOperator:this.toggleSelectionOperator,extraButtons:this.props.extraButtons,sortBy:this.sortBy,sortDirection:this.sortDirection,afterSorting:this.afterSorting,fixedTopRowsData:this.preSelectedRows,highlightedRowClassName:this.selectedRowClassName,numberOfSelectedRows:this.props.selectedRowsKeys.length,showSetOperationsButton:!0}))}},{key:"columnsWidth",get:function(){var e=this;return i().reduce(this.props.columns,(function(t,o){return t[o.columnKey]=(0,f.C)((o.columnWidthRatio?o.columnWidthRatio:zo[o.columnKey])*e.props.width),t}),{})}},{key:"cellMargin",get:function(){return i().reduce(this.props.columns,(function(e,t){return e[t.columnKey]=0,e}),{})}},{key:"tableData",get:function(){return this.props.promise.result||[]}},{key:"selectableTableData",get:function(){var e=this;return 0===this.flattenedFilters.length?this.tableData:i().filter(this.tableData,(function(t){return!e.flattenedFilters.includes((0,po.d6)(t))}))}},{key:"preSelectedRows",get:function(){var e=this;if(0===this.flattenedFilters.length)return[];var t=(0,m.ky)(this.flattenedFilters);return i().chain(this.tableData).filter((function(t){return e.flattenedFilters.includes((0,po.d6)(t))})).sortBy((function(e){return(0,Ne.Z)(t[(0,po.d6)(e)],Number.POSITIVE_INFINITY)})).value()}},{key:"preSelectedRowsKeys",get:function(){return this.preSelectedRows.map((function(e){return(0,po.d6)(e)}))}},{key:"tableColumns",get:function(){var e=this;return this.props.columns.map((function(t){return e.getDefaultColumnDefinition(t.columnKey,e.columnsWidth[t.columnKey],e.cellMargin[t.columnKey])}))}}])&&jo(o.prototype,r),a&&jo(o,a),t}(So);Object.defineProperty(Qo,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{cancerGeneFilterEnabled:!1}}),Yo([l.observable],Qo.prototype,"sortBy",void 0),Yo([l.computed],Qo.prototype,"columnsWidth",null),Yo([l.computed],Qo.prototype,"cellMargin",null),Yo([l.computed],Qo.prototype,"tableData",null),Yo([l.computed],Qo.prototype,"selectableTableData",null),Yo([l.computed],Qo.prototype,"preSelectedRows",null),Yo([l.computed],Qo.prototype,"preSelectedRowsKeys",null),Yo([l.computed],Qo.prototype,"tableColumns",null),Yo([l.action.bound],Qo.prototype,"afterSorting",null),Qo=Yo([a.observer],Qo);var Zo=o(63443),Jo=o(38383),$o=o(71780),en=o(87097);function tn(e){return function(e){if(Array.isArray(e)){for(var t=0,o=new Array(e.length);t<e.length;t++)o[t]=e[t];return o}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function on(e,t,o){return t.min+(e-an)*(t.max-t.min)/o}function nn(e,t,o){return an+(e-t.min)*o/(t.max-t.min)}function rn(e){var t=e.toString();return"1"===t[0]&&0===parseFloat(t.substring(1))}var an=5,sn=30;function ln(e){return function(e){if(Array.isArray(e)){for(var t=0,o=new Array(e.length);t<e.length;t++)o[t]=e[t];return o}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function un(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cn(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function pn(e,t){return!t||"object"!==fn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dn(e){return(dn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function hn(e,t){return(hn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fn(e){return(fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var mn=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===("undefined"==typeof Reflect?"undefined":fn(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},yn=function(e){function t(){return un(this,t),pn(this,dn(t).apply(this,arguments))}var o,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hn(e,t)}(t,e),o=t,(r=[{key:"renderCurve",value:function(){if(this.props.curveMagnitudes.length>0){for(var e=15,t=Math.min(1,12/Math.max.apply(Math,ln(this.props.curveMagnitudes))),o=this.props.curveMagnitudes.map((function(e){return t*e})),r=this.violinWidth/(o.length-1),i="M 0 ".concat(e," L 0 ").concat(e-o[0]),a="M 0 ".concat(e," L 0 ").concat(e+o[0]),s=1;s<o.length;s++)i="".concat(i," L ").concat(s*r," ").concat(e-o[s]),a="".concat(a," L ").concat(s*r," ").concat(e+o[s]);return i="".concat(i," L ").concat(this.violinWidth," ").concat(e," L 0 ").concat(e),a="".concat(a," L ").concat(this.violinWidth," ").concat(e," L 0 ").concat(e),n.createElement("g",{transform:"translate(".concat(an,", 0)")},n.createElement("path",{d:i,fill:"gray"}),n.createElement("path",{d:a,fill:"gray"}))}return null}},{key:"x",value:function(e){return nn(e,this.props.violinBounds,this.violinWidth)}},{key:"renderPoints",value:function(){var e=this;return this.props.individualPoints.map((function(t){return n.createElement("circle",{key:"".concat(t.studyId,":").concat(t.sampleId),onMouseMove:function(o){e.props.onMouseOverPoint(t,o.pageX,o.pageY),o.stopPropagation()},cx:e.x(t.value),cy:15,r:3})}))}},{key:"renderBox",value:function(){var e=this,t=this.x(this.props.boxData.whiskerLower),o=this.x(this.props.boxData.whiskerUpper),r=this.x(this.props.boxData.q3)-this.x(this.props.boxData.q1),i=this.x(this.props.boxData.q1),a=this.x(this.props.boxData.median);return n.createElement(n.Fragment,null,n.createElement("line",{x1:t,x2:t,y1:12,y2:18,stroke:"black",strokeWidth:.5}),n.createElement("line",{x1:t,x2:o,y1:15,y2:15,stroke:"black",strokeWidth:.5}),n.createElement("line",{x1:o,x2:o,y1:12,y2:18,stroke:"black",strokeWidth:.5}),n.createElement("rect",{x:i,y:10,width:r,height:10,fill:"#dddddd",stroke:"black",strokeWidth:.2,onMouseOver:function(t){return e.props.onMouseOverBoxPlot(t.pageX,t.pageY)}}),n.createElement("line",{x1:a,x2:a,y1:10,y2:20,stroke:"black"}))}},{key:"renderGridLines",value:function(){var e=this;return n.createElement(n.Fragment,null,this.props.gridValues.map((function(t,o){var r=e.x(t);return n.createElement(n.Fragment,null,n.createElement("line",{x1:r,x2:r,y1:0,y2:sn,stroke:"#aaa",strokeWidth:1,strokeDasharray:"3,2"}))})))}},{key:"render",value:function(){return n.createElement("svg",{width:this.svgWidth,height:sn,style:{marginTop:5}},this.renderGridLines(),this.props.curveMagnitudes.length>0&&this.props.showViolin&&this.renderCurve(),n.createElement("rect",{width:this.svgWidth,height:sn,fillOpacity:0,onMouseMove:this.props.onMouseOverBackground}),this.props.curveMagnitudes.length>0&&this.props.showBox&&this.renderBox(),(this.props.showViolin||this.props.showBox)&&this.renderPoints())}},{key:"svgWidth",get:function(){return this.props.width}},{key:"violinWidth",get:function(){return this.svgWidth-2*an}}])&&cn(o.prototype,r),i&&cn(o,i),t}(n.Component);mn([l.computed],yn.prototype,"svgWidth",null),mn([l.computed],yn.prototype,"violinWidth",null);const bn=yn=mn([a.observer],yn);var gn=o(5985),vn=o.n(gn),Cn=o(3563);function Sn(e){return function(e){if(Array.isArray(e)){for(var t=0,o=new Array(e.length);t<e.length;t++)o[t]=e[t];return o}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function wn(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function En(e){return(En=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Tn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function On(e,t){return(On=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function An(e){return(An="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var kn=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===("undefined"==typeof Reflect?"undefined":An(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Nn="#",Pn=50,_n=function(e){function t(e){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=function(e,t){return!t||"object"!==An(t)&&"function"!=typeof t?Tn(e):t}(this,En(t).call(this,e)),Object.defineProperty(Tn(o),"ref",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Tn(o),"categoryColumnDragging",{enumerable:!0,configurable:!0,writable:!0,value:{_extraCategoryColumnWidth:0,dragging:!1,mouseXStart:-1,_extraWidthStart:0}}),Object.defineProperty(Tn(o),"rangeSelection",{enumerable:!0,configurable:!0,writable:!0,value:{mouseX:void 0,startX:void 0,dragging:!1,get rectX(){return Math.min(this.mouseX,this.startX)},get rectWidth(){return Math.abs(this.mouseX-this.startX)}}}),Object.defineProperty(Tn(o),"tooltipModel",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(Tn(o),"tooltipResetTimer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(Tn(o),"mouseInTooltip",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Tn(o),"sampleNumberFilter",{enumerable:!0,configurable:!0,writable:!0,value:"10"}),Object.defineProperty(Tn(o),"handlers",{enumerable:!0,configurable:!0,writable:!0,value:{isMouseInside:function(e,t){return e>=o.violinPlotStartX&&e<=o.violinPlotStartX+o.violinColumnWidth-2*an+6&&t>=Pn&&t<=o.props.height},onMouseMove:(0,l.action)((function(e){if(o.mouseInteractionPossible){o.doCategoryColumnDrag(e);var t=o.ref.getBoundingClientRect().x,n=o.ref.getBoundingClientRect().y,r=e.clientX-t,i=e.clientY-n;o.handlers.isMouseInside(r,i)?o.rangeSelection.mouseX=r:(o.rangeSelection.dragging&&o.executeRangeSelection(),o.stopRangeSelectionDrag(e))}})),onMouseLeave:(0,l.action)((function(e){o.stopRangeSelectionDrag(e),o.stopCategoryColumnDrag(e)})),onMouseDown:(0,l.action)((function(e){if(o.mouseInteractionPossible){var t=o.ref.getBoundingClientRect().x,n=o.ref.getBoundingClientRect().y,r=e.clientX-t,i=e.clientY-n;o.handlers.isMouseInside(r,i)&&(o.rangeSelection.startX=r,o.rangeSelection.dragging=!0)}})),onMouseUp:(0,l.action)((function(e){o.mouseInteractionPossible&&(o.rangeSelection.dragging&&o.executeRangeSelection(),o.stopRangeSelectionDrag(e),o.stopCategoryColumnDrag(e))}))}}),(0,l.makeObservable)(Tn(o)),o}var o,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&On(e,t)}(t,e),o=t,(r=[{key:"setRef",value:function(e){this.ref=e}},{key:"onMouseEnterTooltip",value:function(){this.mouseInTooltip=!0}},{key:"onMouseLeaveTooltip",value:function(){this.mouseInTooltip=!1}},{key:"setSampleNumberFilter",value:function(e){this.sampleNumberFilter=e}},{key:"violinX",value:function(e){return nn(e,this.props.violinBounds,this.violinPlotWidth)}},{key:"onMouseOverBoxPlot",value:function(e,t,o,n){this.onMouseLeaveTooltip(),this.cancelResetTooltip(),this.tooltipModel&&this.tooltipModel.category===n&&i().isEqual(this.tooltipModel.boxData,e)||(this.tooltipModel={boxData:e,category:n,mouseX:t,mouseY:o})}},{key:"onMouseOverPoint",value:function(e,t,o,n){this.onMouseLeaveTooltip(),this.cancelResetTooltip(),this.tooltipModel&&this.tooltipModel.category===n&&i().isEqual(this.tooltipModel.point,e)||(this.tooltipModel={point:e,category:n,mouseX:t,mouseY:o})}},{key:"onMouseOverBackground",value:function(){var e=this;this.onMouseLeaveTooltip(),null===this.tooltipResetTimer&&(this.tooltipResetTimer=setTimeout((function(){e.tooltipResetTimer=null,e.mouseInTooltip||(e.tooltipModel=null)}),400))}},{key:"cancelResetTooltip",value:function(){clearTimeout(this.tooltipResetTimer),this.tooltipResetTimer=null}},{key:"isCategorySelected",value:function(e){return e in this.selectedCategories}},{key:"onSelectCategory",value:function(e){this.props.selectedCategories.includes(e)?this.props.setFilters("categorical",this.props.selectedCategories.filter((function(t){return t!==e}))):this.props.setFilters("categorical",[e].concat(Sn(this.props.selectedCategories)))}},{key:"onSelectRange",value:function(e){this.props.setFilters("numerical",e)}},{key:"startCategoryColumnDrag",value:function(e){e.stopPropagation(),e.preventDefault(),this.categoryColumnDragging.dragging=!0,this.categoryColumnDragging.mouseXStart=e.clientX,this.categoryColumnDragging._extraWidthStart=this.extraCategoryColumnWidth}},{key:"doCategoryColumnDrag",value:function(e){this.categoryColumnDragging.dragging&&(this.categoryColumnDragging._extraCategoryColumnWidth=this.categoryColumnDragging._extraWidthStart+e.clientX-this.categoryColumnDragging.mouseXStart)}},{key:"stopCategoryColumnDrag",value:function(e){this.categoryColumnDragging.dragging&&(e.stopPropagation(),e.preventDefault()),this.categoryColumnDragging.dragging=!1}},{key:"executeRangeSelection",value:function(){if(this.rangeSelection.rectWidth>5){var e=(0,Cn.u)(on(this.rangeSelection.rectX-this.violinPlotStartX,this.props.violinBounds,this.violinPlotWidth),this.props.violinBounds.min,this.props.violinBounds.max),t=(0,Cn.u)(on(this.rangeSelection.rectX+this.rangeSelection.rectWidth-this.violinPlotStartX,this.props.violinBounds,this.violinPlotWidth),this.props.violinBounds.min,this.props.violinBounds.max);this.props.logScale&&(e=Math.exp(e)-1,t=Math.exp(t)-1),this.onSelectRange({start:e,end:t})}}},{key:"stopRangeSelectionDrag",value:function(e){this.rangeSelection.mouseX=void 0,this.rangeSelection.dragging=!1}},{key:"renderGridLabels",value:function(){var e=this;return n.createElement("svg",{style:{position:"absolute",top:52},width:this.props.width,height:20},n.createElement("rect",{width:this.props.width,height:20,fill:"#ffffff"}),n.createElement("g",{transform:"translate(".concat(this.gridLabelsOffset,",0)")},this.gridTicks.map((function(t,o){var r=e.violinX(t);return n.createElement("text",{x:r,y:15,textAnchor:"middle",fill:"#aaa",fontSize:10},e.props.logScale?(0,$o.qm)(Math.exp(t)-1,1):(0,$o.qm)(t,2))}))))}},{key:"renderTooltip",value:function(){var e,t,o,r,a=this.tooltipModel;return a?(a.point?(t=a.point,o=this.props.violinColumnName,r=this.props.logScale,e=n.createElement(n.Fragment,null,n.createElement("b",null,"Study ID:")," ",n.createElement("a",{href:(0,h.yY)(t.studyId)},t.studyId),n.createElement("br",null),n.createElement("b",null,"Sample ID:")," ",n.createElement("a",{href:(0,h.Qk)(t.studyId,t.sampleId)},t.sampleId),n.createElement("br",null),n.createElement("b",null,o,":")," ",(0,$o.qm)(r?Math.exp(t.value)-1:t.value,2))):a.boxData&&(e=function(e,t){return n.createElement(n.Fragment,null,(0,en.Z)(i().map({median:"Median",q1:"Quartile 1",q3:"Quartile 3"},(function(o,r){return n.createElement(n.Fragment,null,n.createElement("b",null,o,":")," ",n.createElement("span",null,(0,$o.qm)(t?Math.exp(e[r])-1:e[r],2)))})),n.createElement("br",null)))}(a.boxData,this.props.logScale)),Je.createPortal(n.createElement(q.Popover,{arrowOffsetTop:17,className:V()("cbioportal-frontend","cbioTooltip",vn().Tooltip),positionLeft:a.mouseX+7,positionTop:a.mouseY-19,onMouseEnter:this.onMouseEnterTooltip,onMouseLeave:this.onMouseLeaveTooltip},e),document.body)):null}},{key:"onScroll",value:function(){this.tooltipModel=null,this.cancelResetTooltip()}},{key:"renderRangeFilterIndicator",value:function(){if(!this.props.isLoading&&this.props.violinFilterRange&&this.data.length>0){var e={min:this.props.logScale&&void 0!==this.props.violinFilterRange.min?Math.log(this.props.violinFilterRange.min+1):this.props.violinFilterRange.min,max:this.props.logScale&&void 0!==this.props.violinFilterRange.max?Math.log(this.props.violinFilterRange.max+1):this.props.violinFilterRange.max};return n.createElement(n.Fragment,null,void 0!==this.props.violinFilterRange.min&&n.createElement("div",{style:{top:72,height:this.props.height-Pn-.5,position:"absolute",background:"#fff",borderRight:"1px solid #404040",left:this.violinPlotStartX+this.violinX(this.props.violinBounds.min)-1,width:1+this.violinX(e.min)-this.violinX(this.props.violinBounds.min),zIndex:100,opacity:.95,pointerEvents:"none"}}),void 0!==this.props.violinFilterRange.max&&n.createElement("div",{style:{top:72,height:this.props.height-Pn-.5,position:"absolute",background:"#fff",borderLeft:"1px solid #404040",left:this.violinPlotStartX+this.violinX(e.max),width:1+this.violinX(this.props.violinBounds.max)-this.violinX(e.max),zIndex:100,opacity:.95,pointerEvents:"none"}}))}return null}},{key:"renderRangeSelectUI",value:function(){return this.mouseInteractionPossible?this.rangeSelection.dragging?n.createElement("div",{style:{top:72,height:this.props.height-Pn-.5,position:"absolute",background:"#ccc",left:this.rangeSelection.rectX,width:this.rangeSelection.rectWidth,zIndex:100,opacity:.3}}):void 0===this.rangeSelection.mouseX||this.categoryColumnDragging.dragging?void 0:n.createElement("div",{style:{top:72,height:this.props.height-Pn-.5,position:"absolute",left:this.rangeSelection.mouseX,borderLeft:"1px dashed #999",width:1,zIndex:100,overflow:"visible",pointerEvents:"none"}}):null}},{key:"renderLoadingIndicator",value:function(){return this.props.isLoading?n.createElement("div",{style:{position:"absolute",left:0,top:0,width:this.props.width,height:this.props.height+50}},n.createElement("div",{style:{position:"absolute",width:"100%",height:this.props.height+2,top:20,background:"#fff",left:0,opacity:.8}}),n.createElement(p.Z,{centerRelativeToContainer:!0,isLoading:!0,className:B().chartLoader})):null}},{key:"render",value:function(){return n.createElement("div",{ref:this.setRef,onMouseMove:this.handlers.onMouseMove,onMouseLeave:this.handlers.onMouseLeave,onMouseDown:this.handlers.onMouseDown,onMouseUp:this.handlers.onMouseUp,className:this.rangeSelection.dragging||this.categoryColumnDragging.dragging?"noselect":""},n.createElement(n.Fragment,null,n.createElement(ce.Z,{columns:this.columns,data:this.data,headerHeight:Pn,headerClassName:V()("violinPlotTableHeader",{nomouse:this.categoryColumnDragging.dragging}),rowHeight:30,width:this.props.width,height:this.props.height,sortBy:Nn,sortDirection:"desc",extraFooterElements:this.extraFooterElements,onScroll:this.onScroll}),this.renderGridLabels(),this.renderRangeFilterIndicator(),this.renderRangeSelectUI(),this.renderTooltip(),this.renderLoadingIndicator()),0===this.data.length&&n.createElement("div",{style:{position:"absolute",left:0,top:70,width:this.props.width,height:this.props.height-70,display:"flex",alignItems:"center",justifyContent:"center"}},"No data."))}},{key:"extraCategoryColumnWidth",get:function(){return(0,Cn.u)(this.categoryColumnDragging._extraCategoryColumnWidth,0,this.violinColumnWidthWithoutColumnResize/2)}},{key:"violinColumnWidthWithoutColumnResize",get:function(){var e=0;return this.props.dimension.w>3&&(e=(this.props.dimension.w-3)*U.$u.layout.grid.w),160+e}},{key:"violinColumnWidth",get:function(){return this.violinColumnWidthWithoutColumnResize-this.extraCategoryColumnWidth}},{key:"violinPlotWidth",get:function(){return this.violinColumnWidth-2*an}},{key:"selectedCategories",get:function(){return i().keyBy(this.props.selectedCategories)}},{key:"columns",get:function(){var e=this;return[{name:this.props.categoryColumnName,render:function(e){return n.createElement("span",null,e.category)},headerRender:function(){return n.createElement("div",{style:{display:"flex",justifyContent:"space-between",width:"100%"}},n.createElement("span",null,e.props.categoryColumnName),n.createElement("div",{onMouseDown:e.startCategoryColumnDrag,style:{color:"#ddd",width:1,height:15,cursor:"ew-resize"}},"|"))},width:120+this.extraCategoryColumnWidth,sortBy:function(e){return e.category},filter:function(e,t,o){return e.category.toUpperCase().includes(o)},visible:!0,resizable:!0},{name:this.props.violinColumnName,render:function(t,o){return n.createElement(bn,{curveMagnitudes:t.curveData,violinBounds:e.props.violinBounds,individualPoints:t.individualPoints,boxData:t.boxData,showViolin:e.props.showViolin,showBox:e.props.showBox,width:e.violinColumnWidth,gridValues:e.gridTicks,onMouseOverPoint:function(o,n,r){return e.onMouseOverPoint(o,n,r,t.category)},onMouseOverBoxPlot:function(o,n){e.onMouseOverBoxPlot(t.boxData,o,n,t.category)},onMouseOverBackground:e.onMouseOverBackground})},sortBy:function(e){return e.boxData.median},width:this.violinColumnWidth,visible:!0},{name:Nn,render:function(t){return n.createElement(ue.Z,{checked:e.isCategorySelected(t.category),onChange:function(){return e.onSelectCategory(t.category)},labelProps:{style:{display:"flex",justifyContent:"space-between"}},inputProps:{className:de().autoMarginCheckbox}},n.createElement("span",{"data-test":"fixedHeaderTableRightJustified"},t.numSamples))},sortBy:function(e){return e.numSamples},visible:!0,width:60},{name:"Median",render:function(e){return n.createElement("span",{className:"fixedHeaderTableRightJustified"},(0,$o.qm)(e.boxData.median,2))},sortBy:function(e){return e.boxData.median},visible:this.props.dimension.w>2,width:42},{name:"Quartile 1",render:function(e){return n.createElement("span",{className:"fixedHeaderTableRightJustified"},(0,$o.qm)(e.boxData.q1,2))},sortBy:function(e){return e.boxData.q1},visible:this.props.dimension.w>2,width:50},{name:"Quartile 3",render:function(e){return n.createElement("span",{className:"fixedHeaderTableRightJustified"},(0,$o.qm)(e.boxData.q3,2))},sortBy:function(e){return e.boxData.q3},visible:this.props.dimension.w>2,width:50}].filter((function(e){return e.visible}))}},{key:"gridLabelsOffset",get:function(){var e=0;return this.props.dimension.w>2?e+=140:e+=139,e+=this.extraCategoryColumnWidth}},{key:"gridTicks",get:function(){if(this.data.length>0){var e=function(e,t,o){var n=[e.min,e.max],r=tn(n),a=2*t-2;if(o){var s;n=n.map(Math.exp);var l=(0,Jo.p2)().domain(n).ticks();for(l.length>a&&(l=l.filter((function(e){return e%10==0}))),l.length>a&&(l=l.filter(rn));l.length>a;)l=l.filter((function(e,t){return t%2==0}));(s=r).push.apply(s,tn(l.map((function(e){return Math.log(e+1)}))))}else{var u;(u=r).push.apply(u,tn((0,Jo.BY)().domain(n).ticks(2*t-2)))}return i().sortBy(i().uniq(r))}(this.props.violinBounds,this.props.dimension.w,this.props.logScale);return e.length>2&&this.violinX(e[1])<this.violinX(e[0])+30&&e.splice(1,1),e.length>2&&this.violinX(e[e.length-2])>this.violinX(e[e.length-1])-30&&e.splice(e.length-2,1),e}return[]}},{key:"data",get:function(){var e=this;return this.props.rows.filter((function(t){return t.numSamples>=parseFloat(e.sampleNumberFilter)}))}},{key:"extraFooterElements",get:function(){var e=[n.createElement("div",{style:{border:"1px solid #cccccc",padding:"1px 4px 1px 4px",borderRadius:4}},n.createElement("span",null,"Hide # <"),n.createElement(m.m1,{value:this.sampleNumberFilter,setValue:this.setSampleNumberFilter,style:{width:50,marginTop:0,marginLeft:5,lineHeight:"15px"},numericOnly:!0,textFieldAppearance:!0}))];return this.props.dimension.w<=2&&e.push(n.createElement("div",{style:{width:71,position:"absolute",right:18,fontSize:11,lineHeight:1.1}},"Expand to see quartiles ")),e}},{key:"mouseInteractionPossible",get:function(){return!this.props.isLoading&&this.data.length>0}},{key:"violinPlotStartX",get:function(){return this.extraCategoryColumnWidth+140}}])&&wn(o.prototype,r),a&&wn(o,a),t}(n.Component);kn([l.observable],_n.prototype,"categoryColumnDragging",void 0),kn([l.computed],_n.prototype,"extraCategoryColumnWidth",null),kn([g.default],_n.prototype,"setRef",null),kn([l.observable],_n.prototype,"rangeSelection",void 0),kn([l.observable],_n.prototype,"tooltipModel",void 0),kn([g.default],_n.prototype,"onMouseEnterTooltip",null),kn([g.default],_n.prototype,"onMouseLeaveTooltip",null),kn([l.observable],_n.prototype,"sampleNumberFilter",void 0),kn([l.action.bound],_n.prototype,"setSampleNumberFilter",null),kn([l.computed],_n.prototype,"violinColumnWidthWithoutColumnResize",null),kn([l.computed],_n.prototype,"violinColumnWidth",null),kn([l.computed],_n.prototype,"violinPlotWidth",null),kn([l.action.bound],_n.prototype,"onMouseOverBoxPlot",null),kn([l.action.bound],_n.prototype,"onMouseOverPoint",null),kn([l.action.bound],_n.prototype,"onMouseOverBackground",null),kn([l.action.bound],_n.prototype,"onSelectCategory",null),kn([l.action.bound],_n.prototype,"onSelectRange",null),kn([l.action.bound],_n.prototype,"startCategoryColumnDrag",null),kn([l.action.bound],_n.prototype,"doCategoryColumnDrag",null),kn([l.action.bound],_n.prototype,"stopCategoryColumnDrag",null),kn([l.action.bound],_n.prototype,"executeRangeSelection",null),kn([l.action.bound],_n.prototype,"stopRangeSelectionDrag",null),kn([l.computed],_n.prototype,"selectedCategories",null),kn([l.computed],_n.prototype,"columns",null),kn([l.computed],_n.prototype,"gridLabelsOffset",null),kn([l.computed],_n.prototype,"gridTicks",null),kn([l.computed],_n.prototype,"data",null),kn([l.computed],_n.prototype,"extraFooterElements",null),kn([l.action.bound],_n.prototype,"onScroll",null),kn([l.computed],_n.prototype,"mouseInteractionPossible",null),kn([l.computed],_n.prototype,"violinPlotStartX",null);const Rn=_n=kn([a.observer],_n);function Mn(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Dn(e){return(Dn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function In(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xn(e,t){return(xn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ln(e){return(Ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var jn=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===("undefined"==typeof Reflect?"undefined":Ln(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Gn=[U.oV.PIE_CHART,U.oV.TABLE,U.oV.BAR_CHART,U.oV.MUTATED_GENES_TABLE,U.oV.CNA_GENES_TABLE,U.oV.SAMPLE_TREATMENTS_TABLE,U.oV.SAMPLE_TREATMENT_GROUPS_TABLE,U.oV.SAMPLE_TREATMENT_TARGET_TABLE,U.oV.PATIENT_TREATMENTS_TABLE,U.oV.PATIENT_TREATMENT_GROUPS_TABLE,U.oV.PATIENT_TREATMENT_TARGET_TABLE,U.oV.STRUCTURAL_VARIANT_GENES_TABLE],Bn=function(e){function t(e){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=function(e,t){return!t||"object"!==Ln(t)&&"function"!=typeof t?In(e):t}(this,Dn(t).call(this,e)),Object.defineProperty(In(o),"chartHeaderHeight",{enumerable:!0,configurable:!0,writable:!0,value:20}),Object.defineProperty(In(o),"handlers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(In(o),"plot",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(In(o),"mouseLeaveTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(In(o),"mouseInChart",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(In(o),"placement",{enumerable:!0,configurable:!0,writable:!0,value:"right"}),Object.defineProperty(In(o),"chartType",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(In(o),"newlyAdded",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(In(o),"selectedRowsKeys",{enumerable:!0,configurable:!0,writable:!0,value:[]}),(0,l.makeObservable)(In(o)),o.chartType=o.props.chartType,o.handlers={ref:function(e){o.plot=e},resetFilters:(0,l.action)((function(){o.props.onResetSelection(o.props.chartMeta,[])})),onValueSelection:(0,l.action)((function(e){o.props.onValueSelection(o.props.chartMeta,e)})),onChangeSelectedRows:(0,l.action)((function(e){o.selectedRowsKeys=e})),onDataBinSelection:(0,l.action)((function(e){o.props.onDataBinSelection(o.props.chartMeta,e)})),onToggleLogScale:(0,l.action)((function(){var e,t;null===(t=(e=o.props).onToggleLogScale)||void 0===t||t.call(e,o.props.chartMeta)})),onToggleLogScaleX:(0,l.action)((function(){var e,t;null===(t=(e=o.props).onToggleLogScaleX)||void 0===t||t.call(e,o.props.chartMeta)})),onToggleLogScaleY:(0,l.action)((function(){var e,t;null===(t=(e=o.props).onToggleLogScaleY)||void 0===t||t.call(e,o.props.chartMeta)})),onToggleBoxPlot:(0,l.action)((function(){var e,t;null===(t=(e=o.props).onToggleBoxPlot)||void 0===t||t.call(e,o.props.chartMeta)})),onToggleViolinPlot:(0,l.action)((function(){var e,t;null===(t=(e=o.props).onToggleViolinPlot)||void 0===t||t.call(e,o.props.chartMeta)})),onToggleNAValue:(0,l.action)((function(){var e,t;null===(t=(e=o.props).onToggleNAValue)||void 0===t||t.call(e,o.props.chartMeta)})),onSwapAxes:(0,l.action)((function(){var e,t;null===(t=(e=o.props).onSwapAxes)||void 0===t||t.call(e,o.props.chartMeta)})),onMouseEnterChart:(0,l.action)((function(e){o.mouseLeaveTimeout&&clearTimeout(o.mouseLeaveTimeout),o.placement=e.nativeEvent.x>Ze.Z.size.width-400?"left":"right",o.mouseInChart=!0})),onMouseLeaveChart:(0,l.action)((function(){o.mouseLeaveTimeout=setTimeout((function(){o.placement="right",o.mouseInChart=!1}),100)})),defaultDownload:{SVG:function(){return Promise.resolve((new XMLSerializer).serializeToString(o.toSVGDOMNode()))},PNG:function(){return Promise.resolve(o.toSVGDOMNode())},PDF:function(){return Promise.resolve(o.toSVGDOMNode())}},onChangeChartType:function(e){o.mouseInChart=!1,o.props.onChangeChartType(o.props.chartMeta,e)},onDeleteChart:function(){o.props.onDeleteChart(o.props.chartMeta)}},(0,l.makeObservable)(In(o)),o}var o,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xn(e,t)}(t,e),o=t,(r=[{key:"toSVGDOMNode",value:function(){return this.plot?this.plot.toSVGDOMNode():document.createElementNS("http://www.w3.org/2000/svg","svg")}},{key:"changeChartType",value:function(e){this.chartType=e,this.handlers.onChangeChartType(e)}},{key:"openComparisonPage",value:function(e){var t=this;if(this.comparisonPagePossible)switch(this.props.chartType){case U.oV.PIE_CHART:case U.oV.TABLE:t.props.store.openComparisonPage(t.props.chartMeta,{clinicalAttributeValues:t.props.promise.result});break;default:this.props.store.openComparisonPage(this.props.chartMeta,e||{})}}},{key:"getScatterPlotHeight",value:function(e){return U.$u.layout.grid.h*e-this.chartHeaderHeight+33}},{key:"componentDidMount",value:function(){var e=this;this.props.isNewlyAdded(this.props.chartMeta.uniqueKey)&&(this.newlyAdded=!0,setTimeout((function(){return e.newlyAdded=!1}),U.$u.thresholds.chartHighlight))}},{key:"componentWillReceiveProps",value:function(e,t){e.chartType!==this.chartType&&(this.chartType=e.chartType)}},{key:"render",value:function(){var e,t,o,r=this;return n.createElement("div",{className:V()(B().chart,(e={},t=B().highlight,o=this.highlightChart,t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e)),"data-test":"chart-container-".concat(this.props.chartMeta.uniqueKey),onMouseEnter:this.handlers.onMouseEnterChart,onMouseLeave:this.handlers.onMouseLeaveChart},n.createElement(se,{height:this.chartHeaderHeight,chartMeta:this.props.chartMeta,chartType:this.props.chartType,store:this.props.store,title:this.props.title,active:this.mouseInChart,resetChart:this.handlers.resetFilters,deleteChart:this.handlers.onDeleteChart,selectedRowsKeys:this.selectedRowsKeys,toggleLogScale:this.handlers.onToggleLogScale,toggleLogScaleX:this.handlers.onToggleLogScaleX,toggleLogScaleY:this.handlers.onToggleLogScaleY,toggleBoxPlot:this.handlers.onToggleBoxPlot,toggleViolinPlot:this.handlers.onToggleViolinPlot,swapAxes:this.handlers.onSwapAxes,toggleNAValue:this.handlers.onToggleNAValue,chartControls:this.chartControls,changeChartType:this.changeChartType,getSVG:function(){return Promise.resolve(r.toSVGDOMNode())},getData:this.props.getData,downloadTypes:this.props.downloadTypes,openComparisonPage:this.openComparisonPage,placement:this.placement,description:this.props.description}),n.createElement("div",{className:B().chartInnerWrapper},this.props.promise.isPending&&n.createElement(p.Z,{isLoading:!0,className:B().chartLoader}),this.props.promise.isError&&n.createElement("div",{className:B().chartError},n.createElement("i",{className:"fa fa-warning","aria-hidden":"true"})," ","Error when loading data."),(!this.props.chartMeta.renderWhenDataChange||this.props.promise.isComplete)&&n.createElement("div",{style:{visibility:this.props.promise.isPending?"hidden":"visible",display:"flex"}},this.chart&&this.chart())))}},{key:"chartControls",get:function(){var e={};switch(this.chartType){case U.oV.BAR_CHART:e={showLogScaleToggle:this.props.showLogScaleToggle,logScaleChecked:this.props.logScaleChecked,isShowNAChecked:this.props.isShowNAChecked,showNAToggle:this.props.showNAToggle};break;case U.oV.SCATTER:e={showLogScaleXToggle:this.props.showLogScaleXToggle,logScaleXChecked:this.props.logScaleXChecked,showLogScaleYToggle:this.props.showLogScaleYToggle,logScaleYChecked:this.props.logScaleYChecked,showSwapAxes:!!this.props.onSwapAxes};break;case U.oV.VIOLIN_PLOT_TABLE:e={showLogScaleToggle:this.props.showLogScaleToggle,logScaleChecked:this.props.logScaleChecked,showViolinPlotToggle:this.props.showViolinPlotToggle,violinPlotChecked:this.props.violinPlotChecked,showBoxPlotToggle:this.props.showBoxPlotToggle,boxPlotChecked:this.props.boxPlotChecked};break;case U.oV.PIE_CHART:e={showTableIcon:!0};break;case U.oV.TABLE:e={showPieIcon:!0}}return this.comparisonPagePossible&&(e.showComparisonPageIcon=!0),Object.assign(Object.assign({},e),{showResetIcon:this.props.filters&&this.props.filters.length>0})}},{key:"comparisonPagePossible",get:function(){return this.props.promise.isComplete&&this.props.promise.result.length>1&&Gn.indexOf(this.props.chartType)>-1}},{key:"survivalChartData",get:function(){var e,t,o,n,r,a,s,l=this;if(this.props.promise.isComplete&&this.props.patientToAnalysisGroup&&this.props.patientToAnalysisGroup.isComplete){var u=i().find(this.props.promise.result,(function(e){return e.id===l.props.chartMeta.uniqueKey}));return e=u.survivalData,t=this.props.analysisGroupsSettings.groups,o=this.props.patientToAnalysisGroup.result,n=i().mapValues(o,(function(e){return[e]})),r=i().reduce(e,(function(e,t){return t.uniquePatientKey in n&&n[t.uniquePatientKey].forEach((function(o){e[o]=e[o]||[],e[o].push(t)})),e}),{}),a=i().mapValues(r,(function(e){return e.sort((function(e,t){return e.months-t.months}))})),s=null,t.length>1&&(s=dt.M.apply(void 0,ht(t.map((function(e){return a[e.value]||[]}))))),{patientToAnalysisGroups:n,analysisGroups:t,sortedGroupedSurvivals:a,pValue:s}}}},{key:"borderWidth",get:function(){return this.highlightChart?2:1}},{key:"comparisonButtonForTables",get:function(){var e=this;return this.selectedRowsKeys.length>=2?{content:n.createElement("div",{style:{display:"flex",alignItems:"center"}},n.createElement($,{className:V()("fa fa-fw"),style:{marginRight:4}}),"Compare"),onClick:function(){e.openComparisonPage((0,ee.AJ)(e.selectedRowsKeys,e.chartType))},isDisabled:function(){return e.selectedRowsKeys.length<2}}:void 0}},{key:"chart",get:function(){var e=this;switch(this.chartType){case U.oV.PIE_CHART:return function(){return n.createElement(Fe,{width:(0,f.Ft)(e.props.dimension,e.borderWidth),height:(0,f.xJ)(e.props.dimension,e.chartHeaderHeight),ref:e.handlers.ref,onUserSelection:e.handlers.onValueSelection,openComparisonPage:e.openComparisonPage,filters:e.props.filters,data:e.props.promise.result,placement:e.placement,label:e.props.title,labelDescription:e.props.chartMeta.description,patientAttribute:e.props.chartMeta.patientAttribute})};case U.oV.BAR_CHART:return function(){return n.createElement(ut,{width:(0,f.Ft)(e.props.dimension,e.borderWidth),height:(0,f.xJ)(e.props.dimension,e.chartHeaderHeight),ref:e.handlers.ref,onUserSelection:e.handlers.onDataBinSelection,filters:e.props.filters,data:e.props.promise.result,showNAChecked:e.props.store.isShowNAChecked(e.props.chartMeta.uniqueKey)})};case U.oV.TABLE:return function(){return n.createElement(Ae,{data:e.props.promise.result,width:(0,f.Ft)(e.props.dimension,e.borderWidth),height:(0,f.qU)(e.props.dimension,e.chartHeaderHeight),filters:e.props.filters,onUserSelection:e.handlers.onValueSelection,labelDescription:e.props.chartMeta.description,patientAttribute:e.props.chartMeta.patientAttribute,showAddRemoveAllButtons:e.mouseInChart})};case U.oV.MUTATED_GENES_TABLE:return function(){var t={columnKey:ao.NUMBER};return e.props.store.isGlobalMutationFilterActive&&(t.columnTooltip=n.createElement("span",{"data-test":"hidden-mutation-alterations"},"Total number of mutations",n.createElement("br",null),"This table is filtered based on selections in the ",n.createElement("i",null,"Alteration Filter")," menu.")),n.createElement(co,{tableType:Mt.Zh.MUTATION,promise:e.props.promise,width:(0,f.Ft)(e.props.dimension,e.borderWidth),height:(0,f.qU)(e.props.dimension,e.chartHeaderHeight),filters:e.props.filters,onSubmitSelection:e.handlers.onValueSelection,onChangeSelectedRows:e.handlers.onChangeSelectedRows,extraButtons:e.comparisonButtonForTables&&[e.comparisonButtonForTables],selectedRowsKeys:e.selectedRowsKeys,onGeneSelect:e.props.onGeneSelect,selectedGenes:e.props.selectedGenes,genePanelCache:e.props.genePanelCache,cancerGeneFilterEnabled:e.props.cancerGeneFilterEnabled,filterByCancerGenes:e.props.filterByCancerGenes,onChangeCancerGeneFilter:e.props.onChangeCancerGeneFilter,alterationFilterEnabled:e.props.alterationFilterEnabled,filterAlterations:e.props.filterAlterations,columns:[{columnKey:ao.GENE},{columnKey:ao.NUMBER_MUTATIONS},t,{columnKey:ao.FREQ}],defaultSortBy:ao.FREQ})};case U.oV.STRUCTURAL_VARIANT_GENES_TABLE:return function(){var t={columnKey:ao.NUMBER};return e.props.store.isGlobalMutationFilterActive&&(t.columnTooltip=n.createElement("span",{"data-test":"hidden-fusion-alterations"},"Total number of fusions",n.createElement("br",null),"This table is filtered based on selections in the ",n.createElement("i",null,"Alteration Filter")," menu.")),n.createElement(co,{tableType:Mt.Zh.STRUCTURAL_VARIANT,promise:e.props.promise,width:(0,f.Ft)(e.props.dimension,e.borderWidth),height:(0,f.qU)(e.props.dimension,e.chartHeaderHeight),filters:e.props.filters,onSubmitSelection:e.handlers.onValueSelection,onChangeSelectedRows:e.handlers.onChangeSelectedRows,extraButtons:e.comparisonButtonForTables&&[e.comparisonButtonForTables],selectedRowsKeys:e.selectedRowsKeys,onGeneSelect:e.props.onGeneSelect,selectedGenes:e.props.selectedGenes,genePanelCache:e.props.genePanelCache,cancerGeneFilterEnabled:e.props.cancerGeneFilterEnabled,filterByCancerGenes:e.props.filterByCancerGenes,onChangeCancerGeneFilter:e.props.onChangeCancerGeneFilter,alterationFilterEnabled:e.props.alterationFilterEnabled,filterAlterations:e.props.filterAlterations,columns:[{columnKey:ao.GENE},{columnKey:ao.NUMBER_STRUCTURAL_VARIANTS},t,{columnKey:ao.FREQ}],defaultSortBy:ao.FREQ})};case U.oV.CNA_GENES_TABLE:return function(){var t={columnKey:ao.NUMBER,columnWidthRatio:.17};return e.props.store.isGlobalAlterationFilterActive&&(t.columnTooltip=n.createElement("span",{"data-test":"hidden-fusion-alterations"},"Number of samples with one or more copy number alterations",n.createElement("br",null),"This table is filtered based on selections in the ",n.createElement("i",null,"Alteration Filter")," menu.")),n.createElement(co,{tableType:Mt.Zh.CNA,promise:e.props.promise,width:(0,f.Ft)(e.props.dimension,e.borderWidth),height:(0,f.qU)(e.props.dimension,e.chartHeaderHeight),filters:e.props.filters,onSubmitSelection:e.handlers.onValueSelection,onChangeSelectedRows:e.handlers.onChangeSelectedRows,extraButtons:e.comparisonButtonForTables&&[e.comparisonButtonForTables],selectedRowsKeys:e.selectedRowsKeys,onGeneSelect:e.props.onGeneSelect,selectedGenes:e.props.selectedGenes,genePanelCache:e.props.genePanelCache,cancerGeneFilterEnabled:e.props.cancerGeneFilterEnabled,filterByCancerGenes:e.props.filterByCancerGenes,onChangeCancerGeneFilter:e.props.onChangeCancerGeneFilter,alterationFilterEnabled:e.props.alterationFilterEnabled,filterAlterations:e.props.filterAlterations,columns:[{columnKey:ao.GENE,columnWidthRatio:.24},{columnKey:ao.CYTOBAND,columnWidthRatio:.24},{columnKey:ao.CNA,columnWidthRatio:.18},t,{columnKey:ao.FREQ,columnWidthRatio:.17}],defaultSortBy:ao.FREQ})};case U.oV.GENOMIC_PROFILES_TABLE:return function(){return n.createElement(co,{tableType:Mt.Zh.DATA,promise:e.props.promise,width:(0,f.Ft)(e.props.dimension,e.borderWidth),height:(0,f.qU)(e.props.dimension,e.chartHeaderHeight),filters:e.props.filters,onSubmitSelection:e.handlers.onValueSelection,onChangeSelectedRows:e.handlers.onChangeSelectedRows,selectedRowsKeys:e.selectedRowsKeys,onGeneSelect:e.props.onGeneSelect,selectedGenes:e.props.selectedGenes,genePanelCache:e.props.genePanelCache,cancerGeneFilterEnabled:e.props.cancerGeneFilterEnabled,filterByCancerGenes:e.props.filterByCancerGenes,onChangeCancerGeneFilter:e.props.onChangeCancerGeneFilter,columns:[{columnKey:ao.MOLECULAR_PROFILE},{columnKey:ao.NUMBER},{columnKey:ao.FREQ}],defaultSortBy:ao.FREQ})};case U.oV.CASE_LIST_TABLE:return function(){return n.createElement(co,{tableType:Mt.Zh.DATA,promise:e.props.promise,width:(0,f.Ft)(e.props.dimension,e.borderWidth),height:(0,f.qU)(e.props.dimension,e.chartHeaderHeight),filters:e.props.filters,onSubmitSelection:e.handlers.onValueSelection,onChangeSelectedRows:e.handlers.onChangeSelectedRows,selectedRowsKeys:e.selectedRowsKeys,onGeneSelect:e.props.onGeneSelect,selectedGenes:e.props.selectedGenes,genePanelCache:e.props.genePanelCache,cancerGeneFilterEnabled:e.props.cancerGeneFilterEnabled,filterByCancerGenes:e.props.filterByCancerGenes,onChangeCancerGeneFilter:e.props.onChangeCancerGeneFilter,columns:[{columnKey:ao.CASE_LIST},{columnKey:ao.NUMBER},{columnKey:ao.FREQ}],defaultSortBy:ao.FREQ})};case U.oV.SURVIVAL:if(this.survivalChartData){var t=this.survivalChartData;return function(){return n.createElement(Ue.Z,{ref:e.handlers.ref,sortedGroupedSurvivals:t.sortedGroupedSurvivals,patientToAnalysisGroups:t.patientToAnalysisGroups,pValue:t.pValue,analysisGroups:t.analysisGroups,legendLocation:Ue.L.TOOLTIP,title:e.props.title,totalCasesHeader:"Number of Cases, Total",statusCasesHeader:"Number of Events",medianMonthsHeader:"Median Months Survival",yLabelTooltip:Zo.Ic,xLabelWithEventTooltip:Zo.qm,xLabelWithoutEventTooltip:Zo.jM,showDownloadButtons:!1,showSlider:!1,showTable:!1,styleOpts:{padding:{top:15,bottom:30,left:45,right:20},width:(0,f.Ft)(e.props.dimension,e.borderWidth),height:(0,f.xJ)(e.props.dimension,e.chartHeaderHeight),tooltipXOffset:10,tooltipYOffset:-58,pValue:{x:(0,f.Ft)(e.props.dimension,e.borderWidth)-10,y:30,textAnchor:"end"},axis:{y:{axisLabel:{padding:40}}}},fileName:e.props.title.replace(" ","_"),yAxisTickCount:2,xAxisTickCount:4})}}return null;case U.oV.SAMPLE_TREATMENT_TARGET_TABLE:case U.oV.SAMPLE_TREATMENT_GROUPS_TABLE:case U.oV.SAMPLE_TREATMENTS_TABLE:return function(){return n.createElement(Lo,{tableType:po.k6.SAMPLE,promise:e.props.promise,width:(0,f.Ft)(e.props.dimension,e.borderWidth),height:(0,f.qU)(e.props.dimension,e.chartHeaderHeight),filters:e.props.filters,onSubmitSelection:e.handlers.onValueSelection,onChangeSelectedRows:e.handlers.onChangeSelectedRows,extraButtons:e.comparisonButtonForTables&&[e.comparisonButtonForTables],selectedRowsKeys:e.selectedRowsKeys,columns:[{columnKey:Ro.TREATMENT},{columnKey:Ro.TIME},{columnKey:Ro.COUNT}],defaultSortBy:Ro.COUNT,selectedTreatments:[]})};case U.oV.PATIENT_TREATMENT_TARGET_TABLE:case U.oV.PATIENT_TREATMENT_GROUPS_TABLE:case U.oV.PATIENT_TREATMENTS_TABLE:return function(){return n.createElement(Qo,{tableType:po.k6.PATIENT,promise:e.props.promise,width:(0,f.Ft)(e.props.dimension,e.borderWidth),height:(0,f.qU)(e.props.dimension,e.chartHeaderHeight),filters:e.props.filters,onSubmitSelection:e.handlers.onValueSelection,onChangeSelectedRows:e.handlers.onChangeSelectedRows,extraButtons:e.comparisonButtonForTables&&[e.comparisonButtonForTables],selectedRowsKeys:e.selectedRowsKeys,columns:[{columnKey:Ho.TREATMENT},{columnKey:Ho.COUNT}],defaultSortBy:Ho.COUNT,selectedTreatments:[]})};case U.oV.SCATTER:return function(){return n.createElement("div",{style:{overflow:"hidden",height:(0,f.xJ)(e.props.dimension,e.chartHeaderHeight)}},n.createElement("div",{style:{marginTop:-33}},n.createElement(_t,{ref:e.handlers.ref,width:(0,f.Ft)(e.props.dimension,e.borderWidth),height:e.getScatterPlotHeight(e.props.dimension.h),spearmanCorr:e.props.promise.result.spearmanCorr,pearsonCorr:e.props.promise.result.pearsonCorr,plotDomain:e.props.plotDomain,yBinsMin:f.fh,onSelection:e.props.onValueSelection,selectionBounds:e.props.filters&&e.props.filters.length>0?e.props.filters[0]:void 0,data:e.props.promise.result.bins,xBinSize:e.props.promise.result.xBinSize,yBinSize:e.props.promise.result.yBinSize,isLoading:e.props.promise.isPending,axisLabelX:e.props.axisLabelX,axisLabelY:e.props.axisLabelY,tooltip:e.props.tooltip})))};case U.oV.VIOLIN_PLOT_TABLE:this.props.store.getXvsYChartSettings(this.props.chartMeta.uniqueKey);var o=this.props.store.getXvsYViolinChartInfo(this.props.chartMeta.uniqueKey),r=(this.props.store.filters.clinicalDataFilters||[]).find((function(e){return e.attributeId===o.numericalAttr.clinicalAttributeId}));return function(){var t=e.props.store.clinicalDataBinPromises[o.numericalAttr.clinicalAttributeId]&&e.props.store.clinicalDataBinPromises[o.numericalAttr.clinicalAttributeId].isPending||e.props.promise.isPending;return n.createElement(Rn,{dimension:e.props.dimension,width:(0,f.Ft)(e.props.dimension,e.borderWidth),height:(0,f.qU)(e.props.dimension,e.chartHeaderHeight),categoryColumnName:e.props.axisLabelX,violinColumnName:e.props.axisLabelY,violinBounds:{min:e.props.promise.result.data.axisStart,max:e.props.promise.result.data.axisEnd},violinFilterRange:r&&(0,f.Sk)(r.values),rows:e.props.promise.result.data.rows||[],showViolin:e.props.violinPlotChecked,showBox:e.props.boxPlotChecked,logScale:e.props.promise.result.violinLogScale,setFilters:e.props.onValueSelection,selectedCategories:e.props.selectedCategories,isLoading:t})};default:return null}}},{key:"highlightChart",get:function(){return this.newlyAdded}}])&&Mn(o.prototype,r),a&&Mn(o,a),t}(n.Component);jn([l.observable],Bn.prototype,"mouseInChart",void 0),jn([l.observable],Bn.prototype,"placement",void 0),jn([l.observable],Bn.prototype,"chartType",void 0),jn([l.observable],Bn.prototype,"newlyAdded",void 0),jn([l.observable],Bn.prototype,"selectedRowsKeys",void 0),jn([l.computed],Bn.prototype,"chartControls",null),jn([l.action.bound],Bn.prototype,"changeChartType",null),jn([l.computed],Bn.prototype,"comparisonPagePossible",null),jn([l.action.bound],Bn.prototype,"openComparisonPage",null),jn([l.computed],Bn.prototype,"survivalChartData",null),jn([l.computed],Bn.prototype,"borderWidth",null),jn([l.computed],Bn.prototype,"comparisonButtonForTables",null),jn([l.computed],Bn.prototype,"chart",null),jn([l.computed],Bn.prototype,"highlightChart",null),Bn=jn([a.observer],Bn);var Fn=o(10300),Vn=o.n(Fn);function Un(e){return(Un="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qn(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Kn(e,t){return!t||"object"!==Un(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Hn(e){return(Hn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Yn(e,t){return(Yn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var zn=function(e){function t(){return Wn(this,t),Kn(this,Hn(t).apply(this,arguments))}var o,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yn(e,t)}(t,e),o=t,(n=[{key:"shouldComponentUpdate",value:function(){var e=this;return setTimeout((function(){return e.forceUpdate()}),0),!1}},{key:"render",value:function(){return this.props.children}}])&&qn(o.prototype,n),r&&qn(o,r),t}(n.Component),Xn=o(41940),Qn=o(26942);function Zn(){return(Zn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}function Jn(e){return function(e){if(Array.isArray(e)){for(var t=0,o=new Array(e.length);t<e.length;t++)o[t]=e[t];return o}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function $n(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function er(e){return(er=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function or(e,t){return(or=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function nr(e){return(nr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var rr=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===("undefined"==typeof Reflect?"undefined":nr(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},ir=function(e){function t(e){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=function(e,t){return!t||"object"!==nr(t)&&"function"!=typeof t?tr(e):t}(this,er(t).call(this,e)),Object.defineProperty(tr(o),"store",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(tr(o),"handlers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(tr(o),"showErrorMessage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(tr(o),"renderAttributeChart",{enumerable:!0,configurable:!0,writable:!0,value:function(e){var t={chartMeta:e,chartType:o.props.store.chartsType.get(e.uniqueKey),store:o.props.store,dimension:o.store.chartsDimension.get(e.uniqueKey),title:e.displayName,filters:[],onDeleteChart:o.handlers.onDeleteChart,isNewlyAdded:o.handlers.isNewlyAdded,studyViewFilters:o.store.filters,analysisGroupsSettings:o.store.analysisGroupsSettings,cancerGeneFilterEnabled:o.store.oncokbCancerGeneFilterEnabled,setComparisonConfirmationModal:o.store.setComparisonConfirmationModal};switch(o.store.chartsType.get(e.uniqueKey)){case U.oV.PIE_CHART:o.store.isUserDefinedCustomDataChart(e.uniqueKey)?(t.filters=o.store.getCustomDataFiltersByUniqueKey(e.uniqueKey).map((function(e){return e.value})),t.onValueSelection=o.handlers.setCustomChartFilters,t.onResetSelection=o.handlers.setCustomChartFilters,t.promise=o.store.getCustomDataCount(e)):o.store.isGenericAssayChart(e.uniqueKey)?(t.filters=o.store.getGenericAssayDataFiltersByUniqueKey(t.chartMeta.uniqueKey).map((function(e){return e.value})),t.onValueSelection=o.handlers.onGenericAssayCategoricalValueSelection,t.onResetSelection=o.handlers.onGenericAssayCategoricalValueSelection,t.promise=o.store.getGenericAssayChartDataCount(e)):(t.promise=o.store.getClinicalDataCount(e),t.filters=o.store.getClinicalDataFiltersByUniqueKey(e.uniqueKey).map((function(e){return e.value})),t.onValueSelection=o.handlers.onValueSelection,t.onResetSelection=o.handlers.onValueSelection),t.onChangeChartType=o.handlers.onChangeChartType,t.getData=function(t){return o.store.getPieChartDataDownload(e,t)},t.downloadTypes=["Summary Data","Full Data","SVG","PDF"];break;case U.oV.BAR_CHART:o.store.isGeneSpecificChart(e.uniqueKey)?(t.promise=o.store.getGenomicChartDataBin(e),t.filters=o.store.getGenomicDataIntervalFiltersByUniqueKey(t.chartMeta.uniqueKey),t.onDataBinSelection=o.handlers.onGenomicDataBinSelection,t.onResetSelection=o.handlers.onGenomicDataBinSelection,t.getData=function(){return o.store.getChartDownloadableData(e)}):o.store.isGenericAssayChart(e.uniqueKey)?(t.promise=o.store.getGenericAssayChartDataBin(e),t.filters=o.store.getGenericAssayDataFiltersByUniqueKey(t.chartMeta.uniqueKey),t.onDataBinSelection=o.handlers.onGenericAssayDataBinSelection,t.onResetSelection=o.handlers.onGenericAssayDataBinSelection,t.getData=function(){return o.store.getChartDownloadableData(e)}):(t.promise=o.store.getClinicalDataBin(e),t.filters=o.store.getClinicalDataFiltersByUniqueKey(e.uniqueKey),t.onDataBinSelection=o.handlers.onDataBinSelection,t.onResetSelection=o.handlers.onDataBinSelection,t.getData=function(){return o.store.getChartDownloadableData(e)}),t.onToggleLogScale=o.handlers.onToggleLogScale,t.onToggleNAValue=o.handlers.onToggleNAValue,t.showLogScaleToggle=o.store.isLogScaleToggleVisible(e.uniqueKey,t.promise.result),t.logScaleChecked=o.store.isLogScaleChecked(e.uniqueKey),t.isShowNAChecked=o.store.isShowNAChecked(e.uniqueKey),t.showNAToggle=o.store.isShowNAToggleVisible(t.promise.result),t.downloadTypes=["Data","SVG","PDF"];break;case U.oV.TABLE:o.store.isUserDefinedCustomDataChart(e.uniqueKey)?(t.filters=o.store.getCustomDataFiltersByUniqueKey(e.uniqueKey).map((function(e){return e.value})),t.onValueSelection=o.handlers.setCustomChartFilters,t.onResetSelection=o.handlers.setCustomChartFilters,t.promise=o.store.getCustomDataCount(e)):o.store.isGenericAssayChart(e.uniqueKey)?(t.filters=o.store.getGenericAssayDataFiltersByUniqueKey(t.chartMeta.uniqueKey).map((function(e){return e.value})),t.onValueSelection=o.handlers.onGenericAssayCategoricalValueSelection,t.onResetSelection=o.handlers.onGenericAssayCategoricalValueSelection,t.promise=o.store.getGenericAssayChartDataCount(e)):(t.filters=o.store.getClinicalDataFiltersByUniqueKey(e.uniqueKey).map((function(e){return e.value})),t.promise=o.store.getClinicalDataCount(e),t.onValueSelection=o.handlers.onValueSelection,t.onResetSelection=o.handlers.onValueSelection),t.onChangeChartType=o.handlers.onChangeChartType,t.getData=function(){return o.store.getChartDownloadableData(e)},t.downloadTypes=["Data"];break;case U.oV.MUTATED_GENES_TABLE:t.filters=o.store.getGeneFiltersByUniqueKey(e.uniqueKey),t.promise=o.store.mutatedGeneTableRowData,t.onValueSelection=o.store.addGeneFilters,t.onResetSelection=function(){return o.store.resetGeneFilter(e.uniqueKey)},t.selectedGenes=o.store.selectedGenes,t.onGeneSelect=o.store.onCheckGene,t.title=o.store.getChartTitle(U.oV.MUTATED_GENES_TABLE,t.title),t.getData=function(){return o.store.getMutatedGenesDownloadData()},t.genePanelCache=o.store.genePanelCache,t.downloadTypes=["Data"],t.filterByCancerGenes=o.store.filterMutatedGenesTableByCancerGenes,t.onChangeCancerGeneFilter=o.store.updateMutatedGenesTableByCancerGenesFilter,t.alterationFilterEnabled=(0,Qn.Ib)().skin_show_settings_menu,t.filterAlterations=o.store.isGlobalMutationFilterActive;break;case U.oV.STRUCTURAL_VARIANT_GENES_TABLE:t.filters=o.store.getGeneFiltersByUniqueKey(e.uniqueKey),t.promise=o.store.structuralVariantGeneTableRowData,t.onValueSelection=o.store.addGeneFilters,t.onResetSelection=function(){return o.store.resetGeneFilter(e.uniqueKey)},t.selectedGenes=o.store.selectedGenes,t.onGeneSelect=o.store.onCheckGene,t.title=o.store.getChartTitle(U.oV.STRUCTURAL_VARIANT_GENES_TABLE,t.title),t.getData=function(){return o.store.getStructuralVariantGenesDownloadData()},t.genePanelCache=o.store.genePanelCache,t.downloadTypes=["Data"],t.filterByCancerGenes=o.store.filterSVGenesTableByCancerGenes,t.onChangeCancerGeneFilter=o.store.updateSVGenesTableByCancerGenesFilter,t.alterationFilterEnabled=(0,Qn.Ib)().skin_show_settings_menu,t.filterAlterations=o.store.isGlobalMutationFilterActive;break;case U.oV.CNA_GENES_TABLE:t.filters=o.store.getGeneFiltersByUniqueKey(e.uniqueKey),t.promise=o.store.cnaGeneTableRowData,t.onValueSelection=o.store.addGeneFilters,t.onResetSelection=function(){return o.store.resetGeneFilter(e.uniqueKey)},t.selectedGenes=o.store.selectedGenes,t.onGeneSelect=o.store.onCheckGene,t.title=o.store.getChartTitle(U.oV.CNA_GENES_TABLE,t.title),t.getData=function(){return o.store.getGenesCNADownloadData()},t.genePanelCache=o.store.genePanelCache,t.downloadTypes=["Data"],t.filterByCancerGenes=o.store.filterCNAGenesTableByCancerGenes,t.onChangeCancerGeneFilter=o.store.updateCNAGenesTableByCancerGenesFilter,t.alterationFilterEnabled=(0,Qn.Ib)().skin_show_settings_menu,t.filterAlterations=o.store.isGlobalAlterationFilterActive;break;case U.oV.GENOMIC_PROFILES_TABLE:t.filters=(0,l.toJS)(o.store.genomicProfilesFilter),t.promise=o.store.molecularProfileSampleCounts,t.onValueSelection=o.store.addGenomicProfilesFilter,t.onResetSelection=function(){o.store.setGenomicProfilesFilter([])};break;case U.oV.CASE_LIST_TABLE:t.filters=(0,l.toJS)(o.store.caseListsFilter),t.promise=o.store.caseListSampleCounts,t.onValueSelection=o.store.addCaseListsFilter,t.onResetSelection=function(){o.store.setCaseListsFilter([])};break;case U.oV.SURVIVAL:t.promise=o.store.survivalPlotData,t.getData=function(){return o.store.getSurvivalDownloadData(e)},t.patientToAnalysisGroup=o.store.patientToAnalysisGroup,t.downloadTypes=["Data","SVG","PDF"],t.description=o.store.survivalDescriptions.result?o.store.survivalDescriptions.result[e.uniqueKey.substring(0,e.uniqueKey.lastIndexOf("_SURVIVAL"))][0]:void 0;break;case U.oV.VIOLIN_PLOT_TABLE:var r=o.store.getXvsYViolinChartInfo(t.chartMeta.uniqueKey),i=o.store.getXvsYChartSettings(t.chartMeta.uniqueKey);t.filters=[].concat(Jn(o.store.getClinicalDataFiltersByUniqueKey(r.categoricalAttr.clinicalAttributeId)),Jn(o.store.getClinicalDataFiltersByUniqueKey(r.numericalAttr.clinicalAttributeId))),t.title="".concat(r.numericalAttr.displayName).concat(i.violinLogScale?" (log)":""," vs ").concat(r.categoricalAttr.displayName),t.promise=o.store.clinicalViolinDataCache.get({chartInfo:r,violinLogScale:!!i.violinLogScale}),t.axisLabelX=r.categoricalAttr.displayName,t.axisLabelY=r.numericalAttr.displayName,t.showLogScaleToggle=(0,f.S6)(r.numericalAttr.clinicalAttributeId),t.logScaleChecked=i.violinLogScale,t.onToggleLogScale=function(){var e=o.store.getXvsYChartSettings(t.chartMeta.uniqueKey);e.violinLogScale=!e.violinLogScale},t.showViolinPlotToggle=!0,t.violinPlotChecked=i.showViolin,t.onToggleViolinPlot=function(){var e=o.store.getXvsYChartSettings(t.chartMeta.uniqueKey);e.showViolin=!e.showViolin},t.showBoxPlotToggle=!0,t.boxPlotChecked=i.showBox,t.onToggleBoxPlot=function(){var e=o.store.getXvsYChartSettings(t.chartMeta.uniqueKey);e.showBox=!e.showBox},t.onValueSelection=function(e,t){switch(e){case"categorical":o.store.updateClinicalAttributeFilterByValues(r.categoricalAttr.clinicalAttributeId,t.map((function(e){return{value:e}})));break;case"numerical":o.store.updateClinicalDataCustomIntervalFilter(r.numericalAttr.clinicalAttributeId,t)}},t.selectedCategories=o.store.getClinicalDataFiltersByUniqueKey(r.categoricalAttr.clinicalAttributeId).map((function(e){return e.value})),t.onResetSelection=function(){o.store.updateClinicalAttributeFilterByValues(r.categoricalAttr.clinicalAttributeId,[]),o.store.updateClinicalAttributeFilterByValues(r.numericalAttr.clinicalAttributeId,[])};break;case U.oV.SCATTER:t.filters=o.store.getScatterPlotFiltersByUniqueKey(t.chartMeta.uniqueKey);var a=o.store.getXvsYScatterChartInfo(t.chartMeta.uniqueKey),s=o.store.getXvsYChartSettings(t.chartMeta.uniqueKey);t.title=t.chartMeta.displayName,t.promise=o.store.clinicalDataDensityCache.get({chartInfo:a,xAxisLogScale:!!s.xLogScale,yAxisLogScale:!!s.yLogScale}),t.showLogScaleXToggle=(0,f.S6)(a.xAttr.clinicalAttributeId),t.showLogScaleYToggle=(0,f.S6)(a.yAttr.clinicalAttributeId),t.logScaleXChecked=s.xLogScale,t.logScaleYChecked=s.yLogScale,t.onToggleLogScaleX=function(){var e=o.store.getXvsYChartSettings(t.chartMeta.uniqueKey);e.xLogScale=!e.xLogScale},t.onToggleLogScaleY=function(){var e=o.store.getXvsYChartSettings(t.chartMeta.uniqueKey);e.yLogScale=!e.yLogScale},t.onSwapAxes=function(){o.store.swapXvsYChartAxes(t.chartMeta.uniqueKey)},t.plotDomain=a.plotDomain,t.axisLabelX="".concat(a.xAttr.displayName).concat(s.xLogScale?" (log)":""),t.axisLabelY="".concat(a.yAttr.displayName).concat(s.yLogScale?" (log)":""),t.tooltip=(0,f.Jd)(a,s),t.onValueSelection=function(e){o.store.updateScatterPlotFilterByValues(t.chartMeta.uniqueKey,e)},t.onResetSelection=function(){o.store.updateScatterPlotFilterByValues(t.chartMeta.uniqueKey)},t.sampleToAnalysisGroup=o.store.sampleToAnalysisGroup,t.getData=function(){return o.store.getScatterDownloadData(t.chartMeta.uniqueKey)},t.downloadTypes=["Data","SVG","PDF"];break;case U.oV.SAMPLE_TREATMENTS_TABLE:t.filters=o.store.sampleTreatmentFiltersAsStrings,t.promise=o.store.sampleTreatments,t.onValueSelection=o.store.onTreatmentSelection,t.onResetSelection=function(){o.store.clearSampleTreatmentFilters()};break;case U.oV.SAMPLE_TREATMENT_GROUPS_TABLE:t.filters=o.store.sampleTreatmentGroupFiltersAsStrings,t.promise=o.store.sampleTreatmentGroups,t.onValueSelection=o.store.onTreatmentSelection,t.onResetSelection=function(){o.store.clearSampleTreatmentGroupFilters()};break;case U.oV.SAMPLE_TREATMENT_TARGET_TABLE:t.filters=o.store.sampleTreatmentTargetFiltersAsStrings,t.promise=o.store.sampleTreatmentTarget,t.onValueSelection=o.store.onTreatmentSelection,t.onResetSelection=function(){o.store.clearSampleTreatmentTargetFilters()};break;case U.oV.PATIENT_TREATMENTS_TABLE:t.filters=o.store.patientTreatmentFiltersAsStrings,t.promise=o.store.patientTreatments,t.onValueSelection=o.store.onTreatmentSelection,t.onResetSelection=function(){o.store.clearPatientTreatmentFilters()};break;case U.oV.PATIENT_TREATMENT_GROUPS_TABLE:t.filters=o.store.patientTreatmentGroupFiltersAsStrings,t.promise=o.store.patientTreatmentGroups,t.onValueSelection=o.store.onTreatmentSelection,t.onResetSelection=function(){o.store.clearPatientTreatmentGroupFilters()};break;case U.oV.PATIENT_TREATMENT_TARGET_TABLE:t.filters=o.store.patientTreatmentTargetFiltersAsStrings,t.promise=o.store.patientTreatmentTarget,t.onValueSelection=o.store.onTreatmentSelection,t.onResetSelection=function(){o.store.clearPatientTreatmentTargetFilters()}}return n.createElement("div",{key:e.uniqueKey},n.createElement(zn,null,n.createElement(Bn,Zn({key:e.uniqueKey},t))))}}),(0,l.makeObservable)(tr(o)),o.store=e.store,o.handlers={onValueSelection:function(e,t){o.store.updateClinicalDataFilterByValues(e.uniqueKey,t.map((function(e){return{value:e}})))},onDataBinSelection:function(e,t){o.store.updateClinicalDataIntervalFilters(e.uniqueKey,t)},onToggleLogScale:function(e){o.store.toggleLogScale(e.uniqueKey)},onToggleNAValue:function(e){o.store.toggleNAValue(e.uniqueKey)},onDeleteChart:function(e){o.store.resetFilterAndChangeChartVisibility(e.uniqueKey,!1)},onChangeChartType:function(e,t){o.store.changeChartType(e,t)},isNewlyAdded:function(e){return o.store.isNewlyAdded(e)},setCustomChartFilters:function(e,t){o.store.setCustomChartFilters(e.uniqueKey,t)},onLayoutChange:function(e){o.store.updateCurrentGridLayout(e),o.onResize(e)},resetGeneFilter:function(e){o.store.resetGeneFilter(e.uniqueKey)},onGenomicDataBinSelection:function(e,t){o.store.updateGenomicDataIntervalFilters(e.uniqueKey,t)},onGenericAssayDataBinSelection:function(e,t){o.store.updateGenericAssayDataFilters(e.uniqueKey,t)},onGenericAssayCategoricalValueSelection:function(e,t){o.store.updateCategoricalGenericAssayDataFilters(e.uniqueKey,t)}},o}var o,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&or(e,t)}(t,e),o=t,(r=[{key:"onResize",value:function(e){var t=this;e.filter((function(e){var o=t.store.chartsDimension.get(e.i);return o&&(o.h!==e.h||o.w!==e.w)})).forEach((function(e){var o=e.i,n=t.store.chartsDimension.get(o);n.h=e.h,n.w=e.w,t.store.chartsDimension.set(o,n)}))}},{key:"getProgressItems",value:function(e){var t=[this.store.initialVisibleAttributesClinicalDataBinCountData,this.store.initialVisibleAttributesClinicalDataCountData],o=[this.store.caseListSampleCounts,this.store.selectedSamples],n=e>2&&"pending"===Xn.CX.apply(void 0,t),r=e>2&&"pending"===Xn.CX.apply(void 0,o);return[{label:"Loading meta information",promises:[this.store.defaultVisibleAttributes,this.store.mutationProfiles,this.store.cnaProfiles]},{label:"Loading clinical data"+(n?" - this can take several seconds":""),promises:t},{label:"Loading sample data"+(r?" - this can take several seconds":""),promises:o},{label:"Rendering"}]}},{key:"render",value:function(){var e=this;return n.createElement("div",null,n.createElement(p.Z,{isLoading:this.store.loadingInitialDataForSummaryTab,size:"big",center:!0},n.createElement(b.Z,{getItems:this.getProgressItems,show:this.store.loadingInitialDataForSummaryTab,sequential:!0})),this.store.invalidSampleIds.result.length>0&&this.showErrorMessage&&n.createElement("div",null,n.createElement("div",{className:"alert alert-danger"},n.createElement("button",{type:"button",className:"close",onClick:function(){return e.showErrorMessage=!1}},""),"The following sample(s) might have been deleted/updated with the recent data updates",n.createElement("br",null),n.createElement("ul",{style:{listStyle:"none",padding:"10px",maxHeight:"300px",overflowY:"scroll"}},this.store.invalidSampleIds.result.map((function(e){return n.createElement("li",null,e.studyId+":"+e.sampleId)}))))),this.store.showSettingRestoreMsg&&n.createElement("div",null,n.createElement("div",{className:"alert alert-info"},n.createElement("button",{type:"button",className:"close",onClick:function(){e.store.hideRestoreSettingsMsg=!0}},""),"Your previously saved layout preferences have been applied.",n.createElement("button",{className:"btn btn-primary btn-sm",onClick:function(){e.store.hideRestoreSettingsMsg=!0},style:{marginLeft:"10px"}},"Keep Saved Layout"),n.createElement("button",{className:"btn btn-primary btn-sm",onClick:function(){e.store.hideRestoreSettingsMsg=!0,e.store.undoUserChartSettings()},style:{marginLeft:"10px"}},"Revert to Previous Layout"))),!this.store.loadingInitialDataForSummaryTab&&!this.store.blockLoading&&n.createElement("div",{"data-test":"summary-tab-content"},n.createElement("div",{className:x().studyViewFlexContainer},this.store.defaultVisibleAttributes.isComplete&&n.createElement(Vn(),{className:"layout",style:{width:this.store.containerWidth},width:this.store.containerWidth,cols:this.store.studyViewPageLayoutProps.cols,rowHeight:this.store.studyViewPageLayoutProps.grid.h,layout:this.store.studyViewPageLayoutProps.layout,margin:[U.$u.layout.gridMargin.x,U.$u.layout.gridMargin.y],useCSSTransforms:!1,draggableHandle:".".concat(j().draggable),onLayoutChange:this.handlers.onLayoutChange,onResizeStop:this.onResize},this.store.visibleAttributes.map(this.renderAttributeChart)))),this.props.store.selectedSamples.isComplete&&0===this.props.store.selectedSamples.result.length&&n.createElement("div",{className:x().studyViewNoSamples},n.createElement("div",{className:x().studyViewNoSamplesInner},n.createElement("p",null,"The filters you have selected have filtered out all the samples in this study; because of this, no data visualizations are shown."),n.createElement("p",null,"You can remove filters in the header of this page to widen your search criteria and add samples back to your results."))))}}])&&$n(o.prototype,r),i&&$n(o,i),t}(n.Component);rr([l.observable],ir.prototype,"showErrorMessage",void 0),rr([g.default],ir.prototype,"onResize",null),rr([g.default],ir.prototype,"getProgressItems",null),ir=rr([a.observer],ir);var ar=o(28358),sr=o.n(ar),lr=o(17790),ur=o(58997),cr=o(4098);function pr(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function dr(e){return(dr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function hr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fr(e,t){return(fr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function mr(e){return(mr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var yr=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===("undefined"==typeof Reflect?"undefined":mr(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},br=function(e){function t(e){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=function(e,t){return!t||"object"!==mr(t)&&"function"!=typeof t?hr(e):t}(this,dr(t).call(this,e)),Object.defineProperty(hr(o),"downloadingData",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(hr(o),"showDownloadErrorMessage",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(hr(o),"geneValidationHasIssue",{enumerable:!0,configurable:!0,writable:!0,value:!1}),(0,l.makeObservable)(hr(o)),o}var o,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fr(e,t)}(t,e),o=t,(r=[{key:"updateSelectedGenes",value:function(e,t,o){this.geneValidationHasIssue=""===o||!i().isUndefined(e.error)||0!==t.suggestions.length,this.props.store.updateSelectedGenes(e.query,o)}},{key:"render",value:function(){var e=this;return n.createElement("div",{className:"studyViewSummaryHeader"},n.createElement("div",{className:sr().rightPanel},n.createElement("div",{className:"small"},n.createElement(lr.Z,{inputGeneQuery:this.props.store.geneQueryStr,validateInputGeneQuery:!0,callback:this.updateSelectedGenes,location:lr.e.STUDY_VIEW_PAGE,error:this.oqlSubmitError,messages:this.oqlMessages})),n.createElement("button",{disabled:this.isQueryButtonDisabled,className:V()("btn btn-primary btn-sm",sr().submitQuery),"data-event":(0,ur.XO)({category:"studyPage",action:"submitQuery",label:this.props.store.queriedPhysicalStudyIds.result}),"data-test":"geneSetSubmit",onClick:function(){return e.props.store.onSubmitQuery()}},"Query")))}},{key:"isQueryButtonDisabled",get:function(){return""===this.props.store.geneQueryStr||this.geneValidationHasIssue||!!this.oqlSubmitError}},{key:"isQueryLimitReached",get:function(){return!!this.props.store.selectedSamples.isComplete&&this.props.store.geneQueries.length*this.props.store.selectedSamples.result.length>(0,Qn.Ib)().query_product_limit}},{key:"geneLimit",get:function(){return this.props.store.selectedSamples.isComplete?Math.floor((0,Qn.Ib)().query_product_limit/this.props.store.selectedSamples.result.length):0}},{key:"oqlMessages",get:function(){return(0,cr.ym)(this.props.store.geneQueries)}},{key:"oqlSubmitError",get:function(){if(this.props.store.isSingleNonVirtualStudyQueried){if(this.props.store.alterationTypesInOQL.haveMutInQuery&&!this.props.store.defaultMutationProfile)return"Mutation data query specified in OQL, but no mutation profile is available for the selected study.";if(this.props.store.alterationTypesInOQL.haveCnaInQuery&&!this.props.store.defaultCnaProfile)return"CNA data query specified in OQL, but no CNA profile is available in the selected study.";if(this.props.store.alterationTypesInOQL.haveMrnaInQuery&&!this.props.store.defaultMrnaProfile)return"mRNA expression data query specified in OQL, but no mRNA profile is available in the selected study.";if(this.props.store.alterationTypesInOQL.haveProtInQuery&&!this.props.store.defaultProtProfile)return"Protein level data query specified in OQL, but no protein level profile is available in the selected study."}return this.props.store.alterationTypesInOQL.haveMrnaInQuery&&this.props.store.displayedStudies.isComplete&&this.props.store.displayedStudies.result.length>1?"Expression filtering in the gene list (the EXP command) is not supported when doing cross cancer queries.":this.props.store.alterationTypesInOQL.haveProtInQuery&&this.props.store.displayedStudies.isComplete&&this.props.store.displayedStudies.result.length>1?"Protein level filtering in the gene list (the PROT command) is not supported when doing cross cancer queries.":this.isQueryLimitReached?"Please limit your queries to ".concat(this.geneLimit," genes or fewer."):void 0}}])&&pr(o.prototype,r),a&&pr(o,a),t}(n.Component);yr([l.observable],br.prototype,"downloadingData",void 0),yr([l.observable],br.prototype,"showDownloadErrorMessage",void 0),yr([l.observable],br.prototype,"geneValidationHasIssue",void 0),yr([l.action.bound],br.prototype,"updateSelectedGenes",null),yr([l.computed],br.prototype,"isQueryButtonDisabled",null),yr([l.computed],br.prototype,"isQueryLimitReached",null),yr([l.computed],br.prototype,"geneLimit",null),yr([l.computed],br.prototype,"oqlMessages",null),yr([l.computed],br.prototype,"oqlSubmitError",null);const gr=br=yr([a.observer],br);var vr=o(44035),Cr=o(9405),Sr=o(85537);function wr(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Er(e){return(Er=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Tr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Or(e,t){return(Or=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ar(e){return(Ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var kr=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===("undefined"==typeof Reflect?"undefined":Ar(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Nr=function(e){function t(e){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=function(e,t){return!t||"object"!==Ar(t)&&"function"!=typeof t?Tr(e):t}(this,Er(t).call(this,e)),Object.defineProperty(Tr(o),"showMoreDescription",{enumerable:!0,configurable:!0,writable:!0,value:!1}),(0,l.makeObservable)(Tr(o)),o}var o,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Or(e,t)}(t,e),o=t,(r=[{key:"render",value:function(){var e=this;return n.createElement("div",{className:V()(sr().summary)},n.createElement("h3",{style:{marginBottom:3,display:"flex",alignItems:"baseline"}},this.name,this.props.isMixedReferenceGenome&&(0,Sr.gM)(),this.showDownload&&n.createElement(m.ZD,{trigger:["hover"],placement:"top",overlay:n.createElement("span",null,"Download all clinical and genomic data of this study")},n.createElement("span",{"data-test":"studySummaryRawDataDownloadIcon","data-event":(0,ur.XO)({category:"studyPage",action:"dataDownload",label:this.props.studies.map((function(e){return e.studyId})).join(",")}),style:{marginLeft:"10px",fontSize:"14px"}},n.createElement(Cr.x,{studyId:this.props.studies[0].studyId})))),n.createElement("div",{className:sr().description},n.createElement("div",null,this.descriptionFirstLine,this.hasMoreDescription&&n.createElement("i",{className:"fa fa-".concat(this.showMoreDescription?"minus":"plus","-circle"),onClick:function(){return e.showMoreDescription=!e.showMoreDescription},style:{marginLeft:"5px",cursor:"pointer"}})),this.showMoreDescription&&n.createElement("div",null,n.createElement("ul",{className:sr().studyLinks},this.descriptionRemainingLines),this.props.showOriginStudiesInSummaryDescription&&n.createElement("div",null,this.props.originStudies.isComplete&&this.props.originStudies.result.length>0&&n.createElement("span",null,n.createElement("span",{style:{fontWeight:"bold",marginBottom:"5px",display:"block"}},"This virtual study was derived from:"),this.props.originStudies.result.map((function(e){return n.createElement(vr.w,e)}))),n.createElement(p.Z,{isLoading:this.props.originStudies.isPending,center:!0,size:"big"})))))}},{key:"name",get:function(){return 1===this.props.studies.length?this.props.studies[0].name:"Combined Study"}},{key:"descriptionFirstLine",get:function(){if(1===this.props.studies.length){var e=[n.createElement("span",{dangerouslySetInnerHTML:{__html:this.props.studies[0].description.split(/\n+/g)[0]}})];return this.props.studies[0].pmid&&e.push(n.createElement("a",{target:"_blank",href:(0,m.H6)("/pubmed/".concat(this.props.studies[0].pmid)),style:{marginLeft:"5px"}},"PubMed")),n.createElement("span",null,e)}return n.createElement("span",null,"This combined study contains samples from ".concat(this.props.studies.length," studies"))}},{key:"hasMoreDescription",get:function(){return this.props.showOriginStudiesInSummaryDescription||this.props.studies.length>1||this.props.studies[0].description.split(/\n/g).length>1}},{key:"descriptionRemainingLines",get:function(){if(1!==this.props.studies.length)return i().map(this.props.studies,(function(e){return n.createElement("li",null,n.createElement("a",{href:(0,h.yY)(e.studyId),target:"_blank"},e.name))}));var e=this.props.studies[0].description.split(/\n/g);return e.length>1?[n.createElement("span",{style:{whiteSpace:"pre"},dangerouslySetInnerHTML:{__html:e.slice(1).join("\n")}})]:[]}},{key:"showDownload",get:function(){return this.props.hasRawDataForDownload&&!0===this.context.showDownloadControls}}])&&wr(o.prototype,r),a&&wr(o,a),t}(n.Component);kr([l.observable],Nr.prototype,"showMoreDescription",void 0),kr([l.computed],Nr.prototype,"name",null),kr([l.computed],Nr.prototype,"descriptionFirstLine",null),kr([l.computed],Nr.prototype,"hasMoreDescription",null),kr([l.computed],Nr.prototype,"descriptionRemainingLines",null),kr([l.computed],Nr.prototype,"showDownload",null);const Pr=Nr=kr([a.observer],Nr);Nr.contextType=m.Il;var _r=o(35286),Rr=o.n(_r),Mr=o(92576),Dr=o.n(Mr),Ir=o(90637),xr=o.n(Ir);function Lr(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function jr(e){return(jr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Gr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Br(e,t){return(Br=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Fr(e){return(Fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Vr=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===("undefined"==typeof Reflect?"undefined":Fr(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Ur=function(e){function t(e){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=function(e,t){return!t||"object"!==Fr(t)&&"function"!=typeof t?Gr(e):t}(this,jr(t).call(this,e)),(0,l.makeObservable)(Gr(o)),o}var o,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Br(e,t)}(t,e),o=t,(r=[{key:"render",value:function(){return n.createElement("div",{className:Dr().main,style:{background:this.props.backgroundColor,color:this.contentColor}},n.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"}},n.createElement("span",{className:Dr().content},this.props.content),this.props.infoSection),n.createElement(y.If,{condition:i().isFunction(this.props.onDelete)},n.createElement("span",{"data-test":"pill-tag-delete",className:Dr().delete,onClick:this.props.onDelete},n.createElement("i",{className:"fa fa-times-circle"}))))}},{key:"contentColor",get:function(){return"light"===xr()(this.props.backgroundColor)?"#000":"#fff"}}])&&Lr(o.prototype,r),a&&Lr(o,a),t}(n.Component);Vr([l.computed],Ur.prototype,"contentColor",null);var Wr=o(68824),qr=o.n(Wr);function Kr(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Hr(e){return(Hr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Yr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zr(e,t){return(zr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Xr(e){return(Xr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Qr=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===("undefined"==typeof Reflect?"undefined":Xr(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Zr=function(e){function t(e){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=function(e,t){return!t||"object"!==Xr(t)&&"function"!=typeof t?Yr(e):t}(this,Hr(t).call(this,e)),(0,l.makeObservable)(Yr(o)),o}var o,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zr(e,t)}(t,e),o=t,(r=[{key:"render",value:function(){return n.createElement("div",{className:qr().main},this.child)}},{key:"child",get:function(){var e=this,t=[];return this.props.group&&t.push(n.createElement("span",{className:V()(qr().text,qr().mostLeft)},"(")),i().reduce(this.props.components,(function(t,o,r){return r>0&&t.push(n.createElement("span",{className:qr().text},e.props.operation)),t.push(o),t}),t),this.props.group&&t.push(n.createElement("span",{className:V()(qr().text,qr().mostRight)},")")),t}}])&&Kr(o.prototype,r),a&&Kr(o,a),t}(n.Component);Qr([l.computed],Zr.prototype,"child",null),Zr=Qr([a.observer],Zr);var Jr=o(57761);function $r(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ei(e){return(ei=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ti(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oi(e,t){return(oi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ni(e){return(ni="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ri=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===("undefined"==typeof Reflect?"undefined":ni(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},ii=function(e){function t(e){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=function(e,t){return!t||"object"!==ni(t)&&"function"!=typeof t?ti(e):t}(this,ei(t).call(this,e)),(0,l.makeObservable)(ti(o)),o}var o,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oi(e,t)}(t,e),o=t,(r=[{key:"renderClinicalDataFilters",value:function(e,t,o){var r=this;return i().reduce(e||[],(function(e,t){var i=r.props.attributesMetaSet[t.attributeId];if(i){var a=r.props.clinicalAttributeIdToDataType[t.attributeId]===f.g.STRING?r.renderCategoricalDataFilter(t,o,i):r.renderDataBinFilter(t.values,(function(e,t){(0,f.oM)(t,i,r.props.store.getClinicalDataBin,r.props.store.getClinicalDataFiltersByUniqueKey,r.props.store.updateCustomBins,r.props.store.updateClinicalDataIntervalFilters)}),o,i);e.push(n.createElement("div",{className:Rr().parentGroupLogic},n.createElement(Zr,{components:[n.createElement("span",{className:Rr().filterClinicalAttrName},i.displayName),a],operation:":",group:!1})))}return e}),t)}},{key:"renderDataBinFilter",value:function(e,t,o,r){return n.createElement(Ur,{content:(0,f.JA)(e,(function(e){return t(r.uniqueKey,e)})),backgroundColor:U.$u.colors.theme.clinicalFilterContent,onDelete:function(){return o(r.uniqueKey,[])}})}},{key:"renderCategoricalDataFilter",value:function(e,t,o){return n.createElement(Zr,{components:e.values.map((function(r){return n.createElement(Ur,{content:r.value,backgroundColor:U.$u.colors.theme.clinicalFilterContent,onDelete:function(){return t(o.uniqueKey,i().remove(e.values,(function(e){return e.value!==r.value})))}})})),operation:"or",group:!1})}},{key:"renderTreatmentFilter",value:function(e,t){var o=this,r=e.filters.map((function(e,r){var i=e.filters.map((function(e,i){var a=e.hasOwnProperty("time")?e.time:"";return n.createElement(Ur,{content:e.treatment+" "+a,backgroundColor:U.$u.colors.theme.clinicalFilterContent,onDelete:function(){o.props.removeTreatmentsFilter(r,i,t)}})}));return n.createElement(Zr,{components:i,operation:"or",group:!0})}));return n.createElement(Zr,{components:r,operation:"and",group:!1})}},{key:"groupedGeneQueries",value:function(e,t){var o=this;return e.map((function(e){var r=ke.pp,i=e.hugoGeneSymbol;switch(t.chartType){case U.oV.MUTATED_GENES_TABLE:r=m.C_;break;case U.oV.STRUCTURAL_VARIANT_GENES_TABLE:r=m.p0;break;case U.oV.CNA_GENES_TABLE:if(1===e.alterations.length){var a=(0,f.H8)(e.alterations[0]);a&&(r=a)}}return n.createElement(Ur,{content:i,backgroundColor:r,infoSection:n.createElement(f.nK,{chartType:t.chartType,geneFilterQuery:e}),onDelete:function(){return o.props.removeGeneFilter(t.uniqueKey,(0,f.zU)(e))}})}))}},{key:"groupedGenomicProfiles",value:function(e){var t=this;return e.map((function(e){return n.createElement(Ur,{content:t.props.molecularProfileNameSet[e]||e,backgroundColor:U.$u.colors.theme.clinicalFilterContent,onDelete:function(){return t.props.removeGenomicProfileFilter(e)}})}))}},{key:"groupedCaseLists",value:function(e){var t=this;return e.map((function(e){return n.createElement(Ur,{content:t.props.caseListNameSet[e]||e,backgroundColor:U.$u.colors.theme.clinicalFilterContent,onDelete:function(){return t.props.removeCaseListsFilter(e)}})}))}},{key:"render",value:function(){return this.showFilters?n.createElement("div",{className:V()(Rr().userSelections,"userSelections")},this.allComponents,n.createElement("button",{"data-test":"clear-all-filters",className:V()("btn btn-default btn-sm",Rr().summaryClearAllBtn),onClick:this.props.clearAllFilters},"Clear All Filters"),n.createElement(m.ZD,{placement:"topLeft",overlay:n.createElement("div",null,"Get bookmark link for this filter")},n.createElement("a",{onClick:this.props.onBookmarkClick,className:Rr().bookmarkButton},n.createElement("span",{className:"fa-stack fa-4x"},n.createElement("i",{className:"fa fa-circle fa-stack-2x"}),n.createElement("i",{className:"fa fa-link fa-stack-1x"}))))):null}},{key:"showFilters",get:function(){return this.allComponents.length>0}},{key:"allComponents",get:function(){var e=this,t=[];if(this.props.numberOfSelectedSamplesInCustomSelection>0&&t.push(n.createElement("div",{className:Rr().parentGroupLogic},n.createElement(Zr,{components:[n.createElement("span",{className:Rr().filterClinicalAttrName},"Custom Selection"),n.createElement(Ur,{content:"".concat(this.props.numberOfSelectedSamplesInCustomSelection," sample").concat(this.props.numberOfSelectedSamplesInCustomSelection>1?"s":""),backgroundColor:U.$u.colors.theme.clinicalFilterContent,onDelete:function(){return e.props.removeCustomSelectionFilter()}})],operation:":",group:!1}))),this.props.comparisonGroupSelection.length>0){var o=(0,Jr.b)(this.props.comparisonGroupSelection).length,r=(0,f.x1)(this.props.comparisonGroupSelection).length;t.push(n.createElement("div",{className:Rr().parentGroupLogic},n.createElement(Zr,{components:[n.createElement("span",{className:Rr().filterClinicalAttrName},(0,f.FR)(this.props.comparisonGroupSelection)),n.createElement(Ur,{content:(0,Jr.L3)(o,r),backgroundColor:U.$u.colors.theme.clinicalFilterContent,onDelete:function(){return e.props.removeComparisonGroupSelectionFilter()}})],operation:":",group:!1})))}this.renderClinicalDataFilters(this.props.filter.clinicalDataFilters,t,this.props.updateClinicalDataFilterByValues),this.renderClinicalDataFilters(this.props.filter.customDataFilters,t,(function(t,o){e.props.updateCustomChartFilter(t,o.map((function(e){return e.value})))})),i().reduce(this.props.filter.genomicDataFilters||[],(function(t,o){var r=(0,f.Xq)(o.hugoGeneSymbol,o.profileType),i=e.props.attributesMetaSet[r];return i&&t.push(n.createElement("div",{className:Rr().parentGroupLogic},n.createElement(Zr,{components:[n.createElement("span",{className:Rr().filterClinicalAttrName},i.displayName),e.renderDataBinFilter(o.values,(function(t,o){(0,f.oM)(o,i,e.props.store.getGenomicChartDataBin,e.props.store.getGenomicDataIntervalFiltersByUniqueKey,e.props.store.updateCustomBins,e.props.store.updateGenomicDataIntervalFilters)}),e.props.updateGenomicDataIntervalFilter,i)],operation:":",group:!1}))),t}),t);var a=[];if(this.props.filter.genericAssayDataFilters&&i().forEach(this.props.filter.genericAssayDataFilters,(function(t){var o=(0,f.XP)(t.stableId,t.profileType),r=e.props.attributesMetaSet[o];r&&a.push(n.createElement("div",{className:Rr().parentGroupLogic},n.createElement(Zr,{components:[n.createElement("span",{className:Rr().filterClinicalAttrName},r.displayName),n.createElement(Ur,{content:(0,f.JA)(t.values,(function(t){(0,f.oM)(t,r,e.props.store.getGenericAssayChartDataBin,e.props.store.getGenericAssayDataFiltersByUniqueKey,e.props.store.updateCustomBins,e.props.store.updateGenericAssayDataFilters)})),backgroundColor:U.$u.colors.theme.clinicalFilterContent,onDelete:function(){return e.props.updateGenericAssayDataFilter(r.uniqueKey,[])}})],operation:":",group:!1})))})),this.renderClinicalDataFilters(this.props.customChartsFilter,t,(function(t,o){e.props.updateCustomChartFilter(t,o.map((function(e){return e.value})))})),i().reduce(this.props.filter.geneFilters||[],(function(t,o){var r=(0,f.wl)(o.molecularProfileIds),i=e.props.attributesMetaSet[r];return i&&t.push(n.createElement("div",{className:Rr().parentGroupLogic},n.createElement(Zr,{components:o.geneQueries.map((function(t){return n.createElement(Zr,{components:e.groupedGeneQueries(t,i),operation:"or",group:t.length>1})})),operation:"and",group:!1}))),t}),t),i().isEmpty(this.props.filter.genomicProfiles)||t.push(n.createElement("div",{className:Rr().parentGroupLogic},n.createElement(Zr,{components:this.props.filter.genomicProfiles.map((function(t){return n.createElement(Zr,{components:e.groupedGenomicProfiles(t),operation:"or",group:t.length>1})})),operation:"and",group:!1}))),i().isEmpty(this.props.filter.caseLists)||t.push(n.createElement("div",{className:Rr().parentGroupLogic},n.createElement(Zr,{components:this.props.filter.caseLists.map((function(t){return n.createElement(Zr,{components:e.groupedCaseLists(t),operation:"or",group:t.length>1})})),operation:"and",group:!1}))),a&&t.push.apply(t,a),this.props.filter.sampleTreatmentFilters&&this.props.filter.sampleTreatmentFilters.filters.length>0){var s=this.renderTreatmentFilter(this.props.filter.sampleTreatmentFilters,"SAMPLE_TREATMENTS");t.push(s)}if(this.props.filter.patientTreatmentFilters&&this.props.filter.patientTreatmentFilters.filters.length>0){var l=this.renderTreatmentFilter(this.props.filter.patientTreatmentFilters,"PATIENT_TREATMENTS");t.push(l)}if(this.props.filter.sampleTreatmentGroupFilters&&this.props.filter.sampleTreatmentGroupFilters.filters.length>0){var u=this.renderTreatmentFilter(this.props.filter.sampleTreatmentGroupFilters,"SAMPLE_TREATMENT_GROUPS");t.push(u)}if(this.props.filter.patientTreatmentGroupFilters&&this.props.filter.patientTreatmentGroupFilters.filters.length>0){var c=this.renderTreatmentFilter(this.props.filter.patientTreatmentGroupFilters,"PATIENT_TREATMENT_GROUPS");t.push(c)}if(this.props.filter.sampleTreatmentTargetFilters&&this.props.filter.sampleTreatmentTargetFilters.filters.length>0){var p=this.renderTreatmentFilter(this.props.filter.sampleTreatmentTargetFilters,"SAMPLE_TREATMENT_TARGET");t.push(p)}if(this.props.filter.patientTreatmentTargetFilters&&this.props.filter.patientTreatmentTargetFilters.filters.length>0){var d=this.renderTreatmentFilter(this.props.filter.patientTreatmentTargetFilters,"PATIENT_TREATMENT_TARGET");t.push(d)}return t}}])&&$r(o.prototype,r),a&&$r(o,a),t}(n.Component);ri([l.computed],ii.prototype,"showFilters",null),ri([l.computed],ii.prototype,"allComponents",null);const ai=ii=ri([a.observer],ii);function si(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function li(e,t){return!t||"object"!==pi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ui(e){return(ui=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ci(e,t){return(ci=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pi(e){return(pi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var di=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===("undefined"==typeof Reflect?"undefined":pi(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},hi=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),li(this,ui(t).call(this,e))}var o,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ci(e,t)}(t,e),o=t,(r=[{key:"render",value:function(){return n.createElement("div",{className:"headBlock","data-test":"study-view-header"},i().keys(this.props.store.pageStatusMessages).length>0&&n.createElement("div",null,i().values(this.props.store.pageStatusMessages).map((function(e){return n.createElement("div",{className:"alert alert-".concat(e.status)},e.message)}))),n.createElement("div",{style:{display:"flex"}},n.createElement(Pr,{hasRawDataForDownload:this.props.store.hasRawDataForDownload.result,studies:this.props.store.displayedStudies.result,originStudies:this.props.store.originStudies,showOriginStudiesInSummaryDescription:this.props.store.showOriginStudiesInSummaryDescription,isMixedReferenceGenome:this.props.store.isMixedReferenceGenome}),n.createElement(gr,{store:this.props.store})),this.props.store.clinicalAttributeIdToDataType.isComplete&&n.createElement(ai,{store:this.props.store,filter:this.props.store.userSelections,comparisonGroupSelection:this.props.store.filterComparisonGroups,numberOfSelectedSamplesInCustomSelection:this.props.store.numberOfSelectedSamplesInCustomSelection,customChartsFilter:Array.from(this.props.store.preDefinedCustomChartFilterSet.values()),attributesMetaSet:this.props.store.chartMetaSetWithChartType,clinicalAttributeIdToDataType:this.props.store.clinicalAttributeIdToDataType.result,updateClinicalDataFilterByValues:this.props.store.updateClinicalDataFilterByValues,updateGenomicDataIntervalFilter:this.props.store.updateGenomicDataIntervalFiltersByValues,updateGenericAssayDataFilter:this.props.store.updateGenericAssayDataFiltersByValues,updateCustomChartFilter:this.props.store.setCustomChartFilters,removeGeneFilter:this.props.store.removeGeneFilter,removeCustomSelectionFilter:this.props.store.removeCustomSelectFilter,removeComparisonGroupSelectionFilter:this.props.store.removeComparisonGroupSelectionFilter,onBookmarkClick:this.props.onBookmarkClick,clearAllFilters:this.props.store.clearAllFilters,molecularProfileNameSet:this.props.store.molecularProfileNameSet.result||{},removeGenomicProfileFilter:this.props.store.removeGenomicProfileFilter,caseListNameSet:this.props.store.caseListNameSet.result||{},removeCaseListsFilter:this.props.store.removeCaseListsFilter,removeTreatmentsFilter:this.props.store.removeTreatmentsFilter}))}}])&&si(o.prototype,r),a&&si(o,a),t}(n.Component);const fi=hi=di([a.observer],hi);var mi=o(32434),yi=o(86002),bi=o(50619),gi=o(5374);function vi(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ci(e){return(Ci=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Si(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wi(e,t){return(wi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ei(e){return(Ei="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Ti=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===("undefined"==typeof Reflect?"undefined":Ei(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Oi=function(e){function t(e){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=function(e,t){return!t||"object"!==Ei(t)&&"function"!=typeof t?Si(e):t}(this,Ci(t).call(this,e)),Object.defineProperty(Si(o),"renderingComplete",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Si(o),"segmentTrackMaxHeight",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Si(o),"lastSelectedLocus",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),(0,l.makeObservable)(Si(o)),o.segmentTrackMaxHeight=.7*Ze.Z.size.height,o}var o,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wi(e,t)}(t,e),o=t,(r=[{key:"updateLastSelectedLocus",value:function(e){this.lastSelectedLocus=e}},{key:"render",value:function(){var e=this;return n.createElement("div",null,n.createElement(p.Z,{isLoading:this.isSampleCountWithinThreshold&&this.isHidden,size:"big",center:!0},n.createElement(b.Z,{getItems:function(){return e.progressItems},show:this.isSampleCountWithinThreshold&&this.isHidden,sequential:!0})),n.createElement("div",{style:{marginBottom:15,marginLeft:15}},n.createElement("span",null,this.selectionInfo),!this.hasNoSegmentData&&n.createElement(gi.Z,{promise:this.activePromise,filename:this.filename})),n.createElement("div",{style:this.isHidden||this.hasNoSegmentData||!this.isSampleCountWithinThreshold?{opacity:0}:void 0},n.createElement(mi.Z,{tracks:[Object.assign(Object.assign({},(0,yi.O4)()),{height:this.segmentTrackHeight,features:this.features})],genome:this.genome,locus:this.lastSelectedLocus,onLocusChange:this.updateLastSelectedLocus,onRenderingStart:this.onIgvRenderingStart,onRenderingComplete:this.onIgvRenderingComplete,isVisible:this.props.store.currentTab===c.rM.CN_SEGMENTS&&!this.isHidden})))}},{key:"onIgvRenderingStart",value:function(){this.renderingComplete=!1}},{key:"onIgvRenderingComplete",value:function(){this.renderingComplete=!0}},{key:"segmentTrackHeight",get:function(){return(0,yi.J1)(this.features,this.segmentTrackMaxHeight)}},{key:"features",get:function(){var e=this.activePromise&&this.activePromise.result||[];return(0,yi.cG)(e)}},{key:"filename",get:function(){return"".concat(this.props.store.downloadFilenamePrefix,"segments.seg")}},{key:"isHidden",get:function(){return this.isLoading||!this.renderingComplete}},{key:"isLoading",get:function(){return!!this.isSampleCountWithinThreshold&&(!this.activePromise||this.activePromise.isPending)}},{key:"isSampleCountWithinThreshold",get:function(){return!this.props.store.selectedSamples.result||!this.props.sampleThreshold||this.props.store.selectedSamples.result.length<=this.props.sampleThreshold}},{key:"activePromise",get:function(){return this.props.store.selectedSamples.result&&this.isSampleCountWithinThreshold?this.props.store.cnSegments:void 0}},{key:"progressItems",get:function(){return this.activePromise?[{label:"Loading copy number segments data...",promises:[this.activePromise]},{label:"Rendering"}]:[]}},{key:"hasNoSegmentData",get:function(){var e;return(null===(e=this.activePromise)||void 0===e?void 0:e.isComplete)&&(!this.activePromise.result||0===this.activePromise.result.length)}},{key:"genome",get:function(){var e=this.props.store.queriedPhysicalStudies.result?this.props.store.queriedPhysicalStudies.result[0]:void 0;return e?e.referenceGenome:bi.Xi}},{key:"selectionInfo",get:function(){var e;if(this.isSampleCountWithinThreshold){var t=this.hasNoSegmentData?"No segmented":"Segmented",o=this.props.store.selectedSamples.result?"".concat(this.props.store.selectedSamples.result.length," "):"",n=1===(null===(e=this.props.store.selectedSamples.result)||void 0===e?void 0:e.length)?"sample":"samples";return"".concat(t," copy-number data for the selected ").concat(o).concat(n,".")}return"Too many samples (>".concat(this.props.sampleThreshold,") for copy number segmentation view, make a selection on Summary tab first.")}}])&&vi(o.prototype,r),i&&vi(o,i),t}(n.Component);Object.defineProperty(Oi,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{sampleThreshold:2e4}}),Ti([l.observable],Oi.prototype,"renderingComplete",void 0),Ti([l.observable.ref],Oi.prototype,"segmentTrackMaxHeight",void 0),Ti([g.default],Oi.prototype,"updateLastSelectedLocus",null),Ti([l.computed],Oi.prototype,"segmentTrackHeight",null),Ti([l.computed],Oi.prototype,"features",null),Ti([l.computed],Oi.prototype,"filename",null),Ti([l.computed],Oi.prototype,"isHidden",null),Ti([l.computed],Oi.prototype,"isLoading",null),Ti([l.computed],Oi.prototype,"isSampleCountWithinThreshold",null),Ti([l.computed],Oi.prototype,"activePromise",null),Ti([l.computed],Oi.prototype,"progressItems",null),Ti([l.computed],Oi.prototype,"hasNoSegmentData",null),Ti([l.computed],Oi.prototype,"genome",null),Ti([l.action.bound],Oi.prototype,"onIgvRenderingStart",null),Ti([l.action.bound],Oi.prototype,"onIgvRenderingComplete",null);const Ai=Oi=Ti([a.observer],Oi);var ki=o(97392),Ni=o(25290),Pi=o.n(Ni),_i=o(2958),Ri=o.n(_i);function Mi(e){return function(e){if(Array.isArray(e)){for(var t=0,o=new Array(e.length);t<e.length;t++)o[t]=e[t];return o}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Di,Ii,xi="custom_value";function Li(e){return i().reduce(e.trim().split(/\n|\r/g),(function(e,t){return(t=t.trim())&&e.push(function(e){var t={line:e,caseId:""},o=e.split(":");if(1===o.length)t.caseId=o[0];else if(o.length>1){t.studyId=o[0];var n=o[1].split(/\s|\t/g);n.length>1&&(t.value=n[1]),t.caseId=n[0]}return t}(t)),e}),[])}function ji(e,t){return"".concat(e,":").concat(t)}function Gi(e){return[e.studyId||"",e.caseId,e.value||""].join("&")}function Bi(e,t,o,n,r){var a=[],s=[],l=[],u=i().reduce(o,(function(e,o){return e["".concat(o.studyId,":").concat(t===f.EU.PATIENT?o.patientId:o.sampleId)]=!0,e}),{}),c={},p={};i().reduce(i().uniqBy(e,(function(e){return Gi(e)})),(function(e,o){var p="",d=!0;return void 0===o.studyId||""===o.studyId?n?(p=ji(r[0],o.caseId),u[p]?(void 0===c[p]&&(c[p]=0),c[p]++):(l.push(o.caseId),d=!1)):(s.push({code:Di.INVALID_CASE_ID,message:new Error("No study specified for ".concat(t," id: ").concat(o.caseId,", and more than one study selected for query. The case will be ignored."))}),d=!1):i().includes(r,o.studyId)?(p=ji(o.studyId,o.caseId),void 0!==u[p]?(void 0===c[p]&&(c[p]=0),c[p]++):(l.push(o.caseId),d=!1)):(a.push({code:Di.STUDY_NOT_SELECTED,message:new Error("Incorrect study id: ".concat(o.studyId))}),d=!1),d&&(e[Gi(o)]=o),e}),p);var d=i().reduce(c,(function(e,t,o){return t>1&&e.push(o),e}),[]);if(d.length>0){var h=i().reduce(e,(function(e,t){var o=t.value?t.value:"_TEST_";return void 0===e[o]&&(e[o]=[]),e[o].push(ji(t.studyId?t.studyId:"",t.caseId)),e}),{}),m=i().reduce(h,(function(e,t){return e+=t.length-i().uniq(t).length}),0);i().keys(h).length>1&&m!==d.length&&s.push({code:Di.POTENTIAL_OVERLAP,message:new Error("".concat(d.join(", ")," ").concat(Ri()("exist",d.length-m)," in different groups."))})}return l.length>0&&s.push({code:Di.INVALID_CASE_ID,message:new Error("The following ".concat(Ri()("case",l.length)," ").concat(Ri()("is",l.length)," invalid and will be ignored. ").concat(l.join(", ")))}),{error:a,warning:s,updatedLines:i().values(p)}}function Fi(e,t,o,n,r){var a={},s={},l=o===f.EU.PATIENT;return i().each(n,(function(e){a["".concat(e.studyId,":").concat(e.sampleId)]=e;var t="".concat(e.studyId,":").concat(e.patientId);void 0===s[t]&&(s[t]=[]),s[t].push(e)})),i().flatMap(e,(function(e){var o=e.value||(r?"Unselected":xi),n=void 0===e.studyId?"".concat(t,":").concat(e.caseId):"".concat(e.studyId,":").concat(e.caseId);return(l?s[n]:[a[n]]).map((function(n){return{studyId:e.studyId||t,sampleId:n.sampleId,patientId:n.patientId,value:o}}))}))}!function(e){e.OVERLAP="OVERLAP",e.POTENTIAL_OVERLAP="POTENTIAL_OVERLAP",e.INVALID="INVALID",e.INVALID_CASE_ID="INVALID_CASE_ID",e.STUDY_NOT_SELECTED="STUDY_NOT_SELECTED",e.INPUT_ERROR="INPUT_ERROR",e.NO_CHART_NAME="NO_CHART_NAME",e.NO_GROUP_NAME="NO_GROUP_NAME"}(Di||(Di={})),function(e){e.GROUP_NAME="GROUP_NAME",e.CHART_NAME="CHART_NAME",e.CASE_ID="CASE_ID"}(Ii||(Ii={}));var Vi=o(77906);function Ui(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Wi(e){return(Wi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ki(e,t){return(Ki=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Hi(e){return(Hi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Yi,zi=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===("undefined"==typeof Reflect?"undefined":Hi(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Xi=[{value:f.EU.SAMPLE,label:"By sample ID"},{value:f.EU.PATIENT,label:"By patient ID"}];!function(e){e[e.SELECTED=0]="SELECTED",e[e.UNSELECTED=1]="UNSELECTED"}(Yi||(Yi={}));var Qi=function(e){function t(e){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=function(e,t){return!t||"object"!==Hi(t)&&"function"!=typeof t?qi(e):t}(this,Wi(t).call(this,e)),Object.defineProperty(qi(o),"validateContent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(qi(o),"chartNameValidation",{enumerable:!0,configurable:!0,writable:!0,value:{warning:[],error:[]}}),Object.defineProperty(qi(o),"chartName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(qi(o),"showCaseIds",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(qi(o),"caseIdsMode",{enumerable:!0,configurable:!0,writable:!0,value:f.EU.SAMPLE}),Object.defineProperty(qi(o),"content",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(qi(o),"validContent",{enumerable:!0,configurable:!0,writable:!0,value:""}),(0,l.makeObservable)(qi(o)),o}var o,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ki(e,t)}(t,e),o=t,(r=[{key:"onClick",value:function(e){var t,o=this;if(e===Yi.SELECTED)t=this.props.selectedSamples;else{var n=i().keyBy(this.props.selectedSamples,(function(e){return e.uniqueSampleKey}));t=this.props.allSamples.filter((function(e){return!n[e.uniqueSampleKey]}))}var r=t.map((function(e){return"".concat(e.studyId,":").concat(o.caseIdsMode===f.EU.SAMPLE?e.sampleId:e.patientId).concat(o.props.disableGrouping?"":" ".concat(xi))}));this.caseIdsMode===f.EU.PATIENT&&(r=i().uniq(r)),this.content=r.join("\n"),this.validateContent=!1,this.validContent=this.content}},{key:"onChange",value:function(e){this.validContent=e,this.validateContent=!0}},{key:"onChartNameChange",value:function(e){this.chartName=e.currentTarget.value;var t=!this.props.isChartNameValid||this.props.isChartNameValid(this.chartName);this.chartNameValidation=t?{error:[],warning:[]}:{error:[{code:Di.INVALID,message:new Error("Custom data exists.")}],warning:[]}}},{key:"onAddChart",value:function(){this.props.onSubmit(this.newChartInfo)}},{key:"mainContent",value:function(){var e=this;return n.createElement("div",{className:Pi().body},n.createElement(q.ButtonGroup,null,Xi.map((function(t,o){return n.createElement(q.Radio,{checked:t.value===e.caseIdsMode,onChange:function(t){e.caseIdsMode=Vi(t.target).attr("data-value"),e.validateContent=!0},inline:!0,"data-value":t.value},t.label)}))),n.createElement("span",null,n.createElement("div",{style:{display:"flex",justifyContent:"space-between",marginTop:5}},n.createElement("span",{className:Pi().selection,onClick:function(){e.onClick(Yi.SELECTED)}},n.createElement("i",{className:"fa fa-arrow-down",style:{marginRight:5}}),n.createElement("span",{className:Pi().selectionText},"currently selected")),n.createElement("span",{className:Pi().selection,onClick:function(){e.onClick(Yi.UNSELECTED)}},n.createElement("i",{className:"fa fa-arrow-down",style:{marginRight:5}}),n.createElement("span",{className:Pi().selectionText},"currently unselected")))),n.createElement("textarea",{className:"form-control",rows:5,value:this.content,placeholder:this.exampleData,onChange:function(t){e.content=t.currentTarget.value,i().delay((function(){e.onChange(e.content)}),500)},"data-test":"CustomCaseSetInput"}),this.props.disableGrouping&&n.createElement("div",{className:"alert alert-warning",style:{marginTop:"15px",marginBottom:"5px"}},n.createElement("i",{className:"fa fa-warning",style:{marginRight:3}}),"Submitting will clear current filters."),n.createElement("div",{className:Pi().operations},!this.props.disableGrouping&&n.createElement("input",{placeholder:"Title (optional)",style:{width:"200px"},type:"text",onInput:this.onChartNameChange,className:"form-control input-sm"}),n.createElement("button",{disabled:this.addChartButtonDisabled,className:"btn btn-primary btn-sm","data-test":"CustomCaseSetSubmitButton","data-event":(0,ur.XO)({category:"studyPage",action:"customCaseSetSelection",label:this.props.queriedStudies.join(",")}),onClick:this.onAddChart},this.submitButtonText)),this.result.validationResult.error.concat(this.chartNameValidation.error).map((function(e){return n.createElement("div",{className:"alert alert-danger",role:"alert",style:{marginTop:"10px",marginBottom:"0"}},e.message.message)})),this.result.validationResult.warning.concat(this.chartNameValidation.warning).map((function(e){return n.createElement("div",{className:"alert alert-warning",role:"alert",style:{marginTop:"10px",marginBottom:"0"},"data-test":"ValidationResultWarning"},e.message.message)})))}},{key:"render",value:function(){return this.mainContent()}},{key:"sampleSet",get:function(){return i().keyBy(this.props.selectedSamples,(function(e){return"".concat(e.studyId,":").concat(e.sampleId)}))}},{key:"isSingleStudy",get:function(){return 1===this.props.queriedStudies.length}},{key:"result",get:function(){return function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0,s={error:[],warning:[]},l=Li(e);if(l.length>0&&t){var u,c,p=Bi(l,n,r,a,o);(u=s.warning).push.apply(u,Mi(p.warning)),(c=s.error).push.apply(c,Mi(p.error)),void 0!==p.updatedLines&&(l=p.updatedLines)}var d=void 0!==i().find(l,(function(e){return void 0!==e.value&&""!==e.value}));return s.error.length>0?{data:[],validationResult:s}:{data:Fi(l,o[0],n,r,d),validationResult:s}}(this.validContent,this.validateContent,this.props.queriedStudies,this.caseIdsMode,this.props.allSamples,this.isSingleStudy)}},{key:"newChartInfo",get:function(){var e=this.chartName?this.chartName:this.props.getDefaultChartName?this.props.getDefaultChartName():"";return{displayName:e,description:e,datatype:f.g.STRING,patientAttribute:this.caseIdsMode===f.EU.PATIENT,data:0===this.result.validationResult.error.length?this.result.data:[]}}},{key:"addChartButtonDisabled",get:function(){return!!this.props.disableSubmitButton||this.result.validationResult.error.length>0||0===this.newChartInfo.data.length||this.chartNameValidation.error.length>0}},{key:"exampleData",get:function(){var e=this.caseIdsMode===f.EU.SAMPLE?"sample_id":"patient_id";return"Example:\nstudy_id:".concat(e,"1").concat(this.props.disableGrouping?"":" value1","\nstudy_id:").concat(e,"2").concat(this.props.disableGrouping?"":" value2")}},{key:"dataFormatContent",get:function(){return"Each row must have two columns separated by space or tab:"+"\n1) study_id: ".concat(this.caseIdsMode===f.EU.SAMPLE?"sample_id":"patient_id"," and")+"\n2) custom data (currently only support categorical data)"}},{key:"submitButtonText",get:function(){return this.props.disableGrouping?"Filter to listed ".concat(this.caseIdsMode===f.EU.SAMPLE?"samples":"patients"):this.props.submitButtonText}}])&&Ui(o.prototype,r),a&&Ui(o,a),t}(n.Component);Object.defineProperty(Qi,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{submitButtonText:"Submit",disableGrouping:!1}}),zi([l.observable.ref],Qi.prototype,"chartName",void 0),zi([l.observable],Qi.prototype,"showCaseIds",void 0),zi([l.observable],Qi.prototype,"caseIdsMode",void 0),zi([l.observable],Qi.prototype,"content",void 0),zi([l.observable],Qi.prototype,"validContent",void 0),zi([l.computed],Qi.prototype,"sampleSet",null),zi([l.computed],Qi.prototype,"isSingleStudy",null),zi([l.computed],Qi.prototype,"result",null),zi([l.computed],Qi.prototype,"newChartInfo",null),zi([l.action.bound],Qi.prototype,"onClick",null),zi([l.action.bound],Qi.prototype,"onChange",null),zi([l.action.bound],Qi.prototype,"onChartNameChange",null),zi([l.action.bound],Qi.prototype,"onAddChart",null),zi([l.computed],Qi.prototype,"addChartButtonDisabled",null),zi([l.computed],Qi.prototype,"exampleData",null),zi([l.computed],Qi.prototype,"dataFormatContent",null),zi([l.computed],Qi.prototype,"submitButtonText",null);const Zi=Qi=zi([a.observer],Qi);function Ji(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $i(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ea(e,t){return!t||"object"!==na(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ta(e){return(ta=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function oa(e,t){return(oa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function na(e){return(na="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ra=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===("undefined"==typeof Reflect?"undefined":na(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},ia=function(e){function t(){return Ji(this,t),ea(this,ta(t).apply(this,arguments))}var o,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oa(e,t)}(t,e),o=t,(r=[{key:"render",value:function(){return n.createElement("div",{className:"alert alert-success",style:{marginTop:"10px",marginBottom:"0"}},n.createElement("span",null,n.createElement("i",{className:"fa fa-md fa-check"})," ",this.props.message))}}])&&$i(o.prototype,r),i&&$i(o,i),t}(n.Component);const aa=ia=ra([a.observer],ia);var sa=o(44743),la=o.n(sa),ua=o(38659),ca=o(35770),pa=o(93527);function da(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ha(e){return(ha=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fa(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ma(e,t){return(ma=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ya(e){return(ya="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ba=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===("undefined"==typeof Reflect?"undefined":ya(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},ga=function(e){function t(e){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=function(e,t){return!t||"object"!==ya(t)&&"function"!=typeof t?fa(e):t}(this,ha(t).call(this,e)),Object.defineProperty(fa(o),"_selectedProfileOption",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(fa(o),"_oql",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(fa(o),"_genes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(fa(o),"_queryStr",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(fa(o),"genomicChartSelection",{enumerable:!0,configurable:!0,writable:!0,value:(0,ca.F)({await:function(){return[o.props.molecularProfileOptionsPromise]},render:function(){return 0===o.props.molecularProfileOptionsPromise.result.length?n.createElement("div",{style:{textAlign:"center"}},"No molecular profiles found"):n.createElement("div",{style:{width:o.props.containerWidth-20}},n.createElement(lr.Z,{inputGeneQuery:o._queryStr,validateInputGeneQuery:!1,callback:function(){o._oql=arguments.length<=0?void 0:arguments[0],o._genes=arguments.length<=1?void 0:arguments[1],o._queryStr=arguments.length<=2?void 0:arguments[2]},location:lr.e.DEFAULT,textBoxPrompt:"Enter gene symbols",textAreaHeight:"40px"}),o.hasOQL&&n.createElement("div",{className:V()("alert",la().oqlerror)},n.createElement("span",{className:"fa fa-exclamation-circle"}),"OQL not allowed"),n.createElement("div",{style:{display:"flex",marginTop:"10px"}},n.createElement("div",{style:{flex:1,marginRight:15}},n.createElement(ua.default,{value:o.selectedOption,onChange:o.handleSelect,options:o.molecularProfileOptions,isClearable:!1,isSearchable:!1})),n.createElement("button",{disabled:o.isQueryInvalid||o.hasOQL,className:"btn btn-primary btn-sm","data-test":"GeneLevelSelectionSubmitButton",onClick:o.onAddChart},o.props.submitButtonText)))},renderPending:function(){return n.createElement("div",{style:{textAlign:"center",marginTop:"20px"}},n.createElement(p.Z,{isLoading:!0}),"Calculating data availability...")},renderError:function(){return n.createElement("div",null,n.createElement(pa.Z,{message:"There was an error loading data. Please try again."}))}})}),(0,l.makeObservable)(fa(o)),o}var o,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ma(e,t)}(t,e),o=t,(r=[{key:"onAddChart",value:function(){var e=this;if(void 0!==this.selectedOption){var t=this.validGenes.map((function(t){return{name:t.hugoGeneSymbol+": "+e.selectedOption.profileName,description:e.selectedOption.description,profileType:e.selectedOption.value,hugoGeneSymbol:t.hugoGeneSymbol}}));this.props.onSubmit(t)}}},{key:"handleSelect",value:function(e){e&&e.value&&(this._selectedProfileOption=e)}},{key:"render",value:function(){return this.genomicChartSelection.component}},{key:"selectedOption",get:function(){return void 0!==this._selectedProfileOption?this._selectedProfileOption:this.props.molecularProfileOptionsPromise.isComplete?this.molecularProfileOptions[0]:void 0}},{key:"isQueryInvalid",get:function(){return""===this._queryStr||void 0===this._oql||void 0===this._genes||!i().isUndefined(this._oql.error)||0!==this._genes.suggestions.length}},{key:"hasOQL",get:function(){return!this.isQueryInvalid&&i().some(this._oql.query,(function(e){return!1!==e.alterations}))}},{key:"validGenes",get:function(){return this.isQueryInvalid||this.hasOQL?[]:this._genes.found}},{key:"molecularProfileOptions",get:function(){return this.props.molecularProfileOptionsPromise.isComplete?this.props.molecularProfileOptionsPromise.result.map((function(e){return Object.assign(Object.assign({},e),{label:"".concat(e.label," (").concat(e.count," samples)"),profileName:e.label})})):[]}}])&&da(o.prototype,r),a&&da(o,a),t}(n.Component);Object.defineProperty(ga,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{disableGrouping:!1}}),ba([l.observable],ga.prototype,"_selectedProfileOption",void 0),ba([l.observable],ga.prototype,"_oql",void 0),ba([l.observable],ga.prototype,"_genes",void 0),ba([l.observable.ref],ga.prototype,"_queryStr",void 0),ba([l.action.bound],ga.prototype,"onAddChart",null),ba([l.action.bound],ga.prototype,"handleSelect",null),ba([l.computed],ga.prototype,"selectedOption",null),ba([l.computed],ga.prototype,"isQueryInvalid",null),ba([l.computed],ga.prototype,"hasOQL",null),ba([l.computed],ga.prototype,"validGenes",null),ba([l.computed],ga.prototype,"molecularProfileOptions",null);const va=ga=ba([a.observer],ga);var Ca=o(55776),Sa=o(79666),wa=o(84232);var Ea=o(63656),Ta=o.n(Ea),Oa=o(74653);function Aa(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ka(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Na(e,t,o){return t&&ka(e.prototype,t),o&&ka(e,o),e}function Pa(e,t){return!t||"object"!==Ia(t)&&"function"!=typeof t?Ra(e):t}function _a(e){return(_a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ra(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ma(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Da(e,t)}function Da(e,t){return(Da=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ia(e){return(Ia="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var xa,La=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===("undefined"==typeof Reflect?"undefined":Ia(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},ja=function(e,t,o,n){return new(o||(o=Promise))((function(r,i){function a(e){try{l(n.next(e))}catch(e){i(e)}}function s(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))};!function(e){e.CUSTOM_DATA="Custom Data",e.CLINICAL="Clinical",e.GENOMIC="Genomic",e.GENE_SPECIFIC="Gene Specific"}(xa||(xa={}));var Ga=function(e){function t(e,o){var r;return Aa(this,t),r=Pa(this,_a(t).call(this,e,o)),Object.defineProperty(Ra(r),"activeId",{enumerable:!0,configurable:!0,writable:!0,value:r.props.defaultActiveTab||f.E4.CLINICAL}),Object.defineProperty(Ra(r),"infoMessage",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(Ra(r),"tabsWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(Ra(r),"selectedGenericAssayProfileIdByType",{enumerable:!0,configurable:!0,writable:!0,value:l.observable.map({},{deep:!0})}),Object.defineProperty(Ra(r),"XvsYSelection",{enumerable:!0,configurable:!0,writable:!0,value:{x:void 0,y:void 0}}),Object.defineProperty(Ra(r),"tabsDivRef",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Ra(r),"genericAssayEntityOptionsReaction",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Ra(r),"XvsYClinicalAttributes",{enumerable:!0,configurable:!0,writable:!0,value:(0,m.$w)({await:function(){return[r.props.store.chartClinicalAttributes]},invoke:function(){return Promise.resolve(r.props.store.chartClinicalAttributes.result)},default:[]})}),Object.defineProperty(Ra(r),"XvsYOptions",{enumerable:!0,configurable:!0,writable:!0,value:(0,m.$w)({await:function(){return[r.XvsYClinicalAttributes]},invoke:function(){return Promise.resolve(r.XvsYClinicalAttributes.result.map((function(e){return{value:e.clinicalAttributeId,label:e.displayName}})))},default:[]})}),Object.defineProperty(Ra(r),"dataCount",{enumerable:!0,configurable:!0,writable:!0,value:(0,m.$w)({await:function(){return[r.props.store.dataWithCount,r.props.store.selectedSamples]},invoke:function(){return ja(Ra(r),void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,f.lT)(this.props.store.dataWithCount.result,this.props.store.selectedSamples.result.length));case 1:case"end":return e.stop()}}),e,this)})))},default:{}})}),Object.defineProperty(Ra(r),"showAddNewChart",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Ra(r),"savingCustomData",{enumerable:!0,configurable:!0,writable:!0,value:!1}),(0,l.makeObservable)(Ra(r)),r.tabsDivRef=n.createRef(),r.genericAssayEntityOptionsReaction=(0,l.when)((function(){return!i().isEmpty(r.props.store.genericAssayProfileOptionsByType.result)}),(function(){return i().forEach(r.props.store.genericAssayProfileOptionsByType.result,(function(e,t){r.selectedGenericAssayProfileIdByType.set(t,e[0].value)}))})),r}return Ma(t,e),Na(t,[{key:"componentDidMount",value:function(){this.setTabsWidth(this.tabsDivRef.current)}},{key:"componentWillUnmount",value:function(){this.genericAssayEntityOptionsReaction()}},{key:"setTabsWidth",value:function(e){e&&(this.tabsWidth=e.offsetWidth)}},{key:"updateActiveId",value:function(e){this.activeId=e,this.resetInfoMessage()}},{key:"updateInfoMessage",value:function(e){this.infoMessage=e,setTimeout(this.resetInfoMessage,1e4)}},{key:"resetInfoMessage",value:function(){this.infoMessage=""}},{key:"onGenericAssaySubmit",value:function(e){this.infoMessage=function(e,t){var o="";if(1===e.length){var n=(0,f.XP)(e[0].genericAssayEntityId,e[0].profileType);o="".concat(e[0].name," ").concat(t.includes(n)?"is already":"has been"," added.")}else o="".concat(e.length," charts added");return o}(e,this.selectedAttrs);var t=i().groupBy(e,(function(e){return e.dataType}));i().isEmpty(t[wa.QH.LIMITVALUE])||this.props.store.addGenericAssayContinuousCharts(t[wa.QH.LIMITVALUE]),i().isEmpty(t[wa.QH.BINARY])||this.props.store.addGenericAssayBinaryOrCategoricalCharts(t[wa.QH.BINARY]),i().isEmpty(t[wa.QH.CATEGORICAL])||this.props.store.addGenericAssayBinaryOrCategoricalCharts(t[wa.QH.CATEGORICAL])}},{key:"onSelectGenericAssayProfileByType",value:function(e,t){this.selectedGenericAssayProfileIdByType.set(e,t)}},{key:"onAddAll",value:function(e){this.props.store.addCharts(this.selectedAttrs.concat(e));var t="".concat(e.length," chart").concat(e.length>1?"s":""," added");this.props.currentTab===c.rM.CLINICAL_DATA?this.updateInfoMessage("".concat(e.length," column").concat(e.length>1?"s":""," added to table and ").concat(t," in Summary tab")):this.props.currentTab===c.rM.SUMMARY?this.updateInfoMessage(t):this.updateInfoMessage("Added")}},{key:"onClearAll",value:function(e){this.props.store.updateChartsVisibility(i().reduce(this.selectedAttrs,(function(t,o){return e.includes(o)||t.push(o),t}),[]));var t="".concat(e.length," chart").concat(e.length>1?"s":""," removed");this.props.currentTab===c.rM.CLINICAL_DATA?this.updateInfoMessage("".concat(e.length," column").concat(e.length>1?"s":""," removed from table and ").concat(t," from Summary tab")):this.props.currentTab===c.rM.SUMMARY?this.updateInfoMessage(t):this.updateInfoMessage("Removed")}},{key:"onToggleOption",value:function(e){var t=this.props.store.chartMetaSet[e];if(void 0!==t){var o=U.$A[this.props.store.chartsType.get(e)];if(this.selectedAttrs.includes(e)){this.props.store.resetFilterAndChangeChartVisibility(e,!1);var n="";this.props.currentTab===c.rM.SUMMARY?n=" ".concat(o):this.props.currentTab===c.rM.CLINICAL_DATA&&(n=" column"),(0,ur.L9)({category:"studyPage",action:"removeChart",label:e}),this.updateInfoMessage("".concat(t.displayName).concat(n," is removed"))}else{this.props.store.addCharts(this.selectedAttrs.concat([e]));var r="";this.props.currentTab===c.rM.SUMMARY?r=" as a ".concat(o):this.props.currentTab===c.rM.CLINICAL_DATA&&(r=" to table and as ".concat(o," in Summary tab")),this.updateInfoMessage("".concat(t.displayName," added").concat(r)),(0,ur.L9)({category:"studyPage",action:"addChart",label:e})}}}},{key:"onToggleAddNewChart",value:function(){this.showAddNewChart=!this.showAddNewChart}},{key:"render",value:function(){var e=this;return n.createElement("div",{style:{display:"flex",flexDirection:"column"},ref:this.tabsDivRef},n.createElement(s.Kh,{unmountOnHide:!1,activeTabId:this.activeId,onTabClick:this.updateActiveId,className:"addChartTabs mainTabs"},n.createElement(s.l6,{key:0,id:f.E4.CLINICAL,linkText:xa.CLINICAL,className:"addClinicalChartTab"},n.createElement(ki.Z,{width:this.getTabsWidth,options:this.clinicalDataOptions,freqPromise:this.dataCount,onAddAll:this.onAddAll,onClearAll:this.onClearAll,onToggleOption:this.onToggleOption})),n.createElement(s.l6,{key:1,id:f.E4.GENOMIC,linkText:xa.GENOMIC,hide:this.props.disableGenomicTab||0===this.genomicChartOptions.length,className:"addGenomicChartTab"},n.createElement(ki.Z,{width:this.getTabsWidth,options:this.genomicChartOptions,freqPromise:this.dataCount,onAddAll:this.onAddAll,onClearAll:this.onClearAll,onToggleOption:this.onToggleOption})),n.createElement(s.l6,{key:2,id:f.E4.GENE_SPECIFIC,linkText:xa.GENE_SPECIFIC,hide:this.hideGeneSpecificTab},n.createElement(va,{containerWidth:this.getTabsWidth,molecularProfileOptionsPromise:this.props.store.molecularProfileOptions,submitButtonText:"Add Chart",onSubmit:function(t){if(1===t.length){var o=(0,f.Xq)(t[0].hugoGeneSymbol,t[0].profileType);e.updateInfoMessage("".concat(t[0].name," ").concat(e.selectedAttrs.includes(o)?"is already":"has been"," added."))}else e.updateInfoMessage("".concat(t.length," charts added"));e.props.store.addGeneSpecificCharts(t)}}),this.geneSpecificChartOptions.length>0&&n.createElement("div",{style:{marginTop:10}},n.createElement(ki.Z,{width:this.getTabsWidth,options:this.geneSpecificChartOptions,freqPromise:this.dataCount,onAddAll:this.onAddAll,onClearAll:this.onClearAll,onToggleOption:this.onToggleOption,hideControls:!0,firstColumnHeaderName:"Gene Specific Chart"}))),n.createElement(s.l6,{key:3,id:f.E4.CUSTOM_DATA,linkText:xa.CUSTOM_DATA,hide:this.props.disableCustomTab,className:"custom"},n.createElement("div",{style:{width:this.getTabsWidth-20}},this.customChartDataOptions.length>0&&n.createElement("button",{className:"btn btn-primary btn-xs",onClick:this.onToggleAddNewChart},this.isAddNewChartWindowVisible?"Cancel":"+ Add new custom data"),this.isAddNewChartWindowVisible&&n.createElement(Zi,{allSamples:this.props.store.samples.result,selectedSamples:this.props.store.selectedSamples.result,submitButtonText:"Add Chart",queriedStudies:this.props.store.queriedPhysicalStudyIds.result,isChartNameValid:this.props.store.isChartNameValid,getDefaultChartName:this.props.store.getDefaultCustomChartName,disableSubmitButton:this.savingCustomData,onSubmit:function(t){e.showAddNewChart=!1,e.savingCustomData=!0,e.updateInfoMessage("Saving ".concat(t.displayName)),e.props.store.addCustomChart(t).then((function(){e.savingCustomData=!1,e.updateInfoMessage("".concat(t.displayName," has been added."))}))}}),n.createElement(n.Fragment,null,this.customChartDataOptions.length>0&&n.createElement(n.Fragment,null,n.createElement("hr",{style:{marginTop:10,marginBottom:10}}),n.createElement(ki.Z,{width:this.getTabsWidth,options:this.customChartDataOptions,freqPromise:this.dataCount,onAddAll:this.onAddAll,onClearAll:this.onClearAll,onToggleOption:this.onToggleOption,hideControls:!0,firstColumnHeaderName:"Custom data",shareCharts:this.props.openShareCustomDataUrlModal,deleteChart:function(t){e.props.store.toggleCustomChartMarkedForDeletion(t)},restoreChart:function(t){e.props.store.toggleCustomChartMarkedForDeletion(t)},markedForDeletion:this.props.store.customChartGroupMarkedForDeletion})),this.notificationMessages.length>0&&n.createElement(n.Fragment,null,n.createElement("br",null),n.createElement("span",{className:"text-warning"},"Note: ",this.notificationMessages))))),n.createElement(s.l6,{id:"X_Vs_Y",linkText:n.createElement("span",null,"X vs Y",n.createElement("strong",{style:{marginLeft:5},className:"beta-text"},"Beta!")),key:4},n.createElement("div",{style:{display:"flex",flexDirection:"column"}},n.createElement("div",{style:{paddingBottom:5}},n.createElement(ua.default,{name:"x-vs-y-select-x",className:"xvsy-x-axis-selector",placeholder:"Select first clinical attribute",closeMenuOnSelect:!0,value:[this.XvsYSelection.x],isMulti:!1,isClearable:!1,options:this.XvsYOptions.result,onChange:(0,l.action)((function(t){e.XvsYSelection.x=t}))})),n.createElement("span",{style:{margin:"auto",marginBottom:6}},"vs."),n.createElement("div",{style:{paddingBottom:15}},n.createElement(ua.default,{name:"x-vs-y-select-y",className:"xvsy-y-axis-selector",placeholder:"Select second clinical attribute",closeMenuOnSelect:!0,value:[this.XvsYSelection.y],isMulti:!1,isClearable:!1,options:this.XvsYOptions.result,onChange:(0,l.action)((function(t){e.XvsYSelection.y=t}))})),this.addXvsYChartButton)),!this.hideGenericAssayTabs&&this.genericAssayTabs),this.showResetButton&&n.createElement("button",{style:{position:"absolute",top:14,right:18,zIndex:2},className:"btn btn-primary btn-xs",onClick:this.props.showResetPopup},"Reset charts"),this.infoMessage&&!this.savingCustomData&&n.createElement(aa,{message:this.infoMessage}),this.savingCustomData&&n.createElement("div",{className:"alert alert-info",style:{marginTop:"10px",marginBottom:"0"}},n.createElement("span",null,n.createElement("i",{className:"fa fa-spinner fa-spin"})," ",this.infoMessage)))}},{key:"getTabsWidth",get:function(){var e=this.tabsWidth+(this.showResetButton?70:0);return e>400?e:400}},{key:"showResetButton",get:function(){return this.props.store.isLoggedIn&&this.props.currentTab===c.rM.SUMMARY&&this.props.store.showResetToDefaultButton}},{key:"groupedChartMetaByDataType",get:function(){return i().chain(this.props.store.chartMetaSet).values().groupBy((function(e){return e.dataType})).value()}},{key:"genomicChartOptions",get:function(){var e=(0,f.Kj)(this.groupedChartMetaByDataType[f.E4.GENOMIC]||[],this.selectedAttrs,i().fromPairs(this.props.store.chartsType.toJSON()));return this.props.currentTab===c.rM.CLINICAL_DATA?e.filter((function(e){return e.chartType===U.oV.BAR_CHART||e.chartType===U.oV.PIE_CHART})):e}},{key:"geneSpecificChartOptions",get:function(){var e=(0,f.Kj)(this.groupedChartMetaByDataType[f.E4.GENE_SPECIFIC]||[],this.selectedAttrs,i().fromPairs(this.props.store.chartsType.toJSON()));return this.props.currentTab===c.rM.CLINICAL_DATA?e.filter((function(e){return e.chartType===U.oV.BAR_CHART||e.chartType===U.oV.PIE_CHART})):e}},{key:"genericAssayChartOptionsByGenericAssayType",get:function(){var e=this,t=i().groupBy(this.groupedChartMetaByDataType[f.E4.GENERIC_ASSAY]||[],(function(e){return e.genericAssayType}));return i().mapValues(t,(function(t){return(0,f.Kj)(t,e.selectedAttrs,i().fromPairs(e.props.store.chartsType.toJSON()))}))}},{key:"clinicalDataOptions",get:function(){return(0,f.Kj)(this.groupedChartMetaByDataType[f.E4.CLINICAL]||[],this.selectedAttrs,i().fromPairs(this.props.store.chartsType.toJSON()))}},{key:"customChartDataOptions",get:function(){return(0,f.Kj)(this.groupedChartMetaByDataType[f.E4.CUSTOM_DATA]||[],this.selectedAttrs,i().fromPairs(this.props.store.chartsType.toJSON()),this.props.store.isLoggedIn?this.props.store.showCustomDataSelectionUI?this.props.store.isSharedCustomData:void 0:this.props.store.isSharedCustomData)}},{key:"selectedAttrs",get:function(){return this.props.store.visibleAttributes.map((function(e){return e.uniqueKey}))}},{key:"hideGeneSpecificTab",get:function(){return this.props.disableGeneSpecificTab||!this.props.store.molecularProfileForGeneCharts.isComplete||this.props.store.molecularProfileForGeneCharts.isComplete&&0===this.props.store.molecularProfileForGeneCharts.result.length}},{key:"hideGenericAssayTabs",get:function(){return this.props.disableGenericAssayTabs||!this.props.store.genericAssayProfiles.isComplete||!this.props.store.genericAssayEntitiesGroupedByProfileId.isComplete||this.props.store.genericAssayProfiles.isComplete&&i().isEmpty(this.props.store.genericAssayProfiles.result)}},{key:"genericAssayTabs",get:function(){var e=this;return i().map(this.props.store.genericAssayProfileOptionsByType.result,(function(t,o){var r,a=((null===(r=t.find((function(t){return t.value===e.selectedGenericAssayProfileIdByType.get(o)})))||void 0===r?void 0:r.profileIds)||[]).reduce((function(t,o){return e.props.store.genericAssayEntitiesGroupedByProfileId.result[o].forEach((function(e){t[e.stableId]=e})),t}),{}),l=i().map(a,Sa.VV),u=e.genericAssayChartOptionsByGenericAssayType[o]&&e.genericAssayChartOptionsByGenericAssayType[o].length>0,c=t.map((function(e){return Object.assign(Object.assign({},e),{label:"".concat(e.label," (").concat(e.count," ").concat(e.patientLevel?"patients":"samples",")"),profileName:e.label})}));return n.createElement(s.l6,{key:o,id:o,linkText:(0,Sa._y)(o)},n.createElement(Ca.ZP,{containerWidth:e.getTabsWidth,molecularProfileOptions:c,submitButtonText:"Add Chart",genericAssayType:o,genericAssayEntityOptions:l,entityMap:a,onChartSubmit:e.onGenericAssaySubmit,onSelectGenericAssayProfile:function(t){return e.onSelectGenericAssayProfileByType(o,t)}}),u&&n.createElement("div",{style:{marginTop:10}},n.createElement(ki.Z,{width:e.getTabsWidth,options:e.genericAssayChartOptionsByGenericAssayType[o],freqPromise:e.dataCount,onAddAll:e.onAddAll,onClearAll:e.onClearAll,onToggleOption:e.onToggleOption,hideControls:!0,firstColumnHeaderName:"".concat((0,Sa._y)(o)," Chart")})))}))}},{key:"existSharedCustomData",get:function(){return i().some(this.customChartDataOptions,(function(e){return e.isSharedChart}))}},{key:"notificationMessages",get:function(){var e,t,o,r=this,a=[];return this.props.store.customChartSet.size>0&&(this.existSharedCustomData&&a.push(n.createElement(n.Fragment,null,n.createElement("span",{className:V()((e={},t=Ta().sharedChart,o=!0,t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e))},"Highlighted rows")," ","are shared custom data.")),!this.props.store.isLoggedIn&&this.props.store.appStore.isSocialAuthenticated?(a.length>0&&a.push(n.createElement("br",null)),a.push(n.createElement(n.Fragment,null,n.createElement("button",{className:"btn btn-default btn-xs",onClick:function(){return(0,Oa.U)(r.props.store.appStore)}},"Login"),"to save custom data charts to your profile."))):this.existSharedCustomData&&(a.length>0&&a.push(n.createElement("br",null)),a.push(n.createElement(n.Fragment,null,"Custom charts are saved to your profile"))),i().isEmpty(this.props.store.customChartGroupMarkedForDeletion)||(a.length>0&&a.push(n.createElement("br",null)),a.push(n.createElement("span",null,"Deleted charts will be permanently removed when this menu is closed. Any active filters based on deleted charts will also be removed.")))),a}},{key:"selectedCustomChartIds",get:function(){return this.customChartDataOptions.filter((function(e){return!!e.selected})).map((function(e){return e.key}))}},{key:"isAddNewChartWindowVisible",get:function(){return 0===this.customChartDataOptions.length||this.showAddNewChart}},{key:"addXvsYChartButton",get:function(){var e,t,o,r,i=this,a=!1;if(this.XvsYSelection.x&&this.XvsYSelection.y)if(this.XvsYSelection.x.value===this.XvsYSelection.y.value)a=!0,e="Please choose two different attributes.";else if(this.props.store.isXvsYChartVisible(this.XvsYSelection.x.value,this.XvsYSelection.y.value))a=!0,e="A chart with these attributes already exists";else{var s=this.props.store.clinicalAttributeIdToClinicalAttribute.result,u=s[this.XvsYSelection.x.value],c=s[this.XvsYSelection.y.value];"STRING"===u.datatype&&"STRING"===c.datatype?(a=!0,e="Can't add a chart with two categorical attributes (yet)."):"NUMBER"===u.datatype&&"STRING"===c.datatype||"STRING"===u.datatype&&"NUMBER"===c.datatype?(e="Add violin/box plot table",t="violin","STRING"===u.datatype?(o=u.clinicalAttributeId,r=c.clinicalAttributeId):(o=c.clinicalAttributeId,r=u.clinicalAttributeId)):(e="Add density plot",t="scatter")}else a=!0,e="Add Chart";return n.createElement("button",{className:"btn btn-primary btn-sm","data-test":"x-vs-y-submit-btn",disabled:a,onClick:a?void 0:(0,l.action)((function(){"scatter"===t?i.props.store.addXvsYScatterChart({xAttrId:i.XvsYSelection.x.value,yAttrId:i.XvsYSelection.y.value}):i.props.store.addXvsYViolinChart({categoricalAttrId:o,numericalAttrId:r}),i.updateInfoMessage("".concat(i.XvsYSelection.y.label," vs ").concat(i.XvsYSelection.x.label," added.")),i.XvsYSelection.x=void 0,i.XvsYSelection.y=void 0}))},e)}}]),t}(n.Component);Object.defineProperty(Ga,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{disableGenomicTab:!1,disableCustomTab:!1,disableGeneSpecificTab:!1,disableGenericAssayTabs:!1}}),La([l.observable],Ga.prototype,"activeId",void 0),La([l.observable],Ga.prototype,"infoMessage",void 0),La([l.observable],Ga.prototype,"tabsWidth",void 0),La([l.observable],Ga.prototype,"XvsYSelection",void 0),La([l.action.bound],Ga.prototype,"setTabsWidth",null),La([l.computed],Ga.prototype,"getTabsWidth",null),La([l.computed],Ga.prototype,"showResetButton",null),La([l.action.bound],Ga.prototype,"updateActiveId",null),La([l.action.bound],Ga.prototype,"updateInfoMessage",null),La([l.action.bound],Ga.prototype,"resetInfoMessage",null),La([l.computed],Ga.prototype,"groupedChartMetaByDataType",null),La([l.computed],Ga.prototype,"genomicChartOptions",null),La([l.computed],Ga.prototype,"geneSpecificChartOptions",null),La([l.computed],Ga.prototype,"genericAssayChartOptionsByGenericAssayType",null),La([l.computed],Ga.prototype,"clinicalDataOptions",null),La([l.computed],Ga.prototype,"customChartDataOptions",null),La([l.computed],Ga.prototype,"selectedAttrs",null),La([l.computed],Ga.prototype,"hideGeneSpecificTab",null),La([l.computed],Ga.prototype,"hideGenericAssayTabs",null),La([l.action.bound],Ga.prototype,"onGenericAssaySubmit",null),La([l.action.bound],Ga.prototype,"onSelectGenericAssayProfileByType",null),La([l.action.bound],Ga.prototype,"onAddAll",null),La([g.default],Ga.prototype,"onClearAll",null),La([l.action.bound],Ga.prototype,"onToggleOption",null),La([l.computed],Ga.prototype,"genericAssayTabs",null),La([l.computed],Ga.prototype,"existSharedCustomData",null),La([l.computed],Ga.prototype,"notificationMessages",null),La([l.computed],Ga.prototype,"selectedCustomChartIds",null),La([l.observable],Ga.prototype,"showAddNewChart",void 0),La([l.action.bound],Ga.prototype,"onToggleAddNewChart",null),La([l.computed],Ga.prototype,"isAddNewChartWindowVisible",null),La([l.observable],Ga.prototype,"savingCustomData",void 0),La([l.computed],Ga.prototype,"addXvsYChartButton",null),Ga=La([a.observer],Ga);var Ba=function(e){function t(e){var o;return Aa(this,t),o=Pa(this,_a(t).call(this,e)),Object.defineProperty(Ra(o),"showTooltip",{enumerable:!0,configurable:!0,writable:!0,value:!1}),(0,l.makeObservable)(Ra(o)),o}return Ma(t,e),Na(t,[{key:"render",value:function(){var e=this;return n.createElement(m.ZD,{visible:this.showTooltip||this.props.store.showCustomDataSelectionUI,onVisibleChange:function(t){e.props.isShareLinkModalVisible||(e.showTooltip=!e.tabsLoading&&!!t,e.props.store.showCustomDataSelectionUI=!1,t||e.props.store.deleteMarkedCustomData())},trigger:["click"],placement:"bottomRight",destroyTooltipOnHide:!1,getTooltipContainer:function(){return document.getElementById("comparisonGroupManagerContainer")},overlay:function(){return n.createElement(Ga,{store:e.props.store,defaultActiveTab:e.props.defaultActiveTab,currentTab:e.props.currentTab,disableGenomicTab:e.props.disableGenomicTab,disableGeneSpecificTab:e.props.disableGeneSpecificTab,disableGenericAssayTabs:e.props.disableGenericAssayTabs,disableCustomTab:e.props.disableCustomTab,showResetPopup:e.props.showResetPopup,openShareCustomDataUrlModal:e.props.openShareCustomDataUrlModal})},overlayClassName:this.props.addChartOverlayClassName},n.createElement("button",{className:V()("btn btn-primary btn-sm",{active:this.showTooltip,disabled:this.tabsLoading}),style:{marginLeft:10},"aria-pressed":this.showTooltip,"data-event":(0,ur.XO)({category:"studyPage",action:"addChartMenuOpen",label:this.props.store.studyIds.join(",")}),"data-test":"add-charts-button"},this.props.buttonText))}},{key:"tabsLoading",get:function(){return this.props.store.genericAssayProfileOptionsByType.isPending||this.props.store.molecularProfileOptions.isPending||this.props.store.genericAssayEntitiesGroupedByProfileId.isPending}}]),t}(n.Component);La([l.observable],Ba.prototype,"showTooltip",void 0),La([l.computed],Ba.prototype,"tabsLoading",null);const Fa=Ba=La([a.observer],Ba);var Va=o(89551),Ua=o(65497),Wa=o.n(Ua);function qa(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ka(e){return(Ka=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ha(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ya(e,t){return(Ya=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function za(e){return(za="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Xa=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===("undefined"==typeof Reflect?"undefined":za(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Qa=function(e){function t(e){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=function(e,t){return!t||"object"!==za(t)&&"function"!=typeof t?Ha(e):t}(this,Ka(t).call(this,e)),Object.defineProperty(Ha(o),"downloadingData",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Ha(o),"showDownloadErrorMessage",{enumerable:!0,configurable:!0,writable:!0,value:!1}),(0,l.makeObservable)(Ha(o)),o}var o,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ya(e,t)}(t,e),o=t,(r=[{key:"initiateDownload",value:function(){var e=this;this.downloadingData=!0,this.showDownloadErrorMessage=!1,this.props.store.getDownloadDataPromise().then((function(t){e.downloadingData=!1,Wa()(t,e.props.store.clinicalDataDownloadFilename)})).catch((function(){e.downloadingData=!1,e.showDownloadErrorMessage=!0}))}},{key:"openCases",value:function(){if(!i().isEmpty(this.props.store.selectedPatients)){var e=this.props.store.selectedPatients[0],t=i().map(this.props.store.selectedPatients,(function(e){return{patientId:e.patientId,studyId:e.studyId}})),o=(0,h.WU)(e.studyId,e.patientId,t);o.length>4500?window.open((0,h.WU)(e.studyId,e.patientId)).clientPostedData={navCaseIds:t}:window.open(o)}}},{key:"render",value:function(){return n.createElement("div",{className:V()(Rr().actionButtons,"btn-group")},n.createElement(m.ZD,{trigger:["hover"],placement:"top",overlay:n.createElement("span",null,"View selected cases")},n.createElement("button",{className:"btn btn-default btn-sm",disabled:!this.props.loadingComplete,onClick:this.openCases,"data-event":(0,ur.XO)({category:"studyPage",action:"viewPatientCohort",label:this.props.store.queriedPhysicalStudyIds.result})},n.createElement("i",{className:"fa fa-user-circle-o"}))),n.createElement(m.ZD,{trigger:["click"],destroyTooltipOnHide:!0,overlay:this.virtualStudy,placement:"bottom"},n.createElement(m.ZD,{placement:"top",trigger:["hover"],overlay:n.createElement("span",null,this.virtualStudyButtonTooltip)},n.createElement("button",{className:"btn btn-default btn-sm",disabled:!this.props.loadingComplete},n.createElement("i",{className:"fa fa-bookmark"})))),!0===this.context.showDownloadControls&&n.createElement(m.ZD,{trigger:["hover"],placement:"top",overlay:n.createElement("span",null,this.downloadButtonTooltip)},n.createElement("button",{className:"btn btn-default btn-sm",disabled:!this.props.loadingComplete,onClick:this.initiateDownload,"data-event":(0,ur.XO)({category:"studyPage",action:"dataDownload",label:this.props.store.queriedPhysicalStudyIds.result})},n.createElement(y.If,{condition:this.downloadingData},n.createElement(y.Then,null,n.createElement("i",{className:"fa fa-spinner fa-spin"})),n.createElement(y.Else,null,n.createElement("i",{className:"fa fa-download"}))))))}},{key:"virtualStudyButtonTooltip",get:function(){return(this.props.appStore.isLoggedIn?"Save/":"")+"Share Virtual Study"}},{key:"downloadButtonTooltip",get:function(){return this.showDownloadErrorMessage?"An error occurred while downloading the data. Please try again.":"Download clinical data for the selected cases"}},{key:"virtualStudy",get:function(){return this.props.loadingComplete?n.createElement(vr.Z,{user:this.props.appStore.userName,name:this.props.store.isSingleVirtualStudyPageWithoutFilter?this.props.store.filteredVirtualStudies.result[0].data.name:void 0,description:this.props.store.isSingleVirtualStudyPageWithoutFilter?this.props.store.filteredVirtualStudies.result[0].data.description:void 0,studyWithSamples:this.props.store.studyWithSamples.result,selectedSamples:this.props.store.selectedSamples.result,filter:this.props.store.userSelections,attributesMetaSet:this.props.store.chartMetaSet,molecularProfileNameSet:this.props.store.molecularProfileNameSet.result||{},caseListNameSet:this.props.store.caseListNameSet.result||{}}):null}}])&&qa(o.prototype,r),a&&qa(o,a),t}(n.Component);Xa([l.observable],Qa.prototype,"downloadingData",void 0),Xa([l.observable],Qa.prototype,"showDownloadErrorMessage",void 0),Xa([g.default],Qa.prototype,"initiateDownload",null),Xa([g.default],Qa.prototype,"openCases",null),Xa([l.computed],Qa.prototype,"virtualStudyButtonTooltip",null),Xa([l.computed],Qa.prototype,"downloadButtonTooltip",null),Xa([l.computed],Qa.prototype,"virtualStudy",null);const Za=Qa=Xa([a.observer],Qa);Qa.contextType=m.Il;var Ja=o(6790),$a=o.n(Ja),es=o(99355),ts=o(30177),os=o(18667),ns=o(6097);function rs(e){return(rs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function is(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function as(e){return(as=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ss(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ls(e,t){return(ls=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var us=function(e){function t(e){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=function(e,t){return!t||"object"!==rs(t)&&"function"!=typeof t?ss(e):t}(this,as(t).call(this,e))).render=o.render.bind(ss(o)),o}var o,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ls(e,t)}(t,e),o=t,(r=[{key:"render",value:function(){var e=this.props.color;return n.createElement("svg",{width:"12",height:"12",className:"case-label-header","data-test":"color-picker-icon"},n.createElement("rect",{width:"12",height:"12",fill:null==e?"#FFFFFF":e,stroke:"#3786c2","stroke-width":"4",cursor:"pointer"}),"#FFFFFF"===e&&n.createElement("line",{x1:"10",y1:"2",x2:"2",y2:"10",stroke:"red","stroke-width":"1"}))}}])&&is(o.prototype,r),i&&is(o,i),t}(n.Component);function cs(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ps(e){return(ps=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ds(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hs(e,t){return(hs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fs(e){return(fs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ms=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===("undefined"==typeof Reflect?"undefined":fs(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},ys=function(e){function t(e){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=function(e,t){return!t||"object"!==fs(t)&&"function"!=typeof t?ds(e):t}(this,ps(t).call(this,e)),Object.defineProperty(ds(o),"handleChangeComplete",{enumerable:!0,configurable:!0,writable:!0,value:function(e,t){e.hex===o.props.color?(o.props.onChangeGroupColor(o.props.group,void 0),o.props.store.flagDuplicateColorsForSelectedGroups(o.props.group.uid,void 0)):(o.props.onChangeGroupColor(o.props.group,e.hex),o.props.store.flagDuplicateColorsForSelectedGroups(o.props.group.uid,e.hex))}}),Object.defineProperty(ds(o),"buildColorChooserWidget",{enumerable:!0,configurable:!0,writable:!0,value:function(){return n.createElement(q.Popover,{id:"popover-basic",onClick:function(e){e.stopPropagation(),e.preventDefault()}},n.createElement("div",null,n.createElement(ns.iY,{colors:o.colorList,circleSize:20,circleSpacing:3,onChangeComplete:o.handleChangeComplete,color:o.props.color,width:"140px"})))}}),(0,l.makeObservable)(ds(o)),o}var o,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hs(e,t)}(t,e),o=t,(r=[{key:"onCheckboxClick",value:function(){this.props.store.toggleComparisonGroupSelected(this.props.group.uid),this.props.store.flagDuplicateColorsForSelectedGroups(this.props.group.uid,this.props.color)}},{key:"onRestoreClick",value:function(){this.props.restore(this.props.group)}},{key:"onDeleteClick",value:function(){this.props.delete(this.props.group)}},{key:"shareGroup",value:function(){this.props.shareGroup(this.props.group)}},{key:"onOverlayEnter",value:function(){this.props.store.numberOfVisibleColorChooserModals+=1}},{key:"onOverlayExit",value:function(){this.props.store.numberOfVisibleColorChooserModals-=1}},{key:"render",value:function(){var e,t,o,r,i=this.props.group;return e=this.props.markedForDeletion?n.createElement("span",{className:$a().markedForDeletion},this.label):n.createElement("div",{className:$a().groupItem,style:{display:"flex",alignItems:"center"}},n.createElement("input",{type:"checkbox",value:i.uid,checked:this.props.store.isComparisonGroupSelected(i.uid),onClick:this.onCheckboxClick}),this.label),n.createElement("div",{key:i.uid,"data-test":i.name,className:V()($a().groupRow,(t={},o=$a().sharedGroup,r=this.props.group.isSharedGroup,o in t?Object.defineProperty(t,o,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[o]=r,t)),style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingBottom:4,paddingTop:4,minHeight:"35px"}},e,n.createElement("div",{className:$a().groupLineItemActionButtons},!this.props.markedForDeletion&&n.createElement(n.Fragment,null,n.createElement(m.ZD,{overlay:"You have selected identical colors for compared groups."},n.createElement("span",null,this.props.markedWithWarningSign&&n.createElement("i",{className:"fa fa-warning",style:{cursor:"pointer",color:"#fad201",position:"relative",top:"1px",right:"2px"}}))),n.createElement(q.OverlayTrigger,{containerPadding:40,trigger:"click",placement:"bottom",overlay:this.buildColorChooserWidget(),onEnter:this.onOverlayEnter,onExit:this.onOverlayExit,rootClose:!0},n.createElement(m.ZD,{overlay:"Optional: Select color for group to be used in group comparison. If no color is selected, a random color will be applied.",disabled:this.props.store.numberOfVisibleColorChooserModals>0},n.createElement("span",{style:{marginTop:2,marginRight:2}},n.createElement(us,{color:this.props.color||"#FFFFFF"})))),n.createElement(m.ZD,{overlay:"Delete Group"},n.createElement("span",{onClick:this.onDeleteClick,"data-test":"deleteGroupButton"},n.createElement("i",{className:"fa fa-md fa-trash",style:{cursor:"pointer"}}))),n.createElement("span",{onClick:this.shareGroup},n.createElement("i",{className:"fa fa-share-alt",style:{cursor:"pointer"}}))),this.props.group.nonExistentSamples.length>0&&n.createElement(os.Z,{tooltip:n.createElement(Jr.Mt,{samples:this.props.group.nonExistentSamples})}),this.props.markedForDeletion&&n.createElement("button",{style:{marginLeft:10},className:"btn btn-xs btn-default",onClick:this.onRestoreClick},"Restore")))}},{key:"label",get:function(){return n.createElement("span",{style:{display:"flex",alignItems:"center",whiteSpace:"nowrap"}},n.createElement(m.Ld,{text:this.props.group.name,maxLength:30}),"(",(0,Jr.L3)((0,Jr.bt)(this.props.group),(0,Jr.Ll)(this.props.group)),")")}},{key:"colorList",get:function(){var e=f.DM.slice(0,20);return e.push(ke.$P),e.push(ke.P2),e.push(ke.sp),e.push(ke.au),e}}])&&cs(o.prototype,r),i&&cs(o,i),t}(n.Component);ms([g.default],ys.prototype,"onCheckboxClick",null),ms([g.default],ys.prototype,"onRestoreClick",null),ms([g.default],ys.prototype,"onDeleteClick",null),ms([g.default],ys.prototype,"shareGroup",null),ms([g.default],ys.prototype,"onOverlayEnter",null),ms([g.default],ys.prototype,"onOverlayExit",null),ms([l.computed],ys.prototype,"label",null),ms([l.computed],ys.prototype,"colorList",null),ms([l.action.bound],ys.prototype,"handleChangeComplete",void 0);const bs=ys=ms([a.observer],ys);var gs=o(31595);function vs(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var o=[],n=!0,r=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(o.push(a.value),!t||o.length!==t);n=!0);}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return o}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Cs(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ss(e){return(Ss=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ws(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Es(e,t){return(Es=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ts(e){return(Ts="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Os=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===("undefined"==typeof Reflect?"undefined":Ts(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},As=function(e,t,o,n){return new(o||(o=Promise))((function(r,i){function a(e){try{l(n.next(e))}catch(e){i(e)}}function s(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))},ks=function(e){function t(e){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=function(e,t){return!t||"object"!==Ts(t)&&"function"!=typeof t?ws(e):t}(this,Ss(t).call(this,e)),Object.defineProperty(ws(o),"groupNameFilter",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(ws(o),"addGroupPanelOpen",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(ws(o),"_inputGroupName",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(ws(o),"addSamplesTargetGroupId",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(ws(o),"filteredGroups",{enumerable:!0,configurable:!0,writable:!0,value:(0,m.$w)({await:function(){return[o.props.store.comparisonGroups]},invoke:function(){return Promise.resolve(i().sortBy(o.props.store.comparisonGroups.result.filter((function(e){return new RegExp(o.groupNameFilter,"i").test(e.name)})),(function(e){return e.name.toLowerCase()})))}})}),Object.defineProperty(ws(o),"groupsSection",{enumerable:!0,configurable:!0,writable:!0,value:(0,ca.F)({await:function(){return[o.props.store.comparisonGroups,o.filteredGroups,o.props.store.selectedSamples]},render:function(){return o.props.store.comparisonGroups.result.length>0?n.createElement("div",{className:$a().groupCheckboxes,"data-test":"group-checkboxes"},o.filteredGroups.result.length>0?o.filteredGroups.result.map((function(e){return n.createElement(bs,{group:e,color:o.props.store.userGroupColors[e.uid],store:o.props.store,markedForDeletion:o.props.store.isComparisonGroupMarkedForDeletion(e.uid),markedWithWarningSign:o.props.store.isComparisonGroupMarkedWithWarningSign(e.uid),restore:o.restoreGroup,delete:o.deleteGroup,studyIds:o.props.store.studyIds,shareGroup:o.shareSingleGroup,onChangeGroupColor:o.onGroupColorChange})})):n.createElement("div",{className:$a().noGroupsMessage},"No results for your current search.")):n.createElement("div",{className:$a().noGroupsMessage},"Group comparison allows you to create custom groups and compare their clinical and genomic features. Use the button below to create groups based on selections.")},renderPending:function(){return n.createElement(p.Z,{isLoading:!0})},renderError:function(){return n.createElement("div",{className:$a().noGroupsMessage},n.createElement(pa.Z,{message:"There was an error loading saved groups. Please try again."}))}})}),Object.defineProperty(ws(o),"actionButtons",{enumerable:!0,configurable:!0,writable:!0,value:(0,ca.F)({await:function(){return[o.props.store.comparisonGroups]},render:function(){return o.props.store.comparisonGroups.result.length>0?n.createElement("div",{style:{marginTop:6}},o.compareButton,o.viewButton,o.shareButton):null}})}),(0,l.makeObservable)(ws(o)),o}var o,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Es(e,t)}(t,e),o=t,(r=[{key:"onChangeGroupNameFilter",value:function(e){this.groupNameFilter=e.target.value}},{key:"onChangeInputGroupName",value:function(e){this._inputGroupName=e.target.value}},{key:"showAddGroupPanel",value:function(){this.addGroupPanelOpen=!0;var e=i().reduce(Array.from(this.props.store.preDefinedCustomChartFilterSet.entries()),(function(e,t){var o=vs(t,2),n=o[0],r=o[1];return e[n]=r.values.map((function(e){return e.value})),e}),{});this._inputGroupName=(0,Jr.xr)(this.props.store.filters,e,this.props.store.clinicalAttributeIdToDataType.result)}},{key:"cancelAddGroup",value:function(){this.addGroupPanelOpen=!1,this._inputGroupName="",this.addSamplesTargetGroupId=""}},{key:"deleteGroup",value:function(e){this.props.store.toggleComparisonGroupMarkedForDeletion(e.uid)}},{key:"selectAllFiltered",value:function(){var e=!0,t=!1,o=void 0;try{for(var n,r=this.filteredGroups.result[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var i=n.value;this.props.store.setComparisonGroupSelected(i.uid,!0)}}catch(e){t=!0,o=e}finally{try{e||null==r.return||r.return()}finally{if(t)throw o}}this.props.store.flagDuplicateColorsForSelectedGroups(void 0,void 0)}},{key:"deselectAllFiltered",value:function(){var e=!0,t=!1,o=void 0;try{for(var n,r=this.filteredGroups.result[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var i=n.value;this.props.store.setComparisonGroupSelected(i.uid,!1),this.props.store.showComparisonGroupWarningSign(i.uid,!1)}}catch(e){t=!0,o=e}finally{try{e||null==r.return||r.return()}finally{if(t)throw o}}}},{key:"restoreGroup",value:function(e){this.props.store.toggleComparisonGroupMarkedForDeletion(e.uid)}},{key:"shareSingleGroup",value:function(e){this.props.shareGroups([e])}},{key:"shareGroups",value:function(){var e=(0,es.Zd)(this.props.store.comparisonGroups.result||[],this.props.store);this.props.shareGroups(e)}},{key:"onSubmitNewGroup",value:function(){return As(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,o,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.store.selectedSamples.isComplete?this.props.store.selectedSamples.result:void 0,e.next=3,ts.Z.addGroup((0,es.$q)(this.inputGroupName,t,this.props.store.studyIds));case 3:o=e.sent,n=o.id,null!=(r=(0,ke.t)(this.inputGroupName))&&this.props.store.onGroupColorChange(n,r),this.props.store.notifyComparisonGroupsChange(),this.props.store.isLoggedIn||this.props.store.trackNewlyCreatedGroup(n),this.cancelAddGroup();case 10:case"end":return e.stop()}}),e,this)})))}},{key:"onGroupColorChange",value:function(e,t){return As(this,void 0,void 0,regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:this.props.onGroupColorChange&&this.props.onGroupColorChange(e.uid,t);case 1:case"end":return o.stop()}}),o,this)})))}},{key:"componentWillUnmount",value:function(){this.props.store.deleteMarkedComparisonGroups()}},{key:"render",value:function(){return n.createElement("div",{className:$a().comparisonGroupManager,style:{position:"relative"}},this.header,this.groupsSection.component,this.notificationMessages.length>0&&n.createElement(n.Fragment,null,n.createElement("br",null),n.createElement("i",{className:"text-warning"},"Note: ",this.notificationMessages)),this.actionButtons.component,n.createElement("hr",null),this.addGroupPanel)}},{key:"inputGroupName",get:function(){return this._inputGroupName}},{key:"header",get:function(){return n.createElement("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",marginTop:3,alignItems:"center",marginBottom:10}},n.createElement("div",{className:"btn-group",role:"group"},n.createElement("button",{className:"btn btn-default btn-xs",onClick:this.selectAllFiltered},"Select all",this.filteredGroups.isComplete?"(".concat(this.filteredGroups.result.length,")"):""),n.createElement("button",{className:"btn btn-default btn-xs",onClick:this.deselectAllFiltered},"Deselect all")),n.createElement("input",{className:"form-control",style:{right:0,width:140,height:25},type:"text",placeholder:"Search..",value:this.groupNameFilter,onChange:this.onChangeGroupNameFilter}))}},{key:"viewButton",get:function(){var e=this;return this.props.store.comparisonGroups.isComplete&&this.props.store.comparisonGroups.result.length>0?n.createElement("button",{className:"btn btn-sm btn-default",disabled:0===(0,es.Zd)(this.props.store.comparisonGroups.result,this.props.store).length,style:{marginLeft:7},onClick:function(){e.props.store.clearAllFilters(),e.props.store.updateComparisonGroupsFilter()}},"Filter"):null}},{key:"shareButton",get:function(){return this.props.store.comparisonGroups.isComplete&&this.props.store.comparisonGroups.result.length>0?n.createElement("button",{className:"btn btn-sm btn-default",disabled:0===(0,es.Zd)(this.props.store.comparisonGroups.result,this.props.store).length,style:{marginLeft:7},onClick:this.shareGroups},"Share"):null}},{key:"allGroupNames",get:function(){return this.props.store.comparisonGroups.isComplete?this.props.store.comparisonGroups.result.map((function(e){return e.name})):void 0}},{key:"submitNewGroupDisabled",get:function(){return!(this.props.store.selectedSamples.isComplete?this.props.store.selectedSamples.result:void 0)||0===this.inputGroupName.length||!this.allGroupNames||this.allGroupNames.includes(this.inputGroupName)}},{key:"compareButton",get:function(){var e=this;if(this.props.store.comparisonGroups.isComplete){var t=(0,es.Zd)(this.props.store.comparisonGroups.result,this.props.store).length,o=t>Jr.EC||t<2,r="";return r=this.props.store.comparisonGroups.result.length>=2?o?"Select between 2 and ".concat(Jr.EC," groups to enable comparison."):"Open a comparison session with selected groups":"Create at least two groups to open a comparison session",n.createElement(m.ZD,{overlay:r},n.createElement("button",{className:"btn btn-sm btn-primary",disabled:o,"data-event":(0,ur.XO)({action:"createCustomComparisonSession",label:this.props.store.comparisonGroups.result.length.toString(),category:"groupComparison"}),onClick:function(){return As(e,void 0,void 0,regeneratorRuntime.mark((function e(){var t,o,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.open((0,h.ds)({phase:gs.J.CREATING_SESSION}),"_blank"),e.next=3,(0,Va.C)((function(){return!!t.routingStore}));case 3:return o=(0,es.Zd)(this.props.store.comparisonGroups.result,this.props.store),e.next=6,ts.Z.addComparisonSession({groups:o,origin:this.props.store.studyIds});case 6:n=e.sent,r=n.id,(0,h.bf)(t,{comparisonId:r});case 9:case"end":return e.stop()}}),e,this)})))}},"Compare"))}return null}},{key:"addGroupPanel",get:function(){var e,t=this,o=this.props.store.selectedSamples.isComplete?this.props.store.selectedSamples.result:void 0;return e=this.addGroupPanelOpen?[n.createElement("div",{style:{display:"none",flexDirection:"row",justifyContent:"space-between",width:"100%",marginTop:3}},n.createElement("h5",null,"Add",o?" ".concat(o.length):""," ","selected samples"),n.createElement("button",{className:"btn btn-xs btn-default",style:{right:0,marginTop:-4},onClick:this.cancelAddGroup},"Cancel")),n.createElement("div",{style:{width:"100%",marginTop:7}},n.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%"}},n.createElement(m.ZD,{visible:this.allGroupNames&&this.allGroupNames.includes(this.inputGroupName),overlay:n.createElement("div",null,n.createElement("i",{className:"fa fa-md fa-exclamation-triangle",style:{color:"#BB1700",marginRight:5}}),n.createElement("span",null,Jr.Bj))},n.createElement("input",{className:"form-control",style:{marginRight:5},type:"text",placeholder:"Enter a name for your new group",value:this.inputGroupName,onChange:this.onChangeInputGroupName,onKeyPress:function(e){"Enter"!=e.key||t.submitNewGroupDisabled||t.onSubmitNewGroup()}})),n.createElement("button",{className:"btn btn-sm btn-primary",style:{width:58},onClick:this.onSubmitNewGroup,disabled:this.submitNewGroupDisabled},"Create")))]:n.createElement("button",{className:"btn btn-sm btn-primary","data-event":(0,ur.XO)({action:"createCustomGroup",label:"",category:"groupComparison"}),"data-test":"create-new-group-btn",onClick:this.showAddGroupPanel,disabled:!o,style:{width:"100%"}},"Create new group from selected samples"," ",o?" (".concat(o.length,")"):""),n.createElement("div",{style:{width:"100%"}},e)}},{key:"existSharedGroups",get:function(){return this.props.store.comparisonGroups.result.filter((function(e){return e.isSharedGroup})).length>0}},{key:"notificationMessages",get:function(){var e,t,o,r=this,i=[];return this.props.store.comparisonGroups.result.length>0&&(this.existSharedGroups&&i.push(n.createElement(n.Fragment,null,n.createElement("span",{className:V()((e={},t=$a().sharedGroup,o=!0,t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e))},"Highlighted rows")," ","are shared groups.")),!this.props.store.isLoggedIn&&this.props.store.appStore.isSocialAuthenticated?i.push(n.createElement(n.Fragment,null,n.createElement("br",null),"The groups above will not be saved without ",n.createElement("button",{className:"btn btn-default btn-xs",onClick:function(){return(0,Oa.U)(r.props.store.appStore)}},"Login"),n.createElement("br",null))):this.existSharedGroups&&i.push(n.createElement(n.Fragment,null,"They have been saved to your profile."))),i}}])&&Cs(o.prototype,r),a&&Cs(o,a),t}(n.Component);Os([l.observable],ks.prototype,"groupNameFilter",void 0),Os([l.observable],ks.prototype,"addGroupPanelOpen",void 0),Os([l.observable],ks.prototype,"_inputGroupName",void 0),Os([l.computed],ks.prototype,"inputGroupName",null),Os([l.observable],ks.prototype,"addSamplesTargetGroupId",void 0),Os([l.action.bound],ks.prototype,"onChangeGroupNameFilter",null),Os([l.action.bound],ks.prototype,"onChangeInputGroupName",null),Os([l.action.bound],ks.prototype,"showAddGroupPanel",null),Os([l.action.bound],ks.prototype,"cancelAddGroup",null),Os([l.action.bound],ks.prototype,"deleteGroup",null),Os([l.action.bound],ks.prototype,"selectAllFiltered",null),Os([l.action.bound],ks.prototype,"deselectAllFiltered",null),Os([g.default],ks.prototype,"restoreGroup",null),Os([g.default],ks.prototype,"shareSingleGroup",null),Os([g.default],ks.prototype,"shareGroups",null),Os([l.computed],ks.prototype,"allGroupNames",null),Os([l.computed],ks.prototype,"submitNewGroupDisabled",null),Os([l.action.bound],ks.prototype,"onSubmitNewGroup",null),Os([l.action.bound],ks.prototype,"onGroupColorChange",null),Os([l.computed],ks.prototype,"existSharedGroups",null),Os([l.computed],ks.prototype,"notificationMessages",null);const Ns=ks=Os([a.observer],ks);var Ps=o(99549),_s=o(90848),Rs=o(60727),Ms=o(83300),Ds=o(95497);function Is(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function xs(e){return(xs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ls(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function js(e,t){return(js=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Gs(e){return(Gs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Bs=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===("undefined"==typeof Reflect?"undefined":Gs(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Fs=function(e){function t(e){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=function(e,t){return!t||"object"!==Gs(t)&&"function"!=typeof t?Ls(e):t}(this,xs(t).call(this,e,{tab:{isSessionProp:!1},resourceUrl:{isSessionProp:!1}})),(0,l.makeObservable)(Ls(o)),o}var o,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&js(e,t)}(t,e),o=t,(n=[{key:"setTab",value:function(e){this.updateURL({},"".concat(Ds._.Study,"/").concat(e))}},{key:"setResourceUrl",value:function(e){this.updateURL({resourceUrl:e})}},{key:"tabId",get:function(){var e=new RegExp("".concat(Ds._.Study,"/(.+)")).exec(this.pathName);return e&&e[1]||c.rM.SUMMARY}}])&&Is(o.prototype,n),r&&Is(o,r),t}(Ms.Z);Bs([l.computed],Fs.prototype,"tabId",null);var Vs=o(30256),Us=o(2320);function Ws(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qs(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ks(e,t){return!t||"object"!==Xs(t)&&"function"!=typeof t?Ys(e):t}function Hs(e){return(Hs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ys(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zs(e,t){return(zs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Xs(e){return(Xs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Qs=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===("undefined"==typeof Reflect?"undefined":Xs(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Zs="Files & Links",Js=function(e){function t(){var e;return Ws(this,t),e=Ks(this,Hs(t).apply(this,arguments)),Object.defineProperty(Ys(e),"studyResources",{enumerable:!0,configurable:!0,writable:!0,value:(0,ca.F)({await:function(){return[e.props.store.studyResourceData,e.props.store.queriedPhysicalStudies]},render:function(){return e.props.store.studyResourceData.result.length>0?n.createElement("div",{className:"resourcesSection"},n.createElement("h4",{className:"blackHeader"},"Study Resources for"," ",e.props.store.queriedPhysicalStudies.result[0].name),i().sortBy(e.props.store.studyResourceData.result,(function(e){return parseFloat(e.resourceDefinition.priority)})).map((function(t){return n.createElement(Us.Z,{resource:t,isTabOpen:e.props.store.isResourceTabOpen,openResource:e.props.openResource})}))):null}})}),e}var o,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zs(e,t)}(t,e),o=t,(r=[{key:"render",value:function(){return n.createElement("div",{className:"resourcesTab"},n.createElement(Vs.Z,{title:Zs,isLoading:this.studyResources.isPending,className:"pull-left"}),n.createElement("br",null),n.createElement("br",null),n.createElement("div",null,this.studyResources.component))}}])&&qs(o.prototype,r),a&&qs(o,a),t}(n.Component);const $s=Js=Qs([a.observer],Js);var el=o(77906),tl=o.n(el),ol=o(97513),nl=o(37395),rl=o(7706),il=o(37687);function al(e){return function(e){if(Array.isArray(e)){for(var t=0,o=new Array(e.length);t<e.length;t++)o[t]=e[t];return o}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function sl(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ll(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ul(e,t,o){return t&&ll(e.prototype,t),o&&ll(e,o),e}function cl(e,t){return!t||"object"!==ml(t)&&"function"!=typeof t?pl(e):t}function pl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dl(e){return(dl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function hl(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fl(e,t)}function fl(e,t){return(fl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ml(e){return(ml="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var yl=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===("undefined"==typeof Reflect?"undefined":ml(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},bl=function(e,t,o,n){return new(o||(o=Promise))((function(r,i){function a(e){try{l(n.next(e))}catch(e){i(e)}}function s(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))},gl=function(e){function t(){return sl(this,t),cl(this,dl(t).apply(this,arguments))}return hl(t,e),ul(t,[{key:"render",value:function(){return n.createElement("div",{className:Rr().selectedInfo,"data-test":"selected-info"},n.createElement("strong",null,"Selected:"),n.createElement("strong",{"data-test":"selected-patients"},this.props.store.selectedPatients.length.toLocaleString()),"",n.createElement("strong",null,"patients"),"|",n.createElement("strong",{"data-test":"selected-samples"},this.props.store.selectedSamples.result.length.toLocaleString()),"",n.createElement("strong",null,"samples"))}}]),t}(n.Component);gl=yl([a.observer],gl);var vl=function(e){function t(e){var o;sl(this,t),o=cl(this,dl(t).call(this,e)),Object.defineProperty(pl(o),"urlWrapper",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(pl(o),"store",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(pl(o),"enableCustomSelectionInTabs",{enumerable:!0,configurable:!0,writable:!0,value:[c.rM.SUMMARY,c.rM.CLINICAL_DATA,c.rM.CN_SEGMENTS]}),Object.defineProperty(pl(o),"enableAddChartInTabs",{enumerable:!0,configurable:!0,writable:!0,value:[c.rM.SUMMARY,c.rM.CLINICAL_DATA]}),Object.defineProperty(pl(o),"toolbar",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(pl(o),"toolbarLeftUpdater",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(pl(o),"toolbarLeft",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(pl(o),"showCustomSelectTooltip",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(pl(o),"showAlterationFilterTooltip",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(pl(o),"showReturnToDefaultChartListModal",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(pl(o),"showBookmarkModal",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(pl(o),"shareLinkModal",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(pl(o),"getShareBookmarkUrl",{enumerable:!0,configurable:!0,writable:!0,value:Promise.resolve(null)}),Object.defineProperty(pl(o),"sharedGroups",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(pl(o),"shareCustomDataLinkModal",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(pl(o),"getShareCustomChartBookmarkUrl",{enumerable:!0,configurable:!0,writable:!0,value:Promise.resolve(null)}),Object.defineProperty(pl(o),"chartDataPromises",{enumerable:!0,configurable:!0,writable:!0,value:(0,m.$w)({await:function(){return[].concat(al(i().values(o.store.clinicalDataBinPromises)),al(i().values(o.store.clinicalDataCountPromises)),al(i().values(o.store.genericAssayDataCountPromises)),[o.store.mutationProfiles,o.store.cnaProfiles,o.store.selectedSamples,o.store.molecularProfileSampleCounts,o.store.sampleTreatments,o.store.patientTreatments,o.store.patientTreatmentGroups,o.store.sampleTreatmentGroups])},invoke:function(){return bl(pl(o),void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,Va._)(10);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}})}),Object.defineProperty(pl(o),"resourceTabs",{enumerable:!0,configurable:!0,writable:!0,value:(0,ca.F)({await:function(){return[o.store.resourceDefinitions,o.store.resourceIdToResourceData]},render:function(){var e=o.store.resourceDefinitions.result.filter((function(e){return o.store.isResourceTabOpen(e.resourceId)})),t=i().sortBy(e,(function(e){return e.priority})),r=o.store.resourceIdToResourceData.result;return t.reduce((function(e,t){var i=r[t.resourceId];return i&&i.length>0&&e.push(n.createElement(s.l6,{key:(0,c.f6)(t.resourceId),id:(0,c.f6)(t.resourceId),linkText:t.displayName,onClickClose:o.closeResourceTab},n.createElement(Rs.Z,{resourceData:r[t.resourceId],urlWrapper:o.urlWrapper}))),e}),[])}})}),Object.defineProperty(pl(o),"body",{enumerable:!0,configurable:!0,writable:!0,value:(0,ca.F)({await:function(){return[o.store.unknownQueriedIds,o.store.queriedPhysicalStudyIds]},render:function(){if(o.store.unknownQueriedIds.result.length&&0===o.store.queriedPhysicalStudyIds.result.length){var e=o.store.unknownQueriedIds.result.length>1?"Studies":"Study";return n.createElement(rl.Z,{title:"Unknown/Unauthorized ".concat(e),body:"The following studies are unknown or you lack privileges to view them:\n                            ".concat(o.store.unknownQueriedIds.result.join(", "),"\n                            ")})}return o.content()}})}),(0,l.makeObservable)(pl(o)),o.urlWrapper=new Fs(o.props.routing),o.store=new u.NB(o.props.appStore,Qn.v4.sessionServiceIsEnabled(),o.urlWrapper);var r=o.urlWrapper.tabId&&(0,c.tz)(o.urlWrapper.tabId);if(r&&o.store.setResourceTabOpen(r,!0),(0,m.hZ)().studyPage=pl(o),!(0,m.hZ)().globalStores.routing.location.pathname.includes("/study"))return cl(o);var a=e.routing.query,p=e.routing.location.hash;e.routing.location.hash="";var d=i().pick(a,["id","studyId","cancer_study_id","filterAttributeId","filterValues"]);d.filterJson=a.filters;var h=p||(0,m.hZ)().studyPageFilter;if(delete window.studyPageFilter,h){var f=(0,ol.parse)(h);f.filterJson&&(d.filterJson=f.filterJson),f.sharedGroups&&(d.sharedGroups=f.sharedGroups),f.sharedCustomData&&(d.sharedCustomData=f.sharedCustomData)}return i().isEqual(d,o.store.studyViewQueryFilter)||(o.store.updateStoreFromURL(d),o.store.studyViewQueryFilter=d),(0,m.XE)(o.store.queriedPhysicalStudyIds,(function(e){var t,n,r;(0,ur.L9)({category:"studyPage",action:"studyPageLoad",label:e.join(",")+",",fieldsObject:(t={},n=ur.lh.VirtualStudy,r=(o.store.filteredVirtualStudies.result.length>0).toString(),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t)})})),o}return hl(t,e),ul(t,[{key:"componentDidMount",value:function(){var e=this;this.props.routing.updateRoute({},"study/".concat(this.store.currentTab),!1,!0),this.toolbarLeftUpdater=setInterval((function(){e.toolbar&&(e.toolbarLeft=tl()(e.toolbar).position().left)}),500)}},{key:"toolbarRef",value:function(e){this.toolbar=e}},{key:"handleTabChange",value:function(e){this.urlWrapper.setTab(e)}},{key:"toggleBookmarkModal",value:function(){this.showBookmarkModal=!this.showBookmarkModal}},{key:"toggleShareLinkModal",value:function(){this.shareLinkModal=!this.shareLinkModal,this.sharedGroups=[]}},{key:"toggleShareCustomDataLinkModal",value:function(){this.shareCustomDataLinkModal=!this.shareCustomDataLinkModal}},{key:"openShareUrlModal",value:function(e){this.shareLinkModal=!0,this.sharedGroups=e;var t=e.map((function(e){return e.uid}));this.getShareBookmarkUrl=Promise.resolve({bitlyUrl:void 0,fullUrl:"".concat(window.location.protocol,"//").concat(window.location.host).concat(window.location.pathname).concat(window.location.search,"#sharedGroups=").concat(t.join(",")),sessionUrl:void 0})}},{key:"openShareCustomDataUrlModal",value:function(e){this.shareCustomDataLinkModal=!0,this.getShareCustomChartBookmarkUrl=Promise.resolve({bitlyUrl:void 0,fullUrl:"".concat(window.location.protocol,"//").concat(window.location.host).concat(window.location.pathname).concat(window.location.search,"#sharedCustomData=").concat(e.join(",")),sessionUrl:void 0})}},{key:"onBookmarkClick",value:function(){this.toggleBookmarkModal()}},{key:"openResource",value:function(e){this.store.setResourceTabOpen(e.resourceId,!0),this.urlWrapper.setTab((0,c.f6)(e.resourceId)),this.urlWrapper.setResourceUrl(e.url)}},{key:"closeResourceTab",value:function(e){var t=(0,c.tz)(e);t&&(this.store.setResourceTabOpen(t,!1),this.urlWrapper.tabId===(0,c.f6)(t)&&this.urlWrapper.setTab(c.rM.FILES_AND_LINKS))}},{key:"getBookmarkUrl",value:function(){return bl(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,_s.k)(this.studyViewFullUrlWithFilter,(0,Qn.Ib)().bitly_access_token);case 2:return t=e.sent,e.abrupt("return",{bitlyUrl:t,fullUrl:this.studyViewFullUrlWithFilter,sessionUrl:void 0});case 4:case"end":return e.stop()}}),e,this)})))}},{key:"content",value:function(){var e=this;return n.createElement("div",{className:"studyView"},this.showBookmarkModal&&n.createElement(Ps.S,{onHide:this.toggleBookmarkModal,title:"Bookmark this filter",urlPromise:this.getBookmarkUrl()}),this.shareLinkModal&&n.createElement(Ps.S,{onHide:this.toggleShareLinkModal,title:this.sharedGroups.length>1?"Share ".concat(this.sharedGroups.length," Groups"):"Share Group",urlPromise:this.getShareBookmarkUrl,description:"Please send the following link to users with whom you want to share the selected group(s)."}),this.shareCustomDataLinkModal&&n.createElement(Ps.S,{onHide:this.toggleShareCustomDataLinkModal,title:"Share custom data",urlPromise:this.getShareCustomChartBookmarkUrl,description:"Please send the following link to users with whom you want to share the selected custom data"}),this.store.comparisonConfirmationModal,this.store.queriedSampleIdentifiers.isComplete&&this.store.invalidSampleIds.isComplete&&this.store.unknownQueriedIds.isComplete&&this.store.displayedStudies.isComplete&&this.store.queriedPhysicalStudies.isComplete&&this.store.queriedPhysicalStudies.result.length>0&&n.createElement("div",null,n.createElement(fi,{store:this.store,onBookmarkClick:this.onBookmarkClick}),n.createElement("div",{className:Rr().mainTabs},n.createElement(s.Kh,{id:"studyViewTabs",activeTabId:this.store.currentTab,onTabClick:function(t){return e.handleTabChange(t)},className:"mainTabs",unmountOnHide:!1,getPaginationWidth:function(){return e.toolbarLeft},contentWindowExtra:n.createElement(il.v,{path:this.props.routing.location.pathname}),hrefRoot:(0,h.gN)("study")},n.createElement(s.l6,{key:0,id:c.rM.SUMMARY,linkText:u.gp.SUMMARY},n.createElement(ir,{store:this.store})),n.createElement(s.l6,{key:1,id:c.rM.CLINICAL_DATA,linkText:u.gp.CLINICAL_DATA,hide:0===this.store.selectedSamples.result.length},n.createElement(R,{store:this.store})),n.createElement(s.l6,{key:2,id:c.rM.HEATMAPS,linkText:u.gp.HEATMAPS,hide:0===this.store.MDACCHeatmapStudyMeta.result.length},n.createElement(D.Z,{className:"mdacc-heatmap-iframe",url:"https://bioinformatics.mdanderson.org/TCGA/NGCHMPortal/?".concat(this.store.MDACCHeatmapStudyMeta.result[0])})),n.createElement(s.l6,{key:3,id:c.rM.CN_SEGMENTS,linkText:u.gp.CN_SEGMENTS,hide:this.store.hasCNSegmentData.isPending||!this.store.hasCNSegmentData.result},n.createElement(Ai,{store:this.store})),n.createElement(s.l6,{key:4,id:c.rM.FILES_AND_LINKS,linkText:Zs,hide:!this.shouldShowResources},n.createElement("div",null,n.createElement($s,{store:this.store,openResource:this.openResource}))),this.resourceTabs.component),n.createElement("div",{ref:this.toolbarRef,className:Rr().absolutePanel},n.createElement(a.Observer,null,(function(){var t=n.createElement(gl,{store:e.store,appStore:e.props.appStore,loadingComplete:e.chartDataPromises.isComplete}),o=n.createElement(Za,{store:e.store,appStore:e.props.appStore,loadingComplete:e.chartDataPromises.isComplete});return n.createElement("div",{className:Rr().studyFilterResult},n.createElement(y.If,{condition:e.store.selectedSamples.isComplete},n.createElement(y.Then,null,t,o),n.createElement(y.Else,null,n.createElement(p.Z,{isLoading:!0,size:"small",className:Rr().selectedInfoLoadingIndicator}),o)))})),n.createElement("div",{id:"comparisonGroupManagerContainer",style:{display:"flex",position:"relative"}},this.enableCustomSelectionInTabs.includes(this.store.currentTab)&&n.createElement(n.Fragment,null,n.createElement(m.ZD,{visible:this.showCustomSelectTooltip,trigger:["click"],placement:"bottomLeft",onVisibleChange:function(t){return e.showCustomSelectTooltip=!!t},destroyTooltipOnHide:!0,overlay:function(){return n.createElement("div",{style:{width:"350px"}},n.createElement(Zi,{allSamples:e.store.samples.result,selectedSamples:e.store.selectedSamples.result,disableGrouping:!0,queriedStudies:e.store.queriedPhysicalStudyIds.result,onSubmit:function(t){e.showCustomSelectTooltip=!1,e.store.updateCustomSelect(t)}}))}},n.createElement("button",{className:V()("btn btn-primary btn-sm",{active:this.showCustomSelectTooltip}),"aria-pressed":this.showCustomSelectTooltip,"data-test":"custom-selection-button",style:{marginLeft:"10px"}},(0,f.Vj)("Custom Selection")))),(0,Qn.Ib)().skin_show_settings_menu&&n.createElement(m.ZD,{trigger:["click"],placement:"bottomLeft",overlay:n.createElement(nl.Z,{store:this.store,infoElement:n.createElement(f.aI,{includeCnaTable:this.store.hasCnaProfileData}),customDriverSourceName:(0,Qn.Ib)().oncoprint_custom_driver_annotation_binary_menu_label,showDriverAnnotationSection:this.store.doShowDriverAnnotationSectionInGlobalMenu,showTierAnnotationSection:this.store.doShowTierAnnotationSectionInGlobalMenu}),visible:this.showAlterationFilterTooltip,onVisibleChange:function(t){e.showAlterationFilterTooltip=!!t}},n.createElement("button",{"data-test":"AlterationFilterButton",style:{marginLeft:"10px"},className:"btn btn-primary btn-sm"},(0,f.Vj)("Alteration Filter"))),this.enableAddChartInTabs.includes(this.store.currentTab)&&n.createElement(Fa,{buttonText:this.addChartButtonText,store:this.store,currentTab:this.store.currentTab,defaultActiveTab:this.store.showCustomDataSelectionUI?f.E4.CUSTOM_DATA:f.E4.CLINICAL,addChartOverlayClassName:"studyViewAddChartOverlay",disableCustomTab:this.store.currentTab===c.rM.CLINICAL_DATA,disableGeneSpecificTab:this.store.currentTab===c.rM.CLINICAL_DATA,disableGenericAssayTabs:this.store.currentTab===c.rM.CLINICAL_DATA,showResetPopup:function(){e.showReturnToDefaultChartListModal=!0},openShareCustomDataUrlModal:this.openShareCustomDataUrlModal,isShareLinkModalVisible:this.shareCustomDataLinkModal}),n.createElement(q.Modal,{bsSize:"small",show:this.showReturnToDefaultChartListModal,onHide:function(){e.showReturnToDefaultChartListModal=!1},keyboard:!0},n.createElement(q.Modal.Header,{closeButton:!0},n.createElement(q.Modal.Title,null,"Reset charts")),n.createElement(q.Modal.Body,null,n.createElement("div",null,"Please confirm that you would like to replace the current charts with the default list.")),n.createElement(q.Modal.Footer,null,n.createElement("button",{className:"btn btn-primary btn-sm",style:{marginTop:"10px",marginBottom:"0"},onClick:function(){e.store.resetToDefaultChartSettings(),e.showReturnToDefaultChartListModal=!1}},"Confirm"),n.createElement("button",{className:"btn btn-primary btn-sm",style:{marginTop:"10px",marginBottom:"0"},onClick:function(){e.showReturnToDefaultChartListModal=!1}},"Cancel"))),Qn.v4.sessionServiceIsEnabled()&&this.groupsButton)))))}},{key:"componentWillUnmount",value:function(){this.store.destroy(),clearInterval(this.toolbarLeftUpdater)}},{key:"render",value:function(){return n.createElement(M.X,{noMargin:!0,hideFooter:!0,className:"subhead-dark"},n.createElement(p.Z,{size:"big",isLoading:this.store.queriedSampleIdentifiers.isPending||this.store.invalidSampleIds.isPending||this.body.isPending,center:!0}),this.body.component)}},{key:"shouldShowResources",get:function(){return!!this.store.resourceIdToResourceData.isComplete&&i().some(this.store.resourceIdToResourceData.result,(function(e){return e.length>0}))}},{key:"studyViewFullUrlWithFilter",get:function(){return"".concat(window.location.protocol,"//").concat(window.location.host).concat(window.location.pathname).concat(window.location.search,"#filterJson=").concat(JSON.stringify(this.store.filters))}},{key:"addChartButtonText",get:function(){return this.store.currentTab===c.rM.SUMMARY?(0,f.Vj)("Charts"):this.store.currentTab===c.rM.CLINICAL_DATA?(0,f.Vj)("Columns"):""}},{key:"groupsButton",get:function(){var e=this;return n.createElement(n.Fragment,null,n.createElement(m.ZD,{visible:this.store.showComparisonGroupUI,trigger:["click"],placement:"bottomLeft",destroyTooltipOnHide:!0,onPopupAlign:function(e){e.querySelector(".rc-tooltip-arrow").style.right="10px"},onVisibleChange:function(t){0!=e.store.numberOfVisibleColorChooserModals||e.shareLinkModal||(e.store.showComparisonGroupUI=!!t)},getTooltipContainer:function(){return document.getElementById("comparisonGroupManagerContainer")},overlay:n.createElement("div",{style:{width:350}},n.createElement(Ns,{store:this.store,shareGroups:this.openShareUrlModal,onGroupColorChange:this.store.onGroupColorChange}))},n.createElement("button",{className:V()("btn btn-primary btn-xs",{active:this.store.showComparisonGroupUI}),id:"groupManagementButton","data-test":"groups-button","aria-pressed":this.store.showComparisonGroupUI,style:{marginLeft:"10px"},"data-event":(0,ur.XO)({action:"openGroupManagement",label:"",category:"groupComparison"})},(0,f.Vj)("Groups"))))}}]),t}(n.Component);yl([l.observable],vl.prototype,"toolbarLeft",void 0),yl([l.observable],vl.prototype,"showCustomSelectTooltip",void 0),yl([l.observable],vl.prototype,"showAlterationFilterTooltip",void 0),yl([l.observable],vl.prototype,"showReturnToDefaultChartListModal",void 0),yl([g.default],vl.prototype,"toolbarRef",null),yl([l.observable],vl.prototype,"showBookmarkModal",void 0),yl([l.action.bound],vl.prototype,"toggleBookmarkModal",null),yl([l.observable],vl.prototype,"shareLinkModal",void 0),yl([l.action.bound],vl.prototype,"toggleShareLinkModal",null),yl([l.action.bound],vl.prototype,"toggleShareCustomDataLinkModal",null),yl([l.observable],vl.prototype,"shareCustomDataLinkModal",void 0),yl([l.action.bound],vl.prototype,"openShareUrlModal",null),yl([l.action.bound],vl.prototype,"openShareCustomDataUrlModal",null),yl([g.default],vl.prototype,"onBookmarkClick",null),yl([l.action.bound],vl.prototype,"openResource",null),yl([l.action.bound],vl.prototype,"closeResourceTab",null),yl([l.computed],vl.prototype,"shouldShowResources",null),yl([l.computed],vl.prototype,"studyViewFullUrlWithFilter",null),yl([l.computed],vl.prototype,"addChartButtonText",null),yl([l.computed],vl.prototype,"groupsButton",null);const Cl=vl=yl([(0,a.inject)("routing","appStore"),a.observer],vl)},9405:(e,t,o)=>{"use strict";o.d(t,{x:()=>p});var n=o(88034),r=o(58997);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){function t(){return a(this,t),l(this,u(t).apply(this,arguments))}var o,i,p;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(t,e),o=t,(i=[{key:"render",value:function(){var e=this;return n.createElement("a",{className:"dataset-table-download-link",style:{display:"block"},href:"https://cbioportal-datahub.s3.amazonaws.com/"+this.props.studyId+".tar.gz",download:!0,onClick:function(){return(0,r.L9)({category:"download",action:"study download",label:e.props.studyId})}},n.createElement("i",{className:"fa fa-download"}))}}])&&s(o.prototype,i),p&&s(o,p),t}(n.Component)},60727:(e,t,o)=>{"use strict";o.d(t,{Z:()=>w});var n=o(88034),r=o(27808),i=o(30256),a=o(64577),s=o(78566),l=o(93624),u=o.n(l),c=o(76127),p=o.n(c),d=o(65587),h=o(56719);function f(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function m(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var C=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===("undefined"==typeof Reflect?"undefined":v(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},S=function(e){function t(e){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=function(e,t){return!t||"object"!==v(t)&&"function"!=typeof t?b(e):t}(this,y(t).call(this,e)),(0,s.makeObservable)(b(o)),o}var o,r,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(t,e),o=t,(r=[{key:"goToNextDatum",value:function(){this.isLastDatum||this.props.urlWrapper.setResourceUrl(this.props.resourceData[this.currentResourceIndex+1].url)}},{key:"goToPrevDatum",value:function(){this.isFirstDatum||this.props.urlWrapper.setResourceUrl(this.props.resourceData[this.currentResourceIndex-1].url)}},{key:"render",value:function(){var e=this.props.resourceData.length>1;return n.createElement("div",null,n.createElement(i.Z,{title:this.currentResourceDatum.resourceDefinition.displayName,isLoading:!1,className:"pull-left",style:{marginBottom:10}}),n.createElement("div",{style:{width:"100%",height:this.iframeHeight,display:"flex",alignItems:"center"}},e&&n.createElement("div",{className:p()(u().carouselButton,f({},u().active,!this.isFirstDatum)),onClick:this.goToPrevDatum},n.createElement("i",{style:{marginRight:15},className:"fa fa-4x fa-chevron-left"})),this.httpIframeWithHttpsPortal?n.createElement("div",null,n.createElement("span",null,"We can't show this URL in the portal. Please use the link below:"),n.createElement("br",null),n.createElement("a",{href:this.currentResourceDatum.url},this.currentResourceDatum.url)):n.createElement("iframe",{src:this.iframeUrl,style:{width:"100%",height:"100%"}}),e&&n.createElement("div",{className:p()(u().carouselButton,f({},u().active,!this.isLastDatum)),onClick:this.goToNextDatum},n.createElement("i",{style:{marginLeft:15},className:"fa fa-4x fa-chevron-right"}))))}},{key:"iframeHeight",get:function(){return a.Z.size.height-275}},{key:"currentResourceIndex",get:function(){var e=this;if(this.props.urlWrapper.query.resourceUrl){var t=this.props.resourceData.findIndex((function(t){return t.url===e.props.urlWrapper.query.resourceUrl}));return-1===t?0:t}return 0}},{key:"currentResourceDatum",get:function(){return this.props.resourceData[this.currentResourceIndex]}},{key:"isFirstDatum",get:function(){return 0===this.currentResourceIndex}},{key:"isLastDatum",get:function(){return this.currentResourceIndex===this.props.resourceData.length-1}},{key:"httpIframeWithHttpsPortal",get:function(){return"https:"===(0,d.hZ)().location.protocol&&"http:"===new URL(this.currentResourceDatum.url).protocol}},{key:"iframeUrl",get:function(){var e=(0,h.m)(this.currentResourceDatum.url),t=this.currentResourceDatum.url;switch(e){case"pdf":t=(0,h.r)(this.currentResourceDatum.url)}return t}}])&&m(o.prototype,r),l&&m(o,l),t}(n.Component);C([s.computed],S.prototype,"iframeHeight",null),C([s.computed],S.prototype,"currentResourceIndex",null),C([s.computed],S.prototype,"currentResourceDatum",null),C([s.action.bound],S.prototype,"goToNextDatum",null),C([s.action.bound],S.prototype,"goToPrevDatum",null),C([s.computed],S.prototype,"isFirstDatum",null),C([s.computed],S.prototype,"isLastDatum",null),C([s.computed],S.prototype,"httpIframeWithHttpsPortal",null),C([s.computed],S.prototype,"iframeUrl",null);const w=S=C([r.observer],S)},25290:e=>{e.exports={portalWidth:"styles-module__portalWidth__1nrF_",framedImage:"styles-module__framedImage__30VqV",body:"styles-module__body__1rzI0",invalid:"styles-module__invalid__2aTxj",valid:"styles-module__valid__ayiQx",selection:"styles-module__selection__iEp5C",selectionText:"styles-module__selectionText__oWsS9",operations:"styles-module__operations__3fdLE"}},44743:e=>{e.exports={portalWidth:"styles-module__portalWidth__3vtVw",framedImage:"styles-module__framedImage__3P2Qv",oqlerror:"styles-module__oqlerror__1o_bc",operations:"styles-module__operations__2I3K7"}},63656:e=>{e.exports={portalWidth:"styles-module__portalWidth__1fUOQ",framedImage:"styles-module__framedImage__2d1Ka",modalHeader:"styles-module__modalHeader__JllNW",addChart:"styles-module__addChart__1wwdE",child:"styles-module__child__1RDTc",childContent:"styles-module__childContent__3qjw6",faCharC:"styles-module__faCharC__1Juo6",faCharG:"styles-module__faCharG__1M9-6",sharedChart:"styles-module__sharedChart__JehFS"}},31821:e=>{e.exports={portalWidth:"styles-module__portalWidth__18DKo",framedImage:"styles-module__framedImage__24p2j",header:"styles-module__header__1aeAb",name:"styles-module__name__1XFGq",draggable:"styles-module__draggable__3RmmQ",controls:"styles-module__controls__1BH85",menuToggle:"styles-module__menuToggle__1KWSD",item:"styles-module__item__2oGTK",menuItemIcon:"styles-module__menuItemIcon__1T8eb",disabledMenuItem:"styles-module__disabledMenuItem__18WAz",survivalIcon:"styles-module__survivalIcon__20yGX",clickable:"styles-module__clickable__2tZDi",undo:"styles-module__undo__1M88I",downloadControl:"styles-module__downloadControl___BLbx",dropdownHoverEffect:"styles-module__dropdownHoverEffect__30h85"}},70956:e=>{e.exports={portalWidth:"styles-module__portalWidth__1-dsc",framedImage:"styles-module__framedImage__1-X5s",chart:"styles-module__chart__RXir-",highlight:"styles-module__highlight__1DVtC",chartHeightOne:"styles-module__chartHeightOne__1EZ41",chartHeightTwo:"styles-module__chartHeightTwo__38Rdk",chartWidthOne:"styles-module__chartWidthOne__6k_oz",chartWidthTwo:"styles-module__chartWidthTwo__DZIFm",chartLoader:"styles-module__chartLoader__1WwZ2",chartError:"styles-module__chartError__21C0i",chartInnerWrapper:"styles-module__chartInnerWrapper__1ttrJ"}},68824:e=>{e.exports={portalWidth:"styles-module__portalWidth__21Wnc",framedImage:"styles-module__framedImage__2DLAM",main:"styles-module__main__6UjQ_",text:"styles-module__text__3EbPk",mostLeft:"styles-module__mostLeft__1HcgP",mostRight:"styles-module__mostRight__OHotS"}},28358:e=>{e.exports={portalWidth:"styles-module__portalWidth__2G9Ld",framedImage:"styles-module__framedImage__36jTC",rightPanel:"styles-module__rightPanel__1LNa2",summary:"styles-module__summary__3bP5G",description:"styles-module__description__3ShDq",submitQuery:"styles-module__submitQuery__3EV3t",iconGroup:"styles-module__iconGroup__1K9m4",studyLinks:"styles-module__studyLinks__ON9F9"}},2028:e=>{e.exports={portalWidth:"studySummaryTabStyles-module__portalWidth__E_ZYO",framedImage:"studySummaryTabStyles-module__framedImage__2SfLL",studyViewFlexContainer:"studySummaryTabStyles-module__studyViewFlexContainer__2qzDx",studyViewNoSamples:"studySummaryTabStyles-module__studyViewNoSamples__25ZnH",studyViewNoSamplesInner:"studySummaryTabStyles-module__studyViewNoSamplesInner__2CP0d",quickFilters:"studySummaryTabStyles-module__quickFilters__3jA-o"}},92576:e=>{e.exports={portalWidth:"styles-module__portalWidth__3RN1K",framedImage:"styles-module__framedImage__1q4ml",main:"styles-module__main__1M4Pn",content:"styles-module__content__-z-NW",delete:"styles-module__delete__3E7Yr"}},93624:e=>{e.exports={portalWidth:"styles-module__portalWidth__3mtfh",framedImage:"styles-module__framedImage__24LeD",carouselButton:"styles-module__carouselButton__35zgJ",active:"styles-module__active__xJZuN"}},80440:e=>{e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxNi4wLjQsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+DQo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB3aWR0aD0iMTguNzI5cHgiIGhlaWdodD0iOS41NTdweCIgdmlld0JveD0iMCAwIDE4LjcyOSA5LjU1NyIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMTguNzI5IDkuNTU3IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnPg0KCTxwYXRoIGQ9Ik0xLjg4OSw5LjM0NEwwLjM5MywwLjIxM2gxLjUxM2wwLjc4Myw1LjAzYzAuMDg2LDAuNTUsMC4xOTIsMS40NDcsMC4zMTgsMi42OWMwLjI5OC0wLjY0NywwLjY3OS0xLjM5LDEuMTQ0LTIuMjI3DQoJCWwzLjA1Mi01LjQ5NGgxLjY0M0wzLjYxNyw5LjM0NEgxLjg4OXoiLz4NCgk8cGF0aCBkPSJNOC4wOTQsNi4yMjNMOS42NSw2LjEyOGMwLDAuNDQ3LDAuMDY4LDAuODI5LDAuMjA2LDEuMTQ0YzAuMTM4LDAuMzE1LDAuMzkyLDAuNTczLDAuNzYxLDAuNzc0DQoJCWMwLjM3LDAuMiwwLjgwMSwwLjMwMSwxLjI5NCwwLjMwMWMwLjY4OCwwLDEuMjA0LTAuMTM4LDEuNTQ4LTAuNDEzczAuNTE2LTAuNTk5LDAuNTE2LTAuOTcyYzAtMC4yNy0wLjEwMy0wLjUyNC0wLjMxLTAuNzY1DQoJCWMtMC4yMTItMC4yNDEtMC43MjktMC41MzctMS41NTItMC44OXMtMS4zNDktMC42MDEtMS41NzctMC43NDRjLTAuMzg1LTAuMjM1LTAuNjc0LTAuNTEyLTAuODY5LTAuODMNCgkJQzkuNDczLDMuNDE2LDkuMzc1LDMuMDUsOS4zNzUsMi42MzhjMC0wLjcyMiwwLjI4Ny0xLjM0MSwwLjg2LTEuODU3YzAuNTcyLTAuNTE2LDEuMzc1LTAuNzc0LDIuNDA3LTAuNzc0DQoJCWMxLjE0NiwwLDIuMDE5LDAuMjY1LDIuNjE3LDAuNzk1YzAuNiwwLjUzLDAuOTEsMS4yMjgsMC45MzQsMi4wOTNsLTEuNTIyLDAuMTAzYy0wLjAyMi0wLjU1LTAuMjE4LTAuOTg1LTAuNTg0LTEuMzA3DQoJCUMxMy43MiwxLjM3MSwxMy4yMDEsMS4yMSwxMi41MywxLjIxYy0wLjUzOSwwLTAuOTU3LDAuMTIzLTEuMjU1LDAuMzdzLTAuNDQ3LDAuNTEzLTAuNDQ3LDAuOHMwLjEyOSwwLjUzOSwwLjM4NywwLjc1Ng0KCQljMC4xNzIsMC4xNDksMC42MTYsMC4zNzgsMS4zMzMsMC42ODhDMTMuNzQsNC4zNCwxNC40OSw0Ljc0NywxNC44LDUuMDQ1YzAuNDkzLDAuNDc2LDAuNzQsMS4wNTUsMC43NCwxLjczNg0KCQljMCwwLjQ1My0wLjE0LDAuODk3LTAuNDE3LDEuMzMzYy0wLjI3OCwwLjQzNi0wLjcwMiwwLjc4NC0xLjI3MiwxLjA0NUMxMy4yNzksOS40MiwxMi42MDcsOS41NSwxMS44MzQsOS41NQ0KCQljLTEuMDU1LDAtMS45NTEtMC4yNjEtMi42OTEtMC43ODJDOC40MDMsOC4yNDYsOC4wNTQsNy4zOTcsOC4wOTQsNi4yMjN6Ii8+DQoJPHBhdGggZD0iTTE2LjU5OCw5LjM0NGwwLjM2OS0xLjc2M2gxLjc2M2wtMC4zNzgsMS43NjNIMTYuNTk4eiIvPg0KPC9nPg0KPC9zdmc+DQo="}}]);