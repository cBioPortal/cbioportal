(function(r,p){"function"==typeof define&&define.amd?define(["./rangy-core"],r):"undefined"!=typeof module&&"object"==typeof exports?module.exports=r(require("rangy")):r(p.rangy)})(function(r){r.createModule("TextRange",["WrappedSelection"],function(p,r){function ea(a,c){for(var b=a.slice(c.start,c.end),d={isWord:c.isWord,chars:b,toString:function(){return b.join("")}},e=0,f=b.length;e<f;++e)b[e].token=d;return d}function F(a,c,b){c=b(a,c);b=[];for(var d=0,e;e=c[d++];)b.push(ea(a,e));return b}function fa(a){a=
a||"";a="string"==typeof a?a.split(""):a;a.sort(function(a,b){return a.charCodeAt(0)-b.charCodeAt(0)});return a.join("").replace(/(.)\1+/g,"$1")}function B(a,c){var b=y(a,c);if(c.hasOwnProperty("wordOptions")){var d;d=b.wordOptions;var e,f;d?(e=d.language||"en",f={},u(f,G[e]||G.en),u(f,d),d=f):d=G.en;b.wordOptions=d}c.hasOwnProperty("characterOptions")&&(b.characterOptions=y(b.characterOptions,H));return b}function C(a,c){var b=z(a,"display",c),d=a.tagName.toLowerCase();return"block"==b&&P&&Q.hasOwnProperty(d)?
Q[d]:b}function R(a){for(var c=a,b=[];c.parentNode;)b.unshift(c.parentNode),c=c.parentNode;a=b.concat([a]);c=0;for(b=a.length;c<b;++c)if(1==a[c].nodeType&&"none"==C(a[c]))return!0;return!1}function S(a,c){if(!c&&a.hasChildNodes())return a.firstChild;var b;for(b=a;b&&!b.nextSibling;)b=b.parentNode;b=b?b.nextSibling:null;return b}function T(a){var c=a.previousSibling;if(c){for(a=c;a.hasChildNodes();)a=a.lastChild;return a}return(a=a.parentNode)&&1==a.nodeType?a:null}function U(a){if(!a||3!=a.nodeType)return!1;
var c=a.data;if(""===c)return!0;var b=a.parentNode;if(!b||1!=b.nodeType)return!1;a=z(a.parentNode,"whiteSpace");return/^[\t\n\r ]+$/.test(c)&&/^(normal|nowrap)$/.test(a)||/^[\t\r ]+$/.test(c)&&"pre-line"==a}function I(a){return""===a.data?!0:U(a)?!a.parentNode||R(a)?!0:!1:!1}function v(a){var c=a.nodeType;if(!(c=7==c||8==c||R(a)||/^(script|style)$/i.test(a.nodeName)))var b,c=3==a.nodeType&&(b=a.parentNode)&&"hidden"==z(b,"visibility");return c||I(a)}function V(a,c){var b=a.nodeType;return 7==b||8==
b||1==b&&"none"==C(a,c)}function w(){this.store={}}function h(a,c,b){return function(d){var e=this.cache;if(e.hasOwnProperty(a))return ga++,e[a];ha++;d=c.call(this,b?this[b]:this,d);return e[a]=d}}function W(a,c){this.node=a;this.session=c;this.cache=new w;this.positions=new w}function X(a,c){this.offset=c;this.nodeWrapper=a;this.node=a.node;this.session=a.session;this.cache=new w}function J(){K();return t=new ia}function K(){t&&t.detach();t=null}function x(a,c,b,d){function e(){var a=null;c?(a=f,
g||(f=f.previousVisible(),g=!f||b&&f.equals(b))):g||(a=f=f.nextVisible(),g=!f||b&&f.equals(b));g&&(f=null);return a}b&&(c?v(b.node)&&(b=a.previousVisible()):v(b.node)&&(b=b.nextVisible()));var f=a,g=!1,k,n=!1;return{next:function(){if(n)return n=!1,k;for(var a,b;a=e();)if(b=a.getCharacter(d))return k=a;return null},rewind:function(){if(k)n=!0;else throw r.createError("createCharacterIterator: cannot rewind. Only one position can be rewound.");},dispose:function(){a=b=null}}}function D(a,c,b){function d(a){for(var b,
c=[],d=a?e:f,g=!1,k=!1;a=d.next();){b=a.character;if(Y.test(b))k&&(k=!1,g=!0);else if(g){d.rewind();break}else k=!0;c.push(a)}return c}var e=x(a,!1,null,c),f=x(a,!0,null,c),g=b.tokenizer;a=d(!0);c=d(!1).reverse();var k=F(c.concat(a),b,g),n=a.length?k.slice(Z(k,a[0].token)):[],l=c.length?k.slice(0,Z(k,c.pop().token)+1):[];return{nextEndToken:function(){for(var a,c;1==n.length&&!(a=n[0]).isWord&&0<(c=d(!0)).length;)n=F(a.chars.concat(c),b,g);return n.shift()},previousStartToken:function(){for(var a,
c;1==l.length&&!(a=l[0]).isWord&&0<(c=d(!1)).length;)l=F(c.reverse().concat(a.chars),b,g);return l.pop()},dispose:function(){e.dispose();f.dispose();n=l=null}}}function aa(a,c,b,d){var e=a.getRangeBoundaryPosition(c,!0);a=a.getRangeBoundaryPosition(c,!1);return x(d?a:e,!!d,d?e:a,b)}function ja(a,c,b,d,e){function f(a,b){var c=k[a].previousVisible(),d=k[b-1],f;if(!(f=!e.wholeWordsOnly)){f=e.wordOptions;var g=p.createRange(c.node);g.setStartAndEnd(c.node,c.offset,d.node,d.offset);f=!g.expand("word",
{wordOptions:f})}return{startPos:c,endPos:d,valid:f}}var g=L(e.direction);a=x(a,g,a.session.getRangeBoundaryPosition(d,g),e.characterOptions);d="";for(var k=[],n,l,h,m,q,r=null;n=a.next();)if(l=n.character,b||e.caseSensitive||(l=l.toLowerCase()),g?(k.unshift(n),d=l+d):(k.push(n),d+=l),b){if(n=c.exec(d))if(h=n.index,m=h+n[0].length,q){if(!g&&m<d.length||g&&0<h){r=f(h,m);break}}else q=!0}else if(-1!=(h=d.indexOf(c))){r=f(h,h+c.length);break}q&&(r=f(h,m));a.dispose();return r}function m(a){return function(){var c=
!!t,b=[t||J()].concat(E.toArray(arguments)),b=a.apply(this,b);c||K();return b}}function M(a,c){return m(function(b,d,e,f){var g;"undefined"==typeof e&&(e=d,d="character");f=B(f,ka);var k=a;c&&(k=0<=e,this.collapse(!k));b=b.getRangeBoundaryPosition(this,k);var n=f.characterOptions,l=f.wordOptions;f=0;var h=b,m=Math.abs(e);if(0!==e){e=0>e;switch(d){case "character":for(l=x(b,e,null,n);(g=l.next())&&f<m;)++f,h=g;l.dispose();break;case "word":for(var l=D(b,n,l),p=e?l.previousStartToken:l.nextEndToken;(l=
p())&&f<m;)l.isWord&&(++f,h=e?l.chars[0]:l.chars[l.chars.length-1]);break;default:throw Error("movePositionBy: unit '"+d+"' not implemented");}e?(h=h.previousVisible(),f=-f):h&&h.isLeadingSpace&&!h.isTrailingSpace&&("word"==d&&(l=x(b,!1,null,n),g=l.next(),l.dispose()),g&&(h=g.previousVisible()))}b=h;g=f;this[k?"setStart":"setEnd"](b.node,b.offset);return g})}function ba(a){return m(function(c,b){b=y(b,H);for(var d,e=aa(c,this,b,!a),f=0;(d=e.next())&&Y.test(d.character);)++f;e.dispose();if(d=0<f)this[a?
"moveStart":"moveEnd"]("character",a?f:-f,{characterOptions:b});return d})}function N(a){return m(function(c,b){var d=!1;this.changeEachRange(function(c){d=c[a](b)||d});return d})}var q=p.dom,E=p.util,u=E.extend,y=E.createOptions,O=q.getBody,la=/^[ \t\f\r\n]+$/,ma=/^[ \t\f\r]+$/,Y=/^[\t-\r \u0085\u00A0\u1680\u180E\u2000-\u200B\u2028\u2029\u202F\u205F\u3000]+$/,na=/^[\t \u00A0\u1680\u180E\u2000-\u200B\u202F\u205F\u3000]+$/,L=p.Selection.isDirectionBackward,ca=!1,da=!1;(function(){var a=q.createTestElement(document,
"<p>1 </p><p></p>",!0),c=a.firstChild,b=p.getSelection();b.collapse(c.lastChild,2);b.setStart(c.firstChild,0);a.innerHTML="1 <br />";b.collapse(a,2);b.setStart(a.firstChild,0);ca=1==(""+b).length;a.innerHTML="1 <p>1</p>";b.collapse(a,2);b.setStart(a.firstChild,0);da=1==(""+b).length;q.removeNode(a);b.removeAllRanges()})();var H={includeBlockContentTrailingSpace:!0,includeSpaceBeforeBr:!0,includeSpaceBeforeBlock:!0,includePreLineTrailingSpace:!0,ignoreCharacters:""},oa={includeBlockContentTrailingSpace:!1,
includeSpaceBeforeBr:!ca,includeSpaceBeforeBlock:!da,includePreLineTrailingSpace:!0},G={en:{wordRegex:/[a-z0-9]+('[a-z0-9]+)*/gi,includeTrailingSpace:!1,tokenizer:function(a,c){function b(a,b,c){f.push({start:a,end:b,isWord:c})}for(var d=a.join(""),e,f=[],g=0,k;e=c.wordRegex.exec(d);){k=e.index;e=k+e[0].length;k>g&&b(g,k,!1);if(c.includeTrailingSpace)for(;na.test(a[e]);)++e;b(k,e,!0);g=e}g<a.length&&b(g,a.length,!1);return f}}},pa={caseSensitive:!1,withinRange:null,wholeWordsOnly:!1,wrap:!1,direction:"forward",
wordOptions:null,characterOptions:null},ka={wordOptions:null,characterOptions:null},qa={wordOptions:null,characterOptions:null,trim:!1,trimStart:!0,trimEnd:!0},ra={wordOptions:null,characterOptions:null,direction:"forward"},z=q.getComputedStyleProperty,P;(function(){var a=document.createElement("table"),c=O(document);c.appendChild(a);P="block"==z(a,"display");c.removeChild(a)})();var Q={table:"table",caption:"table-caption",colgroup:"table-column-group",col:"table-column",thead:"table-header-group",
tbody:"table-row-group",tfoot:"table-footer-group",tr:"table-row",td:"table-cell",th:"table-cell"};w.prototype={get:function(a){return this.store.hasOwnProperty(a)?this.store[a]:null},set:function(a,c){return this.store[a]=c}};var ga=0,ha=0,A={getPosition:function(a){var c=this.positions;return c.get(a)||c.set(a,new X(this,a))},toString:function(){return"[NodeWrapper("+q.inspectNode(this.node)+")]"}};W.prototype=A;u(A,{isCharacterDataNode:h("isCharacterDataNode",q.isCharacterDataNode,"node"),getNodeIndex:h("nodeIndex",
q.getNodeIndex,"node"),getLength:h("nodeLength",q.getNodeLength,"node"),containsPositions:h("containsPositions",function(a){return q.isCharacterDataNode(a)||!/^(area|base|basefont|br|col|frame|hr|img|input|isindex|link|meta|param)$/i.test(a.nodeName)},"node"),isWhitespace:h("isWhitespace",U,"node"),isCollapsedWhitespace:h("isCollapsedWhitespace",I,"node"),getComputedDisplay:h("computedDisplay",C,"node"),isCollapsed:h("collapsed",v,"node"),isIgnored:h("ignored",V,"node"),next:h("nextPos",S,"node"),
previous:h("previous",T,"node"),getTextNodeInfo:h("textNodeInfo",function(a){var c=null,b=!1,d=z(a.parentNode,"whiteSpace"),e="pre-line"==d;if(e)c=ma,b=!0;else if("normal"==d||"nowrap"==d)c=la,b=!0;return{node:a,text:a.data,spaceRegex:c,collapseSpaces:b,preLine:e}},"node"),hasInnerText:h("hasInnerText",function(a,c){for(var b=this.session,d=b.getPosition(a.parentNode,this.getNodeIndex()+1),e=b.getPosition(a,0),b=c?d:e,d=c?e:d;b!==d;){b.prepopulateChar();if(b.isDefinitelyNonEmpty())return!0;b=c?b.previousVisible():
b.nextVisible()}return!1},"node"),isRenderedBlock:h("isRenderedBlock",function(a){a=a.getElementsByTagName("br");for(var c=0,b=a.length;c<b;++c)if(!v(a[c]))return!0;return this.hasInnerText()},"node"),getTrailingSpace:h("trailingSpace",function(a){if("br"!=a.tagName.toLowerCase())switch(this.getComputedDisplay()){case "inline":for(a=a.lastChild;a;){if(!V(a))return 1==a.nodeType?this.session.getNodeWrapper(a).getTrailingSpace():"";a=a.previousSibling}break;case "inline-block":case "inline-table":case "none":case "table-column":case "table-column-group":break;
case "table-cell":return"\t";default:return this.isRenderedBlock(!0)?"\n":""}return""},"node"),getLeadingSpace:h("leadingSpace",function(a){switch(this.getComputedDisplay()){case "inline":case "inline-block":case "inline-table":case "none":case "table-column":case "table-column-group":case "table-cell":break;default:return this.isRenderedBlock(!1)?"\n":""}return""},"node")});A={character:"",characterType:"EMPTY",isBr:!1,prepopulateChar:function(){if(!this.prepopulatedChar){var a=this.node,c=this.offset,
b="",d="EMPTY",e=!1;if(0<c)if(3==a.nodeType){var a=a.data,f=a.charAt(c-1),g=this.nodeWrapper.getTextNodeInfo(),k=g.spaceRegex;g.collapseSpaces?k.test(f)?1<c&&k.test(a.charAt(c-2))||(g.preLine&&"\n"===a.charAt(c)?(b=" ",d="PRE_LINE_TRAILING_SPACE_BEFORE_LINE_BREAK"):(b=" ",d="COLLAPSIBLE_SPACE")):(b=f,d="NON_SPACE",e=!0):(b=f,d="UNCOLLAPSIBLE_SPACE",e=!0)}else(f=a.childNodes[c-1])&&1==f.nodeType&&!v(f)&&("br"==f.tagName.toLowerCase()?(b="\n",this.isBr=!0,d="COLLAPSIBLE_SPACE",e=!1):this.checkForTrailingSpace=
!0),b||(c=a.childNodes[c])&&1==c.nodeType&&!v(c)&&(this.checkForLeadingSpace=!0);this.prepopulatedChar=!0;this.character=b;this.characterType=d;this.isCharInvariant=e}},isDefinitelyNonEmpty:function(){var a=this.characterType;return"NON_SPACE"==a||"UNCOLLAPSIBLE_SPACE"==a},resolveLeadingAndTrailingSpaces:function(){this.prepopulatedChar||this.prepopulateChar();if(this.checkForTrailingSpace){var a=this.session.getNodeWrapper(this.node.childNodes[this.offset-1]).getTrailingSpace();a&&(this.isTrailingSpace=
!0,this.character=a,this.characterType="COLLAPSIBLE_SPACE");this.checkForTrailingSpace=!1}if(this.checkForLeadingSpace){if(a=this.session.getNodeWrapper(this.node.childNodes[this.offset]).getLeadingSpace())this.isLeadingSpace=!0,this.character=a,this.characterType="COLLAPSIBLE_SPACE";this.checkForLeadingSpace=!1}},getPrecedingUncollapsedPosition:function(a){for(var c=this,b;c=c.previousVisible();)if(b=c.getCharacter(a),""!==b)return c;return null},getCharacter:function(a){function c(){h||(k=l.getPrecedingUncollapsedPosition(a),
h=!0);return k}this.resolveLeadingAndTrailingSpaces();var b=this.character,d=fa(a.ignoreCharacters),e=""!==b&&-1<d.indexOf(b);if(this.isCharInvariant)return e?"":b;var e=["character",a.includeSpaceBeforeBr,a.includeBlockContentTrailingSpace,a.includePreLineTrailingSpace,d].join("_"),f=this.cache.get(e);if(null!==f)return f;var f="",g,k,h=!1,l=this;if("COLLAPSIBLE_SPACE"==this.characterType)if("INCLUDED_TRAILING_LINE_BREAK_AFTER_BR"==this.type)f="\n";else if(" "!=b||c()&&!k.isTrailingSpace&&"\n"!=
k.character&&(" "!=k.character||"COLLAPSIBLE_SPACE"!=k.characterType))if("\n"==b&&this.isLeadingSpace)c()&&"\n"!=k.character&&(f="\n");else if(g=this.nextUncollapsed())if(g.isBr?this.type="TRAILING_SPACE_BEFORE_BR":g.isTrailingSpace&&"\n"==g.character?this.type="TRAILING_SPACE_IN_BLOCK":g.isLeadingSpace&&"\n"==g.character&&(this.type="TRAILING_SPACE_BEFORE_BLOCK"),"\n"==g.character){if("TRAILING_SPACE_BEFORE_BR"!=this.type||a.includeSpaceBeforeBr)if("TRAILING_SPACE_BEFORE_BLOCK"!=this.type||a.includeSpaceBeforeBlock)if("TRAILING_SPACE_IN_BLOCK"!=
this.type||!g.isTrailingSpace||a.includeBlockContentTrailingSpace)if("PRE_LINE_TRAILING_SPACE_BEFORE_LINE_BREAK"!=this.type||"NON_SPACE"!=g.type||a.includePreLineTrailingSpace)"\n"==b?g.isTrailingSpace?!this.isTrailingSpace&&this.isBr&&(g.type="TRAILING_LINE_BREAK_AFTER_BR",c()&&k.isLeadingSpace&&!k.isTrailingSpace&&"\n"==k.character?g.character="":g.type="INCLUDED_TRAILING_LINE_BREAK_AFTER_BR"):f="\n":" "==b&&(f=" ")}else f=b;-1<d.indexOf(f)&&(f="");this.cache.set(e,f);return f},equals:function(a){return!!a&&
this.node===a.node&&this.offset===a.offset},inspect:function(){return"[Position("+q.inspectNode(this.node)+":"+this.offset+")]"},toString:function(){return this.character}};X.prototype=A;u(A,{next:h("nextPos",function(a){var c=a.nodeWrapper,b=a.node,d=a.offset;a=c.session;if(!b)return null;d==c.getLength()?c=(b=b.parentNode)?c.getNodeIndex()+1:0:c.isCharacterDataNode()?c=d+1:(c=b.childNodes[d],a.getNodeWrapper(c).containsPositions()?(b=c,c=0):c=d+1);return b?a.getPosition(b,c):null}),previous:h("previous",
function(a){var c=a.nodeWrapper,b=a.node,d=a.offset;a=c.session;0==d?c=(b=b.parentNode)?c.getNodeIndex():0:c.isCharacterDataNode()?c=d-1:(c=b.childNodes[d-1],a.getNodeWrapper(c).containsPositions()?(b=c,c=q.getNodeLength(c)):c=d-1);return b?a.getPosition(b,c):null}),nextVisible:h("nextVisible",function(a){var c=a.next();if(!c)return null;a=c.nodeWrapper;var b=c.node;a.isCollapsed()&&(c=a.session.getPosition(b.parentNode,a.getNodeIndex()+1));return c}),nextUncollapsed:h("nextUncollapsed",function(a){for(;a=
a.nextVisible();)if(a.resolveLeadingAndTrailingSpaces(),""!==a.character)return a;return null}),previousVisible:h("previousVisible",function(a){var c=a.previous();if(!c)return null;a=c.nodeWrapper;var b=c.node;a.isCollapsed()&&(c=a.session.getPosition(b.parentNode,a.getNodeIndex()));return c})});var t=null,ia=function(){function a(a){var b=new w;return{get:function(c){var g=b.get(c[a]);if(g)for(var k=0,h;h=g[k++];)if(h.node===c)return h;return null},set:function(c){var g=c.node[a];(b.get(g)||b.set(g,
[])).push(c)}}}function c(){this.initCaches()}var b=E.isHostProperty(document.documentElement,"uniqueID");c.prototype={initCaches:function(){this.elementCache=b?function(){var a=new w;return{get:function(b){return a.get(b.uniqueID)},set:function(b){a.set(b.node.uniqueID,b)}}}():a("tagName");this.textNodeCache=a("data");this.otherNodeCache=a("nodeName")},getNodeWrapper:function(a){var b;switch(a.nodeType){case 1:b=this.elementCache;break;case 3:b=this.textNodeCache;break;default:b=this.otherNodeCache}var c=
b.get(a);c||(c=new W(a,this),b.set(c));return c},getPosition:function(a,b){return this.getNodeWrapper(a).getPosition(b)},getRangeBoundaryPosition:function(a,b){var c=b?"start":"end";return this.getPosition(a[c+"Container"],a[c+"Offset"])},detach:function(){this.elementCache=this.textNodeCache=this.otherNodeCache=null}};return c}();u(q,{nextNode:S,previousNode:T});var Z=Array.prototype.indexOf?function(a,c){return a.indexOf(c)}:function(a,c){for(var b=0,d=a.length;b<d;++b)if(a[b]===c)return b;return-1};
u(p.rangePrototype,{moveStart:M(!0,!1),moveEnd:M(!1,!1),move:M(!0,!0),trimStart:ba(!0),trimEnd:ba(!1),trim:m(function(a,c){var b=this.trimStart(c),d=this.trimEnd(c);return b||d}),expand:m(function(a,c,b){var d=!1;b=B(b,qa);var e=b.characterOptions;c||(c="character");if("word"==c){var f=b.wordOptions;c=a.getRangeBoundaryPosition(this,!0);a=a.getRangeBoundaryPosition(this,!1);var g=D(c,e,f).nextEndToken(),k=g.chars[0].previousVisible(),f=this.collapsed?g:D(a,e,f).previousStartToken(),f=f.chars[f.chars.length-
1];k.equals(c)||(this.setStart(k.node,k.offset),d=!0);f&&!f.equals(a)&&(this.setEnd(f.node,f.offset),d=!0);b.trim&&(b.trimStart&&(d=this.trimStart(e)||d),b.trimEnd&&(d=this.trimEnd(e)||d));return d}return this.moveEnd("character",1,b)}),text:m(function(a,c){var b;if(this.collapsed)b="";else{var d=y(c,H);b=[];for(var d=aa(a,this,d),e;e=d.next();)b.push(e);d.dispose();b=b.join("")}return b}),selectCharacters:m(function(a,c,b,d,e){a={characterOptions:e};c||(c=O(this.getDocument()));this.selectNodeContents(c);
this.collapse(!0);this.moveStart("character",b,a);this.collapse(!0);this.moveEnd("character",d-b,a)}),toCharacterRange:m(function(a,c,b){c||(c=O(this.getDocument()));a=c.parentNode;c=q.getNodeIndex(c);var d=-1==q.comparePoints(this.startContainer,this.endContainer,a,c),e=this.cloneRange();d?(e.setStartAndEnd(this.startContainer,this.startOffset,a,c),a=-e.text(b).length):(e.setStartAndEnd(a,c,this.startContainer,this.startOffset),a=e.text(b).length);b=a+this.text(b).length;return{start:a,end:b}}),
findText:m(function(a,c,b){b=B(b,pa);b.wholeWordsOnly&&(b.wordOptions.includeTrailingSpace=!1);var d=L(b.direction),e=b.withinRange;e||(e=p.createRange(),e.selectNodeContents(this.getDocument()));var f=!1;"string"==typeof c?b.caseSensitive||(c=c.toLowerCase()):f=!0;var g=a.getRangeBoundaryPosition(this,!d),k=e.comparePoint(g.node,g.offset);-1===k?g=a.getRangeBoundaryPosition(e,!0):1===k&&(g=a.getRangeBoundaryPosition(e,!1));for(var h=g,k=!1;;)if(h=ja(h,c,f,e,b)){if(h.valid)return this.setStartAndEnd(h.startPos.node,
h.startPos.offset,h.endPos.node,h.endPos.offset),!0;h=d?h.startPos:h.endPos}else if(b.wrap&&!k)e=e.cloneRange(),h=a.getRangeBoundaryPosition(e,!d),e.setBoundary(g.node,g.offset,d),k=!0;else return!1}),pasteHtml:function(a){this.deleteContents();if(a){a=this.createContextualFragment(a);var c=a.lastChild;this.insertNode(a);this.collapseAfter(c)}}});u(p.selectionPrototype,{expand:m(function(a,c,b){this.changeEachRange(function(a){a.expand(c,b)})}),move:m(function(a,c,b,d){a=0;if(this.focusNode){this.collapse(this.focusNode,
this.focusOffset);var e=this.getRangeAt(0);d||(d={});d.characterOptions=y(d.characterOptions,oa);a=e.move(c,b,d);this.setSingleRange(e)}return a}),trimStart:N("trimStart"),trimEnd:N("trimEnd"),trim:N("trim"),selectCharacters:m(function(a,c,b,d,e,f){a=p.createRange(c);a.selectCharacters(c,b,d,f);this.setSingleRange(a,e)}),saveCharacterRanges:m(function(a,c,b){a=this.getAllRanges();for(var d=[],e=1==a.length&&this.isBackward(),f=0,g=a.length;f<g;++f)d[f]={characterRange:a[f].toCharacterRange(c,b),backward:e,
characterOptions:b};return d}),restoreCharacterRanges:m(function(a,c,b){this.removeAllRanges();a=0;for(var d=b.length,e,f,g;a<d;++a)f=b[a],g=f.characterRange,e=p.createRange(c),e.selectCharacters(c,g.start,g.end,f.characterOptions),this.addRange(e,f.backward)}),text:m(function(a,c){for(var b=[],d=0,e=this.rangeCount;d<e;++d)b[d]=this.getRangeAt(d).text(c);return b.join("")})});p.innerText=function(a,c){var b=p.createRange(a);b.selectNodeContents(a);return b.text(c)};p.createWordIterator=function(a,
c,b){var d=t||J();b=B(b,ra);a=d.getPosition(a,c);var e=D(a,b.characterOptions,b.wordOptions),f=L(b.direction);return{next:function(){return f?e.previousStartToken():e.nextEndToken()},dispose:function(){e.dispose();this.next=function(){}}}};p.noMutation=function(a){var c=t||J();a(c);K()};p.noMutation.createEntryPointFunction=m;p.textRange={isBlockNode:function(a){return a&&(1==a.nodeType&&!/^(inline(-block|-table)?|none)$/.test(C(a))||9==a.nodeType||11==a.nodeType)},isCollapsedWhitespaceNode:I,createPosition:m(function(a,
c,b){return a.getPosition(c,b)})}});return r},this);
