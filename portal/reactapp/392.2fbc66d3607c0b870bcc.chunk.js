(self.webpackChunkcbioportal_frontend=self.webpackChunkcbioportal_frontend||[]).push([[392],{97392:(e,t,r)=>{"use strict";r.d(t,{Z:()=>j});var o=r(88034),n=r(78566),l=r(27808),i=r(32591),s=r.n(i),a=r(57930),u=r.n(a),c=r(99666),p=r(72564),d=r(36903),h=r(78448),f=r(5933),m=r(76127),y=r.n(m),b=r(65587),v=r(60138);function g(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C(e,t){return!t||"object"!==O(t)&&"function"!=typeof t?_(e):t}function _(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function R(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&D(e,t)}function D(e,t){return(D=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var E=function(e,t,r,o){var n,l=arguments.length,i=l<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"===("undefined"==typeof Reflect?"undefined":O(Reflect))&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(i=(l<3?n(i):l>3?n(t,r,i):n(t,r))||i);return l>3&&i&&Object.defineProperty(t,r,i),i},A=function(e){function t(){return S(this,t),C(this,k(t).apply(this,arguments))}return R(t,e),t}(h.Z),x=function(e){function t(e){var r;return S(this,t),r=C(this,k(t).call(this,e)),(0,n.makeObservable)(_(r)),r}var r,i,a;return R(t,e),r=t,(i=[{key:"onDeleteClick",value:function(e){this.props.deleteChart(e.key)}},{key:"shareChart",value:function(e){this.props.shareCharts([e.key])}},{key:"onRestoreClick",value:function(e){this.props.restoreChart(e.key)}},{key:"getCurrentSelectedRows",value:function(){return this.options.filter((function(e){return e.selected}))}},{key:"getCurrentSelectedRowKeys",value:function(){return this.getCurrentSelectedRows().map((function(e){return e.key}))}},{key:"addAll",value:function(e){this.props.onAddAll(u().filter(e,(function(e){return!e.disabled})).map((function(e){return e.key})))}},{key:"removeAll",value:function(e){this.props.onClearAll(e.map((function(e){return e.key})))}},{key:"onOptionChange",value:function(e){this.props.onToggleOption(e.key)}},{key:"shareSelected",value:function(){this.props.shareCharts(this.props.options.filter((function(e){return e.selected})).map((function(e){return e.key})))}},{key:"render",value:function(){var e;return o.createElement("div",{style:{display:"flex",flexDirection:"column"},"data-test":"add-by-type"},(!this.props.freqPromise||this.props.freqPromise.isComplete)&&o.createElement(A,{width:this.props.width-20,height:this.tableHeight,columns:this.columns,data:this.options,showControlsAtTop:!0,addAll:this.addAll,removeAll:this.removeAll,showSelectableNumber:!0,showAddRemoveAllButton:!0,autoFocusSearchAfterRendering:!0,numberOfSelectedRows:this.getCurrentSelectedRows().length,hideControls:this.props.hideControls,isSelectedRow:function(e){return!!e.isSharedChart},highlightedRowClassName:function(e){return e.isSharedChart?s().sharedChart:""},extraButtons:this.extraButtons}),(null===(e=this.props.freqPromise)||void 0===e?void 0:e.isPending)&&o.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:100}},o.createElement(d.Z,{isLoading:!0}),o.createElement("br",null),"Calculating data availability..."))}},{key:"options",get:function(){var e,t=this;if(null===(e=this.props.freqPromise)||void 0===e?void 0:e.isComplete){var r=u().reduce(this.props.options,(function(e,r){var o=0===t.props.freqPromise.result[r.key];return e.push({label:r.label,key:r.key,disabled:o,selected:r.selected,isSharedChart:r.isSharedChart,freq:o?0:t.props.freqPromise.result[r.key]}),e}),[]);return this.props.optionsGivenInSortedOrder?r:r.sort((function(e,t){return t.freq-e.freq||e.label.localeCompare(t.label)}))}var o=this.props.options.map((function(e){return Object.assign({freq:100},e)}));return this.props.optionsGivenInSortedOrder?o:o.sort((function(e,t){return e.label.localeCompare(t.label)}))}},{key:"columns",get:function(){var e=this,t=[{name:this.props.firstColumnHeaderName,render:function(t){return o.createElement(l.Observer,null,(function(){return o.createElement("div",{className:y()(s().option,"add-chart-option",g({},s().markedForDeletion,e.props.markedForDeletion&&e.props.markedForDeletion.includes(t.key))),"data-test":"add-chart-option-".concat(t.label.toLowerCase().replace(/\s/g,"-"))},o.createElement(c.Z,{checked:t.selected,disabled:t.disabled||e.props.markedForDeletion&&e.props.markedForDeletion.includes(t.key),labelProps:{className:y()(s().label,t.disabled?s().labelDisabled:"")},inputProps:{className:s().input},onChange:function(){return e.onOptionChange(t)}},o.createElement(b.CQ,{text:t.label})))}))},filter:function(e,t,r){return e.label.toUpperCase().includes(r)},sortBy:function(e){return e.label},width:this.props.width-80-(this.props.shareCharts||this.props.deleteChart?70:0),defaultSortDirection:"asc"}];return this.props.freqPromise&&t.push({name:"Freq",tooltip:o.createElement("span",null,(0,v.Z)(this.props.frequencyHeaderTooltip,"% samples with data")),render:function(t){var r;return o.createElement("span",{className:y()(t.disabled?s().labelDisabled:"",g({},s().markedForDeletion,e.props.markedForDeletion&&e.props.markedForDeletion.includes(t.key)))},(null===(r=e.props.freqPromise)||void 0===r?void 0:r.isComplete)?(0,p.jJ)(t.freq):"")},sortBy:function(e){return e.freq},defaultSortDirection:"desc",width:60}),(this.props.shareCharts||this.props.deleteChart)&&t.push({name:" ",render:function(t){var r=o.createElement(o.Fragment,null);return r=e.props.markedForDeletion&&e.props.markedForDeletion.includes(t.key)?o.createElement("button",{className:"btn btn-xs btn-default",onClick:function(){return e.onRestoreClick(t)}},"Restore"):o.createElement(o.Fragment,null,e.props.deleteChart&&o.createElement(b.ZD,{overlay:"Delete Chart",placement:"top"},o.createElement("span",{onClick:function(){return e.onDeleteClick(t)},style:{marginRight:"5px"}},o.createElement("i",{className:"fa fa-md fa-trash",style:{cursor:"pointer"}}))),e.props.shareCharts&&o.createElement("span",{onClick:function(){return e.shareChart(t)}},o.createElement("i",{className:"fa fa-share-alt",style:{cursor:"pointer"}}))),o.createElement("div",{style:{display:"flex",justifyContent:"flex-end"},className:y()(g({},s().labelDisabled,t.disabled))},r)},width:70}),t}},{key:"tableHeight",get:function(){return this.options.length>15?375:25*(this.options.length+1)}},{key:"extraButtons",get:function(){var e=this;return this.props.shareCharts?[{content:o.createElement(o.Fragment,null,"Share selected"),onClick:this.shareSelected,isDisabled:function(){return 0===e.props.options.filter((function(e){return e.selected})).length}}]:[]}}])&&w(r.prototype,i),a&&w(r,a),t}(o.Component);Object.defineProperty(x,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{firstColumnHeaderName:"Name",hideControls:!1,width:400}}),E([n.computed],x.prototype,"options",null),E([f.default],x.prototype,"onDeleteClick",null),E([f.default],x.prototype,"shareChart",null),E([f.default],x.prototype,"onRestoreClick",null),E([n.computed],x.prototype,"columns",null),E([n.computed],x.prototype,"tableHeight",null),E([f.default],x.prototype,"getCurrentSelectedRows",null),E([f.default],x.prototype,"getCurrentSelectedRowKeys",null),E([n.action.bound],x.prototype,"addAll",null),E([n.action.bound],x.prototype,"removeAll",null),E([n.action.bound],x.prototype,"onOptionChange",null),E([n.action.bound],x.prototype,"shareSelected",null),E([n.computed],x.prototype,"extraButtons",null);const j=x=E([l.observer],x)},78448:(e,t,r)=>{"use strict";r.d(t,{Z:()=>T});var o,n=r(88034),l=r(6240),i=r(84824),s=r(78566),a=r(39594),u=r.n(a),c=r(57930),p=r.n(c),d=r(27808),h=r(76127),f=r.n(h),m=r(59280),y=r(5933),b=r(66072),v=r(65587),g=r(17502),w=r(58235),S=r(79280);function C(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function R(e,t){return!t||"object"!==j(t)&&"function"!=typeof t?O(e):t}function D(e){return(D=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function O(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&A(e,t)}function A(e,t){return(A=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function x(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var P=function(e,t,r,o){var n,l=arguments.length,i=l<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"===("undefined"==typeof Reflect?"undefined":j(Reflect))&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(i=(l<3?n(i):l>3?n(t,r,i):n(t,r))||i);return l>3&&i&&Object.defineProperty(t,r,i),i},N=(x(o={},"desc",i.Sr.DESC),x(o,"asc",i.Sr.ASC),o),F=function(e){function t(e,r){var o;return k(this,t),o=R(this,D(t).call(this,e)),Object.defineProperty(O(o),"fixedTopRowsData",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(O(o),"getSortedData",{enumerable:!0,configurable:!0,writable:!0,value:function(){var e=o.sortMetric||function(){return 0},t=void 0===o.sortAscending||o.sortAscending;return[].concat(_(o.fixedTopRowsData),_((0,l.eS)(o.allData,e,t)))}}),(0,s.makeObservable)(O(o)),o.fixedTopRowsData=r,o}return E(t,e),t}(g.Lq),B=function(e){function t(e){var r;k(this,t),r=R(this,D(t).call(this,e)),Object.defineProperty(O(r),"_store",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(O(r),"inputElement",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(O(r),"_sortBy",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(O(r),"_sortDirection",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),(0,s.makeObservable)(O(r)),r._sortBy=e.sortBy;var o=p().find(r.props.columns,(function(e){return e.name===r._sortBy}));return r._sortDirection=void 0===e.sortDirection?p().isUndefined(o)?"desc":o.defaultSortDirection||"desc":e.sortDirection,r.initDataStore(),r}var r,o,a;return E(t,e),r=t,(o=[{key:"componentWillReceiveProps",value:function(e){this.updateDataStore(e)}},{key:"updateDataStore",value:function(e){var t=this,r=new F((function(){return t.props.data}),this.props.fixedTopRowsData||[]),o=(0,s.toJS)(this._store.filterString);this._store.setProps({columns:e.columns,dataStore:r,initialSortColumn:this._sortBy,initialSortDirection:this._sortDirection}),void 0!==o&&this._store.setFilterString(o)}},{key:"initDataStore",value:function(){var e=this,t=new F((function(){return e.props.data}),this.props.fixedTopRowsData||[]);this._store=new l.EZ({columns:this.props.columns,dataStore:t,initialSortColumn:this._sortBy,initialSortDirection:this._sortDirection})}},{key:"rowClassName",value:function(e){var t=e.index;if(t>-1&&this.isSelectedRow(this._store.dataStore.sortedFilteredData[t])){var r=[u().row];if(this.props.highlightedRowClassName){var o=this.props.highlightedRowClassName(this._store.dataStore.sortedFilteredData[t]);r.push(o)}else r.push(u().highlightedRow);return f()(r)}return t<0?u().headerRow:f()(u().row,t%2==0?u().evenRow:u().oddRow)}},{key:"rowGetter",value:function(e){var t=e.index;return this._store.dataStore.sortedFilteredData[t]}},{key:"getColumn",value:function(e){return p().keyBy(this.props.columns,(function(e){return e.name}))[e]}},{key:"sort",value:function(e){var t=e.sortBy;this._store.defaultHeaderClick(this.getColumn(t)),this._sortBy=t,this._sortDirection=this._store.dataStore.sortAscending?"asc":"desc",this.props.afterSorting&&this.props.afterSorting(this._sortBy,this._sortDirection)}},{key:"onFilterTextChange",value:function(){var e=this;return(0,b._)((function(t){e._store.setFilterString(t)}),400)}},{key:"afterSelectingRows",value:function(){this.props.afterSelectingRows&&this.props.afterSelectingRows()}},{key:"changeSelectionType",value:function(e){this.props.toggleSelectionOperator&&this.props.defaultSelectionOperator!==e&&this.props.toggleSelectionOperator()}},{key:"isSelectedRow",value:function(e){return!!p().isFunction(this.props.isSelectedRow)&&this.props.isSelectedRow(e)}},{key:"onAddAll",value:function(){this.props.addAll&&this.props.addAll(this._store.dataStore.sortedFilteredData)}},{key:"onRemoveAll",value:function(){this.props.removeAll&&this.props.removeAll(this._store.dataStore.sortedFilteredData)}},{key:"setInputRef",value:function(e){this.inputElement=e}},{key:"componentDidMount",value:function(){!this.props.hideControls&&this.props.autoFocusSearchAfterRendering&&this.inputElement.focus()}},{key:"getSelectionOptions",value:function(){var e=this;return Object.keys(w.LY).map((function(t){var r=w.LY[t];return n.createElement(S.MenuItem,{onClick:function(){return e.changeSelectionType(r)},active:e.props.defaultSelectionOperator===t},n.createElement(v.ZD,{overlay:"".concat(r," of samples in the newly selected rows")},n.createElement("div",null,r," ",n.createElement("i",{className:u()[r.toLowerCase()]}))))}))}},{key:"getAddRemoveAllButton",value:function(){var e=0===this.props.numberOfSelectedRows,t=this.props.numberOfSelectedRows===this.props.data.length,r="Select all".concat(this.props.showSelectableNumber?" (".concat(this._store.dataStore.sortedFilteredData.length,")"):""),o=!t&&this.props.addAll,l=!e&&this.props.removeAll;return n.createElement("div",{style:{display:"flex",alignItems:"baseline"}},o&&n.createElement("button",{className:"btn btn-default btn-xs","data-test":"fixed-header-table-add-all",onClick:this.onAddAll},r),l&&n.createElement("button",{className:"btn btn-default btn-xs","data-test":"fixed-header-table-remove-all",onClick:this.onRemoveAll},"Deselect all"))}},{key:"getControls",value:function(){return n.createElement("div",{className:f()(u().controls,x({},u().controlsAtTop,!!this.props.showControlsAtTop))},!this.props.showControlsAtTop&&n.createElement("input",{placeholder:"Search...",type:"text",onInput:this.onFilterTextChange(),className:f()("form-control",u().tableSearchInput)}),this.props.showAddRemoveAllButton&&this.getAddRemoveAllButton(),n.createElement(m.If,{condition:this.props.showSetOperationsButton&&this.props.numberOfSelectedRows>0},n.createElement("div",{className:"btn-group",style:{display:"flex"}},n.createElement("button",{className:"btn btn-default btn-xs",onClick:this.afterSelectingRows},"Select Samples"," ",n.createElement(m.If,{condition:this.props.numberOfSelectedRows>1},n.createElement("i",{style:{marginTop:"-2px"},className:this.props.defaultSelectionOperator===w.LY.INTERSECTION?u().intersection:u().union}))),n.createElement(m.If,{condition:this.props.numberOfSelectedRows>1},n.createElement(S.DropdownButton,{bsSize:"xsmall",title:"",id:"selectButton",pullRight:!0},this.getSelectionOptions())))),this.props.extraButtons&&this.props.extraButtons.map((function(e){return n.createElement("button",{className:"btn btn-default btn-xs",onClick:e.onClick,disabled:e.isDisabled()},e.content)})),this.props.showControlsAtTop&&n.createElement("input",{placeholder:"Search...",type:"text",onInput:this.onFilterTextChange(),ref:this.setInputRef,"data-test":"fixed-header-table-search-input",className:f()("form-control",u().tableSearchInput)}),this.props.extraFooterElements)}},{key:"render",value:function(){var e=this;return n.createElement("div",{className:u().studyViewTablesTable},!this.props.hideControls&&this.props.showControlsAtTop&&this.getControls(),n.createElement(d.Observer,null,(function(){return n.createElement(i.iA,{width:e.props.width,height:e.props.height,onScroll:e.props.onScroll,headerHeight:e.props.headerHeight,rowHeight:e.props.rowHeight,rowCount:e._store.dataStore.sortedFilteredData.length,rowGetter:e.rowGetter,rowClassName:e.rowClassName,headerClassName:f()(u().headerColumn,e.props.headerClassName),sort:e.sort,sortDirection:N[e._sortDirection],sortBy:e._sortBy},e.props.columns.map((function(t,r){return n.createElement(i.sg,{key:t.name,label:t.name,dataKey:t.name,width:Number(t.width),headerRenderer:e.columnHeaders[r],cellRenderer:function(e){return t.render(e.rowData,e.rowIndex)}})})))})),!this.props.hideControls&&!this.props.showControlsAtTop&&this.getControls())}},{key:"columnHeaders",get:function(){var e=this;return this.props.columns.map((function(t){return function(r){var o=[];t.headerRender?o.push(t.headerRender(t.name)):o.push(n.createElement("span",{key:t.name},t.name)),t.name===e._sortBy&&o.push(n.createElement("i",{className:f()("desc"===e._sortDirection?u().headerSortingIconDesc:u().headerSortingIconAsc,"fa","desc"===e._sortDirection?"fa-sort-desc":"fa-sort-asc")}));var l=n.createElement("div",{style:{display:"flex"}},o);return t.tooltip?n.createElement(v.ZD,{placement:"top",overlay:t.tooltip},l):l}}))}}])&&C(r.prototype,o),a&&C(r,a),t}(n.Component);Object.defineProperty(B,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{showControlsAtTop:!1,showAddRemoveAllButton:!1,autoFocusSearchAfterRendering:!1,width:398,height:350,headerHeight:25,rowHeight:25,showSelectableNumber:!1,sortBy:"",numberOfSelectedRows:0,hideControls:!1}}),P([s.observable.ref],B.prototype,"_sortBy",void 0),P([s.observable],B.prototype,"_sortDirection",void 0),P([y.default],B.prototype,"rowClassName",null),P([y.default],B.prototype,"rowGetter",null),P([y.default],B.prototype,"getColumn",null),P([s.action.bound],B.prototype,"sort",null),P([s.action.bound],B.prototype,"onFilterTextChange",null),P([s.action.bound],B.prototype,"afterSelectingRows",null),P([s.action.bound],B.prototype,"changeSelectionType",null),P([y.default],B.prototype,"isSelectedRow",null),P([y.default],B.prototype,"onAddAll",null),P([y.default],B.prototype,"onRemoveAll",null),P([s.computed],B.prototype,"columnHeaders",null),P([y.default],B.prototype,"setInputRef",null);const T=B=P([d.observer],B)},32591:e=>{e.exports={portalWidth:"styles-module__portalWidth__1Knza",framedImage:"styles-module__framedImage__p1p-k",main:"styles-module__main__2V5AI",operations:"styles-module__operations__2tHBt",options:"styles-module__options__2V0tE",option:"styles-module__option__dhLVt",markedForDeletion:"styles-module__markedForDeletion__2l0on",footer:"styles-module__footer__8u68Z",input:"styles-module__input__2Zk8R",label:"styles-module__label__YKqSs",labelDisabled:"styles-module__labelDisabled__3jDaR",sharedChart:"styles-module__sharedChart__23Z4O"}}}]);