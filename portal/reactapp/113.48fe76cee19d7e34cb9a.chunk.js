(self.webpackChunkcbioportal_frontend=self.webpackChunkcbioportal_frontend||[]).push([[113],{93080:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>hs,initStore:()=>ds});var n=r(88034),o=r(57930),i=r.n(o),a=r(77906),l=r.n(a),s=r(11e3),u=r(27808),c=r(78566),p=r(84232),d=r(21015),f=r(79280),m=r(95920),h=r(59280),y=r(76127),b=r.n(y),g=r(49572),v=r(74418),S=r(5933);var E=r(56066),C=r(64577),w=r(65587),T=r(15757),P=r(95497),O=r(67461),k=r(77906);function A(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function I(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function D(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function x(e,t){return(x=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function M(e){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var N=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":M(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},L=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{s(n.next(e))}catch(e){i(e)}}function l(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,l)}s((n=n.apply(e,t||[])).next())}))};function R(e){return i().round(100*e,2)}function j(e){var t=e[0].map((function(e){return e.x})),r=e.reduce((function(e,t){return t.forEach((function(t){e[t.x]=e[t.x]||0,e[t.x]+=t.y})),e}),{});return t.map((function(e){return{x:e,y:r[e],alterationType:"whatever"}}))}var G=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==M(t)&&"function"!=typeof t?D(e):t}(this,_(t).call(this,e)),Object.defineProperty(D(r),"barPlotTooltipModel",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(D(r),"scatterPlotTooltipModel",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(D(r),"barToolTipCounter",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(D(r),"isBarPlotTooltipHovered",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(D(r),"shouldUpdatePosition",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(D(r),"mousePosition",{enumerable:!0,configurable:!0,writable:!0,value:{x:0,y:0}}),Object.defineProperty(D(r),"plotSvg",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(D(r),"dummyScrollPane",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(D(r),"scrollPane",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(D(r),"scrollingDummyPane",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(D(r),"plotElementWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),(0,c.makeObservable)(D(r)),r}var r,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&x(e,t)}(t,e),r=t,(o=[{key:"getSvg",value:function(){return this.plotSvg}},{key:"assignScrollPaneRef",value:function(e){this.scrollPane=e,e&&(this.synchronizeScrollPanes(),k(e).scroll(this.synchronizeScrollPanes))}},{key:"assignDummyScrollPaneRef",value:function(e){var t=this;this.dummyScrollPane=e,e&&(this.synchronizeScrollPanes(),k(e).scroll(this.synchronizeScrollPanes),k(e).on("mousedown",(function(){t.scrollingDummyPane=!0})),k(e).on("mouseup",(function(){t.scrollingDummyPane=!1})))}},{key:"assignPlotSvgRef",value:function(e){this.plotSvg=e,this.plotElementWidth=e?e.scrollWidth:0}},{key:"synchronizeScrollPanes",value:function(){this.scrollPane&&this.dummyScrollPane&&(this.scrollingDummyPane?this.scrollPane.scrollLeft=this.dummyScrollPane.scrollLeft:this.dummyScrollPane.scrollLeft=this.scrollPane.scrollLeft)}},{key:"tooltipMouseEnter",value:function(){this.isBarPlotTooltipHovered=!0}},{key:"tooltipMouseLeave",value:function(){this.isBarPlotTooltipHovered=!1,this.barPlotTooltipModel=null}},{key:"queryStudy",value:function(e){return L(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.props.gene!=ve&&(r=this.props.gene),this.props.handleStudyLinkout&&this.props.handleStudyLinkout(e,r);case 2:case"end":return t.stop()}}),t,this)})))}},{key:"formatStudyLink",value:function(e){return s.format({pathname:"/"+P._.Study,query:{id:e}})}},{key:"onMouseMove",value:function(e){this.shouldUpdatePosition&&(this.mousePosition.x=e.pageX,this.mousePosition.y=e.pageY)}},{key:"barWidth",value:function(){return 20}},{key:"barSeparation",value:function(){return 8}},{key:"tickFormat",value:function(){return this.props.isPercentage?function(e){return"".concat(e,"%")}:function(e){return e}}},{key:"domainPadding",value:function(){return 20}},{key:"categoryAxisDomainPadding",value:function(){return this.domainPadding()}},{key:"countAxisDomainPadding",value:function(){return this.domainPadding()}},{key:"chartDomainPadding",value:function(){return{y:this.countAxisDomainPadding(),x:this.categoryAxisDomainPadding()}}},{key:"barChartHeight",value:function(){return 400}},{key:"getData",value:function(e){var t=this.convertDataToDownloadData(this.props.data);return(0,v.n5)([[this.props.xAxisString,this.yAxisLabel,"Alteration Type","Alteration Count"]].concat(t))}},{key:"convertDataToDownloadData",value:function(e){for(var t=[],r=e.length,n=e[0].length,o=0;o<n;o++)for(var i=0;i<r;i++)0!=e[i][o].y&&t.push([e[i][o].x,e[i][o].y.toString(),e[i][o].alterationType,e[i][o].alterationCount.toString()]);return t}},{key:"getChart",value:function(){return n.createElement("div",{style:this.overflowStyle,className:"borderedChart"},n.createElement(O.Z,{plotElementWidth:this.plotElementWidth,assignDummyScrollPaneRef:this.assignDummyScrollPaneRef,scrollPane:this.scrollPane},n.createElement("div",{style:{overflowX:"auto",overflowY:"hidden"},className:"hideScrollbar",ref:this.assignScrollPaneRef},n.createElement("svg",{style:{width:this.svgWidth,height:this.svgHeight,pointerEvents:"all"},height:this.svgHeight,width:this.svgWidth,role:"img",viewBox:"0 0 ".concat(this.svgWidth," ").concat(this.svgHeight),ref:this.assignPlotSvgRef,onMouseMove:this.onMouseMove},n.createElement("g",{transform:"translate(".concat(this.leftPadding,", 0)")},n.createElement(g.VictoryChart,{theme:w.Nv,width:this.chartWidth,height:this.barChartHeight(),standalone:!1,domainPadding:this.chartDomainPadding(),singleQuadrantDomainPadding:{y:!0,x:!1}},n.createElement(g.VictoryAxis,{dependentAxis:!0,axisLabelComponent:n.createElement(g.VictoryLabel,{dy:-50}),label:this.yAxisLabel,tickFormat:this.tickFormat,offsetX:50,orientation:"left"}),n.createElement(g.VictoryAxis,{tickValues:this.props.xLabels,style:{ticks:{size:0,strokeWidth:0},tickLabels:{fontSize:0},grid:{stroke:0}}}),n.createElement(g.VictoryStack,{colorScale:this.colorArray},this.barPlots),!this.props.hideGenomicAlterations&&n.createElement(g.VictoryLegend,{x:10,y:this.svgHeight-30,orientation:"horizontal",data:this.legendData}))),n.createElement("g",{transform:"translate(".concat(this.leftPadding,", ").concat(this.scatterPlotTopPadding,")")},n.createElement(g.VictoryChart,{theme:w.Nv,width:this.chartWidth,height:this.scatterChartHeight,standalone:!1,domainPadding:this.chartDomainPadding(),singleQuadrantDomainPadding:{y:!0,x:!1}},n.createElement(g.VictoryAxis,{orientation:"bottom",crossAxis:!1,tickValues:this.props.xLabels,style:{axis:{strokeWidth:0},ticks:{size:0,strokeWidth:0},grid:{stroke:0}},tickLabelComponent:n.createElement(g.VictoryLabel,{angle:50,verticalAnchor:"start",textAnchor:"start"})}),n.createElement(g.VictoryAxis,{orientation:"left",dependentAxis:!0,crossAxis:!1,style:{axis:{strokeWidth:0},ticks:{size:0,strokeWidth:0},grid:{stroke:0}}}),n.createElement(g.VictoryScatter,{size:this.barWidth()/5,style:{data:{fill:"black",cursor:function(e){return e.cursor}}},data:this.scatterData,events:this.scatterPlotMouseEvents})))))),n.createElement(w.t_,{getSvg:this.getSvg,getData:this.getData,filename:"cancer_types_summary",dontFade:!0,type:"button",buttons:["SVG","PNG","PDF","Data"],style:{position:"absolute",top:10,right:10}}))}},{key:"render",value:function(){return n.createElement("div",{"data-test":"cancerTypeSummaryChart"},n.createElement(u.Observer,null,this.getChart),this.scatterPlotTooltipComponent,this.barPlotTooltipComponent)}},{key:"scatterPlotTooltipComponent",get:function(){if(this.scatterPlotTooltipModel){var e=this.scatterPlotTooltipModel.datum.profiledCount,t="Not profiled";e>0&&(t="".concat(e," ").concat((0,w._6)("sample",e),"  profiled"));var r=this.mousePosition.x>C.Z.size.width-400?"left":"right";return E.createPortal(n.createElement(f.Popover,{arrowOffsetTop:T.wD,className:b()("cbioportal-frontend","cbioTooltip"),positionLeft:this.mousePosition.x+("left"===r?-T.lw:T.lw),positionTop:this.mousePosition.y-T.wD,style:{transform:"left"===r?"translate(-100%,0%)":void 0,maxWidth:400},placement:r},n.createElement("div",{style:{whiteSpace:"normal"}},t)),document.body)}return null}},{key:"barPlotTooltipComponent",get:function(){var e=this;if(this.barPlotTooltipModel){var t=this.barPlotTooltipModel,r=this.mousePosition.x>C.Z.size.width-400?"left":"right";return E.createPortal(n.createElement(f.Popover,{onMouseLeave:this.tooltipMouseLeave,onMouseEnter:this.tooltipMouseEnter,arrowOffsetTop:T.wD,className:b()("cbioportal-frontend","cbioTooltip"),positionLeft:this.mousePosition.x+("left"===r?-T.lw:T.lw),positionTop:this.mousePosition.y-T.wD,style:{transform:"left"===r?"translate(-100%,0%)":void 0,maxWidth:400},placement:r},n.createElement("div",null,n.createElement(h.If,{condition:this.props.showLinks},n.createElement(h.Then,null,n.createElement("strong",null,n.createElement("a",{href:this.formatStudyLink(t.studyId),target:"_blank"},t.groupName,"Â ",n.createElement("i",{className:"fa fa-external-link",style:{fontWeight:"bold"}})))),n.createElement(h.Else,null,n.createElement("strong",null,"Summary for ",t.groupName))),n.createElement("p",null,"Gene altered in"," ",R(t.alterationData.alteredSampleCount/t.alterationData.profiledSampleTotal),"% of"," ",t.alterationData.profiledSampleTotal," ","cases"),n.createElement("table",{className:"table table-striped"},n.createElement("thead",null,n.createElement("tr",null,n.createElement("th",null,"Alteration"),n.createElement("th",null,"Frequency"))),n.createElement("tbody",null,i().reduce(this.props.alterationTypes,(function(e,r,o){if(o in t.alterationData.alterationTypeCounts&&t.alterationData.alterationTypeCounts[o]>0){var i=t.alterationData.alterationTypeCounts[o];e.push(n.createElement("tr",null,n.createElement("td",null,r),n.createElement("td",null,R(t.alterationData.alterationTypeCounts[o]/t.alterationData.profiledSampleTotal),"% (",i," ",(0,w._6)("case",i),")")))}return e}),[]).reverse())),n.createElement(h.If,{condition:this.props.showLinks},n.createElement("div",{className:"btn btn-primary btn-xs",onClick:function(){e.queryStudy(t.studyId)}},"Query this study",this.props.gene==ve?"":" for ".concat(this.props.gene))))),document.body)}return null}},{key:"svgWidth",get:function(){return this.chartWidth+this.rightPadding+this.leftPadding}},{key:"chartWidth",get:function(){return this.props.xLabels.length*(this.barWidth()+this.barSeparation())+100}},{key:"svgHeight",get:function(){return this.barChartHeight()+this.scatterChartHeight+this.bottomPadding-100}},{key:"rightPadding",get:function(){return Math.max(200,this.legendWidth-this.chartWidth+20)}},{key:"legendWidth",get:function(){var e=this.legendData.map((function(e){return e.name}));return 6*e.join("").length+40*e.length}},{key:"leftPadding",get:function(){return Math.max(50,4*Math.max.apply(Math,A(this.scatterData.map((function(e){return e.y.length})))))}},{key:"bottomPadding",get:function(){return 5*(e=this.props.xLabels,t=e.map((function(e){var t=e.match(/[A-Z]/g)||[],r=e.match(/[a-z]/g)||[],n=e.match(/\s/g)||[],o=e.length-t.length-r.length-n.length;return 2*t.length+1*r.length+2*n.length+1*o})),i().max(t)||0)+40;var e,t}},{key:"colorArray",get:function(){var e=this;return i().map(this.props.alterationTypes,(function(t,r){return e.props.colors[r]}))}},{key:"legendData",get:function(){var e=this;return i().reduce(this.props.alterationTypes,(function(t,r,n){return n in e.props.representedAlterations&&t.push({name:r,symbol:{fill:e.props.colors[n]}}),t}),[]).reverse()}},{key:"yAxisLabel",get:function(){return this.props.isPercentage?"Alteration Frequency":"Absolute Counts"}},{key:"barPlotEvents",get:function(){var e=this;return[{target:"data",eventHandlers:{onMouseEnter:function(){return[{target:"data",mutation:function(t){e.shouldUpdatePosition=!0,t.datum.xKey in e.props.countsByGroup?(e.barPlotTooltipModel=Object.assign(Object.assign({},t),{groupName:t.datum.x,alterationData:e.props.countsByGroup[t.datum.xKey],studyId:t.datum.xKey}),e.barToolTipCounter++):e.barPlotTooltipModel=null}}]},onMouseLeave:function(){return[{target:"data",mutation:function(){e.shouldUpdatePosition=!1,setTimeout((function(){e.isBarPlotTooltipHovered||1!==e.barToolTipCounter||(e.barPlotTooltipModel=null),e.barToolTipCounter--}),100)}}]}}}]}},{key:"scatterPlotMouseEvents",get:function(){var e=this;return[{target:"data",eventHandlers:{onMouseOver:function(){return[{target:"data",mutation:function(t){t.datum&&(e.scatterPlotTooltipModel=t)}}]},onMouseOut:function(){return[{target:"data",mutation:function(){e.scatterPlotTooltipModel=null}}]},onMouseEnter:function(){return[{target:"data",mutation:function(){e.shouldUpdatePosition=!0}}]},onMouseLeave:function(){return[{target:"data",mutation:function(){e.shouldUpdatePosition=!1}}]}}}]}},{key:"overflowStyle",get:function(){return{position:"relative",display:"inline-block",width:this.props.xLabels.length>37?"100%":"auto"}}},{key:"scatterChartHeight",get:function(){var e=i().uniqBy(this.scatterData,(function(e){return e.y})).length;return e>0?e*(this.barWidth()+this.barSeparation())+100:100}},{key:"scatterPlotTopPadding",get:function(){return this.barChartHeight()-100}},{key:"scatterData",get:function(){return i().map(this.props.alterationTypeDataCounts,(function(e){return Object.assign(Object.assign({},e),{symbol:e.profiledCount>0?"plus":"minus"})}))}},{key:"barPlots",get:function(){var e=this;return(this.props.hideGenomicAlterations?[j(this.props.data)]:this.props.data).map((function(t,r){return n.createElement(g.VictoryBar,{style:{data:{width:e.barWidth}},events:e.barPlotEvents,data:t,key:r})}))}}])&&I(r.prototype,o),a&&I(r,a),t}(n.Component);N([c.observable.ref],G.prototype,"barPlotTooltipModel",void 0),N([c.observable.ref],G.prototype,"scatterPlotTooltipModel",void 0),N([c.observable],G.prototype,"barToolTipCounter",void 0),N([c.observable],G.prototype,"isBarPlotTooltipHovered",void 0),N([c.observable],G.prototype,"shouldUpdatePosition",void 0),N([c.observable],G.prototype,"mousePosition",void 0),N([c.observable],G.prototype,"plotElementWidth",void 0),N([S.default],G.prototype,"getSvg",null),N([S.default],G.prototype,"assignScrollPaneRef",null),N([S.default],G.prototype,"assignDummyScrollPaneRef",null),N([S.default],G.prototype,"assignPlotSvgRef",null),N([S.default],G.prototype,"synchronizeScrollPanes",null),N([c.action.bound],G.prototype,"tooltipMouseEnter",null),N([c.action.bound],G.prototype,"tooltipMouseLeave",null),N([c.computed],G.prototype,"scatterPlotTooltipComponent",null),N([c.computed],G.prototype,"barPlotTooltipComponent",null),N([c.action.bound],G.prototype,"onMouseMove",null),N([S.default],G.prototype,"tickFormat",null),N([c.computed],G.prototype,"scatterChartHeight",null),N([c.computed],G.prototype,"scatterPlotTopPadding",null),N([c.computed],G.prototype,"scatterData",null),N([c.computed],G.prototype,"barPlots",null),N([S.default],G.prototype,"getData",null),N([S.default],G.prototype,"convertDataToDownloadData",null),N([S.default],G.prototype,"getChart",null),G=N([u.observer],G);var V=r(22680),F=r(77906);function B(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function q(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function U(e){return(U=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function H(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function W(e,t){return(W=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Y(e){return(Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var K=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":Y(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},Q={multiple:"Multiple Alterations",protExpressionLow:"Protein Low",protExpressionHigh:"Protein High",mrnaExpressionLow:"mRNA Low",mrnaExpressionHigh:"mRNA High",hetloss:"Shallow Deletion",homdel:"Deep Deletion",gain:"Gain",amp:"Amplification",structuralVariant:"Structural Variant",mutated:"Mutation"},X={protein:"Protein data",expression:"mRNA data",cna:"CNA data",mutation:"Mutation data",structuralVariant:"Structural variant data"},Z={mutated:"#008000",amp:"#ff0000",homdel:"#0000ff",hetloss:"#8fd8d8",gain:"rgb(255,182,193)",structuralVariant:"#8B00C9",mrnaExpressionHigh:"#FF989A",mrnaExpressionLow:"#529AC8",protExpressionHigh:"#FF989A",protExpressionLow:"#E0FFFF",multiple:"#666"},z=[{value:"studyId",label:"Cancer Study"},{value:"cancerType",label:"Cancer Type"},{value:"cancerTypeDetailed",label:"Cancer Type Detailed"}];function $(e,t){return e/t*100}var J=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==Y(t)&&"function"!=typeof t?H(e):t}(this,U(t).call(this,e)),Object.defineProperty(H(r),"inputYAxisEl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(H(r),"inputXAxisEl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(H(r),"totalCasesMinDefaultValue",{enumerable:!0,configurable:!0,writable:!0,value:10}),Object.defineProperty(H(r),"tempAltCasesInputValue",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(H(r),"tempTotalCasesInputValue",{enumerable:!0,configurable:!0,writable:!0,value:r.totalCasesMin}),Object.defineProperty(H(r),"pngAnchor",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(H(r),"pdf",{enumerable:!0,configurable:!0,writable:!0,value:{anchor:"",width:0,height:0}}),Object.defineProperty(H(r),"showControls",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(H(r),"hideGenomicAlterations",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(H(r),"yAxis",{enumerable:!0,configurable:!0,writable:!0,value:"alt-freq"}),Object.defineProperty(H(r),"xAxis",{enumerable:!0,configurable:!0,writable:!0,value:"y-axis"}),Object.defineProperty(H(r),"altCasesValue",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(H(r),"totalCasesValue",{enumerable:!0,configurable:!0,writable:!0,value:r.totalCasesMin}),Object.defineProperty(H(r),"tempTotalCasesValue",{enumerable:!0,configurable:!0,writable:!0,value:r.totalCasesMin}),Object.defineProperty(H(r),"tempAltCasesValue",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(H(r),"viewCountsByCancerSubType",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(H(r),"chartComponent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),(0,c.makeObservable)(H(r)),r.handleYAxisChange=r.handleYAxisChange.bind(H(r)),r.handleXAxisChange=r.handleXAxisChange.bind(H(r)),r.handleGenomicCheckboxChange=r.handleGenomicCheckboxChange.bind(H(r)),r.handleCancerTypeCheckboxChange=r.handleCancerTypeCheckboxChange.bind(H(r)),r.handleAltSliderChange=r.handleAltSliderChange.bind(H(r)),r.handleTotalSliderChange=r.handleTotalSliderChange.bind(H(r)),r.handleAltSliderChangeComplete=r.handleAltSliderChangeComplete.bind(H(r)),r.handleTotalSliderChangeComplete=r.handleTotalSliderChangeComplete.bind(H(r)),r.handleAltInputChange=r.handleAltInputChange.bind(H(r)),r.handleAltInputKeyPress=r.handleAltInputKeyPress.bind(H(r)),r.handleTotalInputChange=r.handleTotalInputChange.bind(H(r)),r.handleTotalInputKeyPress=r.handleTotalInputKeyPress.bind(H(r)),r.setPngAnchor=r.setPngAnchor.bind(H(r)),r}var r,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&W(e,t)}(t,e),r=t,(o=[{key:"componentDidMount",value:function(){this.initializeSliderValue()}},{key:"getYValue",value:function(e,t){return"abs-count"===this.yAxis?e:e/t*100}},{key:"determineSorterAndDirection",value:function(){var e,t,r=this;return"x-axis"===this.xAxis?(e=function(e){return e},t="asc"):(e="abs-count"===this.yAxis?function(e){return r.countsData[e].alteredSampleCount}:function(e){var t=r.countsData[e];return t.alteredSampleCount/t.profiledSampleTotal},t="desc"),{sorter:e,dir:t}}},{key:"transformLabel",value:function(e){return this.props.labelTransformer?this.props.labelTransformer(e):e}},{key:"handleYAxisChange",value:function(e){this.yAxis=e.target.value,this.altCasesValue=0,this.handleAltSliderChange(0)}},{key:"handleXAxisChange",value:function(e){this.xAxis=e.target.value}},{key:"handleCancerTypeCheckboxChange",value:function(){this.viewCountsByCancerSubType=!1===this.viewCountsByCancerSubType}},{key:"handleGenomicCheckboxChange",value:function(){this.hideGenomicAlterations=!this.hideGenomicAlterations}},{key:"handleAltSliderChange",value:function(e){this.tempAltCasesValue=e,this.tempAltCasesInputValue=e}},{key:"handleTotalSliderChange",value:function(e){this.tempTotalCasesValue=e,this.tempTotalCasesInputValue=e}},{key:"handleAltInputKeyPress",value:function(e){if(13===e.charCode){if(isNaN(this.tempAltCasesInputValue))return void(this.tempAltCasesInputValue=0);this.tempAltCasesInputValue=Number(this.tempAltCasesInputValue),this.tempAltCasesValue=this.tempAltCasesInputValue,this.handleAltSliderChangeComplete()}}},{key:"handleTotalInputKeyPress",value:function(e){13===e.charCode&&(isNaN(this.tempTotalCasesInputValue)?this.tempTotalCasesInputValue=this.totalCasesMin:this.tempTotalCasesInputValue>this.totalCasesMax?(this.tempTotalCasesInputValue=this.totalCasesMax,this.tempTotalCasesValue=this.totalCasesMax):(this.tempTotalCasesInputValue=Number(this.tempTotalCasesInputValue),this.tempTotalCasesValue=this.tempTotalCasesInputValue),this.handleTotalSliderChangeComplete())}},{key:"handleAltInputChange",value:function(e){this.tempAltCasesInputValue=e.target.value.replace(/[^0-9\.]/g,"")}},{key:"handleTotalInputChange",value:function(e){this.tempTotalCasesInputValue=e.target.value.replace(/[^0-9\.]/g,"")}},{key:"handleAltSliderChangeComplete",value:function(){this.altCasesValue=this.tempAltCasesValue}},{key:"handleTotalSliderChangeComplete",value:function(){this.totalCasesValue=this.tempTotalCasesValue}},{key:"initializeSliderValue",value:function(){this.tempAltCasesValue=0,this.tempAltCasesInputValue=0,this.altCasesValue=0,this.tempTotalCasesValue=this.totalCasesMin,this.tempTotalCasesInputValue=this.totalCasesMin,this.totalCasesValue=this.totalCasesMin}},{key:"setPngAnchor",value:function(e){this.pngAnchor=e}},{key:"render",value:function(){var e=this;return this.alterationTypeDataCounts.length?n.createElement(V.z,{offset:60},n.createElement(h.If,{condition:this.hasAlterations},n.createElement(h.Then,null,n.createElement("div",{"data-test":"cancerTypesSummaryDiv"},n.createElement("div",{className:"cancer-summary--main-options"},n.createElement(f.ButtonGroup,null,z.map((function(t,r){return n.createElement(f.Radio,{checked:t.value===e.props.groupAlterationsBy,onChange:function(t){e.initializeSliderValue(),e.props.handlePivotChange(F(t.target).attr("data-value"))},inline:!0,"data-value":t.value},t.label)})))),n.createElement("div",{className:b()("inlineBlock",{hidden:!this.showControls},"cancer-summary-secondary-options")},this.controls),n.createElement("div",{className:b()("alert","alert-success",{hidden:!this.totalCaseChanged&&!this.altCaseChanged})},n.createElement("span",{style:{verticalAlign:"middle"}},"".concat(this.chartData.labels.length," of ").concat(this.groupKeysSorted.length," categories (").concat(i().keyBy(z,"value")[this.props.groupAlterationsBy].label,") are shown based on filtering."))),n.createElement(G,{gene:this.props.gene,key:Date.now(),data:this.chartData.data,alterationTypeDataCounts:this.chartData.alterationTypeDataCounts,ref:function(t){return e.chartComponent=t},countsByGroup:this.countsData,representedAlterations:this.chartData.representedAlterations,alterationTypes:Q,isPercentage:"alt-freq"===this.yAxis,showLinks:this.showStudyTooltipLinks,colors:Z,hideGenomicAlterations:this.hideGenomicAlterations,xLabels:this.chartData.labels,xAxisString:(z.find((function(t){return t.value==e.props.groupAlterationsBy}))||{}).label||"Cancer",handleStudyLinkout:this.props.handleStudyLinkout}))),n.createElement(h.Else,null,n.createElement("div",{className:"alert alert-info"},"There are no alterations in this gene.")))):n.createElement("div",{className:"alert alert-info"},"No data to plot.")}},{key:"countsData",get:function(){return this.props.groupedAlterationData}},{key:"groupKeysSorted",get:function(){var e=this.determineSorterAndDirection(),t=e.dir,r=e.sorter;return i().chain(this.countsData).keys().orderBy(r,[t]).value()}},{key:"alterationTypeDataCounts",get:function(){var e=this,t=[];return i().forEach(this.groupKeysSorted,(function(r){var n,o=e.countsData[r],a=i().chain(o.profiledSamplesCounts).values().sum().value(),l=$(o.alteredSampleCount,o.profiledSampleTotal);n="abs-count"===e.yAxis?o.alteredSampleCount>=e.tempAltCasesValue:l>=e.tempAltCasesValue;var s=o.profiledSampleTotal>=e.totalCasesValue;a>0&&n&&s&&i().forEach(i().keys(X),(function(n){var i=o.profiledSamplesCounts[n],a=o.notProfiledSamplesCounts[n];i+a>0&&t.push({x:e.props.labelTransformer?e.props.labelTransformer(r):r,y:X[n],profiledCount:i,notProfiledCount:a})}))})),t}},{key:"chartData",get:function(){var e=this,t={},r=0,n=0,o=0,a=[],l=i().map(Q,(function(l,s){return i().reduce(e.groupKeysSorted,(function(l,u){var c,p=e.countsData[u],d=i().chain(p.profiledSamplesCounts).values().sum().value(),f=$(p.alteredSampleCount,p.profiledSampleTotal);c="abs-count"===e.yAxis?p.alteredSampleCount>=e.tempAltCasesValue:f>=e.tempAltCasesValue;var m=p.profiledSampleTotal>=e.totalCasesValue;if(d>0&&c&&m){var h=e.props.labelTransformer?e.props.labelTransformer(u):u;a.push(h),r=f>r?f:r,n=p.alteredSampleCount>n?p.alteredSampleCount:n,o=p.profiledSampleTotal>o?p.profiledSampleTotal:o;var y=p.alterationTypeCounts[s];y>0&&(t[s]=!0),l.push({alterationType:s,alterationCount:y,x:h,xKey:u,y:e.getYValue(y,p.profiledSampleTotal)})}return l}),[])}));return{labels:i().uniq(a),data:l,alterationTypeDataCounts:this.alterationTypeDataCounts,representedAlterations:t,maxPercentage:r,maxAbsoluteCount:n,maxSampleCount:o}}},{key:"altCasesMax",get:function(){return"abs-count"===this.yAxis?this.chartData.maxAbsoluteCount:this.chartData.maxPercentage}},{key:"totalCasesMax",get:function(){return this.chartData.maxSampleCount}},{key:"totalCasesMin",get:function(){return this.totalCasesMax>10?this.totalCasesMinDefaultValue:0}},{key:"hasAlterations",get:function(){return i().reduce(this.countsData,(function(e,t){return e+t.alterationTotal}),0)>0}},{key:"totalCaseChanged",get:function(){return this.totalCasesValue>0}},{key:"altCaseChanged",get:function(){return this.altCasesValue>0}},{key:"showStudyTooltipLinks",get:function(){return"studyId"===this.props.groupAlterationsBy&&this.chartData.labels.length>1}},{key:"controls",get:function(){var e=this,t="alt-freq"===this.yAxis?"%":"";return n.createElement("div",{className:"cancer-summary--form-controls"},n.createElement("table",null,n.createElement("tr",null,n.createElement("td",null,n.createElement(f.ControlLabel,null,"Y-Axis Value:")),n.createElement("td",{className:"dashed-border-right"},n.createElement(f.FormControl,{componentClass:"select","data-test":"cancerSummaryYAxisSelect",onChange:this.handleYAxisChange,ref:function(t){return e.inputYAxisEl=t}},n.createElement("option",{value:"alt-freq"},"Alteration Frequency"),n.createElement("option",{value:"abs-count"},"Absolute Counts"))),n.createElement("td",null,n.createElement(f.ControlLabel,null,"Min. # Total Cases:")),n.createElement("td",null,n.createElement("div",{className:"slider-holder"},n.createElement("div",{className:"slider custom-labels"},n.createElement(m.default,{min:0,max:this.totalCasesMax,value:this.tempTotalCasesValue,labels:B({0:0},this.totalCasesMax,this.totalCasesMax),onChange:this.handleTotalSliderChange,onChangeComplete:this.handleTotalSliderChangeComplete})))),n.createElement("td",{className:b()(this.totalCaseChanged?"highlightInput":"","dashed-border-right","slider-input")},n.createElement(f.FormControl,{type:"text",value:this.tempTotalCasesInputValue,"data-test":"sampleTotalThresholdInput",onChange:this.handleTotalInputChange,onKeyPress:this.handleTotalInputKeyPress})),n.createElement("td",null,n.createElement(f.Checkbox,{checked:!this.hideGenomicAlterations,onChange:this.handleGenomicCheckboxChange},"Show Genomic Alteration Types"))),n.createElement("tr",null,n.createElement("td",null,n.createElement(f.ControlLabel,null,"Sort X-Axis By:")),n.createElement("td",{className:"dashed-border-right"},n.createElement(f.FormControl,{componentClass:"select","data-test":"cancerSummaryXAxisSelect",onChange:this.handleXAxisChange,ref:function(t){return e.inputXAxisEl=t}},n.createElement("option",{value:"y-axis"},"Y-Axis Values"),n.createElement("option",{value:"x-axis"},"Alphabetically"))),n.createElement("td",null,n.createElement(f.ControlLabel,null,"Min. ".concat("alt-freq"===this.yAxis?"%":"#"," Altered Cases:"))),n.createElement("td",null,n.createElement("div",{className:"slider-holder"},n.createElement("div",{className:"slider custom-labels"},n.createElement(m.default,{min:0,max:this.altCasesMax,value:this.tempAltCasesValue,labels:B({0:0+t},this.altCasesMax,Math.ceil(this.altCasesMax)+t),format:function(e){return e+t},onChange:this.handleAltSliderChange,onChangeComplete:this.handleAltSliderChangeComplete})))),n.createElement("td",{className:b()(this.altCaseChanged?"highlightInput":"","dashed-border-right","slider-input")},n.createElement(f.FormControl,{type:"text",value:this.tempAltCasesInputValue+t,onChange:this.handleAltInputChange,"data-test":"alterationThresholdInput",onKeyPress:this.handleAltInputKeyPress})))))}}])&&q(r.prototype,o),a&&q(r,a),t}(n.Component);K([c.observable],J.prototype,"tempAltCasesInputValue",void 0),K([c.observable],J.prototype,"tempTotalCasesInputValue",void 0),K([c.observable],J.prototype,"pngAnchor",void 0),K([c.observable],J.prototype,"pdf",void 0),K([c.observable],J.prototype,"showControls",void 0),K([c.observable],J.prototype,"hideGenomicAlterations",void 0),K([c.observable],J.prototype,"yAxis",void 0),K([c.observable],J.prototype,"xAxis",void 0),K([c.observable],J.prototype,"altCasesValue",void 0),K([c.observable],J.prototype,"totalCasesValue",void 0),K([c.observable],J.prototype,"tempTotalCasesValue",void 0),K([c.observable],J.prototype,"tempAltCasesValue",void 0),K([c.observable],J.prototype,"viewCountsByCancerSubType",void 0),K([c.computed],J.prototype,"alterationTypeDataCounts",null),K([c.computed],J.prototype,"chartData",null),K([c.computed],J.prototype,"altCasesMax",null),K([c.computed],J.prototype,"totalCasesMax",null),K([c.computed],J.prototype,"totalCasesMin",null),K([c.computed],J.prototype,"hasAlterations",null),K([c.computed],J.prototype,"totalCaseChanged",null),K([c.computed],J.prototype,"altCaseChanged",null),K([c.computed],J.prototype,"showStudyTooltipLinks",null),K([c.action],J.prototype,"handleTotalInputKeyPress",null),K([c.action],J.prototype,"initializeSliderValue",null),K([c.computed],J.prototype,"controls",null),J=K([u.observer],J);var ee=r(36903),te=r(85157);function re(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ne(e,t,r,n,o){return i().mapValues(e,(function(e,a){var l={mutated:0,amp:0,homdel:0,hetloss:0,gain:0,structuralVariant:0,mrnaExpressionHigh:0,mrnaExpressionLow:0,protExpressionHigh:0,protExpressionLow:0,multiple:0},s={mutation:0,cna:0,expression:0,protein:0,structuralVariant:0},u={mutation:0,cna:0,expression:0,protein:0,structuralVariant:0},c={profiledSampleTotal:0,alterationTotal:0,alterationTypeCounts:l,alteredSampleCount:0,parentCancerType:e[0].cancerType,profiledSamplesCounts:s,notProfiledSamplesCounts:u};return i().forEach(e,(function(e){var a=!1;if(i().forEach(r,(function(t,r){var l=i().some((0,te.n0)(e.uniqueSampleKey,i().map(t,(function(e){return e.molecularProfileId})),n,o));switch(a=a||l,r){case p.YK.COPY_NUMBER_ALTERATION:l?s.cna++:u.cna++;break;case p.YK.MRNA_EXPRESSION:l?s.expression++:u.expression++;break;case p.YK.PROTEIN_LEVEL:l?s.protein++:u.protein++;break;case p.YK.MUTATION_EXTENDED:l?s.mutation++:u.mutation++;break;case p.YK.STRUCTURAL_VARIANT:l?s.structuralVariant++:u.structuralVariant++}})),a&&(c.profiledSampleTotal+=1),e.uniqueSampleKey in t){var d=t[e.uniqueSampleKey],f=i().uniqBy(d,(function(e){return e.alterationType}));c.alterationTotal+=f.length,f.length>0&&(c.alteredSampleCount+=1),f.length>1?l.multiple++:i().forEach(f,(function(e){switch(e.alterationType){case p.YK.COPY_NUMBER_ALTERATION:l[e.alterationSubType]++;break;case p.YK.MRNA_EXPRESSION:"high"===e.alterationSubType&&l.mrnaExpressionHigh++,"low"===e.alterationSubType&&l.mrnaExpressionLow++;break;case p.YK.PROTEIN_LEVEL:"high"===e.alterationSubType&&l.protExpressionHigh++,"low"===e.alterationSubType&&l.protExpressionLow++;break;case p.YK.MUTATION_EXTENDED:l.mutated++;break;case p.YK.STRUCTURAL_VARIANT:l.structuralVariant++}}))}})),c}))}var oe=r(50558),ie=r(41940),ae=r(71198),le=r(41359),se=r(62524),ue=r(79431),ce=r(71780);function pe(){return(pe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function de(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function me(e){return(me=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function he(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ye(e,t){return(ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function be(e){return(be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ge=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":be(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},ve="all",Se=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==be(t)&&"function"!=typeof t?he(e):t}(this,me(t).call(this,e)),Object.defineProperty(he(r),"activeTab",{enumerable:!0,configurable:!0,writable:!0,value:ve}),Object.defineProperty(he(r),"resultsViewPageWidth",{enumerable:!0,configurable:!0,writable:!0,value:1150}),Object.defineProperty(he(r),"groupAlterationsBy_userSelection",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(he(r),"resultsViewPageContent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),(0,c.makeObservable)(he(r)),r.handleTabClick=r.handleTabClick.bind(he(r)),r.pivotData=r.pivotData.bind(he(r)),r.mapStudyIdToName=r.mapStudyIdToName.bind(he(r)),r}var r,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ye(e,t)}(t,e),r=t,(o=[{key:"handleTabClick",value:function(e){this.activeTab=e}},{key:"pivotData",value:function(e){this.groupAlterationsBy_userSelection=e}},{key:"mapStudyIdToName",value:function(e){return e in this.props.store.physicalStudySet?(0,ce.C8)(this.props.store.physicalStudySet[e].name):e}},{key:"handleStudyLinkout",value:function(e,t){var r,n=Object.assign({},this.props.store.urlWrapper.query,(de(r={},le.O.cancer_study_list,e),de(r,le.O.gene_list,t||this.props.store.urlWrapper.query.gene_list),r));window.open((0,se.gN)("/results")).clientPostedData=n}},{key:"render",value:function(){var e=this;switch((0,ie.CX)(this.props.store.filteredSamplesExtendedWithClinicalData,this.props.store.oqlFilteredAlterationsByGeneBySampleKey,this.props.store.studies,this.props.store.filteredSequencedSampleKeysByGene,this.props.store.selectedMolecularProfileIdsByAlterationType,this.props.store.coverageInformation)){case"pending":return n.createElement(ee.Z,{isLoading:!0,center:!0,size:"big"});case"error":return null;case"complete":return n.createElement("div",{ref:function(t){return e.resultsViewPageContent=t},"data-test":"cancerTypeSummaryWrapper"},n.createElement("div",{className:"tabMessageContainer"},n.createElement(oe.Z,{className:"cancer-types-summary-oql-status-banner",store:this.props.store,tabReflectsOql:!0}),n.createElement(ae.Z,{store:this.props.store}),n.createElement(ue.Z,{store:this.props.store})),n.createElement(d.Kh,{onTabClick:this.handleTabClick,unmountOnHide:!0,arrowStyle:{"line-height":.8},tabButtonStyle:"pills",activeTabId:this.activeTab,className:"pillTabs"},this.tabs))}}},{key:"defaultTabId",get:function(){return ve}},{key:"groupAlterationsBy",get:function(){return void 0===this.groupAlterationsBy_userSelection?this.props.store.studies.result.length>1?"studyId":1===i().chain(this.props.store.filteredSamplesExtendedWithClinicalData.result).map((function(e){return e.cancerType})).uniq().value().length?"cancerTypeDetailed":"cancerType":this.groupAlterationsBy_userSelection}},{key:"tabs",get:function(){var e,t,r,o,a,l=this,s="studyId"===this.groupAlterationsBy?this.mapStudyIdToName:void 0,u=(e=this.props.store.oqlFilteredAlterationsByGeneBySampleKey.result,t=this.props.store.filteredSamplesExtendedWithClinicalData.result,r=this.groupAlterationsBy,o=this.props.store.selectedMolecularProfileIdsByAlterationType.result,a=this.props.store.coverageInformation.result,i().mapValues(e,(function(e,n){return ne(i().groupBy(t,(function(e){return e[r]})),e,o,a,n)}))),c=i().map(this.props.store.genes.result,(function(e){var t=u[e.hugoGeneSymbol],r=0===i().reduce(t,(function(e,t){return e+t.alterationTotal}),0)?{color:"#bbb"}:void 0;return n.createElement(d.l6,pe({key:e.hugoGeneSymbol,id:"summaryTab"+e.hugoGeneSymbol,linkText:e.hugoGeneSymbol},{anchorStyle:r}),n.createElement(J,{groupedAlterationData:u[e.hugoGeneSymbol],handleStudyLinkout:l.handleStudyLinkout,groupAlterationsBy:l.groupAlterationsBy,gene:e.hugoGeneSymbol,labelTransformer:s,handlePivotChange:l.pivotData,width:l.resultsViewPageWidth}))}));if(c.length>1){var p=function(e,t,r,n,o){var a=i().groupBy(t,(function(e){return e[r]})),l=i().flatMap(e,(function(e){return e}));return ne(a,i().mergeWith.apply(i(),[{}].concat(re(l),[function(e,t){if(i().isArray(e))return e.concat(t)}])),n,o)}(this.props.store.oqlFilteredAlterationsByGeneBySampleKey.result,this.props.store.filteredSamplesExtendedWithClinicalData.result,this.groupAlterationsBy,this.props.store.selectedMolecularProfileIdsByAlterationType.result,this.props.store.coverageInformation.result);c.unshift(n.createElement(d.l6,{key:ve,id:"allGenes",linkText:"All Queried Genes"},n.createElement(J,{gene:ve,width:this.resultsViewPageWidth,groupedAlterationData:p,handlePivotChange:this.pivotData,labelTransformer:s,groupAlterationsBy:this.groupAlterationsBy,handleStudyLinkout:this.handleStudyLinkout})))}return c}}])&&fe(r.prototype,o),a&&fe(r,a),t}(n.Component);ge([c.observable],Se.prototype,"activeTab",void 0),ge([c.observable],Se.prototype,"resultsViewPageWidth",void 0),ge([c.observable],Se.prototype,"groupAlterationsBy_userSelection",void 0),ge([c.computed],Se.prototype,"tabs",null),ge([S.default],Se.prototype,"handleStudyLinkout",null);const Ee=Se=ge([u.observer],Se);var Ce=r(19483),we=r(54615),Te=r(79054),Pe=r(75508);function Oe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ke(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ae(e,t,r){return t&&ke(e.prototype,t),r&&ke(e,r),e}function Ie(e,t){return!t||"object"!==Ne(t)&&"function"!=typeof t?_e(e):t}function _e(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function De(e){return(De=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xe(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Me(e,t)}function Me(e,t){return(Me=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ne(e){return(Ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Le=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":Ne(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},Re=function(e){function t(){return Oe(this,t),Ie(this,De(t).apply(this,arguments))}return xe(t,e),Ae(t,[{key:"render",value:function(){return n.createElement("span",{onClick:this.props.onClickFilter,style:{color:this.props.isActive?"#0000ff":Pe.LN,display:"inline-block",cursor:"pointer",visibility:"hidden",marginLeft:5,marginTop:-1}},n.createElement("i",{className:"fa fa-filter"}))}}]),t}(n.Component),je=function(e){function t(){var e;return Oe(this,t),e=Ie(this,De(t).apply(this,arguments)),Object.defineProperty(_e(e),"pullRight",{enumerable:!0,configurable:!0,writable:!0,value:!1}),e}return xe(t,e),Ae(t,[{key:"componentDidUpdate",value:function(){var e=document.getElementById(this.props.id).getBoundingClientRect();e.right>window.innerWidth&&(this.pullRight=!0);var t=0,r=window.innerHeight;e.bottom>r&&(t=e.bottom-r+15),window.scroll(window.scrollX,window.scrollY+t)}},{key:"render",value:function(){return n.createElement("div",{id:this.props.id,className:b()("dropdown-menu",this.pullRight?"pull-right":"pull-left"),style:{transform:this.pullRight?"translateX(10px)":"translateX(-5px)",visibility:this.props.isOpen?"visible":"hidden"}},n.createElement("div",{style:{margin:"6px",marginBottom:"0px"}},this.props.id,n.createElement("div",{style:{marginTop:"10px"}},this.props.menuComponent),n.createElement("button",{className:"btn btn-default btn-xs",onClick:this.props.onClickRemove,disabled:!this.props.isActive,style:{marginTop:"10px",float:"right"}},"Remove filter")))}}]),t}(n.Component);Le([c.observable],je.prototype,"pullRight",void 0);var Ge=function(e){function t(e){var r;return Oe(this,t),r=Ie(this,De(t).call(this,e)),Object.defineProperty(_e(r),"isOpen",{enumerable:!0,configurable:!0,writable:!0,value:!1}),(0,c.makeObservable)(_e(r)),r}return xe(t,e),Ae(t,[{key:"hide",value:function(){this.isOpen=!1}},{key:"onClickRemove",value:function(){this.isOpen=!1,this.props.deactivateFilter()}},{key:"onClickFilter",value:function(){this.isOpen=!this.isOpen,this.props.filterIsActive||this.props.setupFilter()}},{key:"render",value:function(){return n.createElement(Te.zx,{onRootClose:this.hide},n.createElement(f.Dropdown,{id:this.props.id+" filterIconModal",open:this.isOpen},n.createElement(Re,{bsRole:"toggle",isActive:this.props.filterIsActive,onClickFilter:this.onClickFilter}),n.createElement(je,{bsRole:"menu",id:this.props.id,isOpen:this.isOpen,isActive:this.props.filterIsActive,onClickRemove:this.onClickRemove,menuComponent:this.props.menuComponent})))}}]),t}(n.Component);Le([c.observable],Ge.prototype,"isOpen",void 0),Le([c.action.bound],Ge.prototype,"hide",null),Le([c.action.bound],Ge.prototype,"onClickRemove",null),Le([c.action.bound],Ge.prototype,"onClickFilter",null);const Ve=Ge=Le([u.observer],Ge);var Fe=r(66072);function Be(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function qe(e){return(qe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ue(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function He(e,t){return(He=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function We(e){return(We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Ye=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":We(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},Ke="135px",Qe=Math.pow(10,10),Xe=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==We(t)&&"function"!=typeof t?Ue(e):t}(this,qe(t).call(this,e)),Object.defineProperty(Ue(r),"justReleasedHandle",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),(0,c.makeObservable)(Ue(r)),r.justReleasedHandle=!1,r.state={lowerValue:r.props.lowerValue||r.min,upperValue:r.props.upperValue||r.max},r}var r,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&He(e,t)}(t,e),r=t,(o=[{key:"componentDidMount",value:function(){this.syncValues(!0),this.syncValues(!1)}},{key:"componentDidUpdate",value:function(e){e!==this.props?this.setState({lowerValue:this.props.lowerValue||this.min,upperValue:this.props.upperValue||this.max}):(this.syncValues(!0),this.syncValues(!1))}},{key:"syncValues",value:function(e,t){if(e){this.LH.value=""+this.state.lowerValue,this.LB.value=""+this.state.lowerValue;var r=(this.state.lowerValue-this.min)/(this.max-this.min);this.MID.style.left=100*r+"%",t&&this.props.callbackLowerValue(this.state.lowerValue)}else{this.UH.value=""+this.state.upperValue,this.UB.value=""+this.state.upperValue;var n=(this.max-this.state.upperValue)/(this.max-this.min);this.MID.style.right=100*n+"%",t&&this.props.callbackUpperValue(this.state.upperValue)}this.updateInputBoxWidth(e)}},{key:"updateInputBoxWidth",value:function(e){e?this.LB.style.width=7*(this.LB.value.length+3)+"px":this.UB.style.width=7*(this.UB.value.length+3)+"px"}},{key:"onChangeInputBox",value:function(e,t,r,n,o,i){return(0,Fe._)((function(a){!a||r(+a)?o(e):n(+a)?o(t):isNaN(+a)?i():o(+a)}),300)}},{key:"onChangeSlider",value:function(e,t,r){var n=this;return function(o){if(n.justReleasedHandle)n.justReleasedHandle=!1,n.syncValues(e);else{var i=e?n.state.upperValue:n.state.lowerValue,a=t(+o.target.value)?i:+o.target.value;r(a)}}}},{key:"render",value:function(){var e=this;return n.createElement("div",{style:{width:Ke,margin:"auto",display:"flex",flexDirection:"column"}},n.createElement("div",{className:"slider"},n.createElement("div",{className:"mainTrack"}),n.createElement("div",{id:this.MIDId,className:"middleTrack"}),n.createElement("input",{type:"range",id:this.LHId,className:"handle",min:this.min,max:this.max,step:this.defaultStepSize,defaultValue:""+this.state.lowerValue,onMouseUp:function(t){e.justReleasedHandle=!0,e.setState({lowerValue:+t.target.value},(function(){return e.syncValues(!0,!0)}))},onChange:this.onChangeSlider(!0,(function(t){return t>e.state.upperValue}),(function(t){return e.setState({lowerValue:t},(function(){return e.syncValues(!0)}))}))}),n.createElement("input",{type:"range",id:this.UHId,className:"handle",min:this.min,max:this.max,step:this.defaultStepSize,defaultValue:""+this.state.upperValue,onMouseUp:function(t){e.justReleasedHandle=!0,e.setState({upperValue:+t.target.value},(function(){return e.syncValues(!1,!0)}))},onChange:this.onChangeSlider(!1,(function(t){return t<e.state.lowerValue}),(function(t){return e.setState({upperValue:t},(function(){return e.syncValues(!1)}))}))})),n.createElement("div",{style:{marginTop:"13px"}},n.createElement("input",{id:this.LBId,className:"form-control input-sm",style:{float:"left",maxWidth:Ke},defaultValue:""+this.state.lowerValue,onChange:this.onChangeInputBox(this.min,this.state.upperValue,(function(t){return t<e.min}),(function(t){return t>e.state.upperValue}),(function(t){return e.setState({lowerValue:t},(function(){return e.syncValues(!0,!0)}))}),(function(){return e.syncValues(!0)})),onInput:function(){return e.updateInputBoxWidth(!0)}}),n.createElement("input",{id:this.UBId,className:"form-control input-sm",style:{float:"right",maxWidth:Ke},defaultValue:""+this.state.upperValue,onChange:this.onChangeInputBox(this.max,this.state.lowerValue,(function(t){return t>e.max}),(function(t){return t<e.state.lowerValue}),(function(t){return e.setState({upperValue:t},(function(){return e.syncValues(!1,!0)}))}),(function(){return e.syncValues(!1)})),onInput:function(){return e.updateInputBoxWidth(!1)}})))}},{key:"min",get:function(){var e=+(+this.props.min).toFixed(11);return Math.floor(Qe*e)/Qe}},{key:"max",get:function(){var e=+(+this.props.max).toFixed(11);return Math.ceil(Qe*e)/Qe}},{key:"id",get:function(){return this.props.id.replace(/\s+/,"_")}},{key:"LHId",get:function(){return this.id+"-lowerValue-handle"}},{key:"UHId",get:function(){return this.id+"-upperValue-handle"}},{key:"LBId",get:function(){return this.id+"-lowerValue-box"}},{key:"UBId",get:function(){return this.id+"-upperValue-box"}},{key:"MIDId",get:function(){return this.id+"-middleTrack"}},{key:"LH",get:function(){return document.getElementById(this.LHId)}},{key:"UH",get:function(){return document.getElementById(this.UHId)}},{key:"LB",get:function(){return document.getElementById(this.LBId)}},{key:"UB",get:function(){return document.getElementById(this.UBId)}},{key:"MID",get:function(){for(var e=document.getElementsByClassName("middleTrack"),t=0;t<e.length;t++)if(e[t].id===this.MIDId)return e[t];return e[0]}},{key:"defaultStepSize",get:function(){var e=this.props.min,t=this.props.max;return"string"==typeof e&&e.includes(".")||"string"==typeof t&&t.includes(".")?(this.max-this.min)/100:1}}])&&Be(r.prototype,o),i&&Be(r,i),t}(n.Component);function Ze(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ze(e){return(ze=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $e(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Je(e,t){return(Je=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function et(e){return(et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Ye([c.computed],Xe.prototype,"min",null),Ye([c.computed],Xe.prototype,"max",null),Ye([c.computed],Xe.prototype,"id",null),Ye([c.computed],Xe.prototype,"defaultStepSize",null),Ye([c.action],Xe.prototype,"onChangeInputBox",null),Ye([c.action],Xe.prototype,"onChangeSlider",null);var tt=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":et(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},rt=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==et(t)&&"function"!=typeof t?$e(e):t}(this,ze(t).call(this,e)),Object.defineProperty($e(r),"filterString",{enumerable:!0,configurable:!0,writable:!0,value:""}),(0,c.makeObservable)($e(r)),r}var r,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Je(e,t)}(t,e),r=t,(o=[{key:"componentDidUpdate",value:function(){this.props.emptyFilterString&&(this.filterString="")}},{key:"onChangeFilterCondition",value:function(e){var t=e.target.value;this.props.updateFilterCondition(t)}},{key:"onChangeFilterString",value:function(e){var t=this,r=e.target.value;this.filterString=r,window.setTimeout((function(){t.props.updateFilterString(r)}),400)}},{key:"selectAll",value:function(){var e=this,t=new Set;this.props.allSelections.forEach((function(r){e.props.currSelections.has(r)||t.add(r)})),this.props.toggleSelections(t),this.forceUpdate()}},{key:"deselectAll",value:function(){var e=this,t=new Set;this.props.allSelections.forEach((function(r){e.props.currSelections.has(r)&&t.add(r)})),this.props.toggleSelections(t),this.forceUpdate()}},{key:"onChangeSelection",value:function(e){var t=e.currentTarget.getAttribute("data-id");void 0!==t&&(this.props.toggleSelections(new Set([t])),this.forceUpdate())}},{key:"render",value:function(){return n.createElement("div",{style:{margin:"auto",display:"flex",flexDirection:"column"}},n.createElement("div",{style:{display:"flex"}},this.filterConditionDropdown,this.filterStringInputBox),n.createElement("div",{style:{marginTop:10}},this.selectDeselectAllButtons),n.createElement("div",{style:{marginTop:10,paddingLeft:10,maxHeight:250,maxWidth:320,overflow:"auto",whiteSpace:"nowrap"}},this.selectionCheckboxes))}},{key:"filterConditionDropdown",get:function(){return n.createElement("select",{className:"form-control input-sm",onChange:this.onChangeFilterCondition,style:{width:"160px"}},n.createElement("option",{value:"contains"},"Contains"),n.createElement("option",{value:"doesNotContain"},"Does Not Contain"),n.createElement("option",{value:"equals"},"Equals"),n.createElement("option",{value:"doesNotEqual"},"Does Not Equal"),n.createElement("option",{value:"beginsWith"},"Begins With"),n.createElement("option",{value:"doesNotBeginWith"},"Does Not Begin With"),n.createElement("option",{value:"endsWith"},"Ends With"),n.createElement("option",{value:"doesNotEndWith"},"Does Not End With"),n.createElement("option",{value:"regex"},"Regular Expression"))}},{key:"filterStringInputBox",get:function(){return n.createElement("input",{className:"form-control input-sm",value:this.filterString,onChange:this.onChangeFilterString,style:{width:"160px"},"data-test":"categorical-filter-menu-search-input"})}},{key:"selectDeselectAllButtons",get:function(){var e=this.props.currSelections.size!==this.props.allSelections.size,t=0!==this.props.currSelections.size;return n.createElement("div",{style:{display:"flex",alignItems:"baseline"}},e&&n.createElement("button",{className:"btn btn-default btn-xs",onClick:this.selectAll},"Select all (".concat(this.props.allSelections.size,")")),t&&n.createElement("button",{className:"btn btn-default btn-xs",onClick:this.deselectAll},"Deselect all"))}},{key:"sortedSelections",get:function(){return Array.from(this.props.allSelections).sort()}},{key:"selectionCheckboxes",get:function(){var e=this;return this.sortedSelections.map((function(t){return n.createElement(f.Checkbox,{"data-id":t,onChange:e.onChangeSelection,checked:e.props.currSelections.has(t)},n.createElement(w.Ld,{maxLength:37,text:t,tooltip:n.createElement("div",{style:{maxWidth:300}},t)}))}))}}])&&Ze(r.prototype,o),i&&Ze(r,i),t}(n.Component);tt([c.observable],rt.prototype,"filterString",void 0),tt([c.action.bound],rt.prototype,"onChangeFilterCondition",null),tt([c.computed],rt.prototype,"filterConditionDropdown",null),tt([c.action.bound],rt.prototype,"onChangeFilterString",null),tt([c.computed],rt.prototype,"filterStringInputBox",null),tt([c.action.bound],rt.prototype,"selectAll",null),tt([c.action.bound],rt.prototype,"deselectAll",null),tt([c.computed],rt.prototype,"selectDeselectAllButtons",null),tt([c.action.bound],rt.prototype,"onChangeSelection",null),tt([c.computed],rt.prototype,"sortedSelections",null),tt([c.computed],rt.prototype,"selectionCheckboxes",null);const nt=rt=tt([u.observer],rt);var ot=r(65463),it=r.n(ot),at=r(28775),lt=r(22157);function st(){return(st=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function ut(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ct(e){return(ct=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dt(e,t){return(dt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ft(e){return(ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var mt=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":ft(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};function ht(e){return e.description?n.createElement("span",null,e.title,n.createElement(w.ZD,{placement:"right",overlay:n.createElement("span",null,e.description)},n.createElement("i",{className:"fa fa-info-circle",style:{marginLeft:"0.2rem"}}))):e.title}var yt=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==ft(t)&&"function"!=typeof t?pt(e):t}(this,ct(t).call(this,e)),(0,c.makeObservable)(pt(r)),r}var r,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dt(e,t)}(t,e),r=t,(o=[{key:"render",value:function(){return void 0===this.props.germlineContent?n.createElement(n.Fragment,null,this.somaticInfo,this.germlinePlaceholder):n.createElement(Ce.PY,st({badgeSelectorOptions:this.mutationStatusFilterOptions},this.props))}},{key:"mutationStatusFilterOptions",get:function(){var e=[{value:"Somatic",label:ht(this.props.somaticContent),badgeStyleOverride:Ce.nk,badgeStyleSelectedOverride:Ce.nk}];return this.props.germlineContent&&e.push({value:"Germline",label:ht(this.props.germlineContent),badgeStyleOverride:Ce.nk,badgeStyleSelectedOverride:Ce.nk}),e}},{key:"somaticInfo",get:function(){return this.props.rates?n.createElement(Ce.Bo,{label:ht(this.props.somaticContent),badgeContent:"".concat((0,ie.C_)(this.props.rates.Somatic),"%"),badgeStyleOverride:this.mutationStatusFilterOptions[0].badgeStyleOverride}):null}},{key:"germlinePlaceholder",get:function(){return n.createElement("div",{"data-test":"germlineMutationRate",className:"invisible",style:{display:"none"}},"%")}}])&&ut(r.prototype,o),i&&ut(r,i),t}(n.Component);mt([c.computed],yt.prototype,"mutationStatusFilterOptions",null);const bt=yt=mt([u.observer],yt);function gt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function vt(e){return(vt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function St(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Et(e,t){return(Et=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ct(e){return(Ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var wt=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":Ct(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},Tt=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==Ct(t)&&"function"!=typeof t?St(e):t}(this,vt(t).call(this,e)),(0,c.makeObservable)(St(r)),r}var r,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Et(e,t)}(t,e),r=t,(o=[{key:"render",value:function(){return n.createElement("span",{"data-test":"mutation-rate-summary"},n.createElement(bt,{filter:this.props.mutationStatusFilter,onSelect:this.props.onMutationStatusSelect,rates:{Germline:this.germlineMutationRate,Somatic:this.somaticMutationRate},somaticContent:{title:"Somatic Mutation Frequency",description:"Percentage of samples with a somatic mutation in ".concat(this.props.hugoGeneSymbol)},germlineContent:this.germlineMutationRate>0?{title:"Germline Mutation Frequency",description:"Percentage of samples with a germline mutation in ".concat(this.props.hugoGeneSymbol)}:void 0}))}},{key:"germlineMutationRate",get:function(){var e;return"pending"!==this.props.germlineConsentedSamples.status&&(e=this.props.germlineConsentedSamples&&this.props.germlineConsentedSamples.result&&this.props.germlineConsentedSamples.result.length>0?this.props.germlineConsentedSamples.result:this.props.samples),e?(0,we.Ho)(this.props.hugoGeneSymbol,this.props.mutations,this.props.molecularProfileIdToMolecularProfile.result,e):0}},{key:"somaticMutationRate",get:function(){return this.props.samples.length>0?(0,we.F)(this.props.hugoGeneSymbol,this.props.mutations,this.props.molecularProfileIdToMolecularProfile.result,this.props.samples):0}}])&&gt(r.prototype,o),i&&gt(r,i),t}(n.Component);wt([c.computed],Tt.prototype,"germlineMutationRate",null),wt([c.computed],Tt.prototype,"somaticMutationRate",null);const Pt=Tt=wt([u.observer],Tt);var Ot=r(62043),kt=r(74944),At=r(17328),It=r(90860),_t=r(1765),Dt=r(64015),xt=r(52638),Mt=r(97392);function Nt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Lt(e){return(Lt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Rt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jt(e,t){return(jt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Gt(e){return(Gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Vt,Ft=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":Gt(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};!function(e){e.MUTATIONS="Mutations",e.CLINICAL="Clinical"}(Vt||(Vt={}));var Bt=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==Gt(t)&&"function"!=typeof t?Rt(e):t}(this,Lt(t).call(this,e)),Object.defineProperty(Rt(r),"tabId",{enumerable:!0,configurable:!0,writable:!0,value:Vt.MUTATIONS}),(0,c.makeObservable)(Rt(r)),r}var r,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jt(e,t)}(t,e),r=t,(o=[{key:"updateTabId",value:function(e){this.tabId=e}},{key:"addAll",value:function(e,t){if(this.props.onColumnToggled&&t.length>0){var r=!0,n=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(r=(i=a.next()).done);r=!0){var l=i.value;!l.selected&&e.includes(l.key)&&this.props.onColumnToggled(l.key)}}catch(e){n=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(n)throw o}}}}},{key:"clearAll",value:function(e,t){if(this.props.onColumnToggled&&t.length>0){var r=!0,n=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(r=(i=a.next()).done);r=!0){var l=i.value;l.selected&&e.includes(l.key)&&this.props.onColumnToggled(l.key)}}catch(e){n=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(n)throw o}}}}},{key:"toggle",value:function(e){this.props.onColumnToggled&&this.props.onColumnToggled(e)}},{key:"getTextPixel",value:function(e,t){return Math.floor((0,w.mY)(e,"Helvetica Neue",t))}},{key:"render",value:function(){var e=this.mutationsOptions.length>0,t=this.clinicalOptions.length>0,r=e||t;return n.createElement("div",{style:{float:"right"}},n.createElement(xt.Z,{bsStyle:"default",title:this.dropdownButtonText,id:"addColumnsDropdown",className:this.props.className,styles:{minWidth:400,width:"auto"},buttonClassName:"btn btn-default btn-sm"},n.createElement("div",{style:{display:"flex",flexDirection:"column"}},r&&n.createElement(d.Kh,{activeTabId:this.tabId,onTabClick:this.updateTabId,unmountOnHide:!1,className:"mainTabs mutationsTabAddColumnsDropdown"},e&&n.createElement(d.l6,{key:0,id:Vt.MUTATIONS,linkText:this.mutationsTabText},this.mutationsTabContent),t&&n.createElement(d.l6,{key:1,id:Vt.CLINICAL,linkText:this.clinicalTabText},this.clinicalTabContent)),r&&this.props.showResetColumnsButton&&n.createElement("button",{style:{position:"absolute",top:11,right:12,zIndex:2},className:"btn btn-primary btn-xs",onClick:this.props.resetColumnVisibility},"Reset columns"))))}},{key:"clinicalAttributeIds",get:function(){var e=new Set;return this.props.clinicalAttributes.forEach((function(t){return e.add(t.clinicalAttributeId)})),e.add("CANCER_STUDY").add("CANCER_TYPE_DETAILED").add("MUTATION_COUNT")}},{key:"mutationsOptions",get:function(){var e=this;return this.props.columnVisibility?this.props.columnVisibility.filter((function(t){return!e.clinicalAttributeIds.has(t.id)})).map((function(e){return{key:e.id,label:e.name,selected:e.visible}})):[]}},{key:"numSelectedMutationsOptions",get:function(){return this.mutationsOptions.filter((function(e){return e.selected})).length}},{key:"mutationsTabContent",get:function(){var e=this;return n.createElement(Mt.Z,{options:this.mutationsOptions,onAddAll:function(t){return e.addAll(t,e.mutationsOptions)},onClearAll:function(t){return e.clearAll(t,e.mutationsOptions)},onToggleOption:this.toggle,optionsGivenInSortedOrder:!0,width:this.dropdownWidth})}},{key:"clinicalOptions",get:function(){var e=this;return this.props.columnVisibility?this.props.columnVisibility.filter((function(t){return e.clinicalAttributeIds.has(t.id)})).map((function(e){return{key:e.id,label:e.name,selected:e.visible}})):[]}},{key:"numSelectedClinicalOptions",get:function(){return this.clinicalOptions.filter((function(e){return e.selected})).length}},{key:"clinicalTabContent",get:function(){var e=this;return n.createElement(Mt.Z,{options:this.clinicalOptions,freqPromise:this.props.clinicalAttributeIdToAvailableFrequency,onAddAll:function(t){return e.addAll(t,e.clinicalOptions)},onClearAll:function(t){return e.clearAll(t,e.clinicalOptions)},onToggleOption:this.toggle,optionsGivenInSortedOrder:!1,width:this.dropdownWidth})}},{key:"mutationsTabText",get:function(){return n.createElement("span",{style:{marginTop:"3px",marginBottom:"3px"}},Vt.MUTATIONS,n.createElement("span",{style:{paddingLeft:5}},n.createElement("span",{className:"oncoprintDropdownCount"},this.numSelectedMutationsOptions," /"," ",this.mutationsOptions.length)))}},{key:"clinicalTabText",get:function(){return n.createElement("span",{style:{marginTop:"3px",marginBottom:"3px"}},Vt.CLINICAL,n.createElement("span",{style:{paddingLeft:5}},n.createElement("span",{className:"oncoprintDropdownCount"},this.numSelectedClinicalOptions," /"," ",this.clinicalOptions.length)))}},{key:"dropdownButtonText",get:function(){var e=this.numSelectedMutationsOptions+this.numSelectedClinicalOptions,t=this.mutationsOptions.length+this.clinicalOptions.length;return"Columns (".concat(e," / ").concat(t,")")}},{key:"dropdownWidth",get:function(){var e=40;return e+=this.getTextPixel(Vt.CLINICAL,"14px")+14+(this.getTextPixel(this.clinicalOptions.length.toString(),"11px")+17),Math.max(e,400)}}])&&Nt(r.prototype,o),i&&Nt(r,i),t}(n.Component);Ft([c.observable],Bt.prototype,"tabId",void 0),Ft([c.action.bound],Bt.prototype,"updateTabId",null),Ft([c.action.bound],Bt.prototype,"addAll",null),Ft([c.action.bound],Bt.prototype,"clearAll",null),Ft([c.action.bound],Bt.prototype,"toggle",null),Ft([c.computed],Bt.prototype,"clinicalAttributeIds",null),Ft([c.computed],Bt.prototype,"mutationsOptions",null),Ft([c.computed],Bt.prototype,"numSelectedMutationsOptions",null),Ft([c.computed],Bt.prototype,"mutationsTabContent",null),Ft([c.computed],Bt.prototype,"clinicalOptions",null),Ft([c.computed],Bt.prototype,"numSelectedClinicalOptions",null),Ft([c.computed],Bt.prototype,"clinicalTabContent",null),Ft([c.computed],Bt.prototype,"mutationsTabText",null),Ft([c.computed],Bt.prototype,"clinicalTabText",null),Ft([c.computed],Bt.prototype,"dropdownButtonText",null),Ft([c.computed],Bt.prototype,"dropdownWidth",null);const qt=Bt=Ft([u.observer],Bt);var Ut=r(45985);function Ht(e){return(Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Yt(e,t){return!t||"object"!==Ht(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Kt(e,t,r){return(Kt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Qt(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function Qt(e){return(Qt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xt(e,t){return(Xt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Zt=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=Yt(this,Qt(t).call(this,e))).props.columnVisibilityProps.customDropdown=function(e){return n.createElement(qt,{className:e.className,columnVisibility:e.columnVisibility,onColumnToggled:e.onColumnToggled,resetColumnVisibility:function(){e.resetColumnVisibility&&e.resetColumnVisibility(),r.props.storeColumnVisibility&&r.props.storeColumnVisibility(void 0)},showResetColumnsButton:e.showResetColumnsButton,clinicalAttributes:r.props.mutationsTabClinicalAttributes.result,clinicalAttributeIdToAvailableFrequency:r.props.clinicalAttributeIdToAvailableFrequency})},r}var r,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xt(e,t)}(t,e),r=t,(o=[{key:"componentWillUpdate",value:function(e){this._columns[Ot.wc.STUDY].visible=!!(e.studyIdToStudy&&Object.keys(e.studyIdToStudy).length>1)}},{key:"generateColumns",value:function(){var e=this;Kt(Qt(t.prototype),"generateColumns",this).call(this);for(var r=this.props.mutationsTabClinicalAttributes.result,o=function(t){var o=r[t].clinicalAttributeId;e.props.columns&&!e.props.columns.includes(o)&&e.props.columns.push(o),e._columns[o]={id:o,name:r[t].displayName,render:_t.Z.makeRenderFunction(r[t],e.props.clinicalAttributeCache),download:function(n){return _t.Z.getTextValue(n,r[t],e.props.clinicalAttributeCache)},sortBy:function(n){return _t.Z.sortBy(n,r[t],e.props.clinicalAttributeCache)},filter:function(n,o,i){return _t.Z.filter(n,i,r[t],e.props.clinicalAttributeCache)},tooltip:n.createElement("span",null,r[t].description),visible:!1,order:300}},a=0;a<r.length;a++)o(a);var l=(0,Ut.T)(this.props.namespaceColumns);i().forIn(l,(function(t,r){e._columns[r]=t})),this._columns[Ot.wc.CANCER_TYPE_DETAILED].visible=kt.Z.isVisible(this.props.dataStore?this.props.dataStore.allData:this.props.data,this.props.uniqueSampleKeyToTumorType),this._columns[Ot.wc.TUMOR_ALLELE_FREQ].visible=At.Z.isVisible(this.props.dataStore?this.props.dataStore.allData:this.props.data),this._columns[Ot.wc.ANNOTATION].shouldExclude=function(){return!1===e.props.isCanonicalTranscript},this._columns[Ot.wc.STUDY].order=0,this._columns[Ot.wc.SAMPLE_ID].order=10,"CANCER_TYPE"in this._columns&&(this._columns.CANCER_TYPE.order=14,this._columns.CANCER_TYPE.resizable=!0,this._columns.CANCER_TYPE.truncateOnResize=!0),this._columns[Ot.wc.CANCER_TYPE_DETAILED].order=15,this._columns[Ot.wc.PROTEIN_CHANGE].order=20,this._columns[Ot.wc.ANNOTATION].order=30,this._columns[Ot.wc.FUNCTIONAL_IMPACT].order=38,this._columns[Ot.wc.MUTATION_TYPE].order=40,this._columns[Ot.wc.VARIANT_TYPE].order=45,this._columns[Ot.wc.ASCN_METHOD].order=46,this._columns[Ot.wc.CLONAL].order=47,this._columns[Ot.wc.CANCER_CELL_FRACTION].order=48,this._columns[Ot.wc.EXPECTED_ALT_COPIES].order=49,this._columns[Ot.wc.ASCN_COPY_NUM].order=50,this._columns[Ot.wc.COPY_NUM].order=51,this._columns[Ot.wc.COSMIC].order=60,this._columns[Ot.wc.MUTATION_STATUS].order=70,this._columns[Ot.wc.VALIDATION_STATUS].order=80,this._columns[Ot.wc.CENTER].order=100,this._columns[Ot.wc.CHROMOSOME].order=110,this._columns[Ot.wc.START_POS].order=120,this._columns[Ot.wc.END_POS].order=130,this._columns[Ot.wc.REF_ALLELE].order=140,this._columns[Ot.wc.VAR_ALLELE].order=150,this._columns[Ot.wc.HGVSG].order=151,this._columns[Ot.wc.HGVSC].order=152,this._columns[Ot.wc.TUMOR_ALLELE_FREQ].order=160,this._columns[Ot.wc.NORMAL_ALLELE_FREQ].order=170,this._columns[Ot.wc.VAR_READS].order=180,this._columns[Ot.wc.REF_READS].order=190,this._columns[Ot.wc.VAR_READS_N].order=200,this._columns[Ot.wc.REF_READS_N].order=210,this._columns[Ot.wc.NUM_MUTATIONS].order=220,this._columns[Ot.wc.EXON].order=230,this._columns[Ot.wc.GNOMAD].order=260,this._columns[Ot.wc.CLINVAR].order=270,this._columns[Ot.wc.DBSNP].order=280,this._columns[Ot.wc.SIGNAL].order=290,this._columns[Ot.wc.CANCER_TYPE_DETAILED].shouldExclude=function(){return!e.props.uniqueSampleKeyToTumorType},this._columns[Ot.wc.CLONAL].shouldExclude=function(){return!e.props.existsSomeMutationWithAscnProperty[Dt.Y.CCF_EXPECTED_COPIES_STRING]},this._columns[Ot.wc.ASCN_METHOD].shouldExclude=function(){return!e.props.existsSomeMutationWithAscnProperty[Dt.Y.ASCN_METHOD_STRING]},this._columns[Ot.wc.CANCER_CELL_FRACTION].shouldExclude=function(){return!e.props.existsSomeMutationWithAscnProperty[Dt.Y.CCF_EXPECTED_COPIES_STRING]},this._columns[Ot.wc.EXPECTED_ALT_COPIES].shouldExclude=function(){return!e.props.existsSomeMutationWithAscnProperty[Dt.Y.EXPECTED_ALT_COPIES_STRING]},this._columns[Ot.wc.ASCN_COPY_NUM].shouldExclude=function(){return!e.props.existsSomeMutationWithAscnProperty[Dt.Y.ASCN_INTEGER_COPY_NUMBER_STRING]||!e.props.existsSomeMutationWithAscnProperty[Dt.Y.TOTAL_COPY_NUMBER_STRING]||!e.props.existsSomeMutationWithAscnProperty[Dt.Y.MINOR_COPY_NUMBER_STRING]},this._columns[Ot.wc.NUM_MUTATIONS].shouldExclude=function(){return!e.props.mutationCountCache},this._columns[Ot.wc.EXON].render=function(t){return It.Z.renderFunction(t,e.props.genomeNexusCache,!1)},this._columns[Ot.wc.EXON].headerRender=function(){return n.createElement("span",{style:{display:"inline-block"}},"Exon",n.createElement("br",null),"(",e.props.totalNumberOfExons," in total)")}}}])&&Wt(r.prototype,o),a&&Wt(r,a),t}(Ot.ZP);Object.defineProperty(Zt,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:Object.assign(Object.assign({},Ot.ZP.defaultProps),{columns:[Ot.wc.STUDY,Ot.wc.SAMPLE_ID,Ot.wc.COPY_NUM,Ot.wc.ASCN_METHOD,Ot.wc.ASCN_COPY_NUM,Ot.wc.ANNOTATION,Ot.wc.HGVSG,Ot.wc.FUNCTIONAL_IMPACT,Ot.wc.REF_READS_N,Ot.wc.VAR_READS_N,Ot.wc.REF_READS,Ot.wc.VAR_READS,Ot.wc.START_POS,Ot.wc.END_POS,Ot.wc.REF_ALLELE,Ot.wc.VAR_ALLELE,Ot.wc.MUTATION_STATUS,Ot.wc.VALIDATION_STATUS,Ot.wc.CENTER,Ot.wc.CHROMOSOME,Ot.wc.PROTEIN_CHANGE,Ot.wc.MUTATION_TYPE,Ot.wc.VARIANT_TYPE,Ot.wc.CLONAL,Ot.wc.CANCER_CELL_FRACTION,Ot.wc.EXPECTED_ALT_COPIES,Ot.wc.COSMIC,Ot.wc.TUMOR_ALLELE_FREQ,Ot.wc.NORMAL_ALLELE_FREQ,Ot.wc.CANCER_TYPE_DETAILED,Ot.wc.NUM_MUTATIONS,Ot.wc.EXON,Ot.wc.HGVSC,Ot.wc.GNOMAD,Ot.wc.CLINVAR,Ot.wc.DBSNP,Ot.wc.SIGNAL],columnVisibilityProps:{}})});var zt=r(40416),$t=r(22773);function Jt(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function er(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function tr(e){return(tr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nr(e,t){return(nr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function or(e){return(or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ir=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":or(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},ar=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==or(t)&&"function"!=typeof t?rr(e):t}(this,tr(t).call(this,e)),Object.defineProperty(rr(r),"minMaxColumns",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(rr(r),"allUniqDataColumns",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(rr(r),"deactivateColumnFilter",{enumerable:!0,configurable:!0,writable:!0,value:function(e){(0,Ce.UK)([],!0,r.store.dataStore,e,(0,we.WP)(e))}}),Object.defineProperty(rr(r),"setupColumnFilter",{enumerable:!0,configurable:!0,writable:!0,value:function(e){var t=e.name;r.props.store.numericalFilterColumns.has(t)?r.minMaxColumns.add(e):r.props.store.categoricalFilterColumns.has(t)&&r.allUniqDataColumns.add(e)}}),Object.defineProperty(rr(r),"columnToHeaderFilterIconModal",{enumerable:!0,configurable:!0,writable:!0,value:function(e){var t,o=e.name,i=r.props.store.numericalFilterColumns.has(o),a=r.props.store.categoricalFilterColumns.has(o);if(i||a)return i&&r.minMaxColumns.has(e)?t=r.numericalFilterComponents[o]:a&&r.allUniqDataColumns.has(e)&&(t=r.categoricalFilterComponents[o]),n.createElement(Ve,{id:o,filterIsActive:r.columnFilterIsActive(o),deactivateFilter:function(){return r.deactivateColumnFilter(o)},setupFilter:function(){return r.setupColumnFilter(e)},menuComponent:t})}}),(0,c.makeObservable)(rr(r)),r.minMaxColumns=new Set,r.allUniqDataColumns=new Set,r}var r,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nr(e,t)}(t,e),r=t,(o=[{key:"getMutationRateSummary",value:function(){return this.props.store.germlineConsentedSamples&&this.props.store.germlineConsentedSamples.result&&this.props.store.mutationData.isComplete&&this.props.store.mutationData.result.length>0&&this.props.store.samples.isComplete&&this.props.store.samples.result&&this.props.store.samples.result.length>0?n.createElement(Pt,{hugoGeneSymbol:this.props.store.gene.hugoGeneSymbol,molecularProfileIdToMolecularProfile:this.props.store.molecularProfileIdToMolecularProfile,mutations:this.props.store.mutationData.result,samples:this.props.store.samples.result,germlineConsentedSamples:this.props.store.germlineConsentedSamples,onMutationStatusSelect:this.onMutationStatusSelect,mutationStatusFilter:this.mutationStatusFilter}):null}},{key:"onMutationStatusSelect",value:function(e,t){(0,Ce.UK)(e,t,this.store.dataStore,Ce.O7.MUTATION_STATUS,lt.lD)}},{key:"columnFilterIsActive",value:function(e){return e in this.getFilters}},{key:"resolveMutationToColumnValue",value:function(e,t){return("Mutation Type"===t.name&&t.sortBy?""+(i().flatten([t.sortBy(e)])[0]||""):i().flatten([t.download(e)])[0])||"(Blanks)"}},{key:"isDefaultNumericalFilter",value:function(e){var t=this.getFilters[e],r=this.columnMinMax[e];return+t.values[0].lowerBound==+r.min&&+t.values[0].upperBound==+r.max&&!1===t.values[0].hideEmptyValues}},{key:"isDefaultCategoricalFilter",value:function(e){var t=this.getFilters[e];return"contains"===t.values[0].filterCondition&&""===t.values[0].filterString&&i().isEqual(t.values[0].selections,this.allUniqColumnData[e])}},{key:"activateNumericalFilter",value:function(e,t,r,n){var o=+this.columnMinMax[e].min,i=+this.columnMinMax[e].max;(0,Ce.UK)([{lowerBound:void 0===t?o:t,upperBound:void 0===r?i:r,hideEmptyValues:void 0!==n&&n}],!1,this.store.dataStore,e,(0,we.WP)(e))}},{key:"activateCategoricalFilter",value:function(e,t,r,n){(0,Ce.UK)([{filterCondition:t||"contains",filterString:r||"",selections:n||this.allUniqColumnData[e]}],!1,this.store.dataStore,e,(0,we.WP)(e))}},{key:"filterResetPanel",get:function(){var e=this,t=this.props.store.dataStore,r="Showing ".concat(t.tableData.length," of ").concat(t.allData.length," mutations.");if(this.props.store.queriedStudies.isComplete){var o=n.createElement("a",{onClick:function(){(0,zt.Bu)(e.props.store.queriedStudies.result,t.tableDataSamples,!0)}},(0,zt.Fq)(t.tableDataSamples,t.tableDataPatients));r=n.createElement("span",null,"Showing ".concat(t.tableData.length," of ").concat(t.allData.length," mutations in "),o,".")}return n.createElement(Ce.$S,{resetFilters:function(){return t.resetFilters()},filterInfo:r,className:b()("alert","alert-success",it().filterResetPanel),buttonClass:"btn btn-default btn-xs"})}},{key:"mutationStatusFilter",get:function(){return this.store.dataStore.dataFilters.find((function(e){return e.id===lt.lD}))}},{key:"isMutationTableDataLoading",get:function(){return"pending"===(0,ie.CX)(this.props.store.clinicalDataForSamples,this.props.store.studiesForSamplesWithoutCancerTypeClinicalData,this.props.store.canonicalTranscript,this.props.store.mutationData,this.props.store.indexedVariantAnnotations,this.props.store.activeTranscript,this.props.store.clinicalDataGroupedBySampleMap,this.props.store.mutationsTabClinicalAttributes)}},{key:"totalExonNumber",get:function(){var e=this.props.store.canonicalTranscript.result&&this.props.store.canonicalTranscript.result.transcriptId,t=this.props.store.activeTranscript.result&&this.props.store.activeTranscript.result===e?this.props.store.canonicalTranscript.result:this.props.store.transcriptsByTranscriptId[this.props.store.activeTranscript.result];return t&&t.exons&&t.exons.length>0?t.exons.length.toString():"None"}},{key:"mutationTableComponent",get:function(){return n.createElement(Zt,{uniqueSampleKeyToTumorType:this.props.store.uniqueSampleKeyToTumorType,oncoKbCancerGenes:this.props.store.oncoKbCancerGenes,discreteCNACache:this.props.discreteCNACache,studyIdToStudy:this.props.store.studyIdToStudy.result,molecularProfileIdToMolecularProfile:this.props.store.molecularProfileIdToMolecularProfile.result,pubMedCache:this.props.pubMedCache,mutationCountCache:this.props.mutationCountCache,clinicalAttributeCache:this.props.clinicalAttributeCache,genomeNexusCache:this.props.genomeNexusCache,genomeNexusMutationAssessorCache:this.props.genomeNexusMutationAssessorCache,dataStore:this.props.store.dataStore,itemsLabelPlural:this.itemsLabelPlural,downloadDataFetcher:this.props.store.downloadDataFetcher,myCancerGenomeData:this.props.store.myCancerGenomeData,hotspotData:this.props.store.indexedHotspotData,indexedVariantAnnotations:this.props.store.indexedVariantAnnotations,indexedMyVariantInfoAnnotations:this.props.store.indexedMyVariantInfoAnnotations,cosmicData:this.props.store.cosmicData.result,oncoKbData:this.props.store.oncoKbData,usingPublicOncoKbInstance:this.props.store.usingPublicOncoKbInstance,mergeOncoKbIcons:this.props.mergeOncoKbIcons,onOncoKbIconToggle:this.props.onOncoKbIconToggle,civicGenes:this.props.store.civicGenes,civicVariants:this.props.store.civicVariants,userEmailAddress:this.props.userEmailAddress,enableOncoKb:this.props.enableOncoKb,enableFunctionalImpact:this.props.enableGenomeNexus,enableHotspot:this.props.enableHotspot,enableMyCancerGenome:this.props.enableMyCancerGenome,enableCivic:this.props.enableCivic,totalNumberOfExons:this.totalExonNumber,generateGenomeNexusHgvsgUrl:this.props.store.generateGenomeNexusHgvsgUrl,isCanonicalTranscript:this.props.store.isCanonicalTranscript,selectedTranscriptId:this.props.store.activeTranscript.result,columnVisibility:this.props.columnVisibility,storeColumnVisibility:this.props.storeColumnVisibility,sampleIdToClinicalDataMap:this.props.store.clinicalDataGroupedBySampleMap,existsSomeMutationWithAscnProperty:this.props.existsSomeMutationWithAscnProperty,mutationsTabClinicalAttributes:this.props.store.mutationsTabClinicalAttributes,clinicalAttributeIdToAvailableFrequency:this.props.store.clinicalAttributeIdToAvailableFrequency,columnToHeaderFilterIconModal:this.columnToHeaderFilterIconModal,deactivateColumnFilter:this.deactivateColumnFilter,namespaceColumns:this.props.store.namespaceColumnConfig,columns:this.columns})}},{key:"columns",get:function(){var e=(0,$t.Tt)(this.props.store.namespaceColumnConfig);return i().concat(Zt.defaultProps.columns,e)}},{key:"mutationTable",get:function(){return n.createElement("span",null,!this.isMutationTableDataLoading&&this.mutationTableComponent)}},{key:"dataFilterColumns",get:function(){return[].concat(Jt(this.props.store.numericalFilterColumns),Jt(this.props.store.categoricalFilterColumns))}},{key:"getFilters",get:function(){var e=this,t={},r=!0,n=!1,o=void 0;try{for(var i,a=function(){var r=i.value,n=e.store.dataStore.dataFilters.find((function(e){return e.type===r}));n&&(t[r]=n)},l=this.dataFilterColumns[Symbol.iterator]();!(r=(i=l.next()).done);r=!0)a()}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return t}},{key:"columnMinMax",get:function(){var e={},t=!0,r=!1,n=void 0;try{for(var o,a=this.minMaxColumns[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var l=o.value,s=l.name,u="0",c="100",p=!1;if(l.sortBy){var d=1/0,f=-1/0,m=void 0,h=void 0,y=!0,b=!1,g=void 0;try{for(var v,S=this.store.dataStore.allData[Symbol.iterator]();!(y=(v=S.next()).done);y=!0){var E=v.value,C=l.sortBy(E);null!==C?(+C<d&&(d=+C,m=E),+C>f&&(f=+C,h=E)):p=!0}}catch(e){b=!0,g=e}finally{try{y||null==S.return||S.return()}finally{if(b)throw g}}m&&h&&(l.download&&(u=i().flatten([l.download(m)])[0],c=i().flatten([l.download(h)])[0]),(!l.download||isNaN(+u)||isNaN(+c))&&(u=""+d,c=""+f))}e[s]={min:u,max:c,hasEmptyValues:p}}}catch(e){r=!0,n=e}finally{try{t||null==a.return||a.return()}finally{if(r)throw n}}return e}},{key:"allUniqColumnData",get:function(){var e={},t=!0,r=!1,n=void 0;try{for(var o,i=this.allUniqDataColumns[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value,l=a.name;if(a.download){e[l]=new Set;var s=!0,u=!1,c=void 0;try{for(var p,d=this.store.dataStore.allData[Symbol.iterator]();!(s=(p=d.next()).done);s=!0){var f=p.value,m=this.resolveMutationToColumnValue(f,a);e[l].add(m)}}catch(e){u=!0,c=e}finally{try{s||null==d.return||d.return()}finally{if(u)throw c}}}else e[l]=new Set}}catch(e){r=!0,n=e}finally{try{t||null==i.return||i.return()}finally{if(r)throw n}}return e}},{key:"allUniqColumnDataFiltered",get:function(){var e={},t=!0,r=!1,n=void 0;try{for(var o,i=this.allUniqDataColumns[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value,l=a.name;if(a.download){e[l]=new Set;var s=!0,u=!1,c=void 0;try{for(var p,d=this.store.dataStore.sortedFilteredData[Symbol.iterator]();!(s=(p=d.next()).done);s=!0){var f=p.value,m=this.resolveMutationToColumnValue(f,a);e[l].add(m)}}catch(e){u=!0,c=e}finally{try{s||null==d.return||d.return()}finally{if(u)throw c}}if(this.columnFilterIsActive(l)){var h=this.getFilters[l],y=!0,b=!1,g=void 0;try{for(var v,S=this.store.dataStore.allData[Symbol.iterator]();!(y=(v=S.next()).done);y=!0){var E=v.value,C=this.resolveMutationToColumnValue(E,a);(0,we.iR)(C,h.values[0])&&!h.values[0].selections.has(C)&&e[l].add(C)}}catch(e){b=!0,g=e}finally{try{y||null==S.return||S.return()}finally{if(b)throw g}}}}else e[l]=new Set}}catch(e){r=!0,n=e}finally{try{t||null==i.return||i.return()}finally{if(r)throw n}}return e}},{key:"numericalFilterComponents",get:function(){var e=this,t={},r=!0,o=!1,i=void 0;try{for(var a,l=function(){var r=a.value.name,o=e.columnFilterIsActive(r)?e.getFilters[r]:void 0;t[r]=n.createElement("div",null,n.createElement(Xe,{id:r,min:e.columnMinMax[r].min,max:e.columnMinMax[r].max,lowerValue:null==o?void 0:o.values[0].lowerBound,upperValue:null==o?void 0:o.values[0].upperBound,callbackLowerValue:function(t){o?(o.values[0].lowerBound=t,e.isDefaultNumericalFilter(r)&&e.deactivateColumnFilter(r)):e.activateNumericalFilter(r,t)},callbackUpperValue:function(t){o?(o.values[0].upperBound=t,e.isDefaultNumericalFilter(r)&&e.deactivateColumnFilter(r)):e.activateNumericalFilter(r,void 0,t)}}),e.columnMinMax[r].hasEmptyValues&&n.createElement("label",{style:{fontWeight:100}},n.createElement("input",{type:"checkbox",style:{marginTop:"10px",marginLeft:"5px",marginRight:"4px"},checked:!!o&&o.values[0].hideEmptyValues,onChange:function(t){o?(o.values[0].hideEmptyValues=!o.values[0].hideEmptyValues,e.isDefaultNumericalFilter(r)&&e.deactivateColumnFilter(r)):e.activateNumericalFilter(r,void 0,void 0,!0)},"data-test":"numerical-filter-menu-remove-empty-rows"}),"Hide empty values"))},s=this.minMaxColumns[Symbol.iterator]();!(r=(a=s.next()).done);r=!0)l()}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return t}},{key:"categoricalFilterComponents",get:function(){var e=this,t={},r=!0,o=!1,i=void 0;try{for(var a,l=function(){var r=a.value.name,o=e.columnFilterIsActive(r)?e.getFilters[r]:void 0;t[r]=n.createElement(nt,{id:r,emptyFilterString:!o,currSelections:o?o.values[0].selections:e.allUniqColumnDataFiltered[r],allSelections:e.allUniqColumnDataFiltered[r],updateFilterCondition:function(t){o?(o.values[0].filterCondition=t,e.isDefaultCategoricalFilter(r)&&e.deactivateColumnFilter(r)):e.activateCategoricalFilter(r,t)},updateFilterString:function(t){o?(o.values[0].filterString=t,e.isDefaultCategoricalFilter(r)&&e.deactivateColumnFilter(r)):e.activateCategoricalFilter(r,void 0,t)},toggleSelections:function(t){if(o){var n=o.values[0].selections;t.forEach((function(e){n.has(e)?n.delete(e):n.add(e)})),e.isDefaultCategoricalFilter(r)&&e.deactivateColumnFilter(r)}else{var i=e.allUniqColumnData[r];t.forEach((function(e){i.delete(e)})),e.activateCategoricalFilter(r,void 0,void 0,i)}}})},s=this.allUniqDataColumns[Symbol.iterator]();!(r=(a=s.next()).done);r=!0)l()}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return t}}])&&er(r.prototype,o),a&&er(r,a),t}(at.Z);ir([c.observable],ar.prototype,"minMaxColumns",void 0),ir([c.observable],ar.prototype,"allUniqDataColumns",void 0),ir([c.computed],ar.prototype,"mutationStatusFilter",null),ir([c.computed],ar.prototype,"columns",null),ir([c.action.bound],ar.prototype,"onMutationStatusSelect",null),ir([c.computed],ar.prototype,"dataFilterColumns",null),ir([c.computed],ar.prototype,"getFilters",null),ir([c.computed],ar.prototype,"columnMinMax",null),ir([c.computed],ar.prototype,"allUniqColumnData",null),ir([c.computed],ar.prototype,"allUniqColumnDataFiltered",null),ir([c.computed],ar.prototype,"numericalFilterComponents",null),ir([c.computed],ar.prototype,"categoricalFilterComponents",null);const lr=ar=ir([u.observer],ar);var sr=r(83724),ur=r(2213),cr=r(26942),pr=r(9337);function dr(){return(dr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function fr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function mr(e){return(mr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function hr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yr(e,t){return(yr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function br(e){return(br="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var gr=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":br(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},vr=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==br(t)&&"function"!=typeof t?hr(e):t}(this,mr(t).call(this,e)),Object.defineProperty(hr(r),"userSelectionStore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),(0,c.makeObservable)(hr(r)),r.userSelectionStore=new ur.Z,r}var r,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yr(e,t)}(t,e),r=t,(o=[{key:"onToggleOql",value:function(){this.props.store.mutationsTabFilteringSettings.useOql=!this.props.store.mutationsTabFilteringSettings.useOql}},{key:"onToggleVUS",value:function(){this.props.store.mutationsTabFilteringSettings.excludeVus=!this.props.store.mutationsTabFilteringSettings.excludeVus}},{key:"onToggleGermline",value:function(){this.props.store.mutationsTabFilteringSettings.excludeGermline=!this.props.store.mutationsTabFilteringSettings.excludeGermline}},{key:"setSelectedGeneSymbol",value:function(e){this.props.urlWrapper.updateURL({mutations_gene:e})}},{key:"render",value:function(){var e=this,t=this.selectedGeneSymbol;return n.createElement("div",{"data-test":"mutationsTabDiv"},this.props.store.mutationsByGene.isComplete&&n.createElement(d.Kh,{id:"mutationsPageTabs",activeTabId:t,onTabClick:function(t){return e.handleTabChange(t)},className:"pillTabs resultsPageMutationsGeneTabs",arrowStyle:{"line-height":.8},tabButtonStyle:"pills",unmountOnHide:!0},this.generateTabs(this.props.store.hugoGeneSymbols,this.props.store.mutationsByGene.result)),this.props.store.mutationsByGene.isPending&&n.createElement(ee.Z,{center:!0,size:"big",isLoading:!0}))}},{key:"generateTabs",value:function(e,t){var r=this,o=[];return e.forEach((function(e){if(t[e]){var i=t[e].length>0?void 0:{color:"#bbb"};o.push(n.createElement(d.l6,{key:e,id:e,linkText:e,anchorStyle:i},r.selectedGeneSymbol===e&&r.geneTabContent))}})),o}},{key:"handleTabChange",value:function(e){this.setSelectedGeneSymbol(e)}},{key:"handleOncoKbIconToggle",value:function(e){this.userSelectionStore.mergeOncoKbIcons=e,(0,pr.qu)({mergeIcons:e})}},{key:"onTranscriptChange",value:function(e){this.props.urlWrapper.updateURL({mutations_transcript_id:e})}},{key:"onClickSettingMenu",value:function(e){this.props.store.isSettingsMenuVisible=e}},{key:"selectedGeneSymbol",get:function(){return this.props.urlWrapper.query.mutations_gene&&this.props.store.hugoGeneSymbols.includes(this.props.urlWrapper.query.mutations_gene)?this.props.urlWrapper.query.mutations_gene:this.props.store.hugoGeneSymbols[0]}},{key:"selectedGene",get:function(){var e=this;return i().find(this.props.store.genes.result,(function(t){return t.hugoGeneSymbol===e.selectedGeneSymbol}))}},{key:"geneTabContent",get:function(){if(this.selectedGene&&this.props.store.getMutationMapperStore(this.selectedGene)){var e=this.props.store.getMutationMapperStore(this.selectedGene);return n.createElement("div",null,n.createElement("div",{className:"tabMessageContainer"},n.createElement(oe.Z,{className:"mutations-oql-status-banner",store:this.props.store,tabReflectsOql:this.props.store.mutationsTabFilteringSettings.useOql,isUnaffected:!this.props.store.queryContainsMutationOql,onToggle:this.onToggleOql}),n.createElement(ae.Z,{store:this.props.store,mutationsTabModeSettings:{excludeVUS:this.props.store.mutationsTabFilteringSettings.excludeVus,excludeGermline:this.props.store.mutationsTabFilteringSettings.excludeGermline,toggleExcludeVUS:this.onToggleVUS,toggleExcludeGermline:this.onToggleGermline,hugoGeneSymbol:this.selectedGene.hugoGeneSymbol}}),n.createElement(ue.Z,{store:this.props.store})),n.createElement(lr,dr({},(0,sr.R)(Object.assign(Object.assign({},(0,cr.Ib)()),{ensembl_transcript_url:this.props.store.ensemblLink,show_oncokb:!!e.isCanonicalTranscript&&(0,cr.Ib)().show_oncokb,show_hotspot:!!e.isCanonicalTranscript&&(0,cr.Ib)().show_hotspot})),{oncoKbPublicApiUrl:(0,se.ID)(),mergeOncoKbIcons:this.userSelectionStore.mergeOncoKbIcons,onOncoKbIconToggle:this.handleOncoKbIconToggle,store:e,isPutativeDriver:this.props.store.driverAnnotationSettings.driversAnnotated?function(e){return e.putativeDriver}:void 0,trackVisibility:this.userSelectionStore.trackVisibility,columnVisibility:this.userSelectionStore.columnVisibility,storeColumnVisibility:this.userSelectionStore.storeColumnVisibility,discreteCNACache:this.props.store.discreteCNACache,pubMedCache:this.props.store.pubMedCache,cancerTypeCache:this.props.store.cancerTypeCache,mutationCountCache:this.props.store.mutationCountCache,clinicalAttributeCache:this.props.store.clinicalAttributeCache,genomeNexusCache:this.props.store.genomeNexusCache,genomeNexusMutationAssessorCache:this.props.store.genomeNexusMutationAssessorCache,pdbHeaderCache:this.props.store.pdbHeaderCache,userEmailAddress:this.props.appStore.userName,generateGenomeNexusHgvsgUrl:this.props.store.generateGenomeNexusHgvsgUrl,existsSomeMutationWithAscnProperty:this.props.store.existsSomeMutationWithAscnProperty,mutationAlignerUrlTemplate:(0,se.Rb)(),showTranscriptDropDown:(0,cr.Ib)().show_transcript_dropdown,onTranscriptChange:this.onTranscriptChange,onClickSettingMenu:this.onClickSettingMenu,compactStyle:!0,ptmSources:(0,cr.Ib)().ptmSources})))}return null}}])&&fr(r.prototype,o),a&&fr(r,a),t}(n.Component);gr([c.computed],vr.prototype,"selectedGeneSymbol",null),gr([c.computed],vr.prototype,"selectedGene",null),gr([S.default],vr.prototype,"onToggleOql",null),gr([S.default],vr.prototype,"onToggleVUS",null),gr([S.default],vr.prototype,"onToggleGermline",null),gr([c.action],vr.prototype,"setSelectedGeneSymbol",null),gr([S.default],vr.prototype,"handleTabChange",null),gr([c.action.bound],vr.prototype,"handleOncoKbIconToggle",null),gr([c.computed],vr.prototype,"geneTabContent",null),gr([c.action.bound],vr.prototype,"onTranscriptChange",null),gr([c.action.bound],vr.prototype,"onClickSettingMenu",null);const Sr=vr=gr([u.observer],vr);var Er=r(6303),Cr=r(65497),wr=r.n(Cr),Tr=r(50619),Pr=r(30256),Or=r(8152),kr=r(6240),Ar=r(60878);function Ir(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Dr(e,t){return!t||"object"!==Lr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xr(e){return(xr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Mr(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Nr(e,t)}function Nr(e,t){return(Nr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Lr(e){return(Lr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Rr=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":Lr(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},jr=function(e){function t(){return _r(this,t),Dr(this,xr(t).apply(this,arguments))}return Mr(t,e),t}(kr.ZP),Gr=function(e){function t(){return _r(this,t),Dr(this,xr(t).apply(this,arguments))}var r,o,i;return Mr(t,e),r=t,(o=[{key:"render",value:function(){return n.createElement(jr,{data:this.props.geneAlterationData,columns:[{name:"Gene Symbol",render:function(e){return n.createElement("span",null,e.gene)},download:function(e){return e.gene},sortBy:function(e){return e.gene},filter:function(e,t,r){return e.gene.toUpperCase().indexOf(r)>-1}},{name:"OQL Line",visible:!1,render:function(e){return n.createElement("span",null,e.oqlLine)},download:function(e){return e.oqlLine},sortBy:function(e){return e.oqlLine},filter:function(e,t,r){return e.oqlLine.toUpperCase().indexOf(r)>-1}},{name:"Num Samples Altered",render:function(e){return n.createElement("span",null,e.sequenced?e.altered:"Not Profiled")},download:function(e){return e.sequenced?"".concat(e.altered):"N/P"},sortBy:function(e){return e.altered}},{name:"Percent Samples Altered",render:function(e){return e.sequenced?n.createElement(Ar.Z,{barWidth:200,textWidth:45,counts:[e.altered],totalCount:e.sequenced}):n.createElement("span",null,"Not Profiled")},download:function(e){return e.percentAltered},sortBy:function(e){return e.altered/e.sequenced}}],initialSortColumn:"Percent Samples Altered",initialSortDirection:"desc",showPagination:!0,initialItemsPerPage:10,showColumnVisibility:!0,showFilter:!0,showCopyDownload:!0,copyDownloadProps:{downloadFilename:"gene_alteration_frequency.tsv"}})}}])&&Ir(r.prototype,o),i&&Ir(r,i),t}(n.Component);const Vr=Gr=Rr([u.observer],Gr);var Fr=r(23280),Br=r(24433),qr=r.n(Br),Ur=r(43752),Hr=r.n(Ur),Wr=r(24639),Yr=r(8974),Kr=r(72903);function Qr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Xr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zr(e,t){return!t||"object"!==en(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zr(e){return(zr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jr(e,t)}function Jr(e,t){return(Jr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function en(e){return(en="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var tn=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":en(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};function rn(e){var t=function(t){return e?"".concat(t.proteinChange).concat(t.isGermline?" [germline]":"").concat(t.putativeDriver?" (driver)":""):n.createElement("span",null,n.createElement("span",null,t.proteinChange),t.isGermline&&n.createElement("span",{className:Hr().germline},"Germline"),t.putativeDriver&&n.createElement("span",{className:Hr().driver},"(Driver)"))};return function(e){return e.map(t)}}function nn(e){var t=function(t){return e?"".concat(t.type).concat(t.putativeDriver?" (driver)":""):n.createElement("span",null,n.createElement("span",null,t.type),t.putativeDriver&&n.createElement("span",{className:Hr().driver},"(Driver)"))};return function(e){return e.map(t)}}function on(e,t,r,n){if(!i().isEmpty(e)&&e[t])return function(e,t,r){var n,o=function(e){return e.map((function(e){return e.type}))},i=void 0;switch(0!==e.alterationTypes.length&&e.alterationTypes.includes(t)||(i={summaryContent:"no alteration",summaryClass:qr().noAlterationSpan,summaryAlteredStatus:Wr.Ug.UNALTERED}),t){case"MUT":n={label:"MUT",getAlterationData:function(e){return e.mutation},isNotProfiled:function(e){return e.isMutationNotProfiled},getValues:rn(r)};break;case"FUSION":n={label:"FUSION",getAlterationData:function(e){return e.structuralVariant},isNotProfiled:function(e){return e.isStructuralVariantNotProfiled},getValues:function(e){return e}};break;case"CNA":n={label:"CNA",getAlterationData:function(e){return e.cna},isNotProfiled:function(e){return e.isCnaNotProfiled},getValues:nn(r)};break;case"EXP":n={label:"EXP",getAlterationData:function(e){return e.mrnaExp},isNotProfiled:function(e){return e.isMrnaExpNotProfiled},getValues:o};break;case"PROT":n={label:"PROT",getAlterationData:function(e){return e.proteinLevel},isNotProfiled:function(e){return e.isProteinLevelNotProfiled},getValues:o}}if(n){var a=n.getAlterationData(e);if(a.length>0){var l=(0,Kr.E)(", ",n.getValues(a));i={summaryContent:r?l.join(""):l,summaryClass:qr().alterationSpan,summaryAlteredStatus:Wr.Ug.ALTERED}}n.isNotProfiled(e)&&(i={summaryContent:"not profiled",summaryClass:qr().notProfiledSpan,summaryAlteredStatus:Wr.Ug.UNPROFILED})}return i||void 0}(e[t],r,n)}function an(e,t,r,n){var o=i().map(r,(function(r){return on(e,t,r,n)})),a=i().filter(o,(function(e){return!!e&&e.summaryAlteredStatus===Wr.Ug.UNPROFILED}));if(a&&a.length===r.length)return{summaryContent:"not profiled",summaryClass:qr().notProfiledSpan,summaryAlteredStatus:Wr.Ug.UNPROFILED};var l=i().filter(o,(function(e){return!!e&&e.summaryAlteredStatus===Wr.Ug.ALTERED})),s=(0,Kr.E)(", ",i().map(l,(function(e){return e.summaryContent})));return l.length>0?{summaryContent:n?s.join(""):s,summaryClass:qr().alterationSpan,summaryAlteredStatus:Wr.Ug.ALTERED}:{summaryContent:"no alteration",summaryClass:qr().noAlterationSpan,summaryAlteredStatus:Wr.Ug.UNALTERED}}var ln=function(e){function t(){return Xr(this,t),Zr(this,zr(t).apply(this,arguments))}return $r(t,e),t}(kr.ZP),sn=function(e){function t(){return Xr(this,t),Zr(this,zr(t).apply(this,arguments))}var r,o,a;return $r(t,e),r=t,(o=[{key:"render",value:function(){var e=this,t=[{name:"Study ID",render:function(e){return n.createElement("span",{style:{whiteSpace:"nowrap"}},n.createElement(Fr._,{studyId:e.studyId},e.studyId))},download:function(e){return e.studyId},sortBy:function(e){return e.studyId},filter:function(e,t){return new RegExp(t,"i").test(e.studyId)}},{name:"Sample ID",render:function(e){return n.createElement("span",{style:{whiteSpace:"nowrap"}},n.createElement("a",{href:(0,se.Qk)(e.studyId,e.sampleId),target:"_blank"},e.sampleId))},download:function(e){return"".concat(e.sampleId)},sortBy:function(e){return e.sampleId},filter:function(e,t){return new RegExp(t,"i").test(e.sampleId)}},{name:"Patient ID",render:function(e){return n.createElement("span",{style:{whiteSpace:"nowrap"}},n.createElement("a",{href:(0,se.WU)(e.studyId,e.patientId),target:"_blank"},e.patientId))},download:function(e){return"".concat(e.patientId)},sortBy:function(e){return e.patientId},filter:function(e,t){return new RegExp(t,"i").test(e.patientId)}},{name:"Altered",tooltip:n.createElement("span",null,"1 = Sample harbors alteration in one of the input genes"),render:function(e){return n.createElement("span",null,e.altered?"1":"0")},download:function(e){return e.altered?"1":"0"},sortBy:function(e){return e.altered?1:0}}];i().forEach(this.props.trackLabels,(function(r){t.push({name:"".concat(r),headerDownload:function(e){return"".concat(r)},render:function(t){var o=an(t.oqlData,r,e.props.trackAlterationTypesMap[r]);return n.createElement("span",{className:o.summaryClass},o.summaryContent)},download:function(t){return an(t.oqlData,r,e.props.trackAlterationTypesMap[r],!0).summaryContent},sortBy:function(t){return an(t.oqlData,r,e.props.trackAlterationTypesMap[r]).summaryContent},filter:function(t,n){return new RegExp(n,"i").test(an(t.oqlData,r,e.props.trackAlterationTypesMap[r]).summaryContent)},visible:!0})}));var r=i().uniq(i().map(this.props.oqls,(function(e){return e.gene})));return i().forEach(r,(function(r){e.props.geneAlterationTypesMap[r].forEach((function(e){var o=(0,Yr.Ig)(e),a=e.alteration_type.toUpperCase(),l="".concat(r,": ").concat(o);i().isEmpty(t.find((function(e){return e.name===l})))&&t.push({name:"".concat(r,": ").concat(o),headerDownload:function(e){return"".concat(r,": ").concat(o)},render:function(e){var t=on(e.oqlDataByGene,r,a);return n.createElement("span",{className:t.summaryClass},t.summaryContent)},download:function(e){return on(e.oqlDataByGene,r,a,!0).summaryContent},sortBy:function(e){return on(e.oqlDataByGene,r,a).summaryContent},filter:function(e,t){return new RegExp(t,"i").test(on(e.oqlDataByGene,r,a).summaryContent)},visible:!1})}))})),n.createElement(ln,{data:this.props.caseAlterationData,columns:t,initialSortColumn:"Altered",initialSortDirection:"desc",initialItemsPerPage:20,showPagination:!0,showColumnVisibility:!0,showFilter:!0,showCopyDownload:!0,enableHorizontalScroll:!0,copyDownloadProps:{downloadFilename:"alterations_across_samples.tsv"}})}}])&&Qr(r.prototype,o),a&&Qr(r,a),t}(n.Component);const un=sn=tn([u.observer],sn);var cn=r(44429),pn=r(93527),dn=r(13654),fn=r(8506),mn=r.n(fn),hn=r(49199);function yn(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function bn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function gn(e){return(gn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Sn(e,t){return(Sn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function En(e){return(En="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Cn=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":En(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},wn=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==En(t)&&"function"!=typeof t?vn(e):t}(this,gn(t).call(this,e)),Object.defineProperty(vn(r),"geneAlterationData",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[r.props.store.oqlFilteredCaseAggregatedDataByOQLLine,r.props.store.filteredSequencedSampleKeysByGene]},invoke:function(){return Promise.resolve((0,cn.eo)(r.props.store.oqlFilteredCaseAggregatedDataByOQLLine.result,r.props.store.filteredSequencedSampleKeysByGene.result))}})}),Object.defineProperty(vn(r),"geneAlterationDataByGene",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[r.geneAlterationData]},invoke:function(){return Promise.resolve(i().keyBy(r.geneAlterationData.result,"gene"))}})}),Object.defineProperty(vn(r),"caseAlterationData",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[r.props.store.selectedMolecularProfiles,r.props.store.oqlFilteredCaseAggregatedDataByOQLLine,r.props.store.oqlFilteredCaseAggregatedDataByUnflattenedOQLLine,r.props.store.coverageInformation,r.props.store.filteredSamples,r.geneAlterationDataByGene,r.props.store.molecularProfileIdToMolecularProfile,r.props.store.defaultOQLQueryAlterations]},invoke:function(){return Promise.resolve((0,cn.gz)(r.props.store.oqlText,r.props.store.defaultOQLQueryAlterations.result,r.props.store.selectedMolecularProfiles.result,r.props.store.oqlFilteredCaseAggregatedDataByOQLLine.result,r.props.store.oqlFilteredCaseAggregatedDataByUnflattenedOQLLine.result,r.props.store.coverageInformation.result,r.props.store.filteredSamples.result,r.geneAlterationDataByGene.result,r.props.store.molecularProfileIdToMolecularProfile.result))}})}),Object.defineProperty(vn(r),"mutationData",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[r.props.store.nonOqlFilteredCaseAggregatedData]},invoke:function(){return Promise.resolve((0,cn.D8)(r.props.store.nonOqlFilteredCaseAggregatedData.result))}})}),Object.defineProperty(vn(r),"mutationDownloadData",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[r.mutationData,r.props.store.samples,r.props.store.genes,r.props.store.coverageInformation,r.props.store.studyToSelectedMolecularProfilesMap]},invoke:function(){return Promise.resolve((0,cn.HV)(r.mutationData.result,r.props.store.samples.result,r.props.store.genes.result,(0,cn.S9)(p.YK.MUTATION_EXTENDED,r.props.store.studyToSelectedMolecularProfilesMap.result,r.props.store.coverageInformation.result)))}})}),Object.defineProperty(vn(r),"genericAssayProfileDownloadDataGroupByProfileIdSuffix",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[r.props.store.samples,r.props.store.genericAssayEntityStableIdsGroupByProfileIdSuffix,r.props.store.genericAssayDataGroupByProfileIdSuffix,r.props.store.genericAssayProfilesGroupByProfileIdSuffix,r.props.store.genericAssayStableIdToMeta]},invoke:function(){var e=i().mapValues(r.props.store.genericAssayDataGroupByProfileIdSuffix.result,(function(e,t){var n={samples:i().groupBy(e,(function(e){return e.uniqueSampleKey}))};return(0,cn.HG)(r.props.store.genericAssayProfilesGroupByProfileIdSuffix.result[t].map((function(e){return e.molecularProfileId})),n)}));return Promise.resolve(i().mapValues(e,(function(e,t){return(0,cn._$)(e,r.props.store.samples.result,r.props.store.genericAssayEntityStableIdsGroupByProfileIdSuffix.result[t],r.props.store.genericAssayStableIdToMeta.result,r.props.store.genericAssayProfilesGroupByProfileIdSuffix.result[t])})))}})}),Object.defineProperty(vn(r),"mrnaData",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[r.props.store.nonOqlFilteredCaseAggregatedData]},invoke:function(){return Promise.resolve((0,cn.Yq)(r.props.store.nonOqlFilteredCaseAggregatedData.result))}})}),Object.defineProperty(vn(r),"mrnaDownloadData",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[r.mrnaData,r.props.store.samples,r.props.store.genes,r.props.store.coverageInformation,r.props.store.studyToSelectedMolecularProfilesMap]},invoke:function(){return Promise.resolve((0,cn.Mg)(r.mrnaData.result,r.props.store.samples.result,r.props.store.genes.result,(0,cn.S9)(p.YK.MRNA_EXPRESSION,r.props.store.studyToSelectedMolecularProfilesMap.result,r.props.store.coverageInformation.result)))}})}),Object.defineProperty(vn(r),"proteinData",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[r.props.store.nonOqlFilteredCaseAggregatedData]},invoke:function(){return Promise.resolve((0,cn.$9)(r.props.store.nonOqlFilteredCaseAggregatedData.result))}})}),Object.defineProperty(vn(r),"proteinDownloadData",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[r.proteinData,r.props.store.samples,r.props.store.genes,r.props.store.coverageInformation,r.props.store.studyToSelectedMolecularProfilesMap]},invoke:function(){return Promise.resolve((0,cn.Mg)(r.proteinData.result,r.props.store.samples.result,r.props.store.genes.result,(0,cn.S9)(p.YK.PROTEIN_LEVEL,r.props.store.studyToSelectedMolecularProfilesMap.result,r.props.store.coverageInformation.result)))}})}),Object.defineProperty(vn(r),"cnaData",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[r.props.store.nonOqlFilteredCaseAggregatedData]},invoke:function(){return Promise.resolve((0,cn.eh)(r.props.store.nonOqlFilteredCaseAggregatedData.result))}})}),Object.defineProperty(vn(r),"cnaDownloadData",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[r.cnaData,r.props.store.samples,r.props.store.genes,r.props.store.coverageInformation,r.props.store.studyToSelectedMolecularProfilesMap]},invoke:function(){return Promise.resolve((0,cn.Mg)(r.cnaData.result,r.props.store.samples.result,r.props.store.genes.result,(0,cn.S9)(p.YK.COPY_NUMBER_ALTERATION,r.props.store.studyToSelectedMolecularProfilesMap.result,r.props.store.coverageInformation.result)))}})}),Object.defineProperty(vn(r),"structuralVariantData",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[r.props.store.nonOqlFilteredCaseAggregatedData]},invoke:function(){return Promise.resolve((0,cn.u9)(r.props.store.nonOqlFilteredCaseAggregatedData.result))}})}),Object.defineProperty(vn(r),"structuralVariantDownloadData",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[r.structuralVariantData,r.props.store.samples,r.props.store.genes,r.props.store.coverageInformation,r.props.store.studyToSelectedMolecularProfilesMap]},invoke:function(){return Promise.resolve((0,cn.GM)(r.structuralVariantData.result,r.props.store.samples.result,r.props.store.genes.result,(0,cn.S9)(p.YK.STRUCTURAL_VARIANT,r.props.store.studyToSelectedMolecularProfilesMap.result,r.props.store.coverageInformation.result)))}})}),Object.defineProperty(vn(r),"alteredCaseAlterationData",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[r.caseAlterationData]},invoke:function(){return Promise.resolve(r.caseAlterationData.result.filter((function(e){return e.altered})))}})}),Object.defineProperty(vn(r),"unalteredCaseAlterationData",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[r.caseAlterationData]},invoke:function(){return Promise.resolve(r.caseAlterationData.result.filter((function(e){return!e.altered})))}})}),Object.defineProperty(vn(r),"sampleMatrix",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[r.caseAlterationData]},invoke:function(){var e=[];return i().map(r.caseAlterationData.result,(function(t){if(i().isEmpty(e)){var r=i().keys(t.oqlDataByGene);e.push(["studyID:sampleId","Altered"].concat(yn(r)))}var n=i().map(t.oqlDataByGene,(function(e){return i().isEmpty(e.alterationTypes)?"0":"1"}));e.push(["".concat(t.studyId,":").concat(t.sampleId),t.altered?"1":"0"].concat(yn(n)))})),Promise.resolve(e)}})}),Object.defineProperty(vn(r),"sampleMatrixText",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[r.sampleMatrix]},invoke:function(){return Promise.resolve((0,cn.xd)(r.sampleMatrix.result))}})}),Object.defineProperty(vn(r),"oqls",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[r.props.store.oqlFilteredCaseAggregatedDataByOQLLine]},invoke:function(){return Promise.resolve(r.props.store.oqlFilteredCaseAggregatedDataByOQLLine.result.map((function(e){return e.oql})))}})}),Object.defineProperty(vn(r),"trackLabels",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[r.props.store.oqlFilteredCaseAggregatedDataByUnflattenedOQLLine,r.props.store.defaultOQLQueryAlterations]},invoke:function(){var e=[];return r.props.store.oqlFilteredCaseAggregatedDataByUnflattenedOQLLine.result.forEach((function(t,n){void 0===t.mergedTrackOqlList?e.push((0,Tr.hR)(n,r.props.store.oqlText,t.oql,r.props.store.defaultOQLQueryAlterations.result)):e.push((0,Tr.Tj)(t.oql))})),Promise.resolve(e)}})}),Object.defineProperty(vn(r),"trackAlterationTypesMap",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[r.props.store.oqlFilteredCaseAggregatedDataByUnflattenedOQLLine,r.props.store.defaultOQLQueryAlterations]},invoke:function(){var e={};return r.props.store.oqlFilteredCaseAggregatedDataByUnflattenedOQLLine.result.forEach((function(t,n){if(void 0===t.mergedTrackOqlList){var o=t.oql,a=(0,Tr.hR)(n,r.props.store.oqlText,t.oql,r.props.store.defaultOQLQueryAlterations.result);o.parsed_oql_line.alterations&&(e[a]=i().uniq(i().map(o.parsed_oql_line.alterations,(function(e){return e.alteration_type.toUpperCase()}))))}else{var l=t.oql,s=(0,Tr.Tj)(t.oql),u=[];i().forEach(l.list,(function(e){if(e.parsed_oql_line.alterations){var t=i().map(e.parsed_oql_line.alterations,(function(e){return e.alteration_type.toUpperCase()}));u.push.apply(u,yn(t))}})),e[s]=i().uniq(u)}})),Promise.resolve(e)}})}),Object.defineProperty(vn(r),"geneAlterationMap",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[r.props.store.oqlFilteredCaseAggregatedDataByUnflattenedOQLLine]},invoke:function(){var e={};return r.props.store.oqlFilteredCaseAggregatedDataByUnflattenedOQLLine.result.forEach((function(t,r){if(void 0===t.mergedTrackOqlList){var n=t.oql;n.parsed_oql_line.alterations&&(e[n.gene]=i().chain(n.parsed_oql_line.alterations).union(e[n.gene]).uniq().value())}else{var o=t.oql;i().forEach(o.list,(function(t){if(t.parsed_oql_line.alterations){i().map(t.parsed_oql_line.alterations,(function(e){return e.alteration_type}));e[t.gene]=i().chain(t.parsed_oql_line.alterations).union(e[t.gene]).uniq().value()}}))}})),Promise.resolve(e)}})}),(0,c.makeObservable)(vn(r)),r.handleMutationDownload=r.handleMutationDownload.bind(vn(r)),r.handleTransposedMutationDownload=r.handleTransposedMutationDownload.bind(vn(r)),r.handleCnaDownload=r.handleCnaDownload.bind(vn(r)),r.handleTransposedCnaDownload=r.handleTransposedCnaDownload.bind(vn(r)),r.handleMrnaDownload=r.handleMrnaDownload.bind(vn(r)),r.handleTransposedMrnaDownload=r.handleTransposedMrnaDownload.bind(vn(r)),r.handleProteinDownload=r.handleProteinDownload.bind(vn(r)),r.handleTransposedProteinDownload=r.handleTransposedProteinDownload.bind(vn(r)),r}var r,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sn(e,t)}(t,e),r=t,(o=[{key:"render",value:function(){switch((0,ie.CX)(this.geneAlterationData,this.caseAlterationData,this.oqls,this.trackLabels,this.trackAlterationTypesMap,this.geneAlterationMap,this.cnaData,this.mutationData,this.structuralVariantData,this.mrnaData,this.proteinData,this.unalteredCaseAlterationData,this.alteredCaseAlterationData,this.props.store.virtualStudyParams,this.sampleMatrixText,this.props.store.nonSelectedDownloadableMolecularProfilesGroupByName,this.props.store.studies,this.props.store.selectedMolecularProfiles,this.props.store.genericAssayDataGroupByProfileIdSuffix)){case"pending":return n.createElement(ee.Z,{isLoading:!0,center:!0,size:"big"});case"error":return n.createElement(pn.Z,null);case"complete":return n.createElement(V.z,{"data-test":"downloadTabDiv",offset:60},n.createElement("div",{className:"tabMessageContainer"},n.createElement(oe.Z,{className:"download-oql-status-banner",store:this.props.store,tabReflectsOql:!0}),n.createElement(ae.Z,{store:this.props.store}),n.createElement(ue.Z,{store:this.props.store})),n.createElement("div",null,n.createElement(Pr.Z,{title:"Downloadable Data Files",className:"forceHeaderStyle h4",isLoading:!1,style:{marginBottom:15}}),n.createElement("table",{className:b()("table","table-striped",qr().downloadCopyTable)},n.createElement("tbody",null,(0,cn.J1)(this.cnaData.result)&&this.cnaDownloadControls(),(0,cn.pk)(this.mutationData.result)&&this.mutationDownloadControls(),(0,cn.eZ)(this.structuralVariantData.result)&&this.structuralVariantDownloadControls(),(0,cn.J1)(this.mrnaData.result)&&this.mrnaExprDownloadControls(this.props.store.selectedMolecularProfiles.result.find((function(e){return e.molecularAlterationType===p.YK.MRNA_EXPRESSION})).name),(0,cn.J1)(this.proteinData.result)&&this.proteinExprDownloadControls(this.props.store.selectedMolecularProfiles.result.find((function(e){return e.molecularAlterationType===p.YK.PROTEIN_LEVEL})).name),this.alteredSamplesDownloadControls(this.alteredCaseAlterationData.result,this.props.store.virtualStudyParams.result),this.unalteredSamplesDownloadControls(this.unalteredCaseAlterationData.result,this.props.store.virtualStudyParams.result),this.sampleMatrixDownloadControls(this.sampleMatrixText.result),this.props.store.doNonSelectedDownloadableMolecularProfilesExist&&this.nonSelectedProfileDownloadRow(this.props.store.nonSelectedDownloadableMolecularProfilesGroupByName.result),1===this.props.store.studies.result.length&&!i().isEmpty(this.props.store.genericAssayProfilesGroupByProfileIdSuffix.result)&&this.genericAssayProfileDownloadRows(this.props.store.genericAssayProfilesGroupByProfileIdSuffix.result,i().keys(this.props.store.genericAssayDataGroupByProfileIdSuffix.result))))),n.createElement("hr",null),n.createElement("div",{className:qr()["tables-container"],"data-test":"dataDownloadGeneAlterationTable"},n.createElement(Pr.Z,{title:"Gene Alteration Frequency",isLoading:!1,className:"pull-left forceHeaderStyle h4"}),n.createElement(Vr,{geneAlterationData:this.geneAlterationData.result})),n.createElement("hr",null),n.createElement("div",{className:qr()["tables-container"]},n.createElement(Pr.Z,{title:"Type of Genetic Alterations Across All Samples",isLoading:!1,className:"pull-left forceHeaderStyle h4"}),n.createElement(un,{caseAlterationData:this.caseAlterationData.result,oqls:this.oqls.result,trackLabels:this.trackLabels.result,trackAlterationTypesMap:this.trackAlterationTypesMap.result,geneAlterationTypesMap:this.geneAlterationMap.result})));default:return n.createElement(pn.Z,null)}}},{key:"cnaDownloadControls",value:function(){return this.downloadControlsRow("Copy-number Alterations (OQL is not in effect)",this.handleCnaDownload,this.handleTransposedCnaDownload)}},{key:"mutationDownloadControls",value:function(){return this.downloadControlsRow("Mutations (OQL is not in effect)",this.handleMutationDownload,this.handleTransposedMutationDownload)}},{key:"structuralVariantDownloadControls",value:function(){return this.downloadControlsRow("Structural Variants (OQL is not in effect)",this.handleStructuralVariantDownload,this.handleTransposedStructuralVariantDownload)}},{key:"mrnaExprDownloadControls",value:function(e){return this.downloadControlsRow(e,this.handleMrnaDownload,this.handleTransposedMrnaDownload)}},{key:"proteinExprDownloadControls",value:function(e){return this.downloadControlsRow(e,this.handleProteinDownload,this.handleTransposedProteinDownload)}},{key:"downloadControlsRow",value:function(e,t,r){return n.createElement("tr",null,n.createElement("td",{style:{width:500}},e),n.createElement("td",null,n.createElement("a",{onClick:function(r){return t(e)}},n.createElement("i",{className:"fa fa-cloud-download",style:{marginRight:5}}),"Tab Delimited Format"),n.createElement("span",{style:{margin:"0px 10px"}},"|"),n.createElement("a",{onClick:function(t){return r(e)}},n.createElement("i",{className:"fa fa-cloud-download",style:{marginRight:5}}),"Transposed Matrix")))}},{key:"nonSelectedProfileDownloadRow",value:function(e){var t=this,r=i().map(e,(function(e,r){return 1===t.props.store.studies.result.length?{name:r,description:e[0].description}:{name:r}}));return i().map(r,(function(e){return n.createElement("tr",null,n.createElement("td",{style:{width:500}},n.createElement("div",{style:{display:"flex",alignItems:"center"}},e.name,e.description&&n.createElement(w.ZD,{mouseEnterDelay:0,placement:"right",overlay:n.createElement("div",{className:qr().tooltip},e.description)},n.createElement(mn(),{className:qr().infoIcon,name:"info-circle"})))),n.createElement("td",null,n.createElement("div",null,n.createElement("a",{onClick:function(){return t.handleNonSelectedMolecularProfileDownload(e.name)}},n.createElement("i",{className:"fa fa-cloud-download",style:{marginRight:5}}),"Tab Delimited Format"),n.createElement("span",{style:{margin:"0px 10px"}},"|"),n.createElement("a",{onClick:function(){return t.handleTransposedNonSelectedMolecularProfileDownload(e.name)}},n.createElement("i",{className:"fa fa-cloud-download",style:{marginRight:5}}),"Transposed Matrix"))))}))}},{key:"genericAssayProfileDownloadRows",value:function(e,t){var r=this,o=i().map(e,(function(e,t){var r=e[0];return{name:r.name,description:r.description,profileIdSuffix:t}}));return i().map(o,(function(e){return n.createElement("tr",null,n.createElement("td",{style:{width:500}},n.createElement("div",{style:{display:"flex",alignItems:"center"}},e.name,e.description&&n.createElement(w.ZD,{mouseEnterDelay:0,placement:"right",overlay:n.createElement("div",{className:qr().tooltip},e.description)},n.createElement(mn(),{className:qr().infoIcon,name:"info-circle"})))),n.createElement("td",null,n.createElement("div",null,n.createElement(h.If,{condition:t.includes(e.profileIdSuffix)},n.createElement(h.Then,null,n.createElement("a",{onClick:function(){return r.handleGenericAssayProfileDownload(e.name,e.profileIdSuffix)}},n.createElement("i",{className:"fa fa-cloud-download",style:{marginRight:5}}),"Tab Delimited Format"),n.createElement("span",{style:{margin:"0px 10px"}},"|"),n.createElement("a",{onClick:function(){return r.handleTransposedGenericAssayProfileDownload(e.name,e.profileIdSuffix)}},n.createElement("i",{className:"fa fa-cloud-download",style:{marginRight:5}}),"Transposed Matrix")),n.createElement(h.Else,null,"Tracks added in theÂ ",n.createElement("a",{onClick:function(){return r.props.store.handleTabChange(hn.PC.ONCOPRINT)}},"OncoPrint tab"),"Â can be downloaded here.")))))}))}},{key:"copyDownloadControlsRow",value:function(e,t,r){return n.createElement("tr",null,n.createElement("td",null,e),n.createElement("td",null,n.createElement(Or.h,{controlsStyle:"LINK",downloadData:t,downloadFilename:r})))}},{key:"copyDownloadQueryControlsRow",value:function(e,t,r,o,i){return n.createElement("tr",null,n.createElement("td",null,e),n.createElement("td",null,n.createElement(Or.h,{controlsStyle:"QUERY",downloadData:t,downloadFilename:r,handleQuery:o,virtualStudyParams:i})))}},{key:"alteredSamplesDownloadControls",value:function(e,t){var r=this,n=i().map(e,(function(e){return"".concat(e.studyId,":").concat(e.sampleId)})),o="".concat(n.length," altered samples from:\n\n");t.studyWithSamples.forEach((function(e){o+=e.name+"\n"}));var a={user:t.user,name:t.name,description:o,studyWithSamples:t.studyWithSamples,selectedSamples:i().filter(t.selectedSamples,(function(e){return n.includes("".concat(e.studyId,":").concat(e.sampleId))})),filter:t.filter,attributesMetaSet:t.attributesMetaSet};return this.copyDownloadQueryControlsRow("Altered samples",(function(){return n.join("\n")}),"altered_samples.txt",(function(){return r.handleQueryButtonClick(n)}),a)}},{key:"unalteredSamplesDownloadControls",value:function(e,t){var r=this,n=i().map(e,(function(e){return"".concat(e.studyId,":").concat(e.sampleId)})),o="".concat(n.length," unaltered samples from:\n\n");t.studyWithSamples.forEach((function(e){o+=e.name+"\n"}));var a={user:t.user,name:t.name,description:o,studyWithSamples:t.studyWithSamples,selectedSamples:i().filter(t.selectedSamples,(function(e){return n.includes("".concat(e.studyId,":").concat(e.sampleId))})),filter:t.filter,attributesMetaSet:t.attributesMetaSet};return this.copyDownloadQueryControlsRow("Unaltered samples",(function(){return n.join("\n")}),"unaltered_samples.txt",(function(){return r.handleQueryButtonClick(n)}),a)}},{key:"sampleMatrixDownloadControls",value:function(e){return this.copyDownloadControlsRow("Sample matrix: List of all samples where 1=altered and 0=unaltered",(function(){return e}),"sample_matrix.txt")}},{key:"handleMutationDownload",value:function(){(0,w.XE)(this.mutationDownloadData,(function(e){var t=(0,cn.Nk)(e);wr()(t,"mutations.txt")}))}},{key:"handleTransposedMutationDownload",value:function(){(0,w.XE)(this.mutationDownloadData,(function(e){var t=(0,cn.Nk)((0,cn.TJ)(e));wr()(t,"mutations_transposed.txt")}))}},{key:"handleStructuralVariantDownload",value:function(){(0,w.XE)(this.structuralVariantDownloadData,(function(e){var t=(0,cn.Nk)(e);wr()(t,"structural_variants.txt")}))}},{key:"handleTransposedStructuralVariantDownload",value:function(){(0,w.XE)(this.structuralVariantDownloadData,(function(e){var t=(0,cn.Nk)((0,cn.TJ)(e));wr()(t,"structural_variants_transposed.txt")}))}},{key:"handleMrnaDownload",value:function(e){(0,w.XE)(this.mrnaDownloadData,(function(t){var r=(0,cn.Nk)(t);wr()(r,"".concat(e,".txt"))}))}},{key:"handleTransposedMrnaDownload",value:function(e){(0,w.XE)(this.mrnaDownloadData,(function(t){var r=(0,cn.Nk)((0,cn.TJ)(t));wr()(r,"".concat(e,".txt"))}))}},{key:"handleProteinDownload",value:function(e){(0,w.XE)(this.proteinDownloadData,(function(t){var r=(0,cn.Nk)(t);wr()(r,"".concat(e,".txt"))}))}},{key:"handleTransposedProteinDownload",value:function(e){(0,w.XE)(this.proteinDownloadData,(function(t){var r=(0,cn.Nk)((0,cn.TJ)(t));wr()(r,"".concat(e,".txt"))}))}},{key:"handleCnaDownload",value:function(){(0,w.XE)(this.cnaDownloadData,(function(e){var t=(0,cn.Nk)(e);wr()(t,"cna.txt")}))}},{key:"handleTransposedCnaDownload",value:function(){(0,w.XE)(this.cnaDownloadData,(function(e){var t=(0,cn.Nk)((0,cn.TJ)(e));wr()(t,"cna_transposed.txt")}))}},{key:"handleNonSelectedMolecularProfileDownload",value:function(e){(0,w.XE)([this.props.store.nonSelectedDownloadableMolecularProfiles,this.props.store.samples,this.props.store.genes],(function(t,r,n){var o=t.filter((function(t){return t.name===e}));(0,cn.cO)(e,o,r,n)}))}},{key:"handleTransposedNonSelectedMolecularProfileDownload",value:function(e){(0,w.XE)([this.props.store.nonSelectedDownloadableMolecularProfiles,this.props.store.samples,this.props.store.genes],(function(t,r,n){var o=t.filter((function(t){return t.name===e}));(0,cn.cO)(e,o,r,n,!0)}))}},{key:"handleGenericAssayProfileDownload",value:function(e,t){(0,w.XE)(this.genericAssayProfileDownloadDataGroupByProfileIdSuffix,(function(r){var n=(0,cn.oC)(r);wr()(n[t],"".concat(e,".txt"))}))}},{key:"handleTransposedGenericAssayProfileDownload",value:function(e,t){(0,w.XE)(this.genericAssayProfileDownloadDataGroupByProfileIdSuffix,(function(r){var n=(0,cn.oC)((0,cn.q)(r));wr()(n[t],"".concat(e,".txt"))}))}},{key:"handleQueryButtonClick",value:function(e){var t={selectedSampleListId:dn.K1,selectedSampleIds:e,caseIdsMode:"sample"};this.props.store.modifyQueryParams=t,this.props.store.queryFormVisible=!0}}])&&bn(r.prototype,o),a&&bn(r,a),t}(n.Component);Cn([S.default],wn.prototype,"handleStructuralVariantDownload",null),Cn([S.default],wn.prototype,"handleTransposedStructuralVariantDownload",null),Cn([S.default],wn.prototype,"handleNonSelectedMolecularProfileDownload",null),Cn([S.default],wn.prototype,"handleTransposedNonSelectedMolecularProfileDownload",null),Cn([S.default],wn.prototype,"handleGenericAssayProfileDownload",null),Cn([S.default],wn.prototype,"handleTransposedGenericAssayProfileDownload",null),Cn([c.action],wn.prototype,"handleQueryButtonClick",null);const Tn=wn=Cn([u.observer],wn);var Pn=r(32434),On=r(5374),kn=r(86002),An=r(54721);function In(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _n(e){return(_n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Dn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xn(e,t){return(xn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Mn(e){return(Mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Nn=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":Mn(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},Ln=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==Mn(t)&&"function"!=typeof t?Dn(e):t}(this,_n(t).call(this,e)),Object.defineProperty(Dn(r),"renderingComplete",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Dn(r),"selectedLocus",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Dn(r),"segmentTrackMaxHeight",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Dn(r),"chromosome",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[r.props.store.hugoGeneSymbolToReferenceGene]},invoke:function(){return Promise.resolve(r.props.store.hugoGeneSymbolToReferenceGene.result[r.activeLocus].chromosome)}})}),(0,c.makeObservable)(Dn(r)),r.segmentTrackMaxHeight=.7*C.Z.size.height,r}var r,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xn(e,t)}(t,e),r=t,(o=[{key:"render",value:function(){var e=this;return n.createElement("div",{className:"pillTabs"},n.createElement(ee.Z,{isLoading:this.isHidden,size:"big",center:!0},n.createElement(An.Z,{getItems:function(){return e.progressItems},show:this.isHidden,sequential:!0})),n.createElement(On.Z,{promise:this.props.store.cnSegments,filename:this.filename}),n.createElement("div",{className:"tabMessageContainer"},n.createElement(ue.Z,{store:this.props.store})),n.createElement(f.Nav,{bsStyle:"pills",activeKey:this.activeLocus,onSelect:this.onTabSelect},n.createElement(f.NavItem,{eventKey:kn.jt},"Whole Genome"),this.props.store.genes.result&&this.props.store.genes.result.map((function(e){return n.createElement(f.NavItem,{eventKey:e.hugoGeneSymbol},e.hugoGeneSymbol)}))),this.tooManySamplesForWholeGenome&&n.createElement("span",null,"Too many samples (",">".concat(this.props.sampleThreshold),") for the whole genome view. Try to select a different sample list."),n.createElement("div",{style:this.isHidden||this.tooManySamplesForWholeGenome?{opacity:0}:void 0},n.createElement(Pn.Z,{tracks:[Object.assign(Object.assign({},(0,kn.O4)()),{height:this.segmentTrackHeight,features:this.features})],genome:this.props.store.referenceGenome,locus:this.activeLocus,onRenderingStart:this.onIgvRenderingStart,onRenderingComplete:this.onIgvRenderingComplete,disableSearch:this.activeLocus!==kn.jt,isVisible:this.props.store.tabId===hn.PC.CN_SEGMENTS&&!this.isHidden&&!this.tooManySamplesForWholeGenome})))}},{key:"onTabSelect",value:function(e){this.selectedLocus=e}},{key:"onIgvRenderingStart",value:function(){this.renderingComplete=!1}},{key:"onIgvRenderingComplete",value:function(){this.renderingComplete=!0}},{key:"segmentTrackHeight",get:function(){return(0,kn.J1)(this.features,this.segmentTrackMaxHeight)}},{key:"activeLocus",get:function(){var e=this.selectedLocus;return e||(e=this.props.store.genes.result?this.props.store.genes.result[0].hugoGeneSymbol:kn.jt),e}},{key:"features",get:function(){var e=this.activePromise&&this.activePromise.result||[];return(0,kn.cG)(e)}},{key:"filename",get:function(){return"".concat(this.props.store.downloadFilenamePrefix,"segments.seg")}},{key:"isHidden",get:function(){return this.isLoading||!this.renderingComplete}},{key:"isSampleCountWithinThreshold",get:function(){return!this.props.store.filteredSamples.result||!this.props.sampleThreshold||this.props.store.filteredSamples.result.length<=this.props.sampleThreshold}},{key:"tooManySamplesForWholeGenome",get:function(){return this.activeLocus===kn.jt&&!this.isSampleCountWithinThreshold}},{key:"isLoading",get:function(){return!this.tooManySamplesForWholeGenome&&(!this.activePromise||this.activePromise.isPending)}},{key:"activePromise",get:function(){return this.activeLocus===kn.jt?this.props.store.filteredSamples.result&&this.isSampleCountWithinThreshold?this.props.store.cnSegments:void 0:this.props.store.cnSegmentsByChromosome.result&&this.chromosome?this.props.store.cnSegmentsByChromosome.result[this.chromosome.result]:void 0}},{key:"indicatorPromises",get:function(){var e=[this.props.store.studies,this.props.store.genes];return this.activeLocus!==kn.jt&&e.push(this.props.store.cnSegmentsByChromosome),this.activePromise&&e.push(this.activePromise),e}},{key:"progressItems",get:function(){return[{label:"Loading copy number segments data...",promises:this.indicatorPromises},{label:"Rendering"}]}}])&&In(r.prototype,o),i&&In(r,i),t}(n.Component);Object.defineProperty(Ln,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{sampleThreshold:2e4}}),Nn([c.observable],Ln.prototype,"renderingComplete",void 0),Nn([c.observable.ref],Ln.prototype,"selectedLocus",void 0),Nn([c.observable],Ln.prototype,"segmentTrackMaxHeight",void 0),Nn([c.computed],Ln.prototype,"segmentTrackHeight",null),Nn([c.computed],Ln.prototype,"activeLocus",null),Nn([c.computed],Ln.prototype,"features",null),Nn([c.computed],Ln.prototype,"filename",null),Nn([c.computed],Ln.prototype,"isHidden",null),Nn([c.computed],Ln.prototype,"isSampleCountWithinThreshold",null),Nn([c.computed],Ln.prototype,"tooManySamplesForWholeGenome",null),Nn([c.computed],Ln.prototype,"isLoading",null),Nn([c.computed],Ln.prototype,"activePromise",null),Nn([c.computed],Ln.prototype,"indicatorPromises",null),Nn([c.computed],Ln.prototype,"progressItems",null),Nn([c.action.bound],Ln.prototype,"onTabSelect",null),Nn([c.action.bound],Ln.prototype,"onIgvRenderingStart",null),Nn([c.action.bound],Ln.prototype,"onIgvRenderingComplete",null);const Rn=Ln=Nn([u.observer],Ln);var jn=r(33986);const Gn=function(e){var t=e.message,r=t!==e.loadingMessage;return n.createElement("div",{"data-test":"pathwayMapperMessageBox",className:"alert "+(r?"alert-warning":"alert-success"),style:{marginLeft:"1%",marginBottom:"0px",marginTop:"5px",color:"black",maxHeight:"32px",overflowY:"auto",display:0==t.length?"none":"block"}},n.createElement("button",{type:"button",className:"close",onClick:e.onClearMessage},n.createElement(mn(),{name:"times"})),r&&n.createElement("i",{className:"fa fa-md fa-exclamation-triangle",style:{marginRight:"6px",marginBottom:"1px"}}),t)};var Vn=r(4098),Fn=r(80686);function Bn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function qn(e){return(qn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Un(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Hn(e,t){return(Hn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Wn(e){return(Wn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Yn=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":Wn(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},Kn=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{s(n.next(e))}catch(e){i(e)}}function l(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,l)}s((n=n.apply(e,t||[])).next())}))},Qn="Loading alteration data...",Xn=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=function(e,t){return!t||"object"!==Wn(t)&&"function"!=typeof t?Un(e):t}(this,qn(t).call(this,e)),Object.defineProperty(Un(n),"accumulatedAlterationFrequencyDataForNonQueryGenes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Un(n),"accumulatedValidGenes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Un(n),"selectedPathway",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(Un(n),"newGenesFromPathway",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Un(n),"warningMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Un(n),"validNonQueryGenes",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({invoke:function(){return Kn(Un(n),void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,Vn.Kn)(this.newGenesFromPathway);case 2:return t=e.sent,e.abrupt("return",t.map((function(e){return e.hugoGeneSymbol})));case 4:case"end":return e.stop()}}),e,this)})))}})}),Object.defineProperty(Un(n),"addGenomicData",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Un(n),"PathwayMapperComponent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),(0,c.makeObservable)(Un(n)),n.accumulatedValidGenes={},n.accumulatedAlterationFrequencyDataForNonQueryGenes=[],Promise.all([r.e(524),r.e(771)]).then(r.t.bind(r,93524,23)).then((function(e){n.PathwayMapperComponent=e.default})),n}var o,a,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hn(e,t)}(t,e),o=t,(a=[{key:"render",value:function(){return this.isNewStoreReady&&this.addGenomicData(this.alterationFrequencyData),this.PathwayMapperComponent?n.createElement("div",{className:"pathwayMapper"},n.createElement("div",{"data-test":"pathwayMapperTabDiv",className:"cBioMode",style:{width:"99%"}},n.createElement(f.Row,null,n.createElement(n.Fragment,null,n.createElement(oe.Z,{className:"coexp-oql-status-banner",store:this.props.store,tabReflectsOql:!0}),n.createElement(this.PathwayMapperComponent,{isCBioPortal:!0,isCollaborative:!1,genes:this.props.store.genes.result,cBioAlterationData:this.alterationFrequencyData,onAddGenes:this.handleAddGenes,changePathwayHandler:this.handlePathwayChange,addGenomicDataHandler:this.addGenomicDataHandler,messageBanner:this.renderBanner,tableComponent:this.renderTable,validGenes:this.validGenes,showMessage:this.updateMessage}))))):null}},{key:"addGenomicDataHandler",value:function(e){this.addGenomicData=e}},{key:"handlePathwayChange",value:function(e){this.newGenesFromPathway=e}},{key:"handleAddGenes",value:function(e){(0,hn.AO)(this.props.urlWrapper,e)}},{key:"updateMessage",value:function(e){this.warningMessage=e}},{key:"clearMessage",value:function(){this.warningMessage=null}},{key:"renderBanner",value:function(){return n.createElement(Gn,{message:this.message,loadingMessage:Qn,onClearMessage:this.clearMessage})}},{key:"renderTable",value:function(e,t,r){return n.createElement(jn.ZP,{data:e,selectedPathway:t,changePathway:r,onSelectedPathwayChange:this.clearMessage})}},{key:"alterationFrequencyData",get:function(){return this.alterationFrequencyDataForQueryGenes.concat(this.alterationFrequencyDataForNonQueryGenes)}},{key:"message",get:function(){return this.isNewStoreReady&&this.warningMessage===Qn?"":!this.isNewStoreReady&&this.validNonQueryGenes.isComplete&&this.validNonQueryGenes.result.length>0?Qn:this.warningMessage?this.warningMessage:""}},{key:"alterationFrequencyDataForQueryGenes",get:function(){var e=this,t=[];return this.props.store.oqlFilteredCaseAggregatedDataByUnflattenedOQLLine.result.forEach((function(r){var n=(0,Fn.DA)(e.props.store.samples.result,e.props.store.patients.result,e.props.store.coverageInformation.result,e.props.store.filteredSequencedSampleKeysByGene.result,e.props.store.filteredSequencedPatientKeysByGene.result,e.props.store.selectedMolecularProfiles.result,r,!0,e.props.store.genes.result);n&&t.push(n)})),t}},{key:"alterationFrequencyDataForNonQueryGenes",get:function(){var e=this,t=[];return this.isNewStoreReady&&this.storeForAllData.oqlFilteredCaseAggregatedDataByUnflattenedOQLLine.result.forEach((function(r){var n=(0,Fn.DA)(e.storeForAllData.samples.result,e.storeForAllData.patients.result,e.storeForAllData.coverageInformation.result,e.storeForAllData.filteredSequencedSampleKeysByGene.result,e.storeForAllData.filteredSequencedPatientKeysByGene.result,e.storeForAllData.selectedMolecularProfiles.result,r,!1,e.props.store.genes.result);n&&t.push(n)})),this.accumulatedAlterationFrequencyDataForNonQueryGenes=this.accumulatedAlterationFrequencyDataForNonQueryGenes.concat(t),this.accumulatedAlterationFrequencyDataForNonQueryGenes}},{key:"isNewStoreReady",get:function(){return this.storeForAllData&&this.storeForAllData.oqlFilteredCaseAggregatedDataByUnflattenedOQLLine.isComplete&&this.storeForAllData.samples.isComplete&&this.storeForAllData.patients.isComplete&&this.storeForAllData.coverageInformation.isComplete&&this.storeForAllData.filteredSequencedSampleKeysByGene.isComplete&&this.storeForAllData.filteredSequencedPatientKeysByGene.isComplete&&this.storeForAllData.selectedMolecularProfiles.isComplete}},{key:"storeForAllData",get:function(){return!this.urlWrapperForAllGenes||this.urlWrapperForAllGenes.hasSessionId&&this.urlWrapperForAllGenes.remoteSessionData.isPending?void 0:ds(this.props.appStore,this.urlWrapperForAllGenes)}},{key:"urlWrapperForAllGenes",get:function(){var e;if(this.validNonQueryGenes.isComplete&&this.validNonQueryGenes.result.length>0){var t=i().cloneDeep(this.props.urlWrapper.query);t.gene_list=this.validNonQueryGenes.result.join(" "),e={query:t}}return e}},{key:"validGenes",get:function(){var e=this;return this.validNonQueryGenes.isComplete&&this.validNonQueryGenes.result.forEach((function(t){e.accumulatedValidGenes[t]=!0})),this.accumulatedValidGenes}}])&&Bn(o.prototype,a),l&&Bn(o,l),t}(n.Component);Yn([c.observable],Xn.prototype,"selectedPathway",void 0),Yn([c.observable],Xn.prototype,"newGenesFromPathway",void 0),Yn([c.observable],Xn.prototype,"warningMessage",void 0),Yn([c.observable],Xn.prototype,"addGenomicData",void 0),Yn([c.observable.ref],Xn.prototype,"PathwayMapperComponent",void 0),Yn([c.computed],Xn.prototype,"alterationFrequencyData",null),Yn([c.computed],Xn.prototype,"message",null),Yn([c.computed],Xn.prototype,"alterationFrequencyDataForQueryGenes",null),Yn([c.computed],Xn.prototype,"alterationFrequencyDataForNonQueryGenes",null),Yn([c.computed],Xn.prototype,"isNewStoreReady",null),Yn([c.computed],Xn.prototype,"storeForAllData",null),Yn([c.computed],Xn.prototype,"urlWrapperForAllGenes",null),Yn([c.computed],Xn.prototype,"validGenes",null),Yn([c.action.bound],Xn.prototype,"addGenomicDataHandler",null),Yn([c.action.bound],Xn.prototype,"handlePathwayChange",null),Yn([c.action.bound],Xn.prototype,"handleAddGenes",null),Yn([c.action.bound],Xn.prototype,"updateMessage",null),Yn([c.action.bound],Xn.prototype,"clearMessage",null),Yn([S.default],Xn.prototype,"renderBanner",null),Yn([S.default],Xn.prototype,"renderTable",null);const Zn=Xn=Yn([u.observer],Xn);var zn=r(20947),$n=r(32096),Jn=r(60138);function eo(e,t,r,n,o,i,a,l,s){var u="sample"===l?"SAMPLE_DATA_":"PATIENT_DATA_";wr()(function(e,t,r,n,o,i,a,l,s){function u(e,t){return"".concat(e," (").concat(t,")")}var c=i.map(a),p={CLINICAL:{},CNA:{},MUTATIONS:{},MRNA:{},PROTEIN:{},STRUCTURAL_VARIANT:{}},d={amp:"Amplification",gain:"Gain",hetloss:"Shallow Deletion",homdel:"Deep Deletion"},f={};f=s?{inframe:"Inframe Mutation (putative passenger)",inframe_rec:"Inframe Mutation (putative driver)",missense:"Missense Mutation (putative passenger)",missense_rec:"Missense Mutation (putative driver)",promoter:"Promoter Mutation",promoter_rec:"Promoter Mutation",trunc:"Truncating mutation (putative passenger)",trunc_rec:"Truncating mutation (putative driver)"}:{inframe:"Inframe Mutation",inframe_rec:"Inframe Mutation",missense:"Missense Mutation",missense_rec:"Missense Mutation",promoter:"Promoter Mutation",promoter_rec:"Promoter Mutation",trunc:"Truncating mutation",trunc_rec:"Truncating mutation"};var m={high:"mRNA High",low:"mRNA Low"},h={low:"Protein Low",high:"Protein High"},y={true:"Structural Variant"},b=!0,g=!1,v=void 0;try{for(var S,E=e[Symbol.iterator]();!(b=(S=E.next()).done);b=!0){var C=S.value.data,w=C[0].trackLabel;void 0===p.CNA[w]&&(p.CNA[w]={}),void 0===p.MUTATIONS[w]&&(p.MUTATIONS[w]={}),void 0===p.MRNA[w]&&(p.MRNA[w]={}),void 0===p.PROTEIN[w]&&(p.PROTEIN[w]={}),void 0===p.STRUCTURAL_VARIANT[w]&&(p.STRUCTURAL_VARIANT[w]={});var T=!0,P=!1,O=void 0;try{for(var k,A=C[Symbol.iterator]();!(T=(k=A.next()).done);T=!0){var I=k.value,_="sample"===l?I.sample:I.patient;p.CNA[w][_]="",p.MUTATIONS[w][_]="",p.MRNA[w][_]="",p.PROTEIN[w][_]="",p.STRUCTURAL_VARIANT[w][_]="",void 0!==I.disp_cna&&(p.CNA[w][_]=d[I.disp_cna]?d[I.disp_cna]:I.disp_cna),void 0!==I.disp_structuralVariant&&(p.STRUCTURAL_VARIANT[w][_]=y[I.disp_structuralVariant+""]?y[I.disp_structuralVariant+""]:I.disp_structuralVariant),void 0!==I.disp_mrna&&(p.MRNA[w][_]=m[I.disp_mrna]?m[I.disp_mrna]:I.disp_mrna),void 0!==I.disp_prot&&(p.PROTEIN[w][_]=h[I.disp_prot]?h[I.disp_prot]:I.disp_prot),void 0!==I.disp_mut&&(p.MUTATIONS[w][_]=f[I.disp_mut]?f[I.disp_mut]:I.disp_mut)}}catch(e){P=!0,O=e}finally{try{T||null==A.return||A.return()}finally{if(P)throw O}}}}catch(e){g=!0,v=e}finally{try{b||null==E.return||E.return()}finally{if(g)throw v}}var D=!0,x=!1,M=void 0;try{for(var N,L=t[Symbol.iterator]();!(D=(N=L.next()).done);D=!0){var R=N.value,j=R.data,G=R.label;if("counts"===R.datatype){var V=!0,F=!1,B=void 0;try{for(var q,U=R.countsCategoryLabels[Symbol.iterator]();!(V=(q=U.next()).done);V=!0){var H=u(G,q.value);p.CLINICAL[H]=p.CLINICAL[H]||{}}}catch(e){F=!0,B=e}finally{try{V||null==U.return||U.return()}finally{if(F)throw B}}}else void 0===p.CLINICAL[G]&&(p.CLINICAL[G]={});var W=!0,Y=!1,K=void 0;try{for(var Q,X=j[Symbol.iterator]();!(W=(Q=X.next()).done);W=!0){var Z=Q.value,z="sample"===l?Z.sample:Z.patient;if("counts"===R.datatype){var $=!0,J=!1,ee=void 0;try{for(var te,re=R.countsCategoryLabels[Symbol.iterator]();!($=(te=re.next()).done);$=!0){var ne=te.value;p.CLINICAL[u(G,ne)][z]=Z.attr_val?Z.attr_val[ne]:""}}catch(e){J=!0,ee=e}finally{try{$||null==re.return||re.return()}finally{if(J)throw ee}}}else p.CLINICAL[G][z]="",p.CLINICAL[G][z]=(0,Jn.Z)(Z.attr_val,"")}}catch(e){Y=!0,K=e}finally{try{W||null==X.return||X.return()}finally{if(Y)throw K}}}}catch(e){x=!0,M=e}finally{try{D||null==L.return||L.return()}finally{if(x)throw M}}var oe=r.concat(n).concat(o),ie=!0,ae=!1,le=void 0;try{for(var se,ue=oe[Symbol.iterator]();!(ie=(se=ue.next()).done);ie=!0){var ce=se.value,pe=ce.label,de="HEATMAP "+ce.molecularAlterationType+" "+ce.datatype,fe=ce.data,me=!0,he=!1,ye=void 0;try{for(var be,ge=fe[Symbol.iterator]();!(me=(be=ge.next()).done);me=!0){var ve=be.value;void 0===p[de]&&(p[de]={}),void 0===p[de][pe]&&(p[de][pe]={});var Se="sample"===l?ve.sample:ve.patient;p[de][pe][Se]=null===ve.profile_data?"":ve.profile_data}}catch(e){he=!0,ye=e}finally{try{me||null==ge.return||ge.return()}finally{if(he)throw ye}}}}catch(e){ae=!0,le=e}finally{try{ie||null==ue.return||ue.return()}finally{if(ae)throw le}}for(var Ee="track_name\ttrack_type",Ce=0;Ce<c.length;Ce++)Ee+="\t"+c[Ce];return Ee+="\n",Object.keys(p).forEach((function(e){Object.keys(p[e]).forEach((function(t){Ee+=t+"\t"+e;for(var r=0;r<c.length;r++)Ee+="\t"+p[e][t][c[r]];Ee+="\n"}))})),Ee}(e,t,r,n,o,i,a,l,s),u+"oncoprint.tsv")}var to=r(4377),ro=r(34965),no=r(3335),oo=r(92421),io=r(22872),ao=r(63276),lo={missense:p.YK.MUTATION_EXTENDED,inframe:p.YK.MUTATION_EXTENDED,structuralVariant:p.YK.STRUCTURAL_VARIANT,promoter:p.YK.MUTATION_EXTENDED,trunc:p.YK.MUTATION_EXTENDED,splice:p.YK.MUTATION_EXTENDED,other:p.YK.MUTATION_EXTENDED,amp:p.YK.COPY_NUMBER_ALTERATION,homdel:p.YK.COPY_NUMBER_ALTERATION,gain:p.YK.COPY_NUMBER_ALTERATION,hetloss:p.YK.COPY_NUMBER_ALTERATION,mrnaHigh:p.YK.MRNA_EXPRESSION,mrnaLow:p.YK.MRNA_EXPRESSION,protHigh:p.YK.PROTEIN_LEVEL,protLow:p.YK.PROTEIN_LEVEL};function so(e,t,r){var n=function(e){var t=null;switch(e.molecularProfileAlterationType){case p.YK.MUTATION_EXTENDED:t=(0,oo.JJ)(e);break;case p.YK.STRUCTURAL_VARIANT:t="structuralVariant";break;case p.YK.COPY_NUMBER_ALTERATION:t=io.Lm[e.value];break;case p.YK.MRNA_EXPRESSION:"high"===e.alterationSubType?t="mrnaHigh":"low"===e.alterationSubType&&(t="mrnaLow");break;case p.YK.PROTEIN_LEVEL:"high"===e.alterationSubType?t="protHigh":"low"===e.alterationSubType&&(t="protLow")}return t}(e);if(n){var o={};return o.sampleId=r,o.hugoGeneSymbol=e.hugoGeneSymbol,o.trackName=t,o.alteration=n,o.proteinChange=e.proteinChange,o.eventInfo=e.eventInfo,o.isGermline=!(0,we.cn)(e),o.isCustomDriver=e.driverFilter===Vn.U1,o}return{sampleId:r}}function uo(e){var t=[e.sampleId];if((0,no.TM)(e)){switch(t.push(e.hugoGeneSymbol),lo[e.alteration]){case p.YK.MUTATION_EXTENDED:t.push(e.proteinChange||"mutation"),t.push(e.alteration.toUpperCase()+(e.isGermline?"_GERMLINE":"")+(e.isCustomDriver?"_DRIVER":""));break;case p.YK.COPY_NUMBER_ALTERATION:t.push(e.alteration.toUpperCase()),t.push("CNA");break;case p.YK.MRNA_EXPRESSION:t.push("mrnaHigh"===e.alteration?"HIGH":"LOW"),t.push("EXP");break;case p.YK.PROTEIN_LEVEL:t.push("protHigh"===e.alteration?"HIGH":"LOW"),t.push("PROT");break;case p.YK.STRUCTURAL_VARIANT:t.push(e.eventInfo||"structural_variant"),t.push("FUSION")}e.trackName&&t.push(e.trackName)}return t.map(co).join("  ")}function co(e){return e.replace(/\s+/g,"_")}function po(e){return e.replace(/[()]/g,"").replace(/\s+/g,"_")}function fo(e,t,r){var n=i().mapValues(i().keyBy(e,(function(e){return e.key})),(function(e){return i().keyBy(e.data,(function(e){return e[r]}))})),o=[];o.push(["Sample"].concat(e.map((function(e){return"".concat(po("".concat(e.label,"_").concat(e.molecularProfileName)),"(").concat(function(e,t){if(/zscores/i.test(e))return ao.UK.HEATMAP_ZSCORE;switch(t){case p.YK.METHYLATION:return ao.UK.HEATMAP_01;default:return ao.UK.HEATMAP}}(e.molecularProfileId,e.molecularAlterationType),")")}))));var a=!0,l=!1,s=void 0;try{for(var u,c=function(){var t=u.value;o.push([t].concat(e.map((function(e){var r=n[e.key][t];return!r||r.na||null===r.profile_data||isNaN(r.profile_data)?ao.Wp:r.profile_data}))))},d=t[Symbol.iterator]();!(a=(u=d.next()).done);a=!0)c()}catch(e){l=!0,s=e}finally{try{a||null==d.return||d.return()}finally{if(l)throw s}}return o.map((function(e){return e.join("  ")})).join("\n")}function mo(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ho(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function yo(e){return(yo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function bo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function go(e,t){return(go=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vo(e){return(vo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var So,Eo=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":vo(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},Co=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{s(n.next(e))}catch(e){i(e)}}function l(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,l)}s((n=n.apply(e,t||[])).next())}))};!function(e){e.CASE_ID="case_id",e.CASE_LIST="case_list",e.NONE=""}(So||(So={}));var wo="CLINICALTRACK_",To=function(e){function t(e){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==vo(t)&&"function"!=typeof t?bo(e):t}(this,yo(t).call(this,e)),Object.defineProperty(bo(r),"distinguishGermlineMutations",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(bo(r),"distinguishMutationType",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(bo(r),"showUnalteredColumns",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(bo(r),"showWhitespaceBetweenColumns",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(bo(r),"showClinicalTrackLegends",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(bo(r),"_onlyShowClinicalLegendForAlteredCases",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(bo(r),"showOqlInLabels",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(bo(r),"showMinimap",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(bo(r),"selectedHeatmapProfileId",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(bo(r),"heatmapGeneInputValue",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(bo(r),"selectedGenericAssayProfileId",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(bo(r),"horzZoom",{enumerable:!0,configurable:!0,writable:!0,value:.5}),Object.defineProperty(bo(r),"mouseInsideBounds",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(bo(r),"renderingComplete",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(bo(r),"heatmapGeneInputValueUpdater",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(bo(r),"molecularProfileIdToTrackGroupIndex",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(bo(r),"expansionsByGeneticTrackKey",{enumerable:!0,configurable:!0,writable:!0,value:c.observable.map()}),Object.defineProperty(bo(r),"expansionsByGenesetHeatmapTrackKey",{enumerable:!0,configurable:!0,writable:!0,value:c.observable.map()}),Object.defineProperty(bo(r),"controlsHandlers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(bo(r),"controlsState",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(bo(r),"oncoprint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(bo(r),"urlParamsReaction",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(bo(r),"unalteredKeys",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[r.geneticTracks]},invoke:function(){return Co(bo(r),void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,Fn.KD)(this.geneticTracks.result));case 1:case"end":return e.stop()}}),e,this)})))}})}),Object.defineProperty(bo(r),"alteredKeys",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[r.geneticTracks]},invoke:function(){return Co(bo(r),void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,Fn.pM)(this.geneticTracks.result));case 1:case"end":return e.stop()}}),e,this)})))},default:[]})}),Object.defineProperty(bo(r),"sampleGeneticTracks",{enumerable:!0,configurable:!0,writable:!0,value:(0,Fn.dk)(bo(r),!0)}),Object.defineProperty(bo(r),"patientGeneticTracks",{enumerable:!0,configurable:!0,writable:!0,value:(0,Fn.dk)(bo(r),!1)}),Object.defineProperty(bo(r),"sampleClinicalTracks",{enumerable:!0,configurable:!0,writable:!0,value:(0,Fn.fE)(bo(r),!0)}),Object.defineProperty(bo(r),"patientClinicalTracks",{enumerable:!0,configurable:!0,writable:!0,value:(0,Fn.fE)(bo(r),!1)}),Object.defineProperty(bo(r),"sampleHeatmapTracks",{enumerable:!0,configurable:!0,writable:!0,value:(0,Fn.Qo)(bo(r),!0)}),Object.defineProperty(bo(r),"patientHeatmapTracks",{enumerable:!0,configurable:!0,writable:!0,value:(0,Fn.Qo)(bo(r),!1)}),Object.defineProperty(bo(r),"samplegGenericAssayHeatmapTracks",{enumerable:!0,configurable:!0,writable:!0,value:(0,Fn.oQ)(bo(r),!0)}),Object.defineProperty(bo(r),"patientGenericAssayHeatmapTracks",{enumerable:!0,configurable:!0,writable:!0,value:(0,Fn.oQ)(bo(r),!1)}),Object.defineProperty(bo(r),"sampleGenericAssayCategoricalTracks",{enumerable:!0,configurable:!0,writable:!0,value:(0,Fn.O9)(bo(r),!0)}),Object.defineProperty(bo(r),"patientGenericAssayCategoricalTracks",{enumerable:!0,configurable:!0,writable:!0,value:(0,Fn.O9)(bo(r),!1)}),Object.defineProperty(bo(r),"sampleGenesetHeatmapTracks",{enumerable:!0,configurable:!0,writable:!0,value:(0,Fn.gm)(bo(r),!0,(0,Fn.Gf)(bo(r),!0))}),Object.defineProperty(bo(r),"patientGenesetHeatmapTracks",{enumerable:!0,configurable:!0,writable:!0,value:(0,Fn.gm)(bo(r),!1,(0,Fn.Gf)(bo(r),!1))}),Object.defineProperty(bo(r),"additionalTrackGroupHeaders",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[r.props.store.molecularProfileIdToMolecularProfile]},invoke:function(){return Promise.resolve((0,ro.zA)(r.props.store.molecularProfileIdToMolecularProfile.result,r.molecularProfileIdToAdditionalTracks,r.genesetHeatmapTrackGroupIndex,(function(){return r.clusteredHeatmapTrackGroupIndex}),r.clusterHeatmapByIndex,(function(){return r.sortByData()}),r.removeAdditionalTrackSection))},default:{}})}),Object.defineProperty(bo(r),"alterationTypesInQuery",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[r.props.store.selectedMolecularProfiles]},invoke:function(){return Promise.resolve(i().uniq(r.props.store.selectedMolecularProfiles.result.map((function(e){return e.molecularAlterationType}))))}})}),Object.defineProperty(bo(r),"loadingGeneticDataDuringCurrentLoad",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(bo(r),"loadingClinicalDataDuringCurrentLoad",{enumerable:!0,configurable:!0,writable:!0,value:!1}),(0,c.makeObservable)(bo(r)),r.showOqlInLabels=e.store.queryContainsOql,window.resultsViewOncoprint=bo(r);var n=bo(r);return r.onChangeSelectedClinicalTracks=r.onChangeSelectedClinicalTracks.bind(bo(r)),r.onDeleteClinicalTrack=r.onDeleteClinicalTrack.bind(bo(r)),r.onMinimapClose=r.onMinimapClose.bind(bo(r)),r.oncoprintRef=r.oncoprintRef.bind(bo(r)),r.toggleColumnMode=r.toggleColumnMode.bind(bo(r)),r.onTrackSortDirectionChange=r.onTrackSortDirectionChange.bind(bo(r)),r.onSuppressRendering=r.onSuppressRendering.bind(bo(r)),r.onReleaseRendering=r.onReleaseRendering.bind(bo(r)),(0,w.XE)(r.props.store.heatmapMolecularProfiles,(function(e){e.length&&(r.selectedHeatmapProfileId=e[0].molecularProfileId)})),r.heatmapGeneInputValueUpdater=(0,w.XE)(r.props.store.genes,(function(e){r.heatmapGeneInputValue=e.map((function(e){return e.hugoGeneSymbol})).join(" ")}),Number.POSITIVE_INFINITY),r.onMouseEnter=r.onMouseEnter.bind(bo(r)),r.onMouseLeave=r.onMouseLeave.bind(bo(r)),r.controlsHandlers=r.buildControlsHandlers(),r.controlsState=(0,c.observable)({get selectedClinicalAttributeIds(){return Array.from(n.selectedClinicalAttributeIds.keys())},get selectedColumnType(){return n.oncoprintAnalysisCaseType},get showUnalteredColumns(){return n.showUnalteredColumns},get showWhitespaceBetweenColumns(){return n.showWhitespaceBetweenColumns},get showClinicalTrackLegends(){return n.showClinicalTrackLegends},get onlyShowClinicalLegendForAlteredCases(){return n.onlyShowClinicalLegendForAlteredCases},get showOqlInLabels(){return n.showOqlInLabels},get showMinimap(){return n.showMinimap},get hideHeatmapMenu(){return n.props.store.studies.result.length>1},get sortByMutationType(){return n.sortByMutationType},get sortByCaseListDisabled(){return!n.caseListSortPossible},get distinguishMutationType(){return n.distinguishMutationType},get distinguishDrivers(){return n.distinguishDrivers},get distinguishGermlineMutations(){return n.distinguishGermlineMutations},get annotateDriversOncoKb(){return n.props.store.driverAnnotationSettings.oncoKb},get annotateDriversOncoKbDisabled(){return!(0,cr.Ib)().show_oncokb},get annotateDriversOncoKbError(){return n.props.store.didOncoKbFailInOncoprint},get annotateDriversHotspots(){return n.props.store.driverAnnotationSettings.hotspots},get annotateDriversHotspotsDisabled(){return!(0,cr.Ib)().show_hotspot},get annotateDriversHotspotsError(){return n.props.store.didHotspotFailInOncoprint},get annotateDriversCBioPortal(){return n.props.store.driverAnnotationSettings.cbioportalCount},get annotateDriversCOSMIC(){return n.props.store.driverAnnotationSettings.cosmicCount},get hidePutativePassengers(){return!n.props.store.driverAnnotationSettings.includeVUS},get hideGermlineMutations(){return!n.props.store.includeGermlineMutations},get annotateCBioPortalInputValue(){return n.props.store.driverAnnotationSettings.cbioportalCountThreshold+""},get annotateCOSMICInputValue(){return n.props.store.driverAnnotationSettings.cosmicCountThreshold+""},get sortMode(){return n.sortMode},get sortByDrivers(){return n.sortByDrivers},get heatmapProfilesPromise(){return n.props.store.heatmapMolecularProfiles},get genericAssayEntitiesGroupedByGenericAssayTypePromise(){return this.genericAssayPromises.genericAssayEntitiesGroupedByGenericAssayType},get selectedHeatmapProfileId(){return n.selectedHeatmapProfileId},get heatmapIsDynamicallyQueried(){return n.heatmapIsDynamicallyQueried},get ngchmButtonActive(){return!(!(0,cr.Ib)().show_mdacc_heatmap||!n.props.store.remoteNgchmUrl.result||""==n.props.store.remoteNgchmUrl.result)},get heatmapGeneInputValue(){return n.heatmapGeneInputValue},get customDriverAnnotationBinaryMenuLabel(){var e=(0,cr.Ib)().oncoprint_custom_driver_annotation_binary_menu_label,t=n.props.store.customDriverAnnotationReport.result;return e&&t&&t.hasBinary?e:void 0},get customDriverAnnotationTiersMenuLabel(){var e=(0,cr.Ib)().oncoprint_custom_driver_annotation_tiers_menu_label,t=n.props.store.customDriverAnnotationReport.result;return e&&t&&t.tiers.length?e:void 0},get customDriverAnnotationTiers(){var e=n.props.store.customDriverAnnotationReport.result;return e&&e.tiers.length?e.tiers:void 0},get annotateCustomDriverBinary(){return n.props.store.driverAnnotationSettings.customBinary},get selectedCustomDriverAnnotationTiers(){return n.props.store.driverAnnotationSettings.driverTiers},get columnMode(){return n.oncoprintAnalysisCaseType},get horzZoom(){return isNaN(n.horzZoom)?1:n.horzZoom}}),r}var r,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&go(e,t)}(t,e),r=t,(o=[{key:"onMouseEnter",value:function(){this.mouseInsideBounds=!0}},{key:"onMouseLeave",value:function(){this.mouseInsideBounds=!1}},{key:"buildControlsHandlers",value:function(){var e=this;return{onSelectColumnType:function(t){e.props.store.setOncoprintAnalysisCaseType(t)},onSelectShowUnalteredColumns:function(t){e.showUnalteredColumns=t},onSelectShowWhitespaceBetweenColumns:function(t){e.showWhitespaceBetweenColumns=t},onSelectShowClinicalTrackLegends:function(t){e.showClinicalTrackLegends=t},onSelectOnlyShowClinicalLegendForAlteredCases:function(t){e._onlyShowClinicalLegendForAlteredCases=t},onSelectShowOqlInLabels:function(t){e.showOqlInLabels=t},onSelectShowMinimap:function(t){e.showMinimap=t},onSelectDistinguishMutationType:function(t){e.distinguishMutationType=t},onSelectDistinguishDrivers:(0,c.action)((function(t){t?(e.controlsState.annotateDriversOncoKbDisabled||e.controlsState.annotateDriversOncoKbError||(e.props.store.driverAnnotationSettings.oncoKb=!0),e.controlsState.annotateDriversHotspotsDisabled||e.controlsState.annotateDriversHotspotsError||(e.props.store.driverAnnotationSettings.hotspots=!0),e.props.store.driverAnnotationSettings.cbioportalCount=!0,e.props.store.driverAnnotationSettings.cosmicCount=!0,e.props.store.driverAnnotationSettings.customBinary=!0,e.props.store.driverAnnotationSettings.driverTiers.forEach((function(t,r){e.props.store.driverAnnotationSettings.driverTiers.set(r,!0)}))):(e.props.store.driverAnnotationSettings.oncoKb=!1,e.props.store.driverAnnotationSettings.hotspots=!1,e.props.store.driverAnnotationSettings.cbioportalCount=!1,e.props.store.driverAnnotationSettings.cosmicCount=!1,e.props.store.driverAnnotationSettings.customBinary=!1,e.props.store.driverAnnotationSettings.driverTiers.forEach((function(t,r){e.props.store.driverAnnotationSettings.driverTiers.set(r,!1)})),e.props.store.driverAnnotationSettings.includeVUS=!0)})),onSelectDistinguishGermlineMutations:function(t){e.distinguishGermlineMutations=t},onSelectAnnotateOncoKb:(0,c.action)((function(t){e.props.store.driverAnnotationSettings.oncoKb=t})),onSelectAnnotateHotspots:(0,c.action)((function(t){e.props.store.driverAnnotationSettings.hotspots=t})),onSelectCustomDriverAnnotationBinary:(0,c.action)((function(t){e.props.store.driverAnnotationSettings.customBinary=t})),onSelectCustomDriverAnnotationTier:(0,c.action)((function(t,r){e.props.store.driverAnnotationSettings.driverTiers.set(t,r)})),onSelectHideVUS:function(t){e.props.store.driverAnnotationSettings.includeVUS=!t},onSelectHideGermlineMutations:function(t){e.props.store.setExcludeGermlineMutations(t)},onSelectSortByMutationType:function(t){e.urlWrapper.updateURL({oncoprint_sort_by_mutation_type:t.toString()})},onClickSortAlphabetical:function(){e.urlWrapper.updateURL({oncoprint_sortby:"case_id",oncoprint_cluster_profile:""})},onClickSortCaseListOrder:function(){e.urlWrapper.updateURL({oncoprint_sortby:"case_list",oncoprint_cluster_profile:""})},onSelectSortByDrivers:function(t){e.urlWrapper.updateURL({oncoprint_sort_by_drivers:t.toString()})},onClickSortByData:function(){e.urlWrapper.updateURL({oncoprint_sortby:"",oncoprint_cluster_profile:""})},onChangeSelectedClinicalTracks:this.onChangeSelectedClinicalTracks,onChangeHeatmapGeneInputValue:(0,c.action)((function(t){e.heatmapGeneInputValue=t,e.heatmapGeneInputValueUpdater()})),onSelectHeatmapProfile:function(t){e.selectedHeatmapProfileId=t},onClickAddGenesToHeatmap:function(){var t=(0,Yr.O$)(e.heatmapGeneInputValue.toUpperCase().trim()).map((function(e){return e.gene}));e.setHeatmapTracks(e.selectedHeatmapProfileId,t)},onSelectGenericAssayProfile:function(t){e.selectedGenericAssayProfileId=t},onClickAddGenericAssays:function(t){e.setGenericAssayTracks(e.selectedGenericAssayProfileId,t.map((function(e){return e.genericAssayEntityId})))},onClickNGCHM:function(){window.open(e.props.store.remoteNgchmUrl.result,"_blank")},onClickDownload:function(t){switch(t){case"pdf":(0,w.N7)("oncoprint.pdf",e.oncoprint.toSVG(!1));break;case"png":e.oncoprint.toCanvas((function(e,t){e.toBlob((function(r){t&&alert("Oncoprint too large - PNG truncated to ".concat(e.getAttribute("width"),"x").concat(e.getAttribute("height"))),wr()(r,"oncoprint.png")}))}),2);break;case"svg":wr()((new XMLSerializer).serializeToString(e.oncoprint.toSVG(!1)),"oncoprint.svg");break;case"order":var r=(0,w.kC)(e.oncoprintAnalysisCaseType);(0,w.XE)([e.props.store.sampleKeyToSample,e.props.store.patientKeyToPatient],(function(t,n){var o="".concat(r," order in the Oncoprint is:\n"),i=(e.oncoprintAnalysisCaseType,Tr.zz.SAMPLE,e.oncoprint.getIdOrder().map(e.oncoprintAnalysisCaseType===Tr.zz.SAMPLE?function(e){return t[e].sampleId}:function(e){return n[e].patientId})),a=!0,l=!1,s=void 0;try{for(var u,c=i[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var p=u.value;o+="".concat(p,"\n")}}catch(e){l=!0,s=e}finally{try{a||null==c.return||c.return()}finally{if(l)throw s}}wr()(o,"OncoPrint".concat(r,"s.txt"))}));break;case"tabular":(0,w.XE)([e.props.store.sampleKeyToSample,e.props.store.patientKeyToPatient],(function(t,r){eo(e.geneticTracks.result,e.clinicalTracks.result,e.heatmapTracks.result,e.genericAssayHeatmapTracks.result,e.genesetHeatmapTracks.result,e.oncoprint.getIdOrder(),e.oncoprintAnalysisCaseType===Tr.zz.SAMPLE?function(e){return t[e].sampleId}:function(e){return r[e].patientId},e.oncoprintAnalysisCaseType,e.distinguishDrivers)}));break;case"oncoprinter":(0,w.XE)([e.props.store.samples,e.props.store.patients,e.geneticTracks,e.clinicalTracks,e.heatmapTracks,e.genesetHeatmapTracks,e.props.store.clinicalAttributeIdToClinicalAttribute],(function(t,r,n,o,a,l,s){var u=e.oncoprintAnalysisCaseType===Tr.zz.SAMPLE?t.map((function(e){return e.sampleId})):r.map((function(e){return e.patientId})),c="";n.length>0&&(c=function(e,t,r){var n={};return i().flatMapDeep(e,(function(e){var t=function(e,t){var r=e;for(t[r]=t[r]||0,t[r]+=1;t[r]>1;)t[r="".concat(r,"_").concat(t[r])]=t[r]||0,t[r]+=1;return r}(e.label,n);return e.data.map((function(e){return e.data.map((function(n){return so(n,t,e[r])}))}))})).map(uo).concat(t).join("\n")}(n,u,e.oncoprintAnalysisCaseType));var p="";o.length>0&&(p=function(e,t,r,n,o){var a=i().groupBy(e,(function(e){return e[o]})),l=[];l.push(["Sample"].concat(r.map((function(e){var t=n[e],r=po(t.displayName),o=t.datatype.toLowerCase();return"MUTATION_COUNT"===t.clinicalAttributeId&&(o=ao.Cb.LOG_NUMBER),t.clinicalAttributeId===to.OY.MutationSpectrum&&(o=to.gh.join("/")),"".concat(r,"(").concat(o,")")}))));var s=!0,u=!1,c=void 0;try{for(var p,d=function(){var e=p.value;l.push([e].concat(r.map((function(t){var r=a[e]&&a[e].find((function(e){return e.attr_id===t}));return r&&!r.na&&r.attr_val?t===to.OY.MutationSpectrum?to.gh.map((function(e){return r.attr_val[e]})).join("/"):co(r.attr_val.toString()):ao.Wp}))))},f=t[Symbol.iterator]();!(s=(p=f.next()).done);s=!0)d()}catch(e){u=!0,c=e}finally{try{s||null==f.return||f.return()}finally{if(u)throw c}}return l.map((function(e){return e.join("  ")})).join("\n")}(i().flatMap(o,(function(e){return e.data})),u,o.map((function(e){return e.attributeId})),s,e.oncoprintAnalysisCaseType));var d="";a.length>0&&(d=fo(a,u,e.oncoprintAnalysisCaseType)),l.length>0&&alert("Oncoprinter does not support geneset heatmaps - all other tracks will still be exported."),window.open((0,se.gN)("/oncoprinter")).clientPostedData={genetic:c,clinical:p,heatmap:d}}))}},onSetHorzZoom:function(t){e.oncoprint.setHorzZoomCentered(t)},onClickZoomIn:function(){e.oncoprint.setHorzZoomCentered(e.oncoprint.getHorzZoom()/.7)},onClickZoomOut:function(){e.oncoprint.setHorzZoomCentered(.7*e.oncoprint.getHorzZoom())}}}},{key:"sortByData",value:function(){this.urlWrapper.updateURL({oncoprint_sortby:"",oncoprint_cluster_profile:""})}},{key:"setGenericAssayTracks",value:function(e,t){var r=this.urlWrapper.query.generic_assay_groups?this.urlWrapper.query.generic_assay_groups.split(";").map((function(e){return e.split(",")})):[],n=r.find((function(t){return t[0]===e}));n?(n.splice(1,n.length),n.push.apply(n,mo(t))):r.push([e].concat(mo(t)));var o=r.filter((function(e){return e.length>1})).map((function(e){return e.join(",")})).join(";");this.urlWrapper.updateURL({generic_assay_groups:o})}},{key:"setHeatmapTracks",value:function(e,t){return Co(this,void 0,void 0,regeneratorRuntime.mark((function r(){var n,o,a,l,s;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=i().cloneDeep(this.molecularProfileIdToAdditionalTracks),o=i().chain(t).keyBy((function(e){return e})).mapValues((function(){return!0})).value(),delete n[e],a=this.props.store.molecularProfileIdToMolecularProfile.result[e].molecularAlterationType,t&&t.length?n[e]={entities:o,molecularAlterationType:a,molecularProfileId:e}:delete n[e],r.next=7,(0,w.Vi)(this.props.store.molecularProfileIdToMolecularProfile);case 7:l=r.sent,s=[],i().forEach(n,(function(e,t){var r=l[t],n=!0;r.molecularAlterationType===p.YK.GENERIC_ASSAY&&(n=(0,ro.w5)(r)),n&&s.push("".concat(t,",").concat(i().keys(e.entities).join(",")))})),this.urlWrapper.updateURL({heatmap_track_groups:s.join(";")});case 11:case"end":return r.stop()}}),r,this)})))}},{key:"toggleColumnMode",value:function(){switch(this.oncoprintAnalysisCaseType){case Tr.zz.SAMPLE:this.controlsHandlers.onSelectColumnType&&this.controlsHandlers.onSelectColumnType(Tr.zz.PATIENT);break;case Tr.zz.PATIENT:this.controlsHandlers.onSelectColumnType&&this.controlsHandlers.onSelectColumnType(Tr.zz.SAMPLE)}}},{key:"oncoprintRef",value:function(e){var t=this;this.oncoprint=e,this.props.addOnBecomeVisibleListener&&this.props.addOnBecomeVisibleListener((function(){return t.oncoprint.triggerPendingResizeAndOrganize(t.onReleaseRendering)})),this.oncoprint.onHorzZoom((function(e){return t.horzZoom=e})),this.horzZoom=this.oncoprint.getHorzZoom(),(0,w.XE)(this.alteredKeys,(function(e){t.oncoprint.setHorzZoomToFit(e)}))}},{key:"setColumnMode",value:function(e){this.urlWrapper.updateURL({show_samples:e===Tr.zz.SAMPLE?"true":"false"})}},{key:"onMinimapClose",value:function(){this.showMinimap=!1}},{key:"onSuppressRendering",value:function(){this.renderingComplete=!1}},{key:"onReleaseRendering",value:function(){this.renderingComplete=!0}},{key:"clinicalTrackKeyToAttributeId",value:function(e){return e.substr(wo.length)}},{key:"clinicalAttributeIdToTrackKey",value:function(e){return"".concat(wo).concat(e)}},{key:"onChangeSelectedClinicalTracks",value:function(e){this.urlWrapper.updateURL(this.urlWrapper.getOncoprintClinicalTrackParams(e))}},{key:"onDeleteClinicalTrack",value:function(e){var t=this;if(!this.isHidden){var r=mo(this.selectedClinicalAttributeIds.keys()),n=i().filter(r,(function(r){return r!==t.clinicalTrackKeyToAttributeId(e)}));this.urlWrapper.updateURL(this.urlWrapper.getOncoprintClinicalTrackParams(n))}}},{key:"onTrackSortDirectionChange",value:function(e,t){1!==t&&-1!==t||this.sortByData()}},{key:"clearSortDirectionsAndSortByData",value:function(){this.oncoprint&&(this.oncoprint.resetSortableTracksSortDirection(),this.sortByData())}},{key:"clusterHeatmapByIndex",value:function(e){var t;if(this.oncoprint&&this.oncoprint.resetSortableTracksSortDirection(),e===this.genesetHeatmapTrackGroupIndex)t=this.props.store.genesetMolecularProfile.result&&this.props.store.genesetMolecularProfile.result.value&&this.props.store.genesetMolecularProfile.result.value.molecularProfileId;else{var r=i().values(this.molecularProfileIdToAdditionalTracks).find((function(t){return t.trackGroupIndex===e}));t=r?r.molecularProfileId:void 0}t&&this.urlWrapper.updateURL({oncoprint_sortby:"cluster",oncoprint_cluster_profile:t})}},{key:"removeAdditionalTrackSection",value:function(e){var t=i().values(this.molecularProfileIdToAdditionalTracks).find((function(t){return t.trackGroupIndex===e}));t&&((0,ro.w5)(t.molecularProfile)||(0,ro.hu)(t.molecularProfile)?this.removeGenericAssayTracksByMolecularProfileId(t.molecularProfileId):this.removeHeatmapTracksByMolecularProfileId(t.molecularProfileId))}},{key:"removeGenericAssayTracksByMolecularProfileId",value:function(e){delete this.molecularProfileIdToTrackGroupIndex[e],this.setGenericAssayTracks(e,[])}},{key:"removeHeatmapTracksByMolecularProfileId",value:function(e){delete this.molecularProfileIdToTrackGroupIndex[e],this.setHeatmapTracks(e,[])}},{key:"getControls",value:function(){return this.oncoprint&&!this.oncoprint.webgl_unavailable&&this.props.store.molecularProfileIdToMolecularProfile.result?n.createElement(w.i0,{showByDefault:!0,show:!0},n.createElement($n.Z,{handlers:this.controlsHandlers,state:this.controlsState,store:this.props.store,molecularProfileIdToMolecularProfile:this.props.store.molecularProfileIdToMolecularProfile.result,selectedGenericAssayEntitiesGroupedByGenericAssayTypeFromUrl:this.selectedGenericAssayEntitiesGroupedByGenericAssayTypeFromUrl})):n.createElement("span",null)}},{key:"getProgressItems",value:function(e){0===e&&(this.loadingGeneticDataDuringCurrentLoad=!1,this.loadingClinicalDataDuringCurrentLoad=!1);var t=i().some(mo(this.selectedClinicalAttributeIds.keys()),(function(e){return!(0,to.Ac)({clinicalAttributeId:e})}));this.geneticTracks.isPending&&(this.loadingGeneticDataDuringCurrentLoad=!0),t&&this.clinicalTracks.isPending&&(this.loadingClinicalDataDuringCurrentLoad=!0);var r,n=[];if(this.props.store.genes.isComplete&&this.props.store.filteredSamples.isComplete){var o=this.props.store.genes.result.length,a=this.props.store.filteredSamples.result.length;r="Querying ".concat(o," genes in ").concat(a," samples")}else r="Querying ... genes in ... samples";var l="";e>2&&(l=" - this can take several seconds"),n.push({label:"".concat(r).concat(l),promises:[],hideIcon:!0,style:{fontWeight:"bold"}});var s=[];this.loadingGeneticDataDuringCurrentLoad&&s.push("genetic"),this.loadingClinicalDataDuringCurrentLoad&&s.push("clinical"),n.push({label:"Loading ".concat(s.join(" and ")," data"),promises:[this.props.store.molecularData,this.props.store.mutations].concat(mo(t?[this.clinicalTracks]:[]))});var u=this.props.store.driverAnnotationSettings.oncoKb,c=this.props.store.driverAnnotationSettings.hotspots;return n.push({label:(0,ro.Iq)(u,c),promises:[this.props.store.filteredAndAnnotatedMolecularData,this.props.store.filteredAndAnnotatedMutations,this.props.store.filteredAndAnnotatedStructuralVariants]}),n.push({label:"Rendering"}),n}},{key:"render",value:function(){return n.createElement("div",{style:{position:"relative"}},n.createElement(ee.Z,{isLoading:this.isHidden,size:"big",centerRelativeToContainer:!1,center:!0,className:"oncoprintLoadingIndicator",noFade:!0},n.createElement("div",null,n.createElement(An.Z,{getItems:this.getProgressItems,show:this.isHidden,sequential:!0}))),n.createElement("div",{className:"tabMessageContainer"},n.createElement(oe.Z,{className:"oncoprint-oql-status-banner",store:this.props.store,tabReflectsOql:!0}),n.createElement(ae.Z,{store:this.props.store}),n.createElement(ue.Z,{store:this.props.store,isPatientMode:this.oncoprintAnalysisCaseType===Tr.zz.PATIENT})),n.createElement("div",{className:b()("oncoprintContainer",{fadeIn:!this.isHidden}),onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},n.createElement(u.Observer,null,this.getControls),n.createElement("div",{style:{position:"relative",marginTop:15}},n.createElement("div",null,n.createElement(zn.ZP,{oncoprintRef:this.oncoprintRef,clinicalTracks:this.clinicalTracks.result,geneticTracks:this.geneticTracks.result,genesetHeatmapTracks:this.genesetHeatmapTracks.result,heatmapTracks:[].concat(this.genericAssayHeatmapTracks.result).concat(this.heatmapTracks.result),categoricalTracks:this.genericAssayCategoricalTracks.result,divId:this.props.divId,width:this.width,caseLinkOutInTooltips:!0,suppressRendering:this.isLoading,keepSorted:!this.isLoading,onSuppressRendering:this.onSuppressRendering,onReleaseRendering:this.onReleaseRendering,hiddenIds:this.showUnalteredColumns?void 0:this.unalteredKeys.result,molecularProfileIdToMolecularProfile:this.props.store.molecularProfileIdToMolecularProfile.result,alterationTypesInQuery:this.alterationTypesInQuery.result,showSublabels:this.showOqlInLabels,additionalTrackGroupHeaders:this.additionalTrackGroupHeaders.result,horzZoomToFitIds:this.alteredKeys.result,distinguishMutationType:this.distinguishMutationType,distinguishDrivers:this.distinguishDrivers,distinguishGermlineMutations:this.distinguishGermlineMutations,sortConfig:this.oncoprintLibrarySortConfig,showClinicalTrackLegends:this.showClinicalTrackLegends,showWhitespaceBetweenColumns:this.showWhitespaceBetweenColumns,showMinimap:this.showMinimap,onMinimapClose:this.onMinimapClose,onDeleteClinicalTrack:this.onDeleteClinicalTrack,onTrackSortDirectionChange:this.onTrackSortDirectionChange,initParams:{max_height:Number.POSITIVE_INFINITY}})))))}},{key:"columnMode",get:function(){return"true"===this.urlWrapper.query.show_samples?"sample":"patient"}},{key:"sortMode",get:function(){var e;switch(this.urlWrapper.query.oncoprint_sortby){case"case_id":e={type:"alphabetical"};break;case"case_list":e={type:"caseList"};break;case"cluster":e={type:"heatmap",clusteredHeatmapProfile:this.urlWrapper.query.oncoprint_cluster_profile};break;case"":default:e={type:"data"}}return e}},{key:"sortByMutationType",get:function(){return!this.urlWrapper.query.oncoprint_sort_by_mutation_type||"true"===this.urlWrapper.query.oncoprint_sort_by_mutation_type}},{key:"sortByDrivers",get:function(){return!this.urlWrapper.query.oncoprint_sort_by_drivers||"true"===this.urlWrapper.query.oncoprint_sort_by_drivers}},{key:"genericAssayPromises",get:function(){return 1===this.props.store.studyIds.result.length?this.props.store:{genericAssayEntitiesGroupedByGenericAssayType:(0,w.ri)({}),genericAssayEntitiesGroupedByGenericAssayTypeLinkMap:(0,w.ri)({})}}},{key:"selectedGenericAssayEntitiesGroupedByGenericAssayTypeFromUrl",get:function(){var e=this;return i().reduce(this.props.store.selectedGenericAssayEntitiesGroupByMolecularProfileId,(function(t,r,n){if(e.props.store.molecularProfileIdToMolecularProfile.result[n]){var o=e.props.store.molecularProfileIdToMolecularProfile.result[n].genericAssayType;t[o]=t[o]?i().union(r,t[o]):r}return t}),{})}},{key:"onlyShowClinicalLegendForAlteredCases",get:function(){return this.showClinicalTrackLegends&&this._onlyShowClinicalLegendForAlteredCases}},{key:"selectedClinicalAttributeIds",get:function(){var e=this.urlWrapper.oncoprintSelectedClinicalTracks.slice();return void 0===this.urlWrapper.query.clinicallist&&(this.props.store.studyIds.result&&this.props.store.studyIds.result.length>1&&e.push(to.OY.StudyOfOrigin),this.props.store.filteredSamples.result&&this.props.store.filteredPatients.result&&this.props.store.filteredSamples.result.length>this.props.store.filteredPatients.result.length&&e.push(to.OY.NumSamplesPerPatient),i().forEach(this.props.store.clinicalAttributes_profiledIn.result,(function(t){e.push(t.clinicalAttributeId)}))),e.reduce((function(e,t){return e.set(t,!0),e}),c.observable.map({},{deep:!1}))}},{key:"molecularProfileIdToAdditionalTracks",get:function(){var e=this,t=this.urlWrapper.query.heatmap_track_groups?this.urlWrapper.query.heatmap_track_groups.split(";").map((function(e){return e.split(",")})):[];this.urlWrapper.query.generic_assay_groups&&t.push.apply(t,mo(this.urlWrapper.query.generic_assay_groups.split(";").map((function(e){return e.split(",")}))));var r,n=t.reduce((function(e,t){return e[t[0]]=t.slice(1),e}),{}),o={};return r=i().isEmpty(this.molecularProfileIdToTrackGroupIndex)?2:Math.max.apply(Math,mo(i().values(this.molecularProfileIdToTrackGroupIndex)))+1,i().forEach(n,(function(t,n){var i=e.props.store.molecularProfileIdToMolecularProfile.result[n];if(i&&t&&t.length){i.molecularProfileId in e.molecularProfileIdToTrackGroupIndex||(e.molecularProfileIdToTrackGroupIndex[i.molecularProfileId]=r,r+=1);var a={trackGroupIndex:e.molecularProfileIdToTrackGroupIndex[i.molecularProfileId],molecularProfile:i,molecularProfileId:i.molecularProfileId,molecularAlterationType:i.molecularAlterationType,entities:{}};t.forEach((function(e){return a.entities[e]=!0})),o[n]=a}})),o}},{key:"urlWrapper",get:function(){return this.props.urlWrapper}},{key:"caseListSortPossible",get:function(){return!(!this.props.store.givenSampleOrder.isComplete||!this.props.store.givenSampleOrder.result.length)}},{key:"distinguishDrivers",get:function(){return this.props.store.driverAnnotationSettings.driversAnnotated}},{key:"heatmapIsDynamicallyQueried",get:function(){var e=this.props.store.molecularProfileIdToMolecularProfile.result;return e.hasOwnProperty(this.selectedHeatmapProfileId)&&e[this.selectedHeatmapProfileId].molecularAlterationType!==p.YK.GENESET_SCORE}},{key:"clinicalTracksUrlParam",get:function(){return mo(this.selectedClinicalAttributeIds.keys()).join(",")}},{key:"oncoprintAnalysisCaseType",get:function(){return"true"===this.urlWrapper.query.show_samples?Tr.zz.SAMPLE:Tr.zz.PATIENT}},{key:"sortOrder",get:function(){return"alphabetical"===this.sortMode.type?this.oncoprintAnalysisCaseType===Tr.zz.SAMPLE?this.alphabeticalSampleOrder:this.alphabeticalPatientOrder:"caseList"===this.sortMode.type?this.oncoprintAnalysisCaseType===Tr.zz.SAMPLE&&this.props.store.givenSampleOrder.isComplete?this.props.store.givenSampleOrder.result.map((function(e){return e.uniqueSampleKey})):this.oncoprintAnalysisCaseType===Tr.zz.PATIENT&&this.props.store.givenSampleOrder.isComplete?i().uniq(this.props.store.givenSampleOrder.result.map((function(e){return e.uniquePatientKey}))):void 0:void 0}},{key:"alphabeticalSampleOrder",get:function(){return this.props.store.filteredSamples.isComplete?i().sortBy(this.props.store.filteredSamples.result,(function(e){return e.sampleId})).map((function(e){return e.uniqueSampleKey})):void 0}},{key:"alphabeticalPatientOrder",get:function(){return this.props.store.filteredPatients.isComplete?i().sortBy(this.props.store.filteredPatients.result,(function(e){return e.patientId})).map((function(e){return e.uniquePatientKey})):void 0}},{key:"geneticTracks",get:function(){return this.oncoprintAnalysisCaseType===Tr.zz.SAMPLE?this.sampleGeneticTracks:this.patientGeneticTracks}},{key:"clinicalTracks",get:function(){return this.oncoprintAnalysisCaseType===Tr.zz.SAMPLE?this.sampleClinicalTracks:this.patientClinicalTracks}},{key:"heatmapTracks",get:function(){return this.oncoprintAnalysisCaseType===Tr.zz.SAMPLE?this.sampleHeatmapTracks:this.patientHeatmapTracks}},{key:"genericAssayHeatmapTracks",get:function(){return this.oncoprintAnalysisCaseType===Tr.zz.SAMPLE?this.samplegGenericAssayHeatmapTracks:this.patientGenericAssayHeatmapTracks}},{key:"genericAssayCategoricalTracks",get:function(){return this.oncoprintAnalysisCaseType===Tr.zz.SAMPLE?this.sampleGenericAssayCategoricalTracks:this.patientGenericAssayCategoricalTracks}},{key:"genesetHeatmapTrackGroupIndex",get:function(){return this.props.store.genesetIds.length>0?1+Math.max.apply(Math,[zn.Z9].concat(mo(this.heatmapTracks.result.map((function(e){return e.trackGroupIndex}))),mo(this.genericAssayHeatmapTracks.result.map((function(e){return e.trackGroupIndex}))),mo(this.genericAssayCategoricalTracks.result.map((function(e){return e.trackGroupIndex}))))):void 0}},{key:"genesetHeatmapTracks",get:function(){return this.oncoprintAnalysisCaseType===Tr.zz.SAMPLE?this.sampleGenesetHeatmapTracks:this.patientGenesetHeatmapTracks}},{key:"clusteredHeatmapTrackGroupIndex",get:function(){if("heatmap"===this.sortMode.type){var e=this.sortMode.clusteredHeatmapProfile;if(e===(this.props.store.genesetMolecularProfile.result&&this.props.store.genesetMolecularProfile.result.value&&this.props.store.genesetMolecularProfile.result.value.molecularProfileId))return this.genesetHeatmapTrackGroupIndex;var t=this.molecularProfileIdToAdditionalTracks[e];return t&&t.trackGroupIndex}}},{key:"oncoprintLibrarySortConfig",get:function(){return{sortByMutationType:this.sortByMutationType,sortByDrivers:this.sortByDrivers,order:this.sortOrder,clusterHeatmapTrackGroupIndex:this.clusteredHeatmapTrackGroupIndex}}},{key:"isLoading",get:function(){return"pending"===(0,ie.CX)(this.clinicalTracks,this.geneticTracks,this.genesetHeatmapTracks,this.genericAssayCategoricalTracks,this.genericAssayHeatmapTracks,this.heatmapTracks,this.props.store.molecularProfileIdToMolecularProfile,this.alterationTypesInQuery,this.alteredKeys,this.additionalTrackGroupHeaders)}},{key:"isHidden",get:function(){return this.isLoading||!this.renderingComplete}},{key:"loadingIndicatorHeight",get:function(){return 300}},{key:"loadingIndicatorMessage",get:function(){return this.isLoading?"Downloading Oncoprint data...":this.renderingComplete?"":"Data downloaded. Rendering Oncoprint.."}},{key:"width",get:function(){return C.Z.size.width-75}}])&&ho(r.prototype,o),a&&ho(r,a),t}(n.Component);Eo([c.computed],To.prototype,"columnMode",null),Eo([c.computed],To.prototype,"sortMode",null),Eo([c.computed],To.prototype,"sortByMutationType",null),Eo([c.computed],To.prototype,"sortByDrivers",null),Eo([c.computed],To.prototype,"genericAssayPromises",null),Eo([c.computed],To.prototype,"selectedGenericAssayEntitiesGroupedByGenericAssayTypeFromUrl",null),Eo([c.observable],To.prototype,"distinguishGermlineMutations",void 0),Eo([c.observable],To.prototype,"distinguishMutationType",void 0),Eo([c.observable],To.prototype,"showUnalteredColumns",void 0),Eo([c.observable],To.prototype,"showWhitespaceBetweenColumns",void 0),Eo([c.observable],To.prototype,"showClinicalTrackLegends",void 0),Eo([c.observable],To.prototype,"_onlyShowClinicalLegendForAlteredCases",void 0),Eo([c.observable],To.prototype,"showOqlInLabels",void 0),Eo([c.computed],To.prototype,"onlyShowClinicalLegendForAlteredCases",null),Eo([c.observable],To.prototype,"showMinimap",void 0),Eo([c.observable],To.prototype,"selectedHeatmapProfileId",void 0),Eo([c.observable],To.prototype,"heatmapGeneInputValue",void 0),Eo([c.observable],To.prototype,"selectedGenericAssayProfileId",void 0),Eo([c.observable],To.prototype,"horzZoom",void 0),Eo([c.observable],To.prototype,"mouseInsideBounds",void 0),Eo([c.observable],To.prototype,"renderingComplete",void 0),Eo([c.computed],To.prototype,"selectedClinicalAttributeIds",null),Eo([c.computed],To.prototype,"molecularProfileIdToAdditionalTracks",null),Eo([c.observable.ref],To.prototype,"oncoprint",void 0),Eo([c.computed],To.prototype,"caseListSortPossible",null),Eo([c.computed],To.prototype,"distinguishDrivers",null),Eo([c.computed],To.prototype,"heatmapIsDynamicallyQueried",null),Eo([c.action],To.prototype,"sortByData",null),Eo([c.computed],To.prototype,"clinicalTracksUrlParam",null),Eo([c.action],To.prototype,"onMinimapClose",null),Eo([c.action],To.prototype,"onSuppressRendering",null),Eo([c.action],To.prototype,"onReleaseRendering",null),Eo([c.action],To.prototype,"onChangeSelectedClinicalTracks",null),Eo([c.action.bound],To.prototype,"clearSortDirectionsAndSortByData",null),Eo([c.computed],To.prototype,"sortOrder",null),Eo([c.computed],To.prototype,"alphabeticalSampleOrder",null),Eo([c.computed],To.prototype,"alphabeticalPatientOrder",null),Eo([c.computed],To.prototype,"geneticTracks",null),Eo([c.computed],To.prototype,"clinicalTracks",null),Eo([c.computed],To.prototype,"heatmapTracks",null),Eo([c.computed],To.prototype,"genericAssayHeatmapTracks",null),Eo([c.computed],To.prototype,"genericAssayCategoricalTracks",null),Eo([c.computed],To.prototype,"genesetHeatmapTrackGroupIndex",null),Eo([c.computed],To.prototype,"genesetHeatmapTracks",null),Eo([c.computed],To.prototype,"clusteredHeatmapTrackGroupIndex",null),Eo([c.computed],To.prototype,"oncoprintLibrarySortConfig",null),Eo([c.action.bound],To.prototype,"clusterHeatmapByIndex",null),Eo([c.action.bound],To.prototype,"removeAdditionalTrackSection",null),Eo([c.action.bound],To.prototype,"removeGenericAssayTracksByMolecularProfileId",null),Eo([c.action.bound],To.prototype,"removeHeatmapTracksByMolecularProfileId",null),Eo([c.computed],To.prototype,"isLoading",null),Eo([c.computed],To.prototype,"isHidden",null),Eo([c.computed],To.prototype,"loadingIndicatorMessage",null),Eo([S.default],To.prototype,"getControls",null),Eo([S.default],To.prototype,"getProgressItems",null),Eo([c.computed],To.prototype,"width",null);const Po=To=Eo([u.observer],To);var Oo=r(39013),ko=r(69539),Ao=r.n(ko),Io=r(99549),_o=r(90848);function Do(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function xo(e){return(xo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Mo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function No(e,t){return(No=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Lo(e){return(Lo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Ro=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":Lo(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},jo=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{s(n.next(e))}catch(e){i(e)}}function l(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,l)}s((n=n.apply(e,t||[])).next())}))},Go=(0,w.hZ)(),Vo=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==Lo(t)&&"function"!=typeof t?Mo(e):t}(this,xo(t).call(this,e)),Object.defineProperty(Mo(r),"showBookmarkDialog",{enumerable:!0,configurable:!0,writable:!0,value:!1}),(0,c.makeObservable)(Mo(r)),r}var r,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&No(e,t)}(t,e),r=t,(o=[{key:"getUrls",value:function(){return jo(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Go.location.href,e.next=3,(0,_o.k)(t,this.props.bitlyAccessToken);case 3:return r=e.sent,e.abrupt("return",{bitlyUrl:r,fullUrl:t,sessionUrl:t});case 5:case"end":return e.stop()}}),e,this)})))}},{key:"toggleBookmarkDialog",value:function(){this.showBookmarkDialog=!this.showBookmarkDialog}},{key:"render",value:function(){return n.createElement("div",{className:Ao().shareModule},n.createElement(w.ZD,{placement:"topLeft",overlay:n.createElement("div",null,"Get bookmark link")},n.createElement("a",{onClick:this.toggleBookmarkDialog},n.createElement("span",{className:"fa-stack fa-4x"},n.createElement("i",{className:"fa fa-circle fa-stack-2x"}),n.createElement("i",{className:"fa fa-link fa-stack-1x"})))),this.showBookmarkDialog&&n.createElement(Io.S,{onHide:this.toggleBookmarkDialog,urlPromise:this.getUrls(),title:"Bookmark Query"}))}}])&&Do(r.prototype,o),i&&Do(r,i),t}(n.Component);Ro([c.observable],Vo.prototype,"showBookmarkDialog",void 0),Ro([c.action.bound],Vo.prototype,"toggleBookmarkDialog",null),Vo=Ro([u.observer],Vo);var Fo=r(35770),Bo=r(58997),qo=r(39887),Uo=r(85537),Ho=r(83224),Wo=r(43643),Yo=r(21382),Ko=r(6175),Qo=r.n(Ko);function Xo(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Zo(e){return(Zo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $o(e,t){return($o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Jo(e){return(Jo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ei,ti=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":Jo(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};!function(e){e.hidePutativePassengers="0",e.showGermlineMutations="1",e.hideUnprofiledSamples="1.1",e.hideAnyUnprofiledSamples="1.2",e.hideTotallyUnprofiledSamples="1.3",e.dataTypeSample="2",e.dataTypePatient="3"}(ei||(ei={}));var ri=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==Jo(t)&&"function"!=typeof t?zo(e):t}(this,Zo(t).call(this,e)),Object.defineProperty(zo(r),"driverSettingsState",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(zo(r),"driverSettingsHandlers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),(0,c.makeObservable)(zo(r),{driverSettingsState:c.observable,driverSettingsHandlers:c.observable}),r.driverSettingsState=(0,Ho.Pj)(e.store.driverAnnotationSettings,e.store.customDriverAnnotationReport.result,e.store.didOncoKbFailInOncoprint,e.store.didHotspotFailInOncoprint),r.driverSettingsHandlers=(0,Ho.Zl)(e.store.driverAnnotationSettings,r.driverSettingsState),r}var r,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$o(e,t)}(t,e),r=t,(o=[{key:"onInputClick",value:function(e){switch(e.target.value){case ei.hidePutativePassengers:this.props.store.driverAnnotationSettings.includeVUS=!this.props.store.driverAnnotationSettings.includeVUS;break;case ei.hideUnprofiledSamples:this.props.store.hideUnprofiledSamples?this.props.store.hideUnprofiledSamples=!1:this.props.store.hideUnprofiledSamples="any";break;case ei.hideAnyUnprofiledSamples:this.props.store.hideUnprofiledSamples="any";break;case ei.hideTotallyUnprofiledSamples:this.props.store.hideUnprofiledSamples="totally";break;case ei.showGermlineMutations:this.props.store.includeGermlineMutations=!this.props.store.includeGermlineMutations}}},{key:"render",value:function(){return this.props.disabled?n.createElement("div",{"data-test":"GlobalSettingsButtonHint"},n.createElement("div",null,"Filtering based on annotations is not available for this study."),n.createElement("div",null,"Load custom driver annotations for the selected study to enable filtering.")):n.createElement("div",{"data-test":"GlobalSettingsDropdown",className:b()("cbioportal-frontend",Qo().globalSettingsDropdown),style:{padding:5}},n.createElement("h5",{style:{marginTop:"auto",marginBottom:"auto"}},"Annotate Data"),n.createElement(Yo.Z,{divStyle:{display:"inline-block",marginLeft:6},style:{color:"rgb(54, 134, 194)"},tooltip:n.createElement("span",null,"Putative driver vs VUS setings apply to every tab except"," ",n.createElement(hn.CT,{words:["Co-expression","CN Segments"]}))}),n.createElement("div",{style:{marginLeft:10}},n.createElement(Wo.Z,{state:this.driverSettingsState,handlers:this.driverSettingsHandlers,resultsView:this.props.resultsView})),n.createElement("hr",null),n.createElement("h5",{style:{marginTop:"auto",marginBottom:"auto"}},"Filter Data"),n.createElement("div",{style:{marginLeft:10}},n.createElement("div",{className:"checkbox"},n.createElement("label",null,n.createElement("input",{"data-test":"HideVUS",type:"checkbox",value:ei.hidePutativePassengers,checked:!this.props.store.driverAnnotationSettings.includeVUS,onClick:this.onInputClick,disabled:!this.driverSettingsState.distinguishDrivers})," ","Exclude alterations (mutations, structural variants and copy number) of unknown significance")),n.createElement("div",{className:"checkbox"},n.createElement("label",null,n.createElement("input",{"data-test":"HideGermline",type:"checkbox",value:ei.showGermlineMutations,checked:!this.props.store.includeGermlineMutations,onClick:this.onInputClick})," ","Exclude germline mutations")),this.props.resultsView&&n.createElement("div",null,n.createElement("div",{className:"checkbox"},n.createElement("label",null,n.createElement("input",{"data-test":"HideUnprofiled",type:"checkbox",value:ei.hideUnprofiledSamples,checked:!1!==this.props.store.hideUnprofiledSamples,onClick:this.onInputClick})," ","Exclude unprofiled samples")),n.createElement("div",{style:{marginLeft:10}},n.createElement("div",{className:"radio"},n.createElement("label",null,n.createElement("input",{type:"radio",checked:"any"===this.props.store.hideUnprofiledSamples,value:ei.hideAnyUnprofiledSamples,onClick:this.onInputClick}),"Exclude samples that are unprofiled in any queried gene or profile"),n.createElement("label",null,n.createElement("input",{type:"radio",checked:"totally"===this.props.store.hideUnprofiledSamples,value:ei.hideTotallyUnprofiledSamples,onClick:this.onInputClick}),"Exclude samples that are unprofiled in every queried gene and profile."))))))}}])&&Xo(r.prototype,o),i&&Xo(r,i),t}(n.Component);ti([S.default],ri.prototype,"onInputClick",null);const ni=ri=ti([u.observer],ri);function oi(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ii(e){return(ii=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ai(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function li(e,t){return(li=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function si(e){return(si="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ui=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":si(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},ci=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==si(t)&&"function"!=typeof t?ai(e):t}(this,ii(t).call(this,e)),Object.defineProperty(ai(r),"visible",{enumerable:!0,configurable:!0,writable:!0,value:!1}),(0,c.makeObservable)(ai(r)),r}var r,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&li(e,t)}(t,e),r=t,(o=[{key:"setVisibilityState",value:function(e){void 0!==e&&(void 0!==this.props.store.isSettingsMenuVisible?this.props.store.isSettingsMenuVisible=!!e:this.visible=!!e)}},{key:"render",value:function(){var e=this;return n.createElement(w.ZD,{trigger:[this.trigger],placement:"bottomRight",overlay:this.overlay,visible:this.visibilityState,onVisibleChange:function(t){e.setVisibilityState(t)},onPopupAlign:function(e){return(0,w.pb)(e,"22px")}},n.createElement("button",{"data-test":"GlobalSettingsButton",style:{marginRight:0,marginLeft:5},className:"btn btn-primary"},n.createElement("i",{className:"fa fa-sliders fa-lg"})))}},{key:"visibilityState",get:function(){return void 0!==this.props.store.isSettingsMenuVisible?this.props.store.isSettingsMenuVisible:this.visible}},{key:"overlay",get:function(){return n.createElement(ni,{store:this.props.store,resultsView:this.props.resultsView,disabled:this.props.disabled})}},{key:"trigger",get:function(){return this.props.disabled?"hover":"click"}}])&&oi(r.prototype,o),i&&oi(r,i),t}(n.Component);ui([c.observable],ci.prototype,"visible",void 0),ui([c.computed],ci.prototype,"visibilityState",null),ui([c.action],ci.prototype,"setVisibilityState",null),ui([c.computed],ci.prototype,"overlay",null),ui([c.computed],ci.prototype,"trigger",null);const pi=ci=ui([u.observer],ci);var di=r(77906);function fi(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function mi(e){return(mi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function hi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yi(e,t){return(yi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bi(e){return(bi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var gi=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":bi(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},vi=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==bi(t)&&"function"!=typeof t?hi(e):t}(this,mi(t).call(this,e)),Object.defineProperty(hi(r),"singleStudyUI",{enumerable:!0,configurable:!0,writable:!0,value:(0,Fo.F)({await:function(){return[r.props.store.queriedStudies,r.props.store.sampleLists,r.props.store.filteredSamples,r.props.store.filteredPatients]},render:function(){var e=r.props.store.sampleLists.result.length>0?n.createElement("span",null,r.props.store.sampleLists.result[0].name):n.createElement("span",null,"User-defined Patient List");return n.createElement("div",null,n.createElement("h3",null,n.createElement("a",{href:(0,se.gN)("study",{id:r.props.store.queriedStudies.result.map((function(e){return e.studyId})).join(",")}),target:"_blank"},r.props.store.queriedStudies.result[0].name)),e,"Â (",r.studyPageFilteredCasesLink,") Â -Â ",(0,zt.sC)(r.props.store.hugoGeneSymbols),"Â ",n.createElement(w.ZD,{overlay:"Edit genes or OQL"},n.createElement("a",{"data-test":"oqlQuickEditButton",onClick:r.props.onToggleOQLEditUIVisibility},n.createElement("i",{className:"fa fa-pencil"}))))}})}),Object.defineProperty(hi(r),"multipleStudyUI",{enumerable:!0,configurable:!0,writable:!0,value:(0,Fo.F)({await:function(){return[r.props.store.filteredSamples,r.props.store.filteredPatients,r.props.store.queriedStudies,r.props.store.sampleLists]},render:function(){return n.createElement("div",null,n.createElement("h3",null,n.createElement("a",{href:(0,se.gN)("study",{id:r.props.store.queriedStudies.result.map((function(e){return e.studyId})).join(",")}),target:"_blank"},"Combined Study (",i().sumBy(r.props.store.queriedStudies.result,(function(e){return e.allSampleCount}))," ","samples)"),r.props.store.isMixedReferenceGenome&&(0,Uo.gM)()),n.createElement("span",null,"Querying ",r.studyPageFilteredCasesLink," in"," ",r.props.store.queriedStudies.result.length," ","studiesÂ ",n.createElement(w.ZD,{placement:"bottom",overlay:r.studyList,destroyTooltipOnHide:!0},n.createElement("i",{className:"fa fa-info-circle"})),"Â ",(0,zt.sC)(r.props.store.hugoGeneSymbols),"Â ",n.createElement(w.ZD,{overlay:"Edit genes or OQL"},n.createElement("a",{"data-test":"oqlQuickEditButton",onClick:r.props.onToggleOQLEditUIVisibility},n.createElement("i",{className:"fa fa-pencil"})))))}})}),Object.defineProperty(hi(r),"cohortAndGeneSummary",{enumerable:!0,configurable:!0,writable:!0,value:(0,Fo.F)({await:function(){return[r.singleStudyUI,r.multipleStudyUI,r.props.store.queriedStudies]},render:function(){return 1===r.props.store.queriedStudies.result.length?r.singleStudyUI.component:r.multipleStudyUI.component}})}),Object.defineProperty(hi(r),"alterationSummary",{enumerable:!0,configurable:!0,writable:!0,value:(0,Fo.F)({await:function(){return[r.props.store.filteredSamples,r.props.store.filteredPatients,r.props.store.filteredAlteredSampleKeys,r.props.store.filteredAlteredPatientKeys]},render:function(){return(0,zt.Rs)(r.props.store.filteredSamples.result.length,r.props.store.filteredPatients.result.length,r.props.store.filteredAlteredSampleKeys.result.length,r.props.store.filteredAlteredPatientKeys.result.length,r.props.store.hugoGeneSymbols.length)}})}),(0,c.makeObservable)(hi(r)),r}var r,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yi(e,t)}(t,e),r=t,(o=[{key:"toggleQueryFormVisibility",value:function(){this.props.onToggleQueryFormVisibility(this.props.store.queryFormVisible),this.props.store.modifyQueryParams&&!0===this.props.store.queryFormVisible&&(this.props.store.modifyQueryParams=void 0),this.props.store.queryFormVisible=!this.props.store.queryFormVisible}},{key:"closeQueryForm",value:function(){!0===this.props.store.queryFormVisible&&(this.toggleQueryFormVisibility(),di(document).scrollTop(0))}},{key:"onSubmit",value:function(){this.closeQueryForm(),(0,Bo.cc)()("send","event","resultsView","query modified")}},{key:"render",value:function(){if(this.cohortAndGeneSummary.isError||this.alterationSummary.isError)return this.isQueryOrGeneInvalid?this.queryForm:null;var e=this.cohortAndGeneSummary.isComplete&&this.alterationSummary.isComplete;return n.createElement("div",null,n.createElement("div",{className:"query-summary"},n.createElement("div",{className:"query-summary__leftItems"},!this.isQueryOrGeneInvalid&&n.createElement("div",{style:{display:"flex"}},n.createElement("button",{id:"modifyQueryBtn",onClick:this.toggleQueryFormVisibility,className:b()("btn btn-primary",{disabled:!e})},this.queryFormVisible?"Cancel Modify Query":"Modify Query"),n.createElement(pi,{store:this.props.store,resultsView:!0})),n.createElement(ee.Z,{isLoading:!e,small:!0}),e&&this.cohortAndGeneSummary.component),n.createElement("div",{className:"query-summary__rightItems"},n.createElement("div",{className:"query-summary__alterationData"},e&&n.createElement("strong",null,this.alterationSummary.component)),n.createElement(Vo,{sessionEnabled:cr.v4.sessionServiceIsEnabled(),bitlyAccessToken:(0,cr.Ib)().bitly_access_token,urlWrapper:this.props.store.urlWrapper}))),this.queryFormVisible&&this.queryForm)}},{key:"queryFormVisible",get:function(){return this.props.store.queryFormVisible||this.isQueryOrGeneInvalid}},{key:"studyPageFilteredCasesLink",get:function(){var e=this;return n.createElement("a",{onClick:function(){(0,zt.Bu)(e.props.store.queriedStudies.result,e.props.store.filteredSamples.result,e.props.store.filteredSamples.result.length<e.props.store.samples.result.length,e.props.store.queriedVirtualStudies.result.length>0,e.props.store.sampleLists.result)}},(0,zt.Fq)(this.props.store.filteredSamples.result,this.props.store.filteredPatients.result))}},{key:"studyList",get:function(){return n.createElement("div",{className:"cbioportal-frontend"},n.createElement("ul",{className:"list-unstyled",style:{marginBottom:0}},this.props.store.queriedStudies.result.map((function(e){return n.createElement("li",null,n.createElement(Fr._,{studyId:e.studyId},e.name))}))))}},{key:"queryForm",get:function(){var e=this;return n.createElement("div",{style:{margin:"10px -20px 0 -20px"}},n.createElement(Oo.Z,{onSubmit:this.onSubmit,forkedMode:!1,showQuickSearchTab:!1,showDownloadTab:!1,showAlerts:!0,modifyQueryParams:this.props.store.modifyQueryParams,getQueryStore:function(){return(0,qo.S)(e.props.store.urlWrapper.query,e.props.store.urlWrapper,!1)}}))}},{key:"isQueryOrGeneInvalid",get:function(){return this.props.store.genesInvalid||this.props.store.queryExceedsLimit}}])&&fi(r.prototype,o),a&&fi(r,a),t}(n.Component);gi([c.action.bound],vi.prototype,"toggleQueryFormVisibility",null),gi([c.computed],vi.prototype,"queryFormVisible",null),gi([c.computed],vi.prototype,"studyPageFilteredCasesLink",null),gi([c.action.bound],vi.prototype,"closeQueryForm",null),gi([S.default],vi.prototype,"onSubmit",null),gi([c.computed],vi.prototype,"queryForm",null),gi([c.computed],vi.prototype,"isQueryOrGeneInvalid",null);const Si=vi=gi([u.observer],vi);var Ei=r(28913),Ci=r(14069),wi=r(92977),Ti=r(42352);function Pi(e){return e>0?"rgb(41, 87, 41)":"rgb(180, 4, 4)"}function Oi(e){return[Math.abs(e),e>0?1:0]}var ki=r(12004),Ai=r(30244),Ii=r(64318),_i=r(3563);function Di(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xi(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Mi(e,t){return!t||"object"!==ji(t)&&"function"!=typeof t?Li(e):t}function Ni(e){return(Ni=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Li(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ri(e,t){return(Ri=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ji(e){return(ji="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Gi=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":ji(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},Vi="q-Value",Fi=[{name:"Correlated Gene",render:function(e){return n.createElement("span",{style:{fontWeight:"bold"}},e.geneticEntityName)},filter:function(e,t,r){return e.geneticEntityName.indexOf(r)>-1},download:function(e){return e.geneticEntityName},sortBy:function(e){return e.geneticEntityName},width:"30%"},{name:"Cytoband",render:function(e){return n.createElement("span",null,e.cytoband)},filter:Ii.x,download:function(e){return e.cytoband},sortBy:function(e){return e.cytoband},width:"30%"},Bi("Spearman's Correlation","spearmansCorrelation",!0,!1),Object.assign(Bi("p-Value","pValue",!1,!1),{tooltip:n.createElement("span",null,"Derived from 2-sided t-test.")}),Object.assign(Bi(Vi,"qValue",!1,!0),{sortBy:function(e){return[e.qValue,e.pValue]},tooltip:n.createElement("span",null,"Derived from Benjamini-Hochberg FDR correction procedure.")})];function Bi(e,t,r,o){return{name:e,render:function(e){return n.createElement("span",{style:{color:r?Pi(e[t]):"#000000",textAlign:"right",float:"right",whiteSpace:"nowrap"}},o?(0,ce.It)(e[t]):(0,_i.C)(e[t],3,.01))},download:function(e){return e[t].toString()+""},sortBy:function(e){return Oi(e[t])},align:"right"}}var qi=function(e){function t(){var e;return Di(this,t),e=Mi(this,Ni(t).apply(this,arguments)),Object.defineProperty(Li(e),"tableModeOptions",{enumerable:!0,configurable:!0,writable:!0,value:[{label:"Show Any Correlation",value:Ka.SHOW_ALL},{label:"Show Only Positively Correlated",value:Ka.SHOW_POSITIVE},{label:"Show Only Negatively Correlated",value:Ka.SHOW_NEGATIVE}]}),Object.defineProperty(Li(e),"paginationProps",{enumerable:!0,configurable:!0,writable:!0,value:{itemsPerPageOptions:[25]}}),e}var r,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ri(e,t)}(t,e),r=t,(o=[{key:"onRowClick",value:function(e){this.props.dataStore.setHighlighted(e)}},{key:"onSelectTableMode",value:function(e){this.props.onSelectTableMode(e.value)}},{key:"render",value:function(){return n.createElement("div",null,n.createElement("div",{style:{float:"left",display:"flex",flexDirection:"row"}},n.createElement("div",{style:{width:180}},n.createElement(wi.default,{value:this.props.tableMode,onChange:this.onSelectTableMode,options:this.tableModeOptions,searchable:!1,clearable:!1,className:"coexpression-select-table-mode"})),n.createElement(Yo.Z,{style:{marginLeft:21,marginTop:"0.7em"},tooltip:n.createElement("div",{style:{maxWidth:200}},ki.f7),tooltipPlacement:"left"})),n.createElement(kr.ZP,{initialSortColumn:Vi,initialSortDirection:"asc",columns:Fi,showColumnVisibility:!1,dataStore:this.props.dataStore,onRowClick:this.onRowClick,filterPlaceholder:"Enter gene or cytoband..",paginationProps:this.paginationProps,initialItemsPerPage:25,copyDownloadProps:{showCopy:!1}}))}}])&&xi(r.prototype,o),i&&xi(r,i),t}(n.Component);Gi([Ai.ak],qi.prototype,"onRowClick",null),Gi([Ai.ak],qi.prototype,"onSelectTableMode",null);const Ui=qi=Gi([u.observer],qi);function Hi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Wi(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Yi(e,t){return!t||"object"!==Zi(t)&&"function"!=typeof t?Qi(e):t}function Ki(e){return(Ki=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xi(e,t){return(Xi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Zi(e){return(Zi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var zi=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":Zi(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},$i="q-Value",Ji=[{name:"Correlated Gene Set",render:function(e){return n.createElement("span",{style:{fontWeight:"bold"}},e.geneticEntityName.length>28?e.geneticEntityName.substring(0,25)+"...":e.geneticEntityName)},filter:function(e,t,r){return e.geneticEntityName.indexOf(r)>-1},download:function(e){return e.geneticEntityName},sortBy:function(e){return e.geneticEntityName},width:"60%"},ea("Spearman's Correlation","spearmansCorrelation",!0,!1),ea("p-Value","pValue",!1,!1),Object.assign(ea($i,"qValue",!1,!0),{sortBy:function(e){return[e.qValue,e.pValue]}})];function ea(e,t,r,o){return{name:e,render:function(e){return n.createElement("span",{style:{color:r?Pi(e[t]):"#000000",textAlign:"right",float:"right",whiteSpace:"nowrap"}},o?(0,ce.It)(e[t]):(0,_i.C)(e[t],3,.01))},download:function(e){return e[t].toString()+""},sortBy:function(e){return Oi(e[t])},align:"right"}}var ta=function(e){function t(){var e;return Hi(this,t),e=Yi(this,Ki(t).apply(this,arguments)),Object.defineProperty(Qi(e),"tableModeOptions",{enumerable:!0,configurable:!0,writable:!0,value:[{label:"Show Any Correlation",value:Ka.SHOW_ALL},{label:"Show Only Positively Correlated",value:Ka.SHOW_POSITIVE},{label:"Show Only Negatively Correlated",value:Ka.SHOW_NEGATIVE}]}),Object.defineProperty(Qi(e),"paginationProps",{enumerable:!0,configurable:!0,writable:!0,value:{itemsPerPageOptions:[25]}}),e}var r,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xi(e,t)}(t,e),r=t,(o=[{key:"onRowClick",value:function(e){this.props.dataStore.setHighlighted(e)}},{key:"onSelectTableMode",value:function(e){this.props.onSelectTableMode(e.value)}},{key:"render",value:function(){return n.createElement("div",null,n.createElement("div",{style:{float:"left",display:"flex",flexDirection:"row"}},n.createElement("div",{style:{width:180}},n.createElement(wi.default,{value:this.props.tableMode,onChange:this.onSelectTableMode,options:this.tableModeOptions,searchable:!1,clearable:!1,className:"coexpression-select-table-mode"})),n.createElement(Yo.Z,{style:{marginLeft:21,marginTop:"0.7em"},tooltip:n.createElement("div",{style:{maxWidth:200}},ki.f7),tooltipPlacement:"left"})),n.createElement(kr.ZP,{initialSortColumn:$i,initialSortDirection:"asc",columns:Ji,showColumnVisibility:!1,dataStore:this.props.dataStore,onRowClick:this.onRowClick,filterPlaceholder:"Enter gene set..",paginationProps:this.paginationProps,initialItemsPerPage:25,copyDownloadProps:{showCopy:!1}}))}}])&&Wi(r.prototype,o),i&&Wi(r,i),t}(n.Component);zi([Ai.ak],ta.prototype,"onRowClick",null),zi([Ai.ak],ta.prototype,"onSelectTableMode",null);const ra=ta=zi([u.observer],ta);var na=r(17502),oa=r(17163),ia=r(21341);function aa(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function la(e,t,r){return"".concat(r,": ").concat(e.geneticEntityName," ").concat(e.cytoband?"(".concat(e.cytoband,") "):"").concat(t?"(".concat(t.label,") "):"")}function sa(e){return!e.profiledX&&!e.profiledY}var ua=r(58839);function ca(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function pa(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function da(e,t){return!t||"object"!==ba(t)&&"function"!=typeof t?fa(e):t}function fa(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ma(e){return(ma=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ha(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ya(e,t)}function ya(e,t){return(ya=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ba(e){return(ba="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ga=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":ba(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},va=function(e){function t(){return pa(this,t),da(this,ma(t).apply(this,arguments))}return ha(t,e),t}(ia.Z),Sa="#0174df",Ea="#58acfa",Ca="#886A08",wa="#DBA901",Ta="#F7819F",Pa="#F5A9F2",Oa="#B40404",ka="#FF0000",Aa="#d3d3d3",Ia="#ffffff";function _a(){}var Da="coexpression-plot-svg",xa=function(e){function t(e){var r;return pa(this,t),r=da(this,ma(t).call(this,e)),(0,c.makeObservable)(fa(r)),r}var r,o,a;return ha(t,e),r=t,(o=[{key:"getSvg",value:function(){return document.getElementById(Da)}},{key:"plot",value:function(){return this.data.length?n.createElement(va,{svgId:Da,title:this.title,data:this.data,size:ua.kl,chartWidth:this.props.width,chartHeight:this.props.height,stroke:this.stroke,fill:this.fill,strokeWidth:1.2,legendData:this.mutationLegendElements,showRegressionLine:this.props.showRegressionLine,logX:this.axisLogScaleFunction,logY:this.axisLogScaleFunction,useLogSpaceTicks:!0,axisLabelX:this.axisLabelX,axisLabelY:this.axisLabelY,tooltip:this.tooltip,fontFamily:"Arial,Helvetica"}):n.createElement("div",{className:"alert alert-info"},"No data to plot.")}},{key:"toolbar",value:function(){return n.createElement("div",{style:{textAlign:"center",position:"relative"}},n.createElement("div",{style:{display:"inline-block"}},this.props.showMutationControls&&n.createElement("div",{className:"checkbox coexpression-plot-toolbar-elt"},n.createElement("label",null,n.createElement("input",{type:"checkbox",checked:this.props.showMutations,onClick:this.props.handlers.onClickShowMutations||_a,"data-test":"ShowMutations"}),"Show Mutations")),this.props.showLogScaleControls&&n.createElement("div",{className:"coexpression-plot-toolbar-elt"},n.createElement("div",{className:"checkbox coexpression-plot-toolbar-elt"},n.createElement("label",null,n.createElement("input",{type:"checkbox",checked:this.props.logScale,onClick:this.props.handlers.onClickLogScale||_a,"data-test":"logScale"}),"Log Scale"))),n.createElement("div",{className:"checkbox coexpression-plot-toolbar-elt"},n.createElement("label",null,n.createElement("input",{type:"checkbox",checked:this.props.showRegressionLine,onClick:this.props.handlers.onClickShowRegressionLine,"data-test":"ShowRegressionLine"}),"Show Regression Line"))),n.createElement(w.t_,{getSvg:this.getSvg,getData:this.getDownloadData,buttons:["SVG","PNG","PDF","Data"],filename:"coexpression",dontFade:!0,type:"button",style:{position:"absolute",top:0,right:0}}))}},{key:"getDownloadData",value:function(){return e=this.props.data,t=this.props.xAxisGeneticEntity,r=this.props.yAxisGeneticEntity,n=this.props.molecularProfileX,o=this.props.molecularProfileY,i=!!this.props.showMutations,a=["Sample ID","".concat(t.geneticEntityName," (").concat(n.name,")"),"".concat(r.geneticEntityName," (").concat(o.name,")")],i&&a.push("".concat(t.geneticEntityName," Mutations"),"".concat(r.geneticEntityName," Mutations")),[a].concat(aa(e.map((function(e){var t=[e.sampleId,e.x,e.y];return i&&t.push(e.profiledX?e.mutationsX||"WT":"NS",e.profiledY?e.mutationsY||"WT":"NS"),t})))).map((function(e){return e.join("\t")})).join("\n");var e,t,r,n,o,i,a}},{key:"tooltip",value:function(e){return n.createElement("div",null,n.createElement("div",null,n.createElement("span",null,"Sample ID: "),n.createElement("a",{href:(0,se.Qk)(e.studyId,e.sampleId)},e.sampleId)),n.createElement("div",null,n.createElement("span",null,this.props.xAxisGeneticEntity.geneticEntityName,":Â ",n.createElement("b",null,e.x.toFixed(2)))),n.createElement("div",null,n.createElement("span",null,this.props.yAxisGeneticEntity.geneticEntityName,":Â ",n.createElement("b",null,e.y.toFixed(2)))),e.mutationsX&&n.createElement("div",null,n.createElement("span",null,this.props.xAxisGeneticEntity.geneticEntityName," ","Mutation:Â ",n.createElement("b",null,e.mutationsX))),e.mutationsY&&n.createElement("div",null,n.createElement("span",null,this.props.yAxisGeneticEntity.geneticEntityName," ","Mutation:Â ",n.createElement("b",null,e.mutationsY))))}},{key:"render",value:function(){return n.createElement("div",{className:"borderedChart inlineBlock","data-test":"CoExpressionPlot"},n.createElement(u.Observer,null,this.toolbar),n.createElement(u.Observer,null,this.plot))}},{key:"stroke",get:function(){return this.props.showMutations?function(e){return sa(e)?Aa:e.mutationsX&&e.mutationsY?Oa:e.mutationsX||e.mutationsY?e.mutationsX?Ca:Ta:Sa}:Sa}},{key:"fill",get:function(){return this.props.showMutations?function(e){return sa(e)?Ia:e.mutationsX&&e.mutationsY?ka:e.mutationsX||e.mutationsY?e.mutationsX?wa:Pa:Ea}:Ea}},{key:"mutationLegendElements",get:function(){if(!this.props.showMutations)return[];var e=!1,t=!1,r=!1,n=!1,o=!1,i=!0,a=!1,l=void 0;try{for(var s,u=this.data[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;sa(c)&&(o=!0),c.mutationsX&&c.mutationsY?e=!0:c.mutationsX||c.mutationsY?c.mutationsX?t=!0:r=!0:n=!0}}catch(e){a=!0,l=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw l}}var p=[];return t&&p.push({name:[this.props.xAxisGeneticEntity.geneticEntityName,"mutated"],symbol:{fill:wa,stroke:Ca}}),r&&p.push({name:[this.props.yAxisGeneticEntity.geneticEntityName,"mutated"],symbol:{fill:Pa,stroke:Ta}}),e&&p.push({name:"Both mutated",symbol:{fill:ka,stroke:Oa}}),n&&p.push({name:"Neither mutated",symbol:{fill:Ea,stroke:Sa}}),o&&p.push({name:"Not profiled for mutations",symbol:{fill:Ia,stroke:Aa}}),p}},{key:"data",get:function(){return i().sortBy(this.props.data,(function(e){return e.mutationsX&&e.mutationsY?3:e.mutationsX||e.mutationsY?2:sa(e)?0:1}))}},{key:"title",get:function(){return"".concat(this.props.xAxisGeneticEntity.geneticEntityName," vs. ").concat(this.props.yAxisGeneticEntity.geneticEntityName)}},{key:"axisLabelX",get:function(){return la({geneticEntityName:this.props.xAxisGeneticEntity.geneticEntityName,cytoband:this.props.xAxisGeneticEntity.cytoband},this.axisLogScaleFunction,this.props.molecularProfileX.name)}},{key:"axisLabelY",get:function(){return la({geneticEntityName:this.props.yAxisGeneticEntity.geneticEntityName},this.axisLogScaleFunction,this.props.molecularProfileY.name)}},{key:"axisLogScaleFunction",get:function(){if(this.props.logScale)return{label:"log2",fLogScale:function(e,t){return Math.log2(Math.max(e,.01))},fInvLogScale:function(e){return Math.pow(2,e)}}}}])&&ca(r.prototype,o),a&&ca(r,a),t}(n.Component);ga([Ai.ak],xa.prototype,"getSvg",null),ga([c.computed],xa.prototype,"stroke",null),ga([c.computed],xa.prototype,"fill",null),ga([c.computed],xa.prototype,"mutationLegendElements",null),ga([c.computed],xa.prototype,"data",null),ga([c.computed],xa.prototype,"axisLabelX",null),ga([c.computed],xa.prototype,"axisLabelY",null),ga([c.computed],xa.prototype,"axisLogScaleFunction",null),ga([Ai.ak],xa.prototype,"plot",null),ga([Ai.ak],xa.prototype,"toolbar",null),ga([S.default],xa.prototype,"getDownloadData",null),ga([Ai.ak],xa.prototype,"tooltip",null);const Ma=xa=ga([u.observer],xa);var Na="Â ";function La(e){return e.map((function(e){return"".concat(e.proteinChange).concat((0,we.cn)(e)?"":" [germline]")})).filter((function(e){return!!e})).join(", ")}function Ra(e,t,r,n,o){var i=o[t];return!!i&&(0,te.vs)(e,i.molecularProfileId,r,n)}var ja=r(55505);function Ga(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Va(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Fa(e,t,r){return t&&Va(e.prototype,t),r&&Va(e,r),e}function Ba(e,t){return!t||"object"!==Ya(t)&&"function"!=typeof t?Ua(e):t}function qa(e){return(qa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ua(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ha(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wa(e,t)}function Wa(e,t){return(Wa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ya(e){return(Ya="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Ka,Qa=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":Ya(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};!function(e){e[e.SHOW_ALL=0]="SHOW_ALL",e[e.SHOW_POSITIVE=1]="SHOW_POSITIVE",e[e.SHOW_NEGATIVE=2]="SHOW_NEGATIVE"}(Ka||(Ka={}));var Xa=function(e){function t(e,r,n){var o;return Ga(this,t),o=Ba(this,qa(t).call(this,e)),Object.defineProperty(Ua(o),"setHighlighted",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(Ua(o),"tableMode",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Ua(o),"reactionDisposer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),(0,c.makeObservable)(Ua(o)),o.tableMode=Ka.SHOW_ALL,o.dataHighlighter=function(e){var t=r();return!(!t||e.geneticEntityId!==t.geneticEntityId)},o.dataSelector=function(e){var t;switch(o.tableMode){case Ka.SHOW_POSITIVE:t=e.spearmansCorrelation>=0;break;case Ka.SHOW_NEGATIVE:t=e.spearmansCorrelation<=0;break;default:t=!0}return t},o.reactionDisposer=(0,c.autorun)((function(){o.sortMetric&&o.sortedFilteredData.length>0&&!r()&&o.setHighlighted(o.sortedFilteredData[0])})),o}return Ha(t,e),Fa(t,[{key:"destroy",value:function(){this.reactionDisposer()}}]),t}(na.Lq);Qa([c.observable],Xa.prototype,"tableMode",void 0);var Za=function(e){function t(e){var r;return Ga(this,t),r=Ba(this,qa(t).call(this,e)),Object.defineProperty(Ua(r),"highlightedCoExpression",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Ua(r),"allDataRequested",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(Ua(r),"lastCoExpressionData",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Ua(r),"coExpressionsWithQValues",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[r.coExpressionDataPromise]},invoke:function(){var e=r.coExpressionDataPromise.result,t=i().sortBy(e,(function(e){return e.pValue}));return(0,ja.f)(t.map((function(e){return e.pValue}))).forEach((function(e,r){t[r].qValue=e})),Promise.resolve(t)}})}),Object.defineProperty(Ua(r),"dataStore",{enumerable:!0,configurable:!0,writable:!0,value:new Xa((function(){return r.props.hidden?r.lastCoExpressionData||[]:r.coExpressionsWithQValues.isComplete?(r.lastCoExpressionData=r.coExpressionsWithQValues.result,r.coExpressionsWithQValues.result):[]}),(function(){return r.highlightedCoExpression}),(function(e){r.highlightedCoExpression=e}))}),Object.defineProperty(Ua(r),"plotData",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){if(r.props.hidden)return[];var e=r.getPlotDataPromises(r.highlightedCoExpression),t=[r.props.coverageInformation,r.props.studyToMutationMolecularProfile,e.molecularX];return e.mutationX&&t.push(e.mutationX),e.molecularY&&t.push(e.molecularY),e.mutationY&&t.push(e.mutationY),t},invoke:function(){if(r.props.hidden)return Promise.resolve([]);if(!r.highlightedCoExpression)return Promise.resolve([]);var e=r.getPlotDataPromises(r.highlightedCoExpression),t=[];e.molecularX&&e.molecularX.isComplete&&(t=t.concat(e.molecularX.result)),e.molecularY&&e.molecularY.isComplete&&(t=t.concat(e.molecularY.result));var n=[];return e.mutationX&&e.mutationX.isComplete&&(n=n.concat(e.mutationX.result)),e.mutationY&&e.mutationY.isComplete&&(n=n.concat(e.mutationY.result)),Promise.resolve(function(e,t,r,n,o,i,a,l){var s={},u={},c={},p={},d={},f=function(e){d[e.uniqueSampleKey]||(d[e.uniqueSampleKey]=e)};if("number"==typeof r){var m=!0,h=!1,y=void 0;try{for(var b,g=t[Symbol.iterator]();!(m=(b=g.next()).done);m=!0){var v=b.value;if(v.proteinChange){var S=v.entrezGeneId===r?c:p;S[v.uniqueSampleKey]=S[v.uniqueSampleKey]||[],S[v.uniqueSampleKey].push(v),f(v)}}}catch(e){h=!0,y=e}finally{try{m||null==g.return||g.return()}finally{if(h)throw y}}}if(e[0]&&void 0!==e[0].entrezGeneId){var E=!0,C=!1,w=void 0;try{for(var T,P=e[Symbol.iterator]();!(E=(T=P.next()).done);E=!0){var O=T.value;(O.entrezGeneId===r?s:u)[O.uniqueSampleKey]=O,f(O)}}catch(e){C=!0,w=e}finally{try{E||null==P.return||P.return()}finally{if(C)throw w}}}else{var k=!0,A=!1,I=void 0;try{for(var _,D=e[Symbol.iterator]();!(k=(_=D.next()).done);k=!0){var x=_.value;(x.genesetId===r.toString()?s:u)[x.uniqueSampleKey]=x,f(x)}}catch(e){A=!0,I=e}finally{try{k||null==D.return||D.return()}finally{if(A)throw I}}}for(var M=[],N=0,L=Object.keys(s);N<L.length;N++){var R=L[N],j=d[R].studyId,G=s[R],V=u[R];if(G&&V){var F=Number(G.value),B=Number(V.value);isNaN(F)||isNaN(B)||M.push({x:F,y:B,mutationsX:La(c[R]||[]),mutationsY:La(p[R]||[]),profiledX:"number"==typeof r&&Ra(R,j,o,a,l),profiledY:"number"==typeof n&&Ra(R,j,i,a,l),studyId:j,sampleId:d[R].sampleId})}}return M}(t,n,r.props.geneticEntity.geneticEntityId,isNaN(Number(r.highlightedCoExpression.geneticEntityId))?r.highlightedCoExpression.geneticEntityId:Number(r.highlightedCoExpression.geneticEntityId),r.props.geneticEntity.geneticEntityName,r.highlightedCoExpression.geneticEntityName,r.props.coverageInformation.result,r.props.studyToMutationMolecularProfile.result))}})}),(0,c.makeObservable)(Ua(r)),r}return Ha(t,e),Fa(t,[{key:"onSelectTableMode",value:function(e){this.dataStore.tableMode=e}},{key:"requestAllData",value:function(){this.allDataRequested=!0}},{key:"getPlotDataPromises",value:function(e){var t={molecularX:this.props.profileX.molecularAlterationType===p.YK.GENESET_SCORE?this.props.numericGenesetMolecularDataCache.get({genesetId:this.props.geneticEntity.geneticEntityId.toString(),molecularProfileId:this.props.profileX.molecularProfileId}):this.props.numericGeneMolecularDataCache.get({entrezGeneId:parseInt(String(this.props.geneticEntity.geneticEntityId),10),molecularProfileId:this.props.profileX.molecularProfileId}),mutationX:void 0,molecularY:void 0,mutationY:void 0};return e&&(t.molecularY=this.props.profileY.molecularAlterationType===p.YK.GENESET_SCORE?this.props.numericGenesetMolecularDataCache.get({genesetId:e.geneticEntityId,molecularProfileId:this.props.profileY.molecularProfileId}):this.props.numericGeneMolecularDataCache.get({entrezGeneId:parseInt(e.geneticEntityId,10),molecularProfileId:this.props.profileY.molecularProfileId})),this.props.mutationCache&&(t.mutationX=this.props.mutationCache.get({entrezGeneId:parseInt(String(this.props.geneticEntity.geneticEntityId),10)}),e&&(t.mutationY=this.props.mutationCache.get({entrezGeneId:parseInt(e.geneticEntityId,10)}))),t}},{key:"table",value:function(){return this.props.profileY.molecularAlterationType!==p.YK.GENESET_SCORE?n.createElement("div",null,n.createElement(Ui,{referenceGeneticEntity:this.props.geneticEntity.geneticEntityData,dataStore:this.dataStore,tableMode:this.dataStore.tableMode,onSelectTableMode:this.onSelectTableMode}),this.requestAllDataButton):n.createElement("div",null,n.createElement(ra,{referenceGeneticEntity:this.props.geneticEntity.geneticEntityData,dataStore:this.dataStore,tableMode:this.dataStore.tableMode,onSelectTableMode:this.onSelectTableMode}),this.requestAllDataButton)}},{key:"plot",value:function(){if(this.props.hidden)return n.createElement("span",null);if(this.plotData.isError)return n.createElement("span",null,"Error fetching data. Please refresh the page and try again.");var e;if(this.highlightedCoExpression){e={geneticEntityName:this.highlightedCoExpression.geneticEntityName,geneticEntityType:this.highlightedCoExpression.geneticEntityType,geneticEntityId:this.highlightedCoExpression.geneticEntityId,cytoband:this.highlightedCoExpression.cytoband,geneticEntityData:{geneticEntityId:0,entrezGeneId:0,hugoGeneSymbol:"",type:""}}}return n.createElement("div",{style:{position:"relative"}},n.createElement(ee.Z,{isLoading:this.dataStore.allData.length>0&&(this.plotData.isPending||!this.highlightedCoExpression),center:!0,size:"big"}),this.plotData.isComplete&&this.highlightedCoExpression&&n.createElement("div",{style:{marginLeft:10}},n.createElement(Ma,{xAxisGeneticEntity:this.props.geneticEntity,yAxisGeneticEntity:e,data:this.plotData.result,showLogScaleControls:this.showLogScaleControls,showMutationControls:this.showMutationControls,showMutations:this.plotShowMutations,showRegressionLine:this.props.plotState.plotShowRegressionLine,logScale:this.plotLogScale,handlers:this.props.plotHandlers,molecularProfileY:this.props.profileY,molecularProfileX:this.props.profileX,height:530,width:530})))}},{key:"componentWillUnmount",value:function(){this.dataStore.destroy()}},{key:"render",value:function(){var e=n.createElement("div",{style:{display:!this.props.hidden&&this.coExpressionsWithQValues.isComplete?"inherit":"none"},"data-test":"CoExpressionGeneTabContent"},n.createElement("div",{className:"clearfix"},this.dataStore.allData.length>0?[n.createElement("div",{style:{width:"40%",float:"left",marginTop:6}},n.createElement(u.Observer,null,this.table)),n.createElement("div",{style:{width:"60%",float:"right",marginTop:6}},n.createElement(u.Observer,null,this.plot))]:n.createElement("div",{style:{position:"absolute",top:200,left:"50%",transform:"translate(-50%, 0)"}},"There is no expression data for"," ",n.createElement("strong",null,this.props.geneticEntity.geneticEntityName)," ","with the selected samples in"," ",n.createElement("strong",null,this.props.profileX.name),".")));return n.createElement("div",{style:{display:this.props.hidden?"none":"inherit",minHeight:826,position:"relative"}},e,n.createElement(ee.Z,{isLoading:!this.props.hidden&&this.coExpressionsWithQValues.isPending,center:!0,size:"big"}))}},{key:"coExpressionDataPromise",get:function(){return this.props.coExpressionCache.get({geneticEntityId:this.props.geneticEntity.geneticEntityId.toString(),geneticEntityType:this.props.geneticEntity.geneticEntityType,profileX:this.props.profileX,profileY:this.props.profileY,allData:this.allDataRequested})}},{key:"plotShowMutations",get:function(){return this.props.plotState.plotShowMutations&&this.showMutationControls}},{key:"plotLogScale",get:function(){return this.props.plotState.plotLogScale&&this.showLogScaleControls}},{key:"showMutationControls",get:function(){return!!this.props.mutationCache}},{key:"showLogScaleControls",get:function(){var e=this.props.profileX.molecularProfileId.toLowerCase(),t=this.props.profileY.molecularProfileId.toLowerCase();return(0,oa.fj)(e)||(0,oa.fj)(t)}},{key:"requestAllDataButton",get:function(){return!this.plotData.isComplete||this.dataStore.allData.length||this.allDataRequested?null:n.createElement("div",null,n.createElement("span",{style:{marginRight:5}},(e=this.props.geneticEntity.geneticEntityName,"There are no genes with a Pearson or Spearman correlation with ".concat(e," of").concat(Na,">").concat(Na,"0.3").concat(Na,"or").concat(Na,"<").concat(Na,"-0.3."))),n.createElement(f.Button,{onClick:this.requestAllData},"Load data for all genes."));var e}}]),t}(n.Component);Qa([c.observable.ref],Za.prototype,"highlightedCoExpression",void 0),Qa([c.observable],Za.prototype,"allDataRequested",void 0),Qa([c.action.bound],Za.prototype,"onSelectTableMode",null),Qa([c.action.bound],Za.prototype,"requestAllData",null),Qa([c.computed],Za.prototype,"plotShowMutations",null),Qa([c.computed],Za.prototype,"plotLogScale",null),Qa([c.computed],Za.prototype,"showMutationControls",null),Qa([c.computed],Za.prototype,"showLogScaleControls",null),Qa([Ai.ak],Za.prototype,"table",null),Qa([Ai.ak],Za.prototype,"plot",null);const za=Za=Qa([u.observer],Za);var $a=r(77791);function Ja(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function el(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tl(e,t){return!t||"object"!==al(t)&&"function"!=typeof t?rl(e):t}function rl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nl(e){return(nl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ol(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&il(e,t)}function il(e,t){return(il=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function al(e){return(al="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ll=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":al(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},sl=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{s(n.next(e))}catch(e){i(e)}}function l(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,l)}s((n=n.apply(e,t||[])).next())}))},ul=function(e){function t(){return el(this,t),tl(this,nl(t).apply(this,arguments))}return ol(t,e),t}($a.Z),cl=function(e){function t(e){var r;return el(this,t),r=tl(this,nl(t).call(this,e)),Object.defineProperty(rl(r),"_selectedProfileX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(rl(r),"_selectedProfileY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(rl(r),"_selectedGeneticEntity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(rl(r),"selectedProfileX",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[r.xProfileOptions]},invoke:function(){return!r._selectedProfileX&&r.xProfileOptions.result.length>0?Promise.resolve(r.xProfileOptions.result[0].value):Promise.resolve(r._selectedProfileX)}})}),Object.defineProperty(rl(r),"selectedProfileY",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[r.yProfileOptions]},invoke:function(){return!r._selectedProfileY&&r.yProfileOptions.result.length>0?Promise.resolve(r.yProfileOptions.result[0].value):Promise.resolve(r._selectedProfileY)}})}),Object.defineProperty(rl(r),"selectedGeneticEntity",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[r.props.store.geneticEntities]},invoke:function(){return r._selectedGeneticEntity?Promise.resolve(r._selectedGeneticEntity):Promise.resolve(r.props.store.geneticEntities.result[0])}})}),Object.defineProperty(rl(r),"isSelectedGeneticEntityAGeneSet",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[r.props.store.geneticEntities]},invoke:function(){if(r._selectedGeneticEntity){var e=!0,t=!1,n=void 0;try{for(var o,i=r.props.store.geneticEntities.result[Symbol.iterator]();!(e=(o=i.next()).done);e=!0){var a=o.value;if(a.geneticEntityType===p.Mz.GENESET&&a.geneticEntityId===r._selectedGeneticEntity.geneticEntityId)return Promise.resolve(!0)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}return Promise.resolve(!1)}})}),Object.defineProperty(rl(r),"plotState",{enumerable:!0,configurable:!0,writable:!0,value:{plotLogScale:!1,plotShowMutations:!0,plotShowRegressionLine:!1}}),Object.defineProperty(rl(r),"plotHandlers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(rl(r),"xProfileOptions",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[r.props.store.coexpressionTabMolecularProfiles,r.isSelectedGeneticEntityAGeneSet,r.props.store.molecularProfileIdToProfiledFilteredSamples]},invoke:function(){var e=[];return e=r.isSelectedGeneticEntityAGeneSet.result?(0,ki.Vv)(r.props.store.coexpressionTabMolecularProfiles.result):(0,ki.aL)(r.props.store.coexpressionTabMolecularProfiles.result),Promise.resolve((0,ki.mY)(e,r.props.store.molecularProfileIdToProfiledFilteredSamples.result))}})}),Object.defineProperty(rl(r),"yProfileOptions",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[r.props.store.coexpressionTabMolecularProfiles,r.props.store.molecularProfileIdToProfiledFilteredSamples]},invoke:function(){return Promise.resolve((0,ki.mY)(r.props.store.coexpressionTabMolecularProfiles.result,r.props.store.molecularProfileIdToProfiledFilteredSamples.result))}})}),Object.defineProperty(rl(r),"coExpressionCache",{enumerable:!0,configurable:!0,writable:!0,value:new ul((function(e){return{await:function(){return[r.props.store.entrezGeneIdToGeneAll,r.props.store.entrezGeneIdToReferenceGene,r.props.store.molecularProfileIdToProfiledFilteredSamples]},invoke:function(){return sl(rl(r),void 0,void 0,regeneratorRuntime.mark((function t(){var r,n,o,a,l,s,u,c,d,f,m,h;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=.3,e.allData&&(r=0),n=this.props.store.molecularProfileIdToProfiledFilteredSamples.result[e.profileX.molecularProfileId],o=this.props.store.molecularProfileIdToProfiledFilteredSamples.result[e.profileY.molecularProfileId],a={},e.profileX.molecularProfileId===e.profileY.molecularProfileId?a=this.props.store.studyToDataQueryFilter.result[e.profileX.studyId]:(l=i().intersectionWith(n,o,(function(e,t){return e.uniqueSampleKey===t.uniqueSampleKey})),a.sampleIds=l.map((function(e){return e.sampleId}))),!i().isEmpty(a.sampleIds)||!i().isEmpty(a.sampleListId)){t.next=8;break}return t.abrupt("return",Promise.resolve([]));case 8:if(null==(s=this.createDataQueryFilterForCoExpression(a,e.geneticEntityId,e.geneticEntityType))){t.next=26;break}return void 0,t.next=13,Ti.Z.fetchCoExpressionsUsingPOST({molecularProfileIdA:e.profileX.molecularProfileId,molecularProfileIdB:e.profileY.molecularProfileId,coExpressionFilter:s,threshold:r,$domain:undefined});case 13:if(u=t.sent,c={},e.profileY.molecularAlterationType!==p.YK.GENESET_SCORE){t.next=21;break}return d=i().chain(u).map((function(e){return e.geneticEntityId})).uniq().value(),t.next=19,Ti.Z.fetchGenesetsUsingPOST({genesetIds:d});case 19:f=t.sent,c=i().keyBy(f,(function(e){return e.genesetId}));case 21:return m=this.props.store.entrezGeneIdToReferenceGene.result||{},h=this.props.store.entrezGeneIdToGeneAll.result||{},t.abrupt("return",Promise.resolve(i().reduce(u,(function(t,r){var n=void 0,o="-";return e.profileY.molecularAlterationType===p.YK.GENESET_SCORE?n=c[r.geneticEntityId].name:void 0!==m[r.geneticEntityId]?(n=m[r.geneticEntityId].hugoGeneSymbol,o=m[r.geneticEntityId].cytoband):void 0!==h[r.geneticEntityId]&&(n=h[r.geneticEntityId].hugoGeneSymbol,o=""),void 0!==n&&t.push(Object.assign(Object.assign({},r),{geneticEntityName:n,cytoband:o})),t}),[])));case 26:return t.abrupt("return",Promise.resolve([]));case 27:case"end":return t.stop()}}),t,this)})))}}}),(function(e){return"".concat(e.geneticEntityId,",").concat(e.profileX.molecularProfileId,",").concat(e.profileY.molecularProfileId)}))}),(0,c.makeObservable)(rl(r)),window.resultsViewCoExpressionTab=rl(r),r.plotHandlers={onClickLogScale:(0,c.action)((function(){r.plotState.plotLogScale=!r.plotState.plotLogScale})),onClickShowMutations:(0,c.action)((function(){r.plotState.plotShowMutations=!r.plotState.plotShowMutations})),onClickShowRegressionLine:(0,c.action)((function(){r.plotState.plotShowRegressionLine=!r.plotState.plotShowRegressionLine}))},r}var r,o,a;return ol(t,e),r=t,(o=[{key:"onSelectProfileX",value:function(e){this._selectedProfileX=e.value}},{key:"onSelectProfileY",value:function(e){this._selectedProfileY=e.value}},{key:"onSelectGeneticEntity",value:function(e){if(!this.props.store.geneticEntities.isComplete)throw new Error("Invalid Genetic Entity");var t=!0,r=!1,n=void 0;try{for(var o,i=this.props.store.geneticEntities.result[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;a.geneticEntityId.toString()===e&&(this._selectedGeneticEntity=a)}}catch(e){r=!0,n=e}finally{try{t||null==i.return||i.return()}finally{if(r)throw n}}}},{key:"createDataQueryFilterForCoExpression",value:function(e,t,r){var n=void 0;return r===p.Mz.GENE?n=Object.assign(Object.assign({},e),{entrezGeneId:parseFloat(t)}):r===p.Mz.GENESET&&(n=Object.assign(Object.assign({},e),{genesetId:t})),n}},{key:"header",value:function(){return n.createElement("div",{style:{marginBottom:20}},this.profilesSelector)}},{key:"geneTabs",value:function(){if(this.selectedGeneticEntity.isComplete&&this.selectedProfileX.isComplete&&this.selectedProfileY.isComplete&&this.props.store.geneticEntities.isComplete&&this.props.store.coexpressionTabMolecularProfiles.isComplete){var e=[],t=!0,r=!1,o=void 0;try{for(var i,a=this.props.store.geneticEntities.result[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var l=i.value,s=!0,c=!1,f=void 0;try{for(var m,h=(l.geneticEntityType===p.Mz.GENE?(0,ki.aL)(this.props.store.coexpressionTabMolecularProfiles.result):(0,ki.Vv)(this.props.store.coexpressionTabMolecularProfiles.result))[Symbol.iterator]();!(s=(m=h.next()).done);s=!0){var y=m.value,b=!0,g=!1,v=void 0;try{for(var S,E=this.props.store.coexpressionTabMolecularProfiles.result[Symbol.iterator]();!(b=(S=E.next()).done);b=!0){var C=S.value;e.push(n.createElement(za,{key:"".concat(l.geneticEntityId,",").concat(y.molecularProfileId,",").concat(C.molecularProfileId),coExpressionCache:this.coExpressionCache,geneticEntity:l,profileX:y,profileY:C,numericGeneMolecularDataCache:this.props.store.numericGeneMolecularDataCache,numericGenesetMolecularDataCache:this.props.store.numericGenesetMolecularDataCache,mutationCache:this.hasMutationData?this.props.store.mutationCache:void 0,hidden:y.molecularProfileId!==this.selectedProfileX.result||C.molecularProfileId!==this.selectedProfileY.result||l.geneticEntityId!==this.selectedGeneticEntity.result.geneticEntityId,plotState:this.plotState,plotHandlers:this.plotHandlers,coverageInformation:this.props.store.coverageInformation,studyToMutationMolecularProfile:this.props.store.studyToMutationMolecularProfile}))}}catch(e){g=!0,v=e}finally{try{b||null==E.return||E.return()}finally{if(g)throw v}}}}catch(e){c=!0,f=e}finally{try{s||null==h.return||h.return()}finally{if(c)throw f}}}}catch(e){r=!0,o=e}finally{try{t||null==a.return||a.return()}finally{if(r)throw o}}return n.createElement("div",null,n.createElement(d.Kh,{id:"coexpressionTabGeneTabs",activeTabId:this.selectedGeneticEntity.result.geneticEntityId.toString(),onTabClick:this.onSelectGeneticEntity,className:"coexpressionTabGeneTabs pillTabs",unmountOnHide:!0,tabButtonStyle:"pills",arrowStyle:{"line-height":.8}},this.props.store.geneticEntities.result.map((function(e,t){return n.createElement(d.l6,{key:t,id:e.geneticEntityId.toString(),linkText:e.geneticEntityName})}))),n.createElement(u.Observer,null,this.header),e)}return n.createElement(ee.Z,{isLoading:!0,center:!0,size:"big"})}},{key:"render",value:function(){var e=null;e=this.props.store.coexpressionTabMolecularProfiles.isComplete&&this.props.store.coexpressionTabMolecularProfiles.result.length>0?n.createElement("div",null,n.createElement(u.Observer,null,this.geneTabs)):n.createElement("div",{className:"alert alert-info"},"There are no available profiles in the queried studies.");var t=(0,ie.CX)(this.props.store.genes,this.props.store.molecularProfileIdToProfiledFilteredSamples,this.props.store.coexpressionTabMolecularProfiles);return n.createElement("div",{"data-test":"coExpressionTabDiv"},n.createElement("div",{className:"tabMessageContainer"},n.createElement(oe.Z,{className:"coexp-oql-status-banner",store:this.props.store,tabReflectsOql:!1}),n.createElement(ae.Z,{store:this.props.store,isUnaffected:!0}),n.createElement(ue.Z,{store:this.props.store})),"complete"===t&&e,n.createElement(ee.Z,{center:!0,size:"big",isLoading:"pending"===t}))}},{key:"hasMutationData",get:function(){return i().some(this.props.store.molecularProfilesWithData.result,(function(e){return e.molecularAlterationType===p.YK.MUTATION_EXTENDED}))}},{key:"profilesSelector",get:function(){return this.selectedGeneticEntity.isComplete&&this.selectedProfileX.isComplete&&this.selectedProfileY.isComplete&&this.xProfileOptions.isComplete&&this.yProfileOptions.isComplete&&this.props.store.coexpressionTabMolecularProfiles.isComplete&&this.isSelectedGeneticEntityAGeneSet.isComplete?n.createElement("div",null,n.createElement("div",{style:{float:"left",width:"100%",display:"flex",alignItems:"center"}},n.createElement("span",null,"Find"," ",(0,ki.Vv)(this.props.store.coexpressionTabMolecularProfiles.result).length>0?"genes/genesets":"genes"," ","in"," "),n.createElement("div",{style:{display:"inline-block",width:376,marginLeft:4,marginRight:4,zIndex:10}},n.createElement(wi.default,{name:"query-profile-select",value:this.selectedProfileY.result,onChange:this.onSelectProfileY,options:this.yProfileOptions.result,searchable:!1,clearable:!1,className:"coexpression-select-query-profile"})),n.createElement("span",null," ","that are correlated with"," ",this.selectedGeneticEntity.result.geneticEntityName," ","in"," "),n.createElement("div",{style:{display:"inline-block",width:376,marginLeft:4,marginRight:4,zIndex:15}},n.createElement(wi.default,{name:"subject-profile-select",value:this.selectedProfileX.result,onChange:this.onSelectProfileX,options:this.xProfileOptions.result,searchable:!1,clearable:!1,disabled:this.isSelectedGeneticEntityAGeneSet.result,className:"coexpression-select-subject-profile"})))):n.createElement(ee.Z,{isLoading:!0,center:!0,size:"big"})}}])&&Ja(r.prototype,o),a&&Ja(r,a),t}(n.Component);ll([c.observable.ref],cl.prototype,"_selectedProfileX",void 0),ll([c.observable.ref],cl.prototype,"_selectedProfileY",void 0),ll([c.observable],cl.prototype,"_selectedGeneticEntity",void 0),ll([c.observable],cl.prototype,"plotState",void 0),ll([Ai.ak],cl.prototype,"onSelectProfileX",null),ll([Ai.ak],cl.prototype,"onSelectProfileY",null),ll([Ai.ak],cl.prototype,"onSelectGeneticEntity",null),ll([c.computed],cl.prototype,"hasMutationData",null),ll([Ai.ak],cl.prototype,"header",null),ll([Ai.ak],cl.prototype,"geneTabs",null);const pl=cl=ll([u.observer],cl);var dl=r(23368),fl=r(94916),ml=r(66798),hl=r(2648),yl=r(16168),bl=r(11037),gl=r(94745),vl=r(35595),Sl=r(38659),El=r(18474),Cl=r(25565),wl=r(30177);function Tl(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Pl(e){return(Pl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ol(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kl(e,t){return(kl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Al(e){return(Al="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Il=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":Al(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},_l=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{s(n.next(e))}catch(e){i(e)}}function l(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,l)}s((n=n.apply(e,t||[])).next())}))},Dl=function(e){function t(e,r,n){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=function(e,t){return!t||"object"!==Al(t)&&"function"!=typeof t?Ol(e):t}(this,Pl(t).call(this,e,r,n)),Object.defineProperty(Ol(o),"urlWrapper",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(Ol(o),"resultsViewStore",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(Ol(o),"_originalGroups",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[o.resultsViewStore.comparisonTabGroups]},invoke:function(){var e=o.resultsViewStore.comparisonTabGroups.result;if(o.groupOrder){var t=(0,w.ky)(o.groupOrder);return Promise.resolve(i().sortBy(e,(function(e){return(0,Jn.Z)(t[e.name],Number.POSITIVE_INFINITY)})))}return Promise.resolve(e)}})}),Object.defineProperty(Ol(o),"nameToUserCreatedGroup",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[o._session]},invoke:function(){return Promise.resolve(i().keyBy(o._session.result.groups,(function(e){return e.name})))}})}),(0,c.makeObservable)(Ol(o)),o}var r,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kl(e,t)}(t,e),r=t,(n=[{key:"updateOverlapStrategy",value:function(e){this.urlWrapper.updateURL({comparison_overlapStrategy:e})}},{key:"setUsePatientLevelEnrichments",value:function(e){this.resultsViewStore.setUsePatientLevelEnrichments(e)}},{key:"isGroupDeletable",value:function(e){return!!this.nameToUserCreatedGroup.isComplete&&e.name in this.nameToUserCreatedGroup.result}},{key:"updateSelectedGroups",value:function(e){this.urlWrapper.updateURL({comparison_selectedGroups:JSON.stringify(e)})}},{key:"isGroupSelected",value:function(e){return this.selectedGroups.includes(e)}},{key:"toggleGroupSelected",value:function(e){var t=this.selectedGroups.slice();t.includes(e)?t.splice(t.indexOf(e),1):t.push(e),this.updateSelectedGroups(t)}},{key:"selectAllGroups",value:function(){var e=this._originalGroups.result;this.updateSelectedGroups(e.map((function(e){return e.name})))}},{key:"deselectAllGroups",value:function(){this.updateSelectedGroups([])}},{key:"updateGroupOrder",value:function(e,t){var r=this.groupOrder;r||(r=this._originalGroups.result.map((function(e){return e.name})));var n=(r=r.slice()).splice(e,1)[0];r.splice(t,0,n),this.urlWrapper.updateURL({comparison_groupOrder:JSON.stringify(r)})}},{key:"saveAndGoToSession",value:function(e){return _l(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,wl.Z.addComparisonSession(e);case 2:r=t.sent,n=r.id,this.urlWrapper.updateURL({comparison_createdGroupsSessionId:n}),this.newSessionPending=!1;case 6:case"end":return t.stop()}}),t,this)})))}},{key:"overlapStrategy",get:function(){return this.urlWrapper.query.comparison_overlapStrategy||El.T.EXCLUDE}},{key:"usePatientLevelEnrichments",get:function(){return this.resultsViewStore.usePatientLevelEnrichments}},{key:"_session",get:function(){return this.resultsViewStore.comparisonTabComparisonSession}},{key:"selectedGroups",get:function(){var e=this.urlWrapper.query.comparison_selectedGroups;return e?JSON.parse(e):[Cl.vj,Cl.iA]}},{key:"groupOrder",get:function(){var e=this.urlWrapper.query.comparison_groupOrder;return e?JSON.parse(e):void 0}},{key:"samples",get:function(){return this.resultsViewStore.samples}},{key:"studies",get:function(){return this.resultsViewStore.studies}}])&&Tl(r.prototype,n),o&&Tl(r,o),t}(El.Z);Il([c.action],Dl.prototype,"updateOverlapStrategy",null),Il([c.computed],Dl.prototype,"overlapStrategy",null),Il([c.computed],Dl.prototype,"usePatientLevelEnrichments",null),Il([c.action.bound],Dl.prototype,"setUsePatientLevelEnrichments",null),Il([c.computed],Dl.prototype,"_session",null),Il([S.default],Dl.prototype,"isGroupDeletable",null),Il([c.computed],Dl.prototype,"selectedGroups",null),Il([c.action],Dl.prototype,"updateSelectedGroups",null),Il([S.default],Dl.prototype,"isGroupSelected",null),Il([c.action.bound],Dl.prototype,"toggleGroupSelected",null),Il([c.action.bound],Dl.prototype,"selectAllGroups",null),Il([c.action.bound],Dl.prototype,"deselectAllGroups",null),Il([c.computed],Dl.prototype,"groupOrder",null),Il([c.action],Dl.prototype,"updateGroupOrder",null),Il([c.action],Dl.prototype,"saveAndGoToSession",null);var xl=r(62046),Ml=r(37672),Nl=r(6790),Ll=r.n(Nl),Rl=r(42764),jl=r(4538),Gl=r(24952),Vl=r(15127),Fl=r(19046),Bl=r(7515),ql=r.n(Bl),Ul=r(57761),Hl=r(79666);function Wl(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Yl(e){return(Yl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Kl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ql(e,t){return(Ql=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Xl(e){return(Xl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Zl=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":Xl(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},zl=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==Xl(t)&&"function"!=typeof t?Kl(e):t}(this,Yl(t).call(this,e)),Object.defineProperty(Kl(r),"store",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Kl(r),"overlapStrategySelector",{enumerable:!0,configurable:!0,writable:!0,value:(0,Fo.F)({await:function(){return[r.store.overlapComputations]},render:function(){if(r.store.overlapComputations.result.totalSampleOverlap||r.store.overlapComputations.result.totalPatientOverlap){var e="Include overlapping samples and patients",t="Exclude overlapping samples and patients";return n.createElement("div",{style:{minWidth:355,width:355,zIndex:20}},n.createElement(Sl.default,{name:"select overlap strategy",onChange:function(e){e&&r.onOverlapStrategySelect(e)},options:[{label:e,value:El.T.INCLUDE},{label:t,value:El.T.EXCLUDE}],clearable:!1,searchable:!1,value:{label:r.store.overlapStrategy===El.T.EXCLUDE?t:e,value:r.store.overlapStrategy}}))}return null}})}),Object.defineProperty(Kl(r),"tabs",{enumerable:!0,configurable:!0,writable:!0,value:(0,Fo.F)({await:function(){return[r.store._activeGroupsNotOverlapRemoved,r.store.activeGroups,r.store.mutationEnrichmentProfiles,r.store.structuralVariantEnrichmentProfiles,r.store.copyNumberEnrichmentProfiles,r.store.mRNAEnrichmentProfiles,r.store.proteinEnrichmentProfiles,r.store.methylationEnrichmentProfiles,r.store.survivalClinicalDataExists,r.store.genericAssayEnrichmentProfilesGroupedByGenericAssayType]},render:function(){return n.createElement(d.Kh,{unmountOnHide:!1,activeTabId:r.props.urlWrapper.comparisonSubTabId,onTabClick:r.props.urlWrapper.setComparisonSubTabId,className:"secondaryNavigation comparisonTabSubTabs"},n.createElement(d.l6,{id:xl.ig.OVERLAP,linkText:"Overlap"},n.createElement(yl.Z,{store:r.store})),r.store.showSurvivalTab&&n.createElement(d.l6,{id:xl.ig.SURVIVAL,linkText:"Survival",anchorClassName:r.store.survivalTabUnavailable?"greyedOut":""},n.createElement(Ml.Z,{store:r.store})),n.createElement(d.l6,{id:xl.ig.CLINICAL,linkText:"Clinical",anchorClassName:r.store.clinicalTabUnavailable?"greyedOut":""},n.createElement(bl.ZP,{store:r.store})),r.store.showAlterationsTab&&n.createElement(d.l6,{id:hn.YP.ALTERATIONS,linkText:r.alterationEnrichmentTabName,anchorClassName:r.store.alterationsTabUnavailable?"greyedOut":""},r.store.activeGroups.isComplete&&r.store.activeGroups.result.length>1&&(0,cr.Ib)().skin_show_settings_menu&&n.createElement(Ul.AI,{store:r.store,updateSelectedEnrichmentEventTypes:r.store.updateSelectedEnrichmentEventTypes})||n.createElement(Vl.Z,{classNames:ql().inlineAlterationTypeSelectorMenu,store:r.store,updateSelectedEnrichmentEventTypes:r.store.updateSelectedEnrichmentEventTypes,showMutations:r.store.hasMutationEnrichmentData,showCnas:r.store.hasCnaEnrichmentData,showStructuralVariants:r.store.hasStructuralVariantData}),n.createElement(Gl.Z,{store:r.store,resultsViewStore:r.props.store})),r.store.showMRNATab&&n.createElement(d.l6,{id:xl.ig.MRNA,linkText:"mRNA",anchorClassName:r.store.mRNATabUnavailable?"greyedOut":""},n.createElement(gl.Z,{store:r.store,resultsViewMode:!0})),r.store.showProteinTab&&n.createElement(d.l6,{id:xl.ig.PROTEIN,linkText:"Protein",anchorClassName:r.store.proteinTabUnavailable?"greyedOut":""},n.createElement(vl.Z,{store:r.store,resultsViewMode:!0})),r.store.showMethylationTab&&n.createElement(d.l6,{id:xl.ig.DNAMETHYLATION,linkText:"DNA Methylation",anchorClassName:r.store.methylationTabUnavailable?"greyedOut":""},n.createElement(jl.Z,{store:r.store,resultsViewMode:!0})),r.store.showGenericAssayTab&&i().keys(r.store.genericAssayEnrichmentProfilesGroupedByGenericAssayType.result).map((function(e){return n.createElement(d.l6,{id:"".concat(hn.YP.GENERIC_ASSAY_PREFIX,"_").concat(e.toLowerCase()),linkText:(0,Hl._y)(e),anchorClassName:r.store.genericAssayTabUnavailable?"greyedOut":""},n.createElement(Fl.Z,{store:r.store,genericAssayType:e,resultsViewMode:!0}))})))},renderPending:function(){return n.createElement(ee.Z,{center:!0,isLoading:!0,size:"big"})},renderError:function(){return n.createElement(pn.Z,null)}})}),(0,c.makeObservable)(Kl(r)),window.comparisonTab=Kl(r),r.store=new Dl(r.props.appStore,r.props.urlWrapper,r.props.store),r}var r,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ql(e,t)}(t,e),r=t,(o=[{key:"componentWillUnmount",value:function(){this.store&&this.store.destroy()}},{key:"onOverlapStrategySelect",value:function(e){(0,Bo.L9)({category:"resultsView",action:"setComparisonTabOverlapStrategy",label:e.value}),this.store.updateOverlapStrategy(e.value)}},{key:"render",value:function(){return this.store?n.createElement("div",{"data-test":"ComparisonTabDiv"},n.createElement(ee.Z,{center:!0,isLoading:this.store.newSessionPending,size:"big"}),n.createElement("div",{className:"tabMessageContainer",style:{marginBottom:10}},n.createElement(oe.Z,{className:"comparison-oql-status-banner",store:this.props.store,tabReflectsOql:!0}),n.createElement(ae.Z,{store:this.props.store}),n.createElement(ue.Z,{store:this.props.store})),n.createElement("div",{style:{display:"flex",justifyContent:"space-between",paddingBottom:25}},n.createElement("div",{className:Ll().headerControls},n.createElement(Rl.Z,{store:this.store,groupCollapseThreshold:40,isGroupDeletable:this.store.isGroupDeletable})),n.createElement("div",null,this.overlapStrategySelector.component)),this.tabs.component):null}},{key:"alterationEnrichmentTabName",get:function(){return xl.hN}}])&&Wl(r.prototype,o),a&&Wl(r,a),t}(n.Component);Zl([c.observable.ref],zl.prototype,"store",void 0),Zl([c.computed],zl.prototype,"alterationEnrichmentTabName",null),Zl([c.action.bound],zl.prototype,"onOverlapStrategySelect",null);const $l=zl=Zl([u.observer],zl);var Jl=r(17790),es=r(5206),ts=r.n(es),rs=r(96840),ns=r(37687),os=r(25120);function is(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function as(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ls(e){return(ls=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ss(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function us(e,t){return(us=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function cs(e){return(cs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ps=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":cs(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};function ds(e,t){var r=new p.oh(e,t);return(0,ml.Z)("resultsViewPageStore",r),(0,c.autorun)((function(){r.studyIds.isComplete&&r.oqlText&&(0,Bo.Ci)(r.studyIds.result,r.oqlText,r.hugoGeneSymbols,r.queriedVirtualStudies.result.length>0)})),r}function fs(e){l()("#oncoprint-result-tab").click(e)}var ms=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==cs(t)&&"function"!=typeof t?ss(e):t}(this,ls(t).call(this,e)),Object.defineProperty(ss(r),"resultsViewPageStore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(ss(r),"urlWrapper",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(ss(r),"quickOQLQueryStore",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(ss(r),"showTabs",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(ss(r),"userMessages",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[r.resultsViewPageStore.expressionProfiles,r.resultsViewPageStore.studies]},invoke:function(){return Promise.resolve([])}})}),(0,c.makeObservable)(ss(r)),r.urlWrapper=new le.Z(e.routing),(0,hl.gM)(r.urlWrapper),(0,hl.$O)(r.urlWrapper),(0,ml.Z)("urlWrapper",r.urlWrapper),r.urlWrapper.hasSessionId?(0,w.XE)(r.urlWrapper.remoteSessionData,(function(){r.resultsViewPageStore=ds(e.appStore,r.urlWrapper)})):r.resultsViewPageStore=ds(e.appStore,r.urlWrapper),r}var r,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&us(e,t)}(t,e),r=t,(o=[{key:"componentWillUnmount",value:function(){this.resultsViewPageStore.destroy(),this.urlWrapper.destroy()}},{key:"evaluateTabInclusion",value:function(e){var t=(0,cr.Ib)().disabled_tabs||"",r=(0,hn.t8)(t).includes(e.id),n=this.resultsViewPageStore.tabId===e.id,o=!!e.hide&&e.hide();return n||!r&&!o}},{key:"handleQuickOQLSubmission",value:function(){this.quickOQLQueryStore.submit(),this.showOQLEditor=!1}},{key:"toggleOQLEditor",value:function(){this.showOQLEditor=!this.showOQLEditor}},{key:"getTabHref",value:function(e){return s.format({pathname:(0,se.gN)("./results/".concat(e)),query:this.props.routing.query,hash:this.props.routing.location.hash})}},{key:"render",value:function(){var e=this;return this.urlWrapper.isTemporarySessionPendingSave||this.urlWrapper.isLoadingSession||!this.resultsViewPageStore.studies.isComplete?n.createElement(ee.Z,{isLoading:!0,center:!0,noFade:!0,size:"big"}):this.resultsViewPageStore.studies.isComplete&&!this.resultsViewPageStore.tabId?(setTimeout((function(){e.resultsViewPageStore.handleTabChange(e.resultsViewPageStore.tabId,!0)})),null):n.createElement(Ci.X,{noMargin:!0,hideFooter:!0,className:"subhead-dark"},this.pageContent)}},{key:"tabs",get:function(){var e=this,t=this.resultsViewPageStore,r=[{id:hn.PC.ONCOPRINT,getTab:function(){return n.createElement(d.l6,{key:0,id:hn.PC.ONCOPRINT,linkText:"OncoPrint"},n.createElement(Po,{divId:"oncoprintDiv",store:t,urlWrapper:t.urlWrapper,key:t.hugoGeneSymbols.join(","),addOnBecomeVisibleListener:fs}))}},{id:hn.PC.CANCER_TYPES_SUMMARY,getTab:function(){return n.createElement(d.l6,{key:1,id:hn.PC.CANCER_TYPES_SUMMARY,linkText:"Cancer Types Summary"},n.createElement(Ee,{store:t}))}},{id:hn.PC.MUTUAL_EXCLUSIVITY,getTab:function(){return n.createElement(d.l6,{key:5,id:hn.PC.MUTUAL_EXCLUSIVITY,linkText:"Mutual Exclusivity"},n.createElement(Er.Z,{store:t,isSampleAlteredMap:t.isSampleAlteredMap}))},hide:function(){return!e.resultsViewPageStore.isSampleAlteredMap.isComplete||i().size(e.resultsViewPageStore.isSampleAlteredMap.result)<2}},{id:hn.PC.PLOTS,getTab:function(){return n.createElement(d.l6,{key:12,id:hn.PC.PLOTS,linkText:"Plots"},n.createElement(Ei.ZP,{store:t,urlWrapper:e.urlWrapper}))}},{id:hn.PC.MUTATIONS,getTab:function(){return n.createElement(d.l6,{key:3,id:hn.PC.MUTATIONS,linkText:"Mutations"},n.createElement(Sr,{store:t,appStore:e.props.appStore,urlWrapper:e.urlWrapper}))}},{id:hn.PC.COEXPRESSION,hide:function(){if(e.resultsViewPageStore.isThereDataForCoExpressionTab.isComplete&&e.resultsViewPageStore.studies.isComplete){var t=e.resultsViewPageStore.studies.result.length>1,r=!e.resultsViewPageStore.isThereDataForCoExpressionTab.result;return t||r}return!0},getTab:function(){return n.createElement(d.l6,{key:7,id:hn.PC.COEXPRESSION,linkText:"Co-expression"},n.createElement(pl,{store:t}))}},{id:hn.PC.COMPARISON,hide:function(){return e.resultsViewPageStore.survivalClinicalDataExists.isPending},getTab:function(){var t=e.resultsViewPageStore.survivalClinicalDataExists.result?"Comparison/Survival":"Comparison";return n.createElement(d.l6,{key:10,id:hn.PC.COMPARISON,linkText:t},n.createElement($l,{urlWrapper:e.urlWrapper,appStore:e.props.appStore,store:e.resultsViewPageStore}))}},{id:hn.PC.CN_SEGMENTS,hide:function(){return!(e.resultsViewPageStore.studies.isComplete&&e.resultsViewPageStore.genes.isComplete&&e.resultsViewPageStore.referenceGenes.isComplete&&(0,Tr.$b)(e.resultsViewPageStore.samples.result))},getTab:function(){return n.createElement(d.l6,{key:6,id:hn.PC.CN_SEGMENTS,linkText:"CN Segments",className:"cnSegmentsMSKTab"},n.createElement(Rn,{store:t}))}},{id:hn.PC.NETWORK,hide:function(){return!0},getTab:function(){return n.createElement(d.l6,{key:9,id:hn.PC.NETWORK,linkText:"Network"},n.createElement("div",{className:"alert alert-info"},"The Network tab has been retired. For similar functionality, please visit"," ",n.createElement("a",{href:"http://www.pathwaycommons.org/pcviz/",target:"_blank"},"http://www.pathwaycommons.org/pcviz/")))}},{id:hn.PC.PATHWAY_MAPPER,hide:function(){return"Internet Explorer"===ts().name||!(0,cr.Ib)().show_pathway_mapper||!e.resultsViewPageStore.studies.isComplete},getTab:function(){var r=t.filteredSequencedSampleKeysByGene.isComplete&&t.oqlFilteredCaseAggregatedDataByOQLLine.isComplete&&t.genes.isComplete&&t.samples.isComplete&&t.patients.isComplete&&t.coverageInformation.isComplete&&t.filteredSequencedSampleKeysByGene.isComplete&&t.filteredSequencedPatientKeysByGene.isComplete&&t.selectedMolecularProfiles.isComplete&&t.oqlFilteredCaseAggregatedDataByUnflattenedOQLLine.isComplete;return n.createElement(d.l6,{key:13,id:hn.PC.PATHWAY_MAPPER,linkText:"Pathways"},r?n.createElement(Zn,{store:t,appStore:e.props.appStore,urlWrapper:e.urlWrapper}):n.createElement(ee.Z,{isLoading:!0,size:"big",center:!0}))}},{id:hn.PC.DOWNLOAD,getTab:function(){return n.createElement(d.l6,{key:11,id:hn.PC.DOWNLOAD,linkText:"Download"},n.createElement(Tn,{store:t}))}}].filter(this.evaluateTabInclusion).map((function(e){return e.getTab()}));return r.push.apply(r,is((0,os.m)(this.customTabs))),r}},{key:"customTabs",get:function(){return(0,os.E)((0,cr.Ib)().custom_tabs,"RESULTS_PAGE")}},{key:"quickOQLSubmitButton",get:function(){if(this.quickOQLQueryStore)return n.createElement(n.Fragment,null,n.createElement("button",{className:"btn btn-primary btn-sm","data-test":"oqlQuickEditSubmitButton",style:{marginLeft:10},onClick:this.handleQuickOQLSubmission,disabled:!this.quickOQLQueryStore.submitEnabled},"Submit Query"),"Â ",n.createElement("button",{className:"btn btn-link btn-sm",onClick:this.toggleOQLEditor},"Cancel"))}},{key:"showOQLEditor",get:function(){return!!this.quickOQLQueryStore},set:function(e){this.quickOQLQueryStore=e?(0,qo.S)(this.urlWrapper.query,this.urlWrapper,!1):null}},{key:"pageContent",get:function(){var e=this;if(0===this.resultsViewPageStore.hugoGeneSymbols.length||this.resultsViewPageStore.invalidStudyIds.result.length>0)return n.createElement("div",null,n.createElement("div",{className:"headBlock"}),n.createElement(Oo.Z,{forkedMode:!1,showQuickSearchTab:!1,showDownloadTab:!1,showAlerts:!0,getQueryStore:function(){return(0,qo.S)(e.urlWrapper.query,e.urlWrapper)}}));var t=this.showTabs&&!this.resultsViewPageStore.genesInvalid&&!this.resultsViewPageStore.queryExceedsLimit&&this.resultsViewPageStore.customDriverAnnotationReport.isComplete;return n.createElement(n.Fragment,null,this.resultsViewPageStore.queryExceedsLimit&&n.createElement("div",{className:"alert alert-danger queryInvalid",style:{marginBottom:"40px"},role:"alert"},n.createElement(fl.Z,{sampleCount:this.resultsViewPageStore.samples.result.length,queryProductLimit:(0,cr.Ib)().query_product_limit,email:(0,cr.Ib)().skin_email_contact})),this.userMessages.isComplete&&this.userMessages.result.length>0&&n.createElement(rs.Z,{messages:this.userMessages.result}),(this.resultsViewPageStore.studies.isPending||!t&&!this.resultsViewPageStore.queryFormVisible)&&n.createElement(ee.Z,{isLoading:!0,center:!0,noFade:!0,size:"big"}),this.resultsViewPageStore.studies.isComplete&&n.createElement(n.Fragment,null,n.createElement(dl.Z,null,n.createElement("title",null,(0,Tr.zF)(this.resultsViewPageStore.hugoGeneSymbols,this.resultsViewPageStore.studies.result))),n.createElement("div",null,n.createElement("div",{className:"headBlock"},n.createElement(Si,{routingStore:this.props.routing,store:this.resultsViewPageStore,onToggleQueryFormVisibility:function(t){(0,c.runInAction)((function(){e.showTabs=t,e.showOQLEditor=!1}))},onToggleOQLEditUIVisibility:this.toggleOQLEditor}),this.showOQLEditor&&n.createElement("div",{className:"quick_oql_edit"},n.createElement(Jl.Z,{validateInputGeneQuery:!0,inputGeneQuery:this.quickOQLQueryStore.geneQuery,callback:function(){e.quickOQLQueryStore.geneQuery=arguments.length<=2?void 0:arguments[2]},location:Jl.e.DEFAULT,submitButton:this.quickOQLSubmitButton,error:this.quickOQLQueryStore.submitError,messages:this.quickOQLQueryStore.oqlMessages}))),t&&n.createElement(d.Kh,{key:this.urlWrapper.hash,activeTabId:this.resultsViewPageStore.tabId,unmountOnHide:!1,onTabClick:function(t){return e.resultsViewPageStore.handleTabChange(t)},className:"mainTabs",hrefRoot:(0,se.gN)("results"),contentWindowExtra:n.createElement(ns.v,{path:this.props.routing.location.pathname})},this.tabs))))}}])&&as(r.prototype,o),a&&as(r,a),t}(n.Component);ps([c.observable.ref],ms.prototype,"quickOQLQueryStore",void 0),ps([c.observable],ms.prototype,"showTabs",void 0),ps([c.computed],ms.prototype,"tabs",null),ps([c.computed],ms.prototype,"customTabs",null),ps([S.default],ms.prototype,"evaluateTabInclusion",null),ps([c.computed],ms.prototype,"quickOQLSubmitButton",null),ps([c.computed],ms.prototype,"showOQLEditor",null),ps([c.action.bound],ms.prototype,"handleQuickOQLSubmission",null),ps([c.action.bound],ms.prototype,"toggleOQLEditor",null),ps([S.default],ms.prototype,"getTabHref",null),ps([c.computed],ms.prototype,"pageContent",null);const hs=ms=ps([(0,u.inject)("appStore","routing"),u.observer],ms)},66798:(e,t,r)=>{"use strict";function n(e,t){window&&(window[e]=t)}r.d(t,{Z:()=>n})},7515:e=>{e.exports={portalWidth:"styles-module__portalWidth__3C3M_",framedImage:"styles-module__framedImage__7sZho",inlineAlterationTypeSelectorMenu:"styles-module__inlineAlterationTypeSelectorMenu__2qY8I",buttonAlterationTypeSelectorMenu:"styles-module__buttonAlterationTypeSelectorMenu__1ECLU"}},24433:e=>{e.exports={portalWidth:"styles-module__portalWidth__1Fjw6",framedImage:"styles-module__framedImage__3hqyk","tables-container":"styles-module__tables-container__1wDsF",downloadCopyTable:"styles-module__downloadCopyTable__1jMBv",noAlterationSpan:"styles-module__noAlterationSpan__1jy3D",notProfiledSpan:"styles-module__notProfiledSpan__2eZFJ",alterationSpan:"styles-module__alterationSpan__1oylB",tooltip:"styles-module__tooltip__2f1I5",infoIcon:"styles-module__infoIcon__2ZQ2T"}},69539:e=>{e.exports={portalWidth:"shareUI-module__portalWidth__23kqI",framedImage:"shareUI-module__framedImage__2dQ1S",shareModule:"shareUI-module__shareModule__3FK_r"}}}]);