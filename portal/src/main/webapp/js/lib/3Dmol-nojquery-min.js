$3Dmol=function(a){return a.$3Dmol||{}}(window);$.get("http://3dmol.csb.pitt.edu/track/report.cgi");$3Dmol.createViewer=function(a,b){"string"===$.type(a)&&(a=$("#"+a));if(a){b=b||{};try{return new $3Dmol.GLViewer(a,b)}catch(c){throw"error creating viewer: "+c;}}};$3Dmol.viewers={};
$3Dmol.download=function(a,b,c,q){var p="",z=b.addModel();if("pdb:"===a.substr(0,4)){p=c&&c.format?c.format:"pdb";a=a.substr(4).toUpperCase();if(!a.match(/^[1-9][A-Za-z0-9]{3}$/)){alert("Wrong PDB ID");return}uri=c&&c.format?"http://www.rcsb.org/pdb/files/"+a+"."+c.format:"http://www.rcsb.org/pdb/files/"+a+".pdb"}else if("cid:"==a.substr(0,4)){p="sdf";a=a.substr(4);if(!a.match(/^[1-9]+$/)){alert("Wrong Compound ID");return}uri="http://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+a+"/SDF?record_type=3d"}$.get(uri,
function(a){z.addMolData(a,p,c);b.zoomTo();b.render();q&&q(z)});return z};$3Dmol.SurfaceType={VDW:1,MS:2,SAS:3,SES:4};$3Dmol.mergeGeos=function(a,b){var c=b.geometry;void 0!==c&&a.geometryGroups.push(c.geometryGroups[0])};$3Dmol.multiLineString=function(a){return a.toString().replace(/^[^\/]+\/\*!?/,"").replace(/\*\/[^\/]+$/,"")};$3Dmol.syncSurface=!1;if(0<=window.navigator.userAgent.indexOf("MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/"))$3Dmol.syncSurface=!0;
$3Dmol.specStringToObject=function(a){if("object"===typeof a||"undefined"===typeof a||null==a)return a;a=a.replace(/%7E/,"~");var b=function(a){return $.isNumeric(a)?Math.floor(parseFloat(a))==parseInt(a)?parseFloat(a):0<=a.indexOf(".")?parseFloat(a):parseInt(a):a},c={};a=a.split(";");for(var q=0;q<a.length;q++){var p=a[q].split(":"),z=p[0],w={};if(p=p[1])if(p=p.replace(/~/g,"="),-1!==p.indexOf("="))for(var p=p.split(","),E=0;E<p.length;E++){var d=p[E].split("=",2);w[d[0]]=b(d[1])}else w=-1!==p.indexOf(",")?
p.split(","):b(p);c[z]=w}return c};
$3Dmol.getExtent=function(a,b){var c,q,p,z,w,E,d,g,f,e,D=!b;c=q=p=9999;z=w=E=-9999;d=g=f=e=0;if(0===a.length)return[[0,0,0],[0,0,0],[0,0,0]];for(var s=0;s<a.length;s++){var G=a[s];if("undefined"!==typeof G&&isFinite(G.x)&&isFinite(G.y)&&isFinite(G.z)&&(e++,d+=G.x,g+=G.y,f+=G.z,c=c<G.x?c:G.x,q=q<G.y?q:G.y,p=p<G.z?p:G.z,z=z>G.x?z:G.x,w=w>G.y?w:G.y,E=E>G.z?E:G.z,G.symmetries&&D))for(var h=0;h<G.symmetries.length;h++)e++,d+=G.symmetries[h].x,g+=G.symmetries[h].y,f+=G.symmetries[h].z,c=c<G.symmetries[h].x?
c:G.symmetries[h].x,q=q<G.symmetries[h].y?q:G.symmetries[h].y,p=p<G.symmetries[h].z?p:G.symmetries[h].z,z=z>G.symmetries[h].x?z:G.symmetries[h].x,w=w>G.symmetries[h].y?w:G.symmetries[h].y,E=E>G.symmetries[h].z?E:G.symmetries[h].z}return[[c,q,p],[z,w,E],[d/e,g/e,f/e]]};$3Dmol.getAtomProperty=function(a,b){var c=null;a.properties&&"undefined"!=typeof a.properties[b]?c=a.properties[b]:"undefined"!=typeof a[b]&&(c=a[b]);return c};
$3Dmol.getPropertyRange=function(a,b){for(var c=Number.POSITIVE_INFINITY,q=Number.NEGATIVE_INFINITY,p=0,z=a.length;p<z;p++){var w=$3Dmol.getAtomProperty(a[p],b);null!=w&&(w<c&&(c=w),w>q&&(q=w))}isFinite(c)||isFinite(q)?isFinite(c)?isFinite(q)||(q=c):c=q:c=q=0;return[c,q]};var $3Dmol=$3Dmol||{};$3Dmol.Math={clamp:function(a,b,c){return Math.min(Math.max(a,b),c)},degToRad:function(){var a=Math.PI/180;return function(b){return b*a}}()};
$3Dmol.Quaternion=function(a,b,c,q){this.x=a||0;this.y=b||0;this.z=c||0;this.w=void 0!==q?q:1};
$3Dmol.Quaternion.prototype={constructor:$3Dmol.Quaternion,set:function(a,b,c,q){this.x=a;this.y=b;this.z=c;this.w=q;return this},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=a.w;return this},conjugate:function(){this.x*=-1;this.y*=-1;this.z*=-1;return this},inverse:function(){return this.conjugate().normalize()},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},normalize:function(){var a=this.length();0===a?(this.z=this.y=this.x=0,this.w=1):
(a=1/a,this.x*=a,this.y*=a,this.z*=a,this.w*=a);return this},multiply:function(a){return this.multiplyQuaternions(this,a)},multiplyQuaternions:function(a,b){var c=a.x,q=a.y,p=a.z,z=a.w,w=b.x,E=b.y,d=b.z,g=b.w;this.x=c*g+z*w+q*d-p*E;this.y=q*g+z*E+p*w-c*d;this.z=p*g+z*d+c*E-q*w;this.w=z*g-c*w-q*E-p*d}};$3Dmol.Vector2=function(a,b){this.x=a||0;this.y=b||0};
$3Dmol.Vector2.prototype={constructor:$3Dmol.Vector2,set:function(a,b){this.x=a;this.y=b;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;return this},copy:function(a){this.x=a.x;this.y=a.y;return this},clone:function(){return new $3Dmol.Vector2(this.x,this.y)}};$3Dmol.Vector3=function(a,b,c){this.x=a||0;this.y=b||0;this.z=c||0};
$3Dmol.Vector3.prototype={constructor:$3Dmol.Vector3,set:function(a,b,c){this.x=a;this.y=b;this.z=c;return this},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;return this},add:function(a){this.x+=a.x;this.y+=a.y;this.z+=a.z;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;return this},sub:function(a){this.x-=a.x;this.y-=a.y;this.z-=a.z;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;return this},multiplyScalar:function(a){this.x*=
a;this.y*=a;this.z*=a;return this},divideScalar:function(a){0!==a?(this.x/=a,this.y/=a,this.z/=a):this.z=this.y=this.x=0;return this},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,c=this.y-a.y;a=this.z-a.z;return b*b+c*c+a*a},applyMatrix4:function(a){var b=this.x,c=this.y,q=this.z;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*q+a[12];this.y=a[1]*b+a[5]*c+a[9]*q+a[13];this.z=a[2]*b+a[6]*c+a[10]*q+a[14];return this},applyProjection:function(a){var b=
this.x,c=this.y,q=this.z;a=a.elements;var p=a[3]*b+a[7]*c+a[11]*q+a[15];this.x=(a[0]*b+a[4]*c+a[8]*q+a[12])/p;this.y=(a[1]*b+a[5]*c+a[9]*q+a[13])/p;this.z=(a[2]*b+a[6]*c+a[10]*q+a[14])/p;return this},applyQuaternion:function(a){var b=this.x,c=this.y,q=this.z,p=a.x,z=a.y,w=a.z,E,d,g;E=2*(c*w-q*z);d=2*(q*p-b*w);g=2*(b*z-c*p);this.x=b+a.w*E+(d*w-g*z);this.y=c+a.w*d+(g*p-E*w);this.z=q+a.w*g+(E*z-d*p);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*a.x+this.y*
a.y+this.z*a.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},normalize:function(){return this.divideScalar(this.length())},cross:function(a){var b=this.x,c=this.y,q=this.z;this.x=c*a.z-q*a.y;this.y=q*a.x-b*a.z;this.z=b*a.y-c*a.x;return this},crossVectors:function(a,b){this.x=a.y*b.z-a.z*b.y;this.y=a.z*b.x-a.x*b.z;this.z=a.x*b.y-a.y*b.x;return this},getPositionFromMatrix:function(a){this.x=a.elements[12];
this.y=a.elements[13];this.z=a.elements[14];return this},setEulerFromRotationMatrix:function(a,b){var c=a.elements,q=c[0],p=c[4],z=c[8],w=c[5],E=c[9],d=c[6],c=c[10];void 0===b||"XYZ"===b?(this.y=Math.asin($3Dmol.Math.clamp(z,-1,1)),.99999>Math.abs(z)?(this.x=Math.atan2(-E,c),this.z=Math.atan2(-p,q)):(this.x=Math.atan2(d,w),this.z=0)):console.error("Error with vector's setEulerFromRotationMatrix: Unknown order: "+b);return this},rotateAboutVector:function(a,b){a.normalize();var c=Math.cos(b),q=Math.sin(b),
p=this.clone().multiplyScalar(c),q=a.clone().cross(this).multiplyScalar(q),c=a.clone().multiplyScalar(a.clone().dot(this)).multiplyScalar(1-c),p=p.add(q).add(c);this.x=p.x;this.y=p.y;this.z=p.z;return this},clone:function(){return new $3Dmol.Vector3(this.x,this.y,this.z)}};$3Dmol.Matrix3=function(a,b,c,q,p,z,w,E,d){this.elements=new Float32Array(9);this.set(void 0!==a?a:1,b||0,c||0,q||0,void 0!==p?p:1,z||0,w||0,E||0,void 0!==d?d:1)};
$3Dmol.Matrix3.prototype={constructor:$3Dmol.Matrix3,set:function(a,b,c,q,p,z,w,E,d){var g=this.elements;g[0]=a;g[3]=b;g[6]=c;g[1]=q;g[4]=p;g[7]=z;g[2]=w;g[5]=E;g[8]=d;return this},identity:function(){this.set(1,0,0,0,1,0,0,0,1);return this},copy:function(a){a=a.elements;this.set(a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8])},multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[3]*=a;b[6]*=a;b[1]*=a;b[4]*=a;b[7]*=a;b[2]*=a;b[5]*=a;b[8]*=a;return this},getInverse:function(a,b){var c=a.elements,
q=this.elements;q[0]=c[10]*c[5]-c[6]*c[9];q[1]=-c[10]*c[1]+c[2]*c[9];q[2]=c[6]*c[1]-c[2]*c[5];q[3]=-c[10]*c[4]+c[6]*c[8];q[4]=c[10]*c[0]-c[2]*c[8];q[5]=-c[6]*c[0]+c[2]*c[4];q[6]=c[9]*c[4]-c[5]*c[8];q[7]=-c[9]*c[0]+c[1]*c[8];q[8]=c[5]*c[0]-c[1]*c[4];c=c[0]*q[0]+c[1]*q[3]+c[2]*q[6];if(0===c){if(b)throw Error("Matrix3.getInverse(): can't invert matrix, determinant is 0");console.warn("Matrix3.getInverse(): can't invert matrix, determinant is 0");this.identity();return this}this.multiplyScalar(1/c);return this},
getDeterminant:function(){var a=this.elements;return a[0]*a[4]*a[8]+a[1]*a[5]*a[6]+a[2]*a[3]*a[7]-a[2]*a[4]*a[6]-a[1]*a[3]*a[8]-a[0]*a[5]*a[7]},transpose:function(){var a,b=this.elements;a=b[1];b[1]=b[3];b[3]=a;a=b[2];b[2]=b[6];b[6]=a;a=b[5];b[5]=b[7];b[7]=a;return this},clone:function(){var a=this.elements;return new $3Dmol.Matrix3(a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8])}};
$3Dmol.Matrix4=function(a,b,c,q,p,z,w,E,d,g,f,e,D,s,G,h){var l=this.elements=new Float32Array(16);l[0]=void 0!==a?a:1;l[4]=b||0;l[8]=c||0;l[12]=q||0;l[1]=p||0;l[5]=void 0!==z?z:1;l[9]=w||0;l[13]=E||0;l[2]=d||0;l[6]=g||0;l[10]=void 0!==f?f:1;l[14]=e||0;l[3]=D||0;l[7]=s||0;l[11]=G||0;l[15]=void 0!==h?h:1};
$3Dmol.Matrix4.prototype={constructor:$3Dmol.Matrix4,set:function(a,b,c,q,p,z,w,E,d,g,f,e,D,s,G,h){var l=this.elements;l[0]=a;l[4]=b;l[8]=c;l[12]=q;l[1]=p;l[5]=z;l[9]=w;l[13]=E;l[2]=d;l[6]=g;l[10]=f;l[14]=e;l[3]=D;l[7]=s;l[11]=G;l[15]=h;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},copy:function(a){a=a.elements;this.set(a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15]);return this},matrix3FromTopLeft:function(){var a=this.elements;
return new $3Dmol.Matrix3(a[0],a[4],a[8],a[1],a[5],a[9],a[2],a[6],a[10])},setRotationFromEuler:function(a,b){var c=this.elements,q=a.x,p=a.y,z=a.z,w=Math.cos(q),q=Math.sin(q),E=Math.cos(p),p=Math.sin(p),d=Math.cos(z),z=Math.sin(z);if(void 0===b||"XYZ"===b){var g=w*d,f=w*z,e=q*d,D=q*z;c[0]=E*d;c[4]=-E*z;c[8]=p;c[1]=f+e*p;c[5]=g-D*p;c[9]=-q*E;c[2]=D-g*p;c[6]=e+f*p;c[10]=w*E}else console.error("Error with matrix4 setRotationFromEuler. Order: "+b);return this},setRotationFromQuaternion:function(a){var b=
this.elements,c=a.x,q=a.y,p=a.z,z=a.w,w=c+c,E=q+q,d=p+p;a=c*w;var g=c*E,c=c*d,f=q*E,q=q*d,p=p*d,w=z*w,E=z*E,z=z*d;b[0]=1-(f+p);b[4]=g-z;b[8]=c+E;b[1]=g+z;b[5]=1-(a+p);b[9]=q-w;b[2]=c-E;b[6]=q+w;b[10]=1-(a+f);return this},lookAt:function(){var a=new $3Dmol.Vector3,b=new $3Dmol.Vector3,c=new $3Dmol.Vector3;return function(q,p,z){var w=this.elements;c.subVectors(q,p).normalize();0===c.length()&&(c.z=1);a.crossVectors(z,c).normalize();0===a.length()&&(c.x+=1E-4,a.crossVectors(z,c).normalize());b.crossVectors(c,
a);w[0]=a.x;w[4]=b.x;w[8]=c.x;w[1]=a.y;w[5]=b.y;w[9]=c.y;w[2]=a.z;w[6]=b.z;w[10]=c.z;return this}}(),multiplyMatrices:function(a,b){var c=a.elements,q=b.elements,p=this.elements,z=c[0],w=c[4],E=c[8],d=c[12],g=c[1],f=c[5],e=c[9],D=c[13],s=c[2],G=c[6],h=c[10],l=c[14],y=c[3],m=c[7],t=c[11],c=c[15],B=q[0],F=q[4],x=q[8],C=q[12],u=q[1],A=q[5],P=q[9],M=q[13],K=q[2],I=q[6],J=q[10],L=q[14],Q=q[3],R=q[7],N=q[11],q=q[15];p[0]=z*B+w*u+E*K+d*Q;p[4]=z*F+w*A+E*I+d*R;p[8]=z*x+w*P+E*J+d*N;p[12]=z*C+w*M+E*L+d*q;p[1]=
g*B+f*u+e*K+D*Q;p[5]=g*F+f*A+e*I+D*R;p[9]=g*x+f*P+e*J+D*N;p[13]=g*C+f*M+e*L+D*q;p[2]=s*B+G*u+h*K+l*Q;p[6]=s*F+G*A+h*I+l*R;p[10]=s*x+G*P+h*J+l*N;p[14]=s*C+G*M+h*L+l*q;p[3]=y*B+m*u+t*K+c*Q;p[7]=y*F+m*A+t*I+c*R;p[11]=y*x+m*P+t*J+c*N;p[15]=y*C+m*M+t*L+c*q;return this},multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[4]*=a;b[8]*=a;b[12]*=a;b[1]*=a;b[5]*=a;b[9]*=a;b[13]*=a;b[2]*=a;b[6]*=a;b[10]*=a;b[14]*=a;b[3]*=a;b[7]*=a;b[11]*=a;b[15]*=a;return this},transpose:function(){var a=this.elements,b;
b=a[1];a[1]=a[4];a[4]=b;b=a[2];a[2]=a[8];a[8]=b;b=a[6];a[6]=a[9];a[9]=b;b=a[3];a[3]=a[12];a[12]=b;b=a[7];a[7]=a[13];a[13]=b;b=a[11];a[11]=a[14];a[14]=b;return this},getPosition:function(){var a=new $3Dmol.Vector3;return function(){console.warn("DEPRECATED: Matrix4's .getPosition() has been removed. Use Vector3.getPositionFromMatrix( matrix ) instead.");var b=this.elements;return a.set(b[12],b[13],b[14])}}(),setPosition:function(a){var b=this.elements;b[12]=a.x;b[13]=a.y;b[14]=a.z;return this},getInverse:function(a,
b){var c=this.elements,q=a.elements,p=q[0],z=q[4],w=q[8],E=q[12],d=q[1],g=q[5],f=q[9],e=q[13],D=q[2],s=q[6],G=q[10],h=q[14],l=q[3],y=q[7],m=q[11],t=q[15];c[0]=f*h*y-e*G*y+e*s*m-g*h*m-f*s*t+g*G*t;c[4]=E*G*y-w*h*y-E*s*m+z*h*m+w*s*t-z*G*t;c[8]=w*e*y-E*f*y+E*g*m-z*e*m-w*g*t+z*f*t;c[12]=E*f*s-w*e*s-E*g*G+z*e*G+w*g*h-z*f*h;c[1]=e*G*l-f*h*l-e*D*m+d*h*m+f*D*t-d*G*t;c[5]=w*h*l-E*G*l+E*D*m-p*h*m-w*D*t+p*G*t;c[9]=E*f*l-w*e*l-E*d*m+p*e*m+w*d*t-p*f*t;c[13]=w*e*D-E*f*D+E*d*G-p*e*G-w*d*h+p*f*h;c[2]=g*h*l-e*s*l+
e*D*y-d*h*y-g*D*t+d*s*t;c[6]=E*s*l-z*h*l-E*D*y+p*h*y+z*D*t-p*s*t;c[10]=z*e*l-E*g*l+E*d*y-p*e*y-z*d*t+p*g*t;c[14]=E*g*D-z*e*D-E*d*s+p*e*s+z*d*h-p*g*h;c[3]=f*s*l-g*G*l-f*D*y+d*G*y+g*D*m-d*s*m;c[7]=z*G*l-w*s*l+w*D*y-p*G*y-z*D*m+p*s*m;c[11]=w*g*l-z*f*l-w*d*y+p*f*y+z*d*m-p*g*m;c[15]=z*f*D-w*g*D+w*d*s-p*f*s-z*d*G+p*g*G;c=q[0]*c[0]+q[1]*c[4]+q[2]*c[8]+q[3]*c[12];if(0===c){if(b)throw Error("Matrix4.getInverse(): can't invert matrix, determinant is 0");console.warn("Matrix4.getInverse(): can't invert matrix, determinant is 0");
this.identity();return this}this.multiplyScalar(1/c);return this},isReflected:function(){return 0>this.matrix3FromTopLeft().getDeterminant()},compose:function(){var a=new $3Dmol.Matrix4,b=new $3Dmol.Matrix4;return function(c,q,p){var z=this.elements;a.identity();a.setRotationFromQuaternion(q);b.makeScale(p.x,p.y,p.z);this.multiplyMatrices(a,b);z[12]=c.x;z[13]=c.y;z[14]=c.z;return this}}(),decompose:function(){var a=new $3Dmol.Vector3,b=new $3Dmol.Vector3,c=new $3Dmol.Vector3,q=new $3Dmol.Matrix4;
return function(p,z,w){var E=this.elements;a.set(E[0],E[1],E[2]);b.set(E[4],E[5],E[6]);c.set(E[8],E[9],E[10]);p=p instanceof $3Dmol.Vector3?p:new $3Dmol.Vector3;z=z instanceof $3Dmol.Quaternion?z:new $3Dmol.Quaternion;w=w instanceof $3Dmol.Vector3?w:new $3Dmol.Vector3;w.x=a.length();w.y=b.length();w.z=c.length();p.x=E[12];p.y=E[13];p.z=E[14];q.copy(this);q.elements[0]/=w.x;q.elements[1]/=w.x;q.elements[2]/=w.x;q.elements[4]/=w.y;q.elements[5]/=w.y;q.elements[6]/=w.y;q.elements[8]/=w.z;q.elements[9]/=
w.z;q.elements[10]/=w.z;z.setFromRotationMatrix(q);return[p,z,w]}}(),scale:function(a){var b=this.elements,c=a.x,q=a.y;a=a.z;b[0]*=c;b[4]*=q;b[8]*=a;b[1]*=c;b[5]*=q;b[9]*=a;b[2]*=c;b[6]*=q;b[10]*=a;b[3]*=c;b[7]*=q;b[11]*=a;return this},getMaxScaleOnAxis:function(){var a=this.elements;return Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1]+a[2]*a[2],Math.max(a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10])))},makeFrustum:function(a,b,c,q,p,z){var w=this.elements;w[0]=2*p/(b-a);w[4]=0;w[8]=(b+a)/
(b-a);w[12]=0;w[1]=0;w[5]=2*p/(q-c);w[9]=(q+c)/(q-c);w[13]=0;w[2]=0;w[6]=0;w[10]=-(z+p)/(z-p);w[14]=-2*z*p/(z-p);w[3]=0;w[7]=0;w[11]=-1;w[15]=0;return this},makePerspective:function(a,b,c,q){a=c*Math.tan($3Dmol.Math.degToRad(.5*a));var p=-a;return this.makeFrustum(p*b,a*b,p,a,c,q)},isEqual:function(a){a=a.elements;var b=this.elements;return b[0]==a[0]&&b[4]==a[4]&&b[8]==a[8]&&b[12]==a[12]&&b[1]==a[1]&&b[5]==a[5]&&b[9]==a[9]&&b[13]==a[13]&&b[2]==a[2]&&b[6]==a[6]&&b[10]==a[10]&&b[14]==a[14]&&b[3]==
a[3]&&b[7]==a[7]&&b[11]==a[11]&&b[15]==a[15]?!0:!1},clone:function(){var a=this.elements;return new $3Dmol.Matrix4(a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15])},isIdentity:function(){var a=this.elements;return 1==a[0]&&0==a[4]&&0==a[8]&&0==a[12]&&0==a[1]&&1==a[5]&&0==a[9]&&0==a[13]&&0==a[2]&&0==a[6]&&1==a[10]&&0==a[14]&&0==a[3]&&0==a[7]&&0==a[11]&&1==a[15]?!0:!1}};
$3Dmol.Ray=function(a,b){this.origin=void 0!==a?a:new $3Dmol.Vector3;this.direction=void 0!==b?b:new $3Dmol.Vector3};
$3Dmol.Ray.prototype={constructor:$3Dmol.Ray,set:function(a,b){this.origin.copy(a);this.direction.copy(b);return this},copy:function(a){this.origin.copy(a.origin);this.direction.copy(a.direction);return this},at:function(a,b){return(b||new $3Dmol.Vector3).copy(this.direction).multiplyScalar(a).add(this.origin)},recast:function(){var a=new $3Dmol.Vector3;return function(b){this.origin.copy(this.at(b,a));return this}}(),closestPointToPoint:function(a,b){var c=b||new $3Dmol.Vector3;c.subVectors(a,this.origin);
var q=c.dot(this.direction);return c.copy(this.direction).multiplyScalar(q).add(this.origin)},distanceToPoint:function(a){var b=new $3Dmol.Vector3;return function(a){var q=b.subVectors(a,this.origin).dot(this.direction);b.copy(this.direction).multiplyScalar(q).add(this.origin);return b.distanceTo(a)}}(),isIntersectionCylinder:function(){},isIntersectionSphere:function(a){return this.distanceToPoint(a.center)<=a.radius},isIntersectionPlane:function(a){return 0!==a.normal.dot(this.direction)||0===a.distanceToPoint(this.origin)?
!0:!1},distanceToPlane:function(a){var b=a.normal.dot(this.direction);if(0===b){if(0===a.distanceToPoint(this.origin))return 0}else return-(this.origin.dot(a.normal)+a.constant)/b},intersectPlane:function(a,b){var c=this.distanceToPlane(a);return void 0===c?void 0:this.at(c,b)},applyMatrix4:function(a){this.direction.add(this.origin).applyMatrix4(a);this.origin.applyMatrix4(a);this.direction.sub(this.origin);return this},equals:function(a){return a.origin.equals(this.origin)&&a.direction.equals(this.direction)},
clone:function(){return(new $3Dmol.Ray).copy(this)}};$3Dmol.Sphere=function(a,b){this.center=void 0!==a?a:new $3Dmol.Vector3;this.radius=void 0!==b?b:0};
$3Dmol.Sphere.prototype={constructor:$3Dmol.Sphere,set:function(a,b){this.center.copy(a);this.radius=b;return this},copy:function(a){this.center.copy(a.center);this.radius=a.radius;return this},applyMatrix4:function(a){this.center.applyMatrix4(a);this.radius*=a.getMaxScaleOnAxis();return this},translate:function(a){this.center.add(a);return this},equals:function(a){return a.center.equals(this.center)&&a.radius===this.radius},clone:function(){return(new $3Dmol.Sphere).copy(this)}};
$3Dmol.Cylinder=function(a,b,c){this.c1=void 0!==a?a:new $3Dmol.Vector3;this.c2=void 0!==b?b:new $3Dmol.Vector3;this.direction=(new $3Dmol.Vector3).subVectors(this.c2,this.c1).normalize();this.radius=void 0!==c?c:0};
$3Dmol.Cylinder.prototype={constructor:$3Dmol.Cylinder,copy:function(a){this.c1.copy(a.c1);this.c2.copy(a.c2);this.direction.copy(a.direction);this.radius=a.radius;return this},lengthSq:function(){var a=new $3Dmol.Vector3;return function(){return a.subVectors(this.c2,this.c1).lengthSq()}}(),applyMatrix4:function(a){this.direction.add(this.c1).applyMatrix4(a);this.c1.applyMatrix4(a);this.c2.applyMatrix4(a);this.direction.sub(this.c1).normalize();this.radius*=a.getMaxScaleOnAxis();return this}};
$3Dmol.Triangle=function(a,b,c){this.a=void 0!==a?a:new $3Dmol.Vector3;this.b=void 0!==b?b:new $3Dmol.Vector3;this.c=void 0!==c?c:new $3Dmol.Vector3};
$3Dmol.Triangle.prototype={constructor:$3Dmol.Triangle,copy:function(a){this.a.copy(a.a);this.b.copy(a.b);this.c.copy(a.c);return this},applyMatrix4:function(a){this.a.applyMatrix4(a);this.b.applyMatrix4(a);this.c.applyMatrix4(a);return this},getNormal:function(){var a=new $3Dmol.Vector3;return function(){var b=this.a.clone();b.sub(this.b);a.subVectors(this.c,this.b);b.cross(a);b.normalize();return b}}()};
$3Dmol.EventDispatcher=function(){var a={};this.addEventListener=function(b,c){void 0===a[b]&&(a[b]=[]);-1===a[b].indexOf(c)&&a[b].push(c)};this.removeEventListener=function(b,c){var q=a[b].indexOf(c);-1!==q&&a[b].splice(q,1)};this.dispatchEvent=function(b){var c=a[b.type];if(void 0!==c){b.target=this;for(var q=0,p=c.length;q<p;q++)c[q].call(this,b)}}};$3Dmol.Color=function(a){return 1<arguments.length?(this.r=arguments[0]||0,this.g=arguments[1]||0,this.b=arguments[2]||0,this):this.set(a)};
$3Dmol.Color.prototype={constructor:$3Dmol.Color,r:0,g:0,b:0,set:function(a){if(a instanceof $3Dmol.Color)return a.clone();"number"===typeof a?this.setHex(a):"object"===typeof a&&"r"in a&&"g"in a&&"b"in a&&(this.r=a.r,this.g=a.g,this.b=a.b)},setHex:function(a){a=Math.floor(a);this.r=(a>>16&255)/255;this.g=(a>>8&255)/255;this.b=(a&255)/255;return this},getHex:function(){var a=Math.round(255*this.r),b=Math.round(255*this.g),c=Math.round(255*this.b);return a<<16|b<<8|c},clone:function(){return new $3Dmol.Color(this.r,
this.g,this.b)},copy:function(a){this.r=a.r;this.g=a.g;this.b=a.b;return this},scaled:function(){var a={};a.r=Math.round(255*this.r);a.g=Math.round(255*this.g);a.b=Math.round(255*this.b);a.a=1;return a}};
$3Dmol.Object3D=function(){this.id=$3Dmol.Object3DIDCount++;this.name="";this.parent=void 0;this.children=[];this.position=new $3Dmol.Vector3;this.rotation=new $3Dmol.Vector3;this.matrix=new $3Dmol.Matrix4;this.matrixWorld=new $3Dmol.Matrix4;this.quaternion=new $3Dmol.Quaternion;this.eulerOrder="XYZ";this.up=new $3Dmol.Vector3(0,1,0);this.scale=new $3Dmol.Vector3(1,1,1);this.rotationAutoUpdate=this.matrixWorldNeedsUpdate=this.matrixAutoUpdate=!0;this.useQuaternion=!1;this.visible=!0};
$3Dmol.Object3D.prototype={constructor:$3Dmol.Object3D,lookAt:function(a){this.matrix.lookAt(a,this.position,this.up);this.rotationAutoUpdate&&(!0===this.useQuaternion?this.quaternion.copy(this.matrix.decompose()[1]):this.rotation.setEulerFromRotationMatrix(this.matrix,this.eulerOrder))},add:function(a){if(a===this)console.error("Can't add $3Dmol.Object3D to itself");else{a.parent=this;this.children.push(a);for(var b=this;void 0!==b.parent;)b=b.parent;void 0!==b&&b instanceof $3Dmol.Scene&&b.__addObject(a)}},
remove:function(a){var b=this.children.indexOf(a);if(-1!==b){a.parent=void 0;this.children.splice(b,1);for(b=this;void 0!==b.parent;)b=b.parent;void 0!==b&&b instanceof $3Dmol.Scene&&b.__removeObject(a)}},updateMatrix:function(){this.matrix.setPosition(this.position);!1===this.useQuaternion?this.matrix.setRotationFromEuler(this.rotation,this.eulerOrder):this.matrix.setRotationFromQuaternion(this.quaternion);1===this.scale.x&&1===this.scale.y&&1===this.scale.z||this.matrix.scale(this.scale);this.matrixWorldNeedsUpdate=
!0},updateMatrixWorld:function(a){!0===this.matrixAutoUpdate&&this.updateMatrix();if(!0===this.matrixWorldNeedsUpdate||!0===a)void 0===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix);this.matrixWorldNeedsUpdate=!1;for(a=0;a<this.children.length;a++)this.children[a].updateMatrixWorld(!0)},clone:function(a){void 0===a&&(a=new $3Dmol.Object3D);a.name=this.name;a.up.copy(this.up);a.position.copy(this.position);a.rotation.copy(this.rotation);
a.eulerOrder=this.eulerOrder;a.scale.copy(this.scale);a.rotationAutoUpdate=this.rotationAutoUpdate;a.matrix.copy(this.matrix);a.matrixWorld.copy(this.matrixWorld);a.quaternion.copy(this.quaternion);a.matrixAutoUpdate=this.matrixAutoUpdate;a.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate;a.useQuaternion=this.useQuaternion;a.visible=this.visible;for(var b=0;b<this.children.length;b++)a.add(this.children[b].clone());return a},setVisible:function(a){this.visible=a;for(var b=0;b<this.children.length;b++)this.children[b].setVisible(a)}};
$3Dmol.Object3DIDCount=0;
$3Dmol.Geometry=function(){var a=function(a){this.id=a||0;this.lineArray=this.faceArray=this.normalArray=this.colorArray=this.vertexArray=null;this.lineidx=this.faceidx=this.vertices=0};a.prototype.getNumVertices=function(){return this.vertices};a.prototype.getVertices=function(){return this.vertexArray};a.prototype.getCentroid=function(){for(var a=new $3Dmol.Vector3,b,c,w,E=0;E<this.vertices;++E)b=3*E,c=this.vertexArray[b],w=this.vertexArray[b+1],b=this.vertexArray[b+2],a.x+=c,a.y+=w,a.z+=b;a.divideScalar(this.vertices);
return a};a.prototype.setNormals=function(){var a=this.faceArray,b=this.vertexArray,c=this.normalArray;if(this.vertices&&this.faceidx)for(var w,E,d,g,f,e,D=0;D<a.length/3;++D)w=3*a[3*D],E=3*a[3*D+1],d=3*a[3*D+2],g=new $3Dmol.Vector3(b[w],b[w+1],b[w+2]),f=new $3Dmol.Vector3(b[E],b[E+1],b[E+2]),e=new $3Dmol.Vector3(b[d],b[d+1],b[d+2]),g.subVectors(g,f),e.subVectors(e,f),e.cross(g),g=e,g.normalize(),c[w]+=g.x,c[E]+=g.x,c[d]+=g.x,c[w+1]+=g.y,c[E+1]+=g.y,c[d+1]+=g.y,c[w+2]+=g.z,c[E+2]+=g.z,c[d+2]+=g.z};
a.prototype.setLineIndices=function(){if(this.faceidx){var a=this.faceArray,b=this.lineArray=new Uint16Array(2*this.faceidx);this.lineidx=2*this.faceidx;for(var c,w=0;w<this.faceidx/3;++w){c=3*w;lineoffset=2*c;var E=a[c],d=a[c+1];c=a[c+2];b[lineoffset]=E;b[lineoffset+1]=d;b[lineoffset+2]=E;b[lineoffset+3]=c;b[lineoffset+4]=d;b[lineoffset+5]=c}}};a.prototype.truncateArrayBuffers=function(a,b){a=!0===a?!0:!1;var c=this.colorArray,w=this.normalArray,E=this.faceArray,d=this.lineArray;this.vertexArray=
this.vertexArray.subarray(0,3*this.vertices);this.colorArray=c.subarray(0,3*this.vertices);a?(this.normalArray=w.subarray(0,3*this.vertices),this.faceArray=E.subarray(0,this.faceidx),this.lineArray=0<this.lineidx?d.subarray(0,this.lineidx):new Uint16Array):(this.normalArray=new Float32Array,this.faceArray=new Uint16Array,this.lineArray=new Uint16Array);b&&(this.normalArray&&(this.normalArray=new Float32Array(this.normalArray)),this.faceArray&&(this.faceArray=new Uint16Array(this.faceArray)),this.lineArray&&
(this.lineArray=new Uint16Array(this.lineArray)),this.vertexArray&&(this.vertexArray=new Float32Array(this.vertexArray)),this.colorArray&&(this.colorArray=new Float32Array(this.colorArray)));this.__inittedArrays=!0};var b=function(b){var c=new a(b.geometryGroups.length);b.geometryGroups.push(c);b.groups=b.geometryGroups.length;c.vertexArray=new Float32Array(196605);c.colorArray=new Float32Array(196605);b.mesh&&(c.normalArray=new Float32Array(196605),c.faceArray=new Uint16Array(393210),c.lineArray=
new Uint16Array(393210));return c},c=function(a){$3Dmol.EventDispatcher.call(this);this.id=$3Dmol.GeometryIDCount++;this.name="";this.hasTangents=!1;this.dynamic=!0;this.mesh=!0===a?!0:!1;this.buffersNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.elementsNeedUpdate=this.verticesNeedUpdate=!1;this.geometryGroups=[];this.groups=0};c.prototype={constructor:c,updateGeoGroup:function(a){var c=0<this.groups?this.geometryGroups[this.groups-1]:null;if(!c||65535<c.vertices+(a||0))c=b(this);return c},
addGeoGroup:function(){return b(this)},setUpNormals:function(a){a=a||!1;for(var b=0;b<this.groups;b++)this.geometryGroups[b].setNormals(a)},setUpWireframe:function(){for(var a=0;a<this.groups;a++)this.geometryGroups[a].setLineIndices()},initTypedArrays:function(){for(var a=0;a<this.groups;a++){var b=this.geometryGroups[a];!0!==b.__inittedArrays&&b.truncateArrayBuffers(this.mesh,!1)}},dispose:function(){this.dispatchEvent({type:"dispose"})}};return c}();
Object.defineProperty($3Dmol.Geometry.prototype,"vertices",{get:function(){for(var a=0,b=0;b<this.groups;b++)a+=this.geometryGroups[b].vertices;return a}});$3Dmol.GeometryIDCount=0;
$3Dmol.Raycaster=function(){var a=function(a,b,d,f){this.ray=new $3Dmol.Ray(a,b);0<this.ray.direction.lengthSq()&&this.ray.direction.normalize();this.near=f||0;this.far=d||Infinity},b=new $3Dmol.Sphere,c=new $3Dmol.Cylinder,q=new $3Dmol.Triangle,p=new $3Dmol.Vector3,z=new $3Dmol.Vector3,w=new $3Dmol.Vector3,E=new $3Dmol.Vector3;new $3Dmol.Ray;new $3Dmol.Vector3;var d=new $3Dmol.Vector3;new $3Dmol.Matrix4;var g=function(a,b){return a.distance-b.distance},f=function(a){return Math.min(Math.max(a,-1),
1)};a.prototype.precision=1E-4;a.prototype.linePrecision=.2;a.prototype.set=function(a,b){this.ray.set(a,b)};a.prototype.intersectObjects=function(a,D){for(var s=[],G=0,h=D.length;G<h;G++)a:{var l=a,y=D[G],m=s;d.getPositionFromMatrix(l.matrixWorld);if(!0===y.clickable&&void 0!==y.intersectionShape){var t=y.intersectionShape,B=this.linePrecision,B=B*l.matrixWorld.getMaxScaleOnAxis(),B=B*B;if(void 0!==y.boundingSphere&&y.boundingSphere instanceof $3Dmol.Sphere&&(b.copy(y.boundingSphere),b.applyMatrix4(l.matrixWorld),
!this.ray.isIntersectionSphere(b)))break a;for(var F=void 0,x=void 0,C=void 0,u=void 0,A=C=void 0,P=void 0,M=void 0,K=void 0,I=void 0,J=I=A=u=void 0,F=0,x=t.triangle.length;F<x;F++)t.triangle[F]instanceof $3Dmol.Triangle&&(q.copy(t.triangle[F]),q.applyMatrix4(l.matrixWorld),C=q.getNormal(),u=this.ray.direction.dot(C),0<=u||(p.subVectors(q.a,this.ray.origin),P=C.dot(p)/u,0>P||(z.copy(this.ray.direction).multiplyScalar(P).add(this.ray.origin),z.sub(q.a),w.copy(q.b).sub(q.a),E.copy(q.c).sub(q.a),u=w.dot(E),
C=w.lengthSq(),A=E.lengthSq(),A=(C*z.dot(E)-u*z.dot(w))/(C*A-u*u),0>A||1<A||(u=(z.dot(w)-A*u)/C,0>u||1<u||1<u+A||m.push({clickable:y,distance:P})))));F=0;for(x=t.cylinder.length;F<x;F++)t.cylinder[F]instanceof $3Dmol.Cylinder&&(c.copy(t.cylinder[F]),c.applyMatrix4(l.matrixWorld),p.subVectors(c.c1,this.ray.origin),C=p.dot(c.direction),A=p.dot(this.ray.direction),u=f(this.ray.direction.dot(c.direction)),K=1-u*u,0!==K&&(I=(u*A-C)/K,J=(A-u*C)/K,z.copy(c.direction).multiplyScalar(I).add(c.c1),w.copy(this.ray.direction).multiplyScalar(J).add(this.ray.origin),
M=E.subVectors(z,w).lengthSq(),I=c.radius*c.radius,M<=I&&(I=(u*C-A)*(u*C-A)-K*(p.lengthSq()-C*C-I),A=0>=I?P=Math.sqrt(M):P=(A-u*C-Math.sqrt(I))/K,u=u*A-C,0>u||u*u>c.lengthSq()||0>A||m.push({clickable:y,distance:P}))));F=0;for(x=t.line.length;F<x;F+=2)z.copy(t.line[F]),z.applyMatrix4(l.matrixWorld),w.copy(t.line[F+1]),w.applyMatrix4(l.matrixWorld),E.subVectors(w,z),P=E.lengthSq(),E.normalize(),p.subVectors(z,this.ray.origin),lineProj=p.dot(E),A=p.dot(this.ray.direction),u=f(this.ray.direction.dot(E)),
K=1-u*u,0!==K&&(I=(u*A-lineProj)/K,J=(A-u*lineProj)/K,z.add(E.multiplyScalar(I)),w.copy(this.ray.direction).multiplyScalar(J).add(this.ray.origin),M=E.subVectors(w,z).lengthSq(),M<B&&I*I<P&&m.push({clickable:y,distance:J}));F=0;for(x=t.sphere.length;F<x;F++)if(t.sphere[F]instanceof $3Dmol.Sphere&&(b.copy(t.sphere[F]),b.applyMatrix4(l.matrixWorld),this.ray.isIntersectionSphere(b))){z.subVectors(b.center,this.ray.origin);l=z.dot(this.ray.direction);I=l*l-(z.lengthSq()-b.radius*b.radius);if(0>l)break a;
P=0>=I?l:l-Math.sqrt(I);m.push({clickable:y,distance:P});break a}}}s.sort(g);return s};return a}();$3Dmol.Projector=function(){new $3Dmol.Matrix4;var a=new $3Dmol.Matrix4;this.projectVector=function(b,c){c.matrixWorldInverse.getInverse(c.matrixWorld);a.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse);return b.applyProjection(a)};this.unprojectVector=function(b,c){c.projectionMatrixInverse.getInverse(c.projectionMatrix);a.multiplyMatrices(c.matrixWorld,c.projectionMatrixInverse);return b.applyProjection(a)}};
$3Dmol.Camera=function(a,b,c,q){$3Dmol.Object3D.call(this);this.fov=void 0!==a?a:50;this.aspect=void 0!==b?b:1;this.near=void 0!==c?c:.1;this.far=void 0!==q?q:2E3;this.projectionMatrix=new $3Dmol.Matrix4;this.projectionMatrixInverse=new $3Dmol.Matrix4;this.matrixWorldInverse=new $3Dmol.Matrix4;this.updateProjectionMatrix()};$3Dmol.Camera.prototype=Object.create($3Dmol.Object3D.prototype);
$3Dmol.Camera.prototype.lookAt=function(a){this.matrix.lookAt(this.position,a,this.up);this.rotationAutoUpdate&&(!1===this.useQuaternion?this.rotation.setEulerFromRotationMatrix(this.matrix,this.eulerOrder):this.quaternion.copy(this.matrix.decompose()[1]))};$3Dmol.Camera.prototype.updateProjectionMatrix=function(){this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far)};
$3Dmol.SpritePlugin=function(){function a(a,b){return a.z!==b.z?b.z-a.z:b.id-a.id}var b,c,q,p,z,w,E,d,g,f;this.init=function(a){b=a.context;c=a;q=a.getPrecision();p=new Float32Array(16);z=new Uint16Array(6);a=0;p[a++]=-1;p[a++]=-1;p[a++]=0;p[a++]=0;p[a++]=1;p[a++]=-1;p[a++]=1;p[a++]=0;p[a++]=1;p[a++]=1;p[a++]=1;p[a++]=1;p[a++]=-1;p[a++]=1;p[a++]=0;p[a++]=1;a=0;z[a++]=0;z[a++]=1;z[a++]=2;z[a++]=0;z[a++]=2;z[a++]=3;w=b.createBuffer();E=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,w);b.bufferData(b.ARRAY_BUFFER,
p,b.STATIC_DRAW);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,E);b.bufferData(b.ELEMENT_ARRAY_BUFFER,z,b.STATIC_DRAW);a=$3Dmol.ShaderLib.sprite;var D=q,s=b.createProgram(),G=b.createShader(b.FRAGMENT_SHADER),h=b.createShader(b.VERTEX_SHADER),D="precision "+D+" float;\n";b.shaderSource(G,D+a.fragmentShader);b.shaderSource(h,D+a.vertexShader);b.compileShader(G);b.compileShader(h);b.getShaderParameter(G,b.COMPILE_STATUS)&&b.getShaderParameter(h,b.COMPILE_STATUS)?(b.attachShader(s,G),b.attachShader(s,h),b.linkProgram(s),
b.getProgramParameter(s,b.LINK_STATUS)||console.error("Could not initialize shader"),a=s):(console.error(b.getShaderInfoLog(G)),console.error("could not initialize shader"),a=null);d=a;g={};f={};g.position=b.getAttribLocation(d,"position");g.uv=b.getAttribLocation(d,"uv");f.uvOffset=b.getUniformLocation(d,"uvOffset");f.uvScale=b.getUniformLocation(d,"uvScale");f.rotation=b.getUniformLocation(d,"rotation");f.scale=b.getUniformLocation(d,"scale");f.alignment=b.getUniformLocation(d,"alignment");f.color=
b.getUniformLocation(d,"color");f.map=b.getUniformLocation(d,"map");f.opacity=b.getUniformLocation(d,"opacity");f.useScreenCoordinates=b.getUniformLocation(d,"useScreenCoordinates");f.screenPosition=b.getUniformLocation(d,"screenPosition");f.modelViewMatrix=b.getUniformLocation(d,"modelViewMatrix");f.projectionMatrix=b.getUniformLocation(d,"projectionMatrix");f.fogType=b.getUniformLocation(d,"fogType");f.fogDensity=b.getUniformLocation(d,"fogDensity");f.fogNear=b.getUniformLocation(d,"fogNear");f.fogFar=
b.getUniformLocation(d,"fogFar");f.fogColor=b.getUniformLocation(d,"fogColor");f.alphaTest=b.getUniformLocation(d,"alphaTest")};this.render=function(e,D,s,G){var h=e.__webglSprites,l=h.length;if(l){var y=g,m=f,t=.5*s,B=.5*G;b.useProgram(d);b.enableVertexAttribArray(y.position);b.enableVertexAttribArray(y.uv);b.disable(b.CULL_FACE);b.enable(b.BLEND);b.bindBuffer(b.ARRAY_BUFFER,w);b.vertexAttribPointer(y.position,2,b.FLOAT,!1,16,0);b.vertexAttribPointer(y.uv,2,b.FLOAT,!1,16,8);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,
E);b.uniformMatrix4fv(m.projectionMatrix,!1,D.projectionMatrix.elements);b.activeTexture(b.TEXTURE0);b.uniform1i(m.map,0);var F=y=0;(y=e.fog)?(b.uniform3f(m.fogColor,y.color.r,y.color.g,y.color.b),b.uniform1f(m.fogNear,y.near),b.uniform1f(m.fogFar,y.far),b.uniform1i(m.fogType,1),F=y=1):(b.uniform1i(m.fogType,0),F=y=0);var x,C,u,A=[];for(x=0;x<l;x++)C=h[x],u=C.material,C.visible&&0!==u.opacity&&(u.useScreenCoordinates?C.z=-C.position.z:(C._modelViewMatrix.multiplyMatrices(D.matrixWorldInverse,C.matrixWorld),
C.z=-C._modelViewMatrix.elements[14]));h.sort(a);for(x=0;x<l;x++)C=h[x],u=C.material,C.visible&&0!==u.opacity&&u.map&&u.map.image&&u.map.image.width&&(b.uniform1f(m.alphaTest,u.alphaTest),D=u.map.image.height,A[0]=u.map.image.width*c.devicePixelRatio/s,A[1]=D*c.devicePixelRatio/G,!0===u.useScreenCoordinates?(b.uniform1i(m.useScreenCoordinates,1),b.uniform3f(m.screenPosition,(C.position.x*c.devicePixelRatio-t)/t,(B-C.position.y*c.devicePixelRatio)/B,Math.max(0,Math.min(1,C.position.z)))):(b.uniform1i(m.useScreenCoordinates,
0),b.uniformMatrix4fv(m.modelViewMatrix,!1,C._modelViewMatrix.elements)),D=e.fog&&u.fog?F:0,y!==D&&(b.uniform1i(m.fogType,D),y=D),D=1/(u.scaleByViewport?G:1),A[0]=A[0]*D*C.scale.x,A[1]=A[1]*D*C.scale.y,b.uniform2f(m.uvScale,u.uvScale.x,u.uvScale.y),b.uniform2f(m.uvOffset,u.uvOffset.x,u.uvOffset.y),b.uniform2f(m.alignment,u.alignment.x,u.alignment.y),b.uniform1f(m.opacity,u.opacity),b.uniform3f(m.color,u.color.r,u.color.g,u.color.b),b.uniform1f(m.rotation,C.rotation),b.uniform2fv(m.scale,A),c.setDepthTest(u.depthTest),
c.setDepthWrite(u.depthWrite),c.setTexture(u.map,0),b.drawElements(b.TRIANGLES,6,b.UNSIGNED_SHORT,0));b.enable(b.CULL_FACE)}}};$3Dmol.Light=function(a,b){$3Dmol.Object3D.call(this);this.color=new $3Dmol.Color(a);this.position=new $3Dmol.Vector3(0,1,0);this.target=new $3Dmol.Object3D;this.intensity=void 0!==b?b:1;this.onlyShadow=this.castShadow=!1};$3Dmol.Light.prototype=Object.create($3Dmol.Object3D.prototype);
$3Dmol.Material=function(){$3Dmol.EventDispatcher.call(this);this.id=$3Dmol.MaterialIdCount++;this.name="";this.side=$3Dmol.FrontSide;this.opacity=1;this.transparent=!1;this.stencilTest=this.depthWrite=this.depthTest=!0;this.polygonOffset=!1;this.alphaTest=this.polygonOffsetUnits=this.polygonOffsetFactor=0;this.needsUpdate=this.visible=!0};
$3Dmol.Material.prototype.setValues=function(a){if(void 0!==a)for(var b in a){var c=a[b];if(void 0===c)console.warn("$3Dmol.Material: '"+b+"' parameter is undefined.");else if(b in this){var q=this[b];q instanceof $3Dmol.Color&&c instanceof $3Dmol.Color?q.copy(c):q instanceof $3Dmol.Color?q.set(c):q instanceof $3Dmol.Vector3&&c instanceof $3Dmol.Vector3?q.copy(c):this[b]=c}}};
$3Dmol.Material.prototype.clone=function(a){void 0===a&&(a=new $3Dmol.Material);a.name=this.name;a.side=this.side;a.opacity=this.opacity;a.transparent=this.transparent;a.depthTest=this.depthTest;a.depthWrite=this.depthWrite;a.stencilTest=this.stencilTest;a.polygonOffset=this.polygonOffset;a.polygonOffsetFactor=this.polygonOffsetFactor;a.polygonOffsetUnits=this.polygonOffsetUnits;a.alphaTest=this.alphaTest;a.overdraw=this.overdraw;a.visible=this.visible;return a};
$3Dmol.Material.prototype.dispose=function(){this.dispatchEvent({type:"dispose"})};$3Dmol.MaterialIdCount=0;$3Dmol.LineBasicMaterial=function(a){$3Dmol.Material.call(this);this.color=new $3Dmol.Color(16777215);this.linewidth=1;this.linejoin=this.linecap="round";this.vertexColors=!1;this.fog=!0;this.shaderID="basic";this.setValues(a)};$3Dmol.LineBasicMaterial.prototype=Object.create($3Dmol.Material.prototype);
$3Dmol.LineBasicMaterial.prototype.clone=function(){var a=new $3Dmol.LineBasicMaterial;$3Dmol.Material.prototype.clone.call(this,a);a.color.copy(this.color);return a};
$3Dmol.MeshLambertMaterial=function(a){$3Dmol.Material.call(this);this.color=new $3Dmol.Color(16777215);this.ambient=new $3Dmol.Color(1048575);this.emissive=new $3Dmol.Color(0);this.wrapAround=!1;this.wrapRGB=new $3Dmol.Vector3(1,1,1);this.envMap=this.specularMap=this.lightMap=this.map=null;this.reflectivity=1;this.refractionRatio=.98;this.fog=!0;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.shading=$3Dmol.SmoothShading;this.shaderID="lambert";
this.vertexColors=$3Dmol.NoColors;this.skinning=!1;this.setValues(a)};$3Dmol.MeshLambertMaterial.prototype=Object.create($3Dmol.Material.prototype);
$3Dmol.MeshLambertMaterial.prototype.clone=function(a){"undefined"===typeof a&&(a=new $3Dmol.MeshLambertMaterial);$3Dmol.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.ambient.copy(this.ambient);a.emissive.copy(this.emissive);a.wrapAround=this.wrapAround;a.wrapRGB.copy(this.wrapRGB);a.map=this.map;a.lightMap=this.lightMap;a.specularMap=this.specularMap;a.envMap=this.envMap;a.combine=this.combine;a.reflectivity=this.reflectivity;a.refractionRatio=this.refractionRatio;a.fog=this.fog;
a.shading=this.shading;a.shaderID=this.shaderID;a.vertexColors=this.vertexColors;a.skinning=this.skinning;a.morphTargets=this.morphTargets;a.morphNormals=this.morphNormals;return a};$3Dmol.MeshDoubleLambertMaterial=function(a){$3Dmol.MeshLambertMaterial.call(this,a);this.shaderID="lambertdouble";this.side=$3Dmol.DoubleSide};$3Dmol.MeshDoubleLambertMaterial.prototype=Object.create($3Dmol.MeshLambertMaterial.prototype);
$3Dmol.MeshDoubleLambertMaterial.prototype.clone=function(){var a=new $3Dmol.MeshDoubleLambertMaterial;$3Dmol.MeshLambertMaterial.prototype.clone.call(this,a);return a};$3Dmol.MeshOutlineMaterial=function(a){$3Dmol.Material.call(this);a=a||{};this.fog=!0;this.shaderID="outline";this.wireframe=!1;this.outlineColor=a.color||new $3Dmol.Color(0,0,0);this.outlineWidth=a.width||.1;this.outlinePushback=a.pushback||1};$3Dmol.MeshOutlineMaterial.prototype=Object.create($3Dmol.Material.prototype);
$3Dmol.MeshOutlineMaterial.prototype.clone=function(a){"undefined"===typeof a&&(a=new $3Dmol.MeshOutlineMaterial);$3Dmol.Material.prototype.clone.call(this,a);a.fog=this.fog;a.shaderID=this.shaderID;a.wireframe=this.wireframe;return a};
$3Dmol.ImposterMaterial=function(a){$3Dmol.Material.call(this);this.color=new $3Dmol.Color(16777215);this.ambient=new $3Dmol.Color(1048575);this.emissive=new $3Dmol.Color(0);this.imposter=!0;this.wrapAround=!1;this.wrapRGB=new $3Dmol.Vector3(1,1,1);this.envMap=this.specularMap=this.lightMap=this.map=null;this.reflectivity=1;this.refractionRatio=.98;this.fog=!0;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.shading=$3Dmol.SmoothShading;this.shaderID=
"sphereimposter";this.vertexColors=$3Dmol.NoColors;this.skinning=!1;this.setValues(a)};$3Dmol.ImposterMaterial.prototype=Object.create($3Dmol.Material.prototype);
$3Dmol.ImposterMaterial.prototype.clone=function(){var a=new $3Dmol.ImposterMaterial;$3Dmol.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.ambient.copy(this.ambient);a.emissive.copy(this.emissive);a.wrapAround=this.wrapAround;a.wrapRGB.copy(this.wrapRGB);a.map=this.map;a.lightMap=this.lightMap;a.specularMap=this.specularMap;a.envMap=this.envMap;a.combine=this.combine;a.reflectivity=this.reflectivity;a.refractionRatio=this.refractionRatio;a.fog=this.fog;a.shading=this.shading;a.shaderID=
this.shaderID;a.vertexColors=this.vertexColors;a.skinning=this.skinning;a.morphTargets=this.morphTargets;a.morphNormals=this.morphNormals;return a};
$3Dmol.SpriteMaterial=function(a){$3Dmol.Material.call(this);this.color=new $3Dmol.Color(16777215);this.map=new $3Dmol.Texture;this.useScreenCoordinates=!0;this.depthTest=!this.useScreenCoordinates;this.sizeAttenuation=!this.useScreenCoordinates;this.scaleByViewPort=!this.sizeAttenuation;this.alignment=$3Dmol.SpriteAlignment.center.clone();this.fog=!1;this.uvOffset=new $3Dmol.Vector2(0,0);this.uvScale=new $3Dmol.Vector2(1,1);this.setValues(a);a=a||{};void 0===a.depthTest&&(this.depthTest=!this.useScreenCoordinates);
void 0===a.sizeAttenuation&&(this.sizeAttenuation=!this.useScreenCoordinates);void 0===a.scaleByViewPort&&(this.scaleByViewPort=!this.sizeAttenuation)};$3Dmol.SpriteMaterial.prototype=Object.create($3Dmol.Material.prototype);
$3Dmol.SpriteMaterial.prototype.clone=function(){var a=new $3Dmol.SpriteMaterial;$3Dmol.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.map=this.map;a.useScreenCoordinates=useScreenCoordinates;a.sizeAttenuation=this.sizeAttenuation;a.scaleByViewport=this.scaleByViewPort;a.alignment.copy(this.alignment);a.uvOffset.copy(this.uvOffset);return a};$3Dmol.SpriteAlignment={};$3Dmol.SpriteAlignment.topLeft=new $3Dmol.Vector2(1,-1);$3Dmol.SpriteAlignment.topCenter=new $3Dmol.Vector2(0,-1);
$3Dmol.SpriteAlignment.topRight=new $3Dmol.Vector2(-1,-1);$3Dmol.SpriteAlignment.centerLeft=new $3Dmol.Vector2(1,0);$3Dmol.SpriteAlignment.center=new $3Dmol.Vector2(0,0);$3Dmol.SpriteAlignment.centerRight=new $3Dmol.Vector2(-1,0);$3Dmol.SpriteAlignment.bottomLeft=new $3Dmol.Vector2(1,1);$3Dmol.SpriteAlignment.bottomCenter=new $3Dmol.Vector2(0,1);$3Dmol.SpriteAlignment.bottomRight=new $3Dmol.Vector2(-1,1);
$3Dmol.Texture=function(a){$3Dmol.EventDispatcher.call(this);this.id=$3Dmol.TextureIdCount++;this.name="";this.image=a;this.mipmaps=[];this.mapping=new $3Dmol.UVMapping;this.wrapT=this.wrapS=$3Dmol.ClampToEdgeWrapping;this.magFilter=$3Dmol.LinearFilter;this.minFilter=$3Dmol.LinearMipMapLinearFilter;this.anisotropy=1;this.format=$3Dmol.RGBAFormat;this.type=$3Dmol.UnsignedByteType;this.offset=new $3Dmol.Vector2(0,0);this.repeat=new $3Dmol.Vector2(1,1);this.generateMipmaps=!0;this.premultiplyAlpha=!1;
this.flipY=!0;this.unpackAlignment=4;this.needsUpdate=!1;this.onUpdate=null};
$3Dmol.Texture.prototype={constructor:$3Dmol.Texture,clone:function(a){void 0===a&&(a=new $3Dmol.Texture);a.image=this.image;a.mipmaps=this.mipmaps.slice(0);a.mapping=this.mapping;a.wrapS=this.wrapS;a.wrapT=this.wrapT;a.magFilter=this.magFilter;a.minFilter=this.minFilter;a.anisotropy=this.anisotropy;a.format=this.format;a.type=this.type;a.offset.copy(this.offset);a.repeat.copy(this.repeat);a.generateMipmaps=this.generateMipmaps;a.premultiplyAlpha=this.premultiplyAlpha;a.flipY=this.flipY;a.unpackAlignment=
this.unpackAlignment;return a},dispose:function(){this.dispatchEvent({type:"dispose"})}};$3Dmol.TextureIdCount=0;$3Dmol.FrontSide=0;$3Dmol.BackSide=1;$3Dmol.DoubleSide=2;$3Dmol.NoShading=0;$3Dmol.FlatShading=1;$3Dmol.SmoothShading=2;$3Dmol.NoColors=0;$3Dmol.FaceColors=1;$3Dmol.VertexColors=2;$3Dmol.MultiplyOperation=0;$3Dmol.MixOperation=1;$3Dmol.AddOperation=2;$3Dmol.UVMapping=function(){};$3Dmol.ClampToEdgeWrapping=1001;$3Dmol.LinearFilter=1006;$3Dmol.LinearMipMapLinearFilter=1008;
$3Dmol.UnsignedByteType=1009;$3Dmol.RGBAFormat=1021;$3Dmol.Line=function(a,b,c){$3Dmol.Object3D.call(this);this.geometry=a;this.material=void 0!==b?b:new $3Dmol.LineBasicMaterial({color:16777215*Math.random()});this.type=void 0!==c?c:$3Dmol.LineStrip};$3Dmol.LineStrip=0;$3Dmol.LinePieces=1;$3Dmol.Line.prototype=Object.create($3Dmol.Object3D.prototype);
$3Dmol.Line.prototype.clone=function(a){void 0===a&&(a=new $3Dmol.Line(this.geometry,this.material,this.type));$3Dmol.Object3D.prototype.clone.call(this,a);return a};$3Dmol.Mesh=function(a,b){$3Dmol.Object3D.call(this);this.geometry=a;this.material=void 0!==b?b:new $3Dmol.MeshBasicMaterial({color:16777215*Math.random(),wireframe:!0})};$3Dmol.Mesh.prototype=Object.create($3Dmol.Object3D.prototype);
$3Dmol.Mesh.prototype.clone=function(a){void 0===a&&(a=new $3Dmol.Mesh(this.geometry,this.material));$3Dmol.Object3D.prototype.clone.call(this,a);return a};$3Dmol.Sprite=function(a){$3Dmol.Object3D.call(this);this.material=void 0!==a?a:new $3Dmol.SpriteMaterial;this.rotation3d=this.rotation;this.rotation=0};$3Dmol.Sprite.prototype=Object.create($3Dmol.Object3D.prototype);
$3Dmol.Sprite.prototype.updateMatrix=function(){this.matrix.setPosition(this.position);this.rotation3d.set(0,0,this.rotation);this.matrix.setRotationFromEuler(this.rotation3d);1===this.scale.x&&1===this.scale.y||this.matrix.scale(this.scale);this.matrixWorldNeedsUpdate=!0};$3Dmol.Sprite.prototype.clone=function(a){void 0===a&&(a=new $3Dmol.Sprite(this.material));$3Dmol.Object3D.prototype.clone.call(this,a);return a};
$3Dmol.Renderer=function(a){function b(a){S[a]||(H.enableVertexAttribArray(a),S[a]=!0)}function c(a,b){var d;"fragment"===a?d=H.createShader(H.FRAGMENT_SHADER):"vertex"===a&&(d=H.createShader(H.VERTEX_SHADER));H.shaderSource(d,b);H.compileShader(d);return H.getShaderParameter(d,H.COMPILE_STATUS)?d:(console.error(H.getShaderInfoLog(d)),console.error("could not initialize shader"),null)}function q(a,b,d,f,e,u,g,c){var A,w,D;b?(w=a.length-1,c=b=-1):(w=0,b=a.length,c=1);for(var m=w;m!==b;m+=c)if(A=a[m],
A.render&&(w=A.object,D=A.buffer,A=A[d])){g&&l.setBlending(!0);l.setDepthTest(A.depthTest);l.setDepthWrite(A.depthWrite);var s=A.polygonOffset;null!==s&&(s?H.enable(H.POLYGON_OFFSET_FILL):H.disable(H.POLYGON_OFFSET_FILL));s=w._modelViewMatrix.isReflected();l.setMaterialFaces(A,s);l.renderBuffer(f,e,u,A,D,w);h&&!A.wireframe&&"basic"!==A.shaderID&&0!==A.opacity&&l.renderBuffer(f,e,u,h,D,w)}}function p(a){return 0===(a&a-1)}function z(a){return a===$3Dmol.UnsignedByteType?H.UNSIGNED_BYTE:a===$3Dmol.RGBAFormat?
H.RGBA:0}a=a||{};var w=void 0!==a.canvas?a.canvas:document.createElement("canvas"),E=void 0!==a.precision?a.precision:"highp",d=void 0!==a.alpha?a.alpha:!0,g=void 0!==a.premultipliedAlpha?a.premultipliedAlpha:!0,f=void 0!==a.antialias?a.antialias:!1,e=void 0!==a.stencil?a.stencil:!0,D=void 0!==a.preserveDrawingBuffer?a.preserveDrawingBuffer:!1,s=void 0!==a.clearColor?new $3Dmol.Color(a.clearColor):new $3Dmol.Color(0),G=void 0!==a.clearAlpha?a.clearAlpha:0,h=void 0!==a.outline?new $3Dmol.MeshOutlineMaterial(a.outline):
null;this.domElement=w;this.context=null;this.devicePixelRatio=void 0!==a.devicePixelRatio?a.devicePixelRatio:void 0!==self.devicePixelRatio?self.devicePixelRatio:1;this.autoUpdateScene=this.autoUpdateObjects=this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0;this.renderPluginsPost=[];this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}};var l=this,y=[],m=0,t=null,B=-1,F=null,x=null,C=0,u=-1,A=-1,P=-1,M=-1,
K=null,I=0,J=0,L=0,Q=0,R=0,N=0,S={},O=new $3Dmol.Matrix4,U=new $3Dmol.Vector3,T=new $3Dmol.Vector3,X=!0,aa=[0,0,0],Y=[],V=[],H;try{if(!(H=w.getContext("experimental-webgl",{alpha:d,premultipliedAlpha:g,antialias:f,stencil:e,preserveDrawingBuffer:D}))&&!(H=w.getContext("webgl",{alpha:d,premultipliedAlpha:g,antialias:f,stencil:e,preserveDrawingBuffer:D})))throw"Error creating WebGL context.";}catch(da){console.error(da)}H.getExtension("EXT_frag_depth");H.clearColor(0,0,0,1);H.clearDepth(1);H.clearStencil(0);
H.enable(H.DEPTH_TEST);H.depthFunc(H.LEQUAL);H.frontFace(H.CCW);H.cullFace(H.BACK);H.enable(H.CULL_FACE);H.enable(H.BLEND);H.blendEquation(H.FUNC_ADD);H.blendFunc(H.SRC_ALPHA,H.ONE_MINUS_SRC_ALPHA);H.clearColor(s.r,s.g,s.b,G);H.getExtension("EXT_frag_depth");this.context=H;this.getContext=function(){return H};this.getPrecision=function(){return E};this.setClearColorHex=function(a,b){s.setHex(a);G=b;H.clearColor(s.r,s.g,s.b,G)};this.enableOutline=function(a){h=new $3Dmol.MeshOutlineMaterial(a)};this.disableOutline=
function(){h=null};this.setSize=function(a,b){w.width=a*this.devicePixelRatio;w.height=b*this.devicePixelRatio;w.style.width=a+"px";w.style.height=b+"px";this.setViewport(0,0,w.width,w.height)};this.setViewport=function(a,b,d,f){I=void 0!==a?a:0;J=void 0!==b?b:0;L=void 0!==d?d:w.width;Q=void 0!==f?f:w.height;H.viewport(I,J,L,Q)};this.clear=function(a,b,d){var f=0;if(void 0===a||a)f|=H.COLOR_BUFFER_BIT;if(void 0===b||b)f|=H.DEPTH_BUFFER_BIT;if(void 0===d||d)f|=H.STENCIL_BUFFER_BIT;H.clear(f)};this.clearTarget=
function(a,b,d){this.clear(a,b,d)};this.setMaterialFaces=function(a,b){var d=a.side===$3Dmol.DoubleSide,f=a.side===$3Dmol.BackSide,f=b?!f:f;u!==d&&(d?H.disable(H.CULL_FACE):H.enable(H.CULL_FACE),u=d);A!==f&&(f?H.frontFace(H.CW):H.frontFace(H.CCW),A=f)};this.setDepthTest=function(a){P!==a&&(a?H.enable(H.DEPTH_TEST):H.disable(H.DEPTH_TEST),P=a)};this.setDepthWrite=function(a){M!==a&&(H.depthMask(a),M=a)};this.setBlending=function(a){a?(H.enable(H.BLEND),H.blendEquationSeparate(H.FUNC_ADD,H.FUNC_ADD),
H.blendFuncSeparate(H.SRC_ALPHA,H.ONE_MINUS_SRC_ALPHA,H.ONE,H.ONE_MINUS_SRC_ALPHA)):H.disable(H.BLEND)};this.addPostPlugin=function(a){a.init(this);this.renderPluginsPost.push(a)};var Z=function(a){a=a.target;a.removeEventListener("dispose",Z);a.__webglInit=void 0;void 0!==a.__webglVertexBuffer&&H.deleteBuffer(a.__webglVertexBuffer);void 0!==a.__webglColorBuffer&&H.deleteBuffer(a.__webglColorBuffer);if(void 0!==a.geometryGroups)for(var b=0,d=a.groups;b<d;b++){var f=a.geometryGroups[b];void 0!==f.__webglVertexBuffer&&
H.deleteBuffer(f.__webglVertexBuffer);void 0!==f.__webglColorBuffer&&H.deleteBuffer(f.__webglColorBuffer);void 0!==f.__webglNormalBuffer&&H.deleteBuffer(f.__webglNormalBuffer);void 0!==f.__webglFaceBuffer&&H.deleteBuffer(f.__webglFaceBuffer);void 0!==f.__webglLineBuffer&&H.deleteBuffer(f.__webglLineBuffer)}l.info.memory.geometries--},ba=function(a){a=a.target;a.removeEventListener("dispose",ba);a.image&&a.image.__webglTextureCube?H.deleteTexture(a.image.__webglTextureCube):a.__webglInit&&(a.__webglInit=
!1,H.deleteTexture(a.__webglTexture));l.info.memory.textures--},Ka=function(a){a=a.target;a.removeEventListener("dispose",Ka);ma(a)},ma=function(a){var b=a.program;if(void 0!==b){a.program=void 0;var f,d,e=!1;a=0;for(f=y.length;a<f;a++)if(d=y[a],d.program===b){d.usedTimes--;0===d.usedTimes&&(e=!0);break}if(!0===e){e=[];a=0;for(f=y.length;a<f;a++)d=y[a],d.program!==b&&e.push(d);y=e;H.deleteProgram(b);l.info.memory.programs--}}};this.initMaterial=function(a,b,f,d){a.addEventListener("dispose",Ka);if(b=
a.shaderID)b=$3Dmol.ShaderLib[b],a.vertexShader=b.vertexShader,a.fragmentShader=b.fragmentShader,a.uniforms=$3Dmol.ShaderUtils.clone(b.uniforms);var e;a:{var u=a.fragmentShader;d=a.vertexShader;f=a.uniforms;var g={wireframe:a.wireframe,fragdepth:a.imposter},A,h;b=[];b.push(u);b.push(d);for(A in g)b.push(A),b.push(g[A]);b=b.join();A=0;for(h=y.length;A<h;A++){var w=y[A];if(w.code===b){w.usedTimes++;e=w.program;break a}}A=H.createProgram();w="precision "+E+" float;";h=""+w;g=[g.fragdepth?"#extension GL_EXT_frag_depth: enable":
"",g.wireframe?"#define WIREFRAME 1":"",w].join("\n");u=c("fragment",g+u);d=c("vertex",h+d);H.attachShader(A,d);H.attachShader(A,u);H.linkProgram(A);H.getProgramParameter(A,H.LINK_STATUS)||console.error("Could not initialize shader");A.uniforms={};A.attributes={};d="viewMatrix modelViewMatrix projectionMatrix normalMatrix modelMatrix cameraPosition".split(" ");for(e in f)d.push(e);for(e=0;e<d.length;e++)f=d[e],A.uniforms[f]=H.getUniformLocation(A,f);d=["position","normal","color","lineDistance"];
for(e=0;e<d.length;e++)f=d[e],A.attributes[f]=H.getAttribLocation(A,f);A.id=m++;y.push({program:A,code:b,usedTimes:1});l.info.memory.programs=y.length;e=A}a.program=e};this.renderBuffer=function(a,d,f,e,A,u){if(e.visible){var g;e.needsUpdate&&(e.program&&ma(e),l.initMaterial(e,d,f,u),e.needsUpdate=!1);var c=!1,h=e.program,w=h.uniforms;g=e.uniforms;h!=t&&(H.useProgram(h),t=h,c=!0);e.id!=B&&(B=e.id,c=!0);a!=x&&(x=a,c=!0);H.uniformMatrix4fv(w.projectionMatrix,!1,a.projectionMatrix.elements);H.uniformMatrix4fv(w.modelViewMatrix,
!1,u._modelViewMatrix.elements);H.uniformMatrix3fv(w.normalMatrix,!1,u._normalMatrix.elements);if(c){g.fogColor.value=f.color;g.fogNear.value=f.near;g.fogFar.value=f.far;if(0===e.shaderID.lastIndexOf("lambert",0)){H.uniformMatrix4fv(w.viewMatrix,!1,a.matrixWorldInverse.elements);if(X){var D,m,s=0,C=0,E=0;a=0;for(f=d.length;a<f;a++)if(c=d[a],D=c.color,m=c.intensity,c instanceof $3Dmol.Light&&(s++,T.getPositionFromMatrix(c.matrixWorld),U.getPositionFromMatrix(c.target.matrixWorld),T.sub(U),T.normalize(),
0!==T.x||0!==T.y||0!==T.z))V[E]=T.x,V[E+1]=T.y,V[E+2]=T.z,Y[E]=D.r*m,Y[E+1]=D.g*m,Y[E+2]=D.b*m,E+=3,C++;aa[0]=0;aa[1]=0;aa[2]=0;X=!1}g.ambientLightColor.value=aa;g.directionalLightColor.value=Y;g.directionalLightDirection.value=V;g.ambient.value=e.ambient;g.emissive.value=e.emissive}else"outline"===e.shaderID?(g.outlineColor.value=e.outlineColor,g.outlineWidth.value=e.outlineWidth,g.outlinePushback.value=e.outlinePushback):"sphereimposter"===e.shaderID&&(H.uniformMatrix4fv(w.viewMatrix,!1,a.matrixWorldInverse.elements),
H.uniformMatrix3fv(w.normalMatrix,!1,u._normalMatrix.elements));g.opacity.value=e.opacity;g.diffuse.value=e.color;for(var y in g)w[y]&&(d=g[y].type,a=g[y].value,f=w[y],"f"===d?H.uniform1f(f,a):"fv"===d?H.uniform3fv(f,a):"c"===d&&H.uniform3f(f,a.r,a.g,a.b))}g=h.attributes;w=!1;h=16777215*A.id+2*h.id+(e.wireframe?1:0);h!==F&&(F=h,w=!0);if(w){for(var P in S)S[P]&&(H.disableVertexAttribArray(P),S[P]=!1);0<=g.position&&(H.bindBuffer(H.ARRAY_BUFFER,A.__webglVertexBuffer),b(g.position),H.vertexAttribPointer(g.position,
3,H.FLOAT,!1,0,0));0<=g.color&&(H.bindBuffer(H.ARRAY_BUFFER,A.__webglColorBuffer),b(g.color),H.vertexAttribPointer(g.color,3,H.FLOAT,!1,0,0));0<=g.normal&&(H.bindBuffer(H.ARRAY_BUFFER,A.__webglNormalBuffer),b(g.normal),H.vertexAttribPointer(g.normal,3,H.FLOAT,!1,0,0))}var G;u instanceof $3Dmol.Mesh?(e.wireframe?(u=A.lineidx,e=e.wireframeLinewidth,e!==K&&(H.lineWidth(e),K=e),w&&H.bindBuffer(H.ELEMENT_ARRAY_BUFFER,A.__webglLineBuffer),H.drawElements(H.LINES,u,H.UNSIGNED_SHORT,0)):(G=A.faceidx,w&&H.bindBuffer(H.ELEMENT_ARRAY_BUFFER,
A.__webglFaceBuffer),H.drawElements(H.TRIANGLES,G,H.UNSIGNED_SHORT,0)),l.info.render.calls++,l.info.render.vertices+=G,l.info.render.faces+=G/3):u instanceof $3Dmol.Line&&(u=A.vertices,A=e.linewidth,A!==K&&(H.lineWidth(A),K=A),H.drawArrays(H.LINES,0,u),l.info.render.calls++)}};this.render=function(a,b,d){if(!1===b instanceof $3Dmol.Camera)console.error("$3Dmol.Renderer.render: camera is not an instance of $3Dmol.Camera.");else{var f,e,g,c,w=a.__lights,h=a.fog;B=-1;X=!0;this.autoUpdateScene&&a.updateMatrixWorld();
void 0===b.parent&&b.updateMatrixWorld();b.matrixWorldInverse.getInverse(b.matrixWorld);O.multiplyMatrices(b.projectionMatrix,b.matrixWorldInverse);this.autoUpdateObjects&&this.initWebGLObjects(a);l.info.render.calls=0;l.info.render.vertices=0;l.info.render.faces=0;l.info.render.points=0;R=L;N=Q;(this.autoClear||d)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil);c=a.__webglObjects;d=0;for(f=c.length;d<f;d++)if(e=c[d],g=e.object,e.render=!1,g.visible){g._modelViewMatrix.multiplyMatrices(b.matrixWorldInverse,
g.matrixWorld);g._normalMatrix.getInverse(g._modelViewMatrix);g._normalMatrix.transpose();g=e;var D=g.object.material;D.transparent?(g.opaque=null,g.transparent=D,D.wireframe||(D=D.clone(),D.opacity=0,g.blank=D)):(g.opaque=D,g.transparent=null);e.render=!0}this.setBlending(!1);q(a.__webglObjects,!0,"opaque",b,w,h,!1,null);q(a.__webglObjects,!0,"blank",b,w,h,!0,null);q(a.__webglObjects,!1,"transparent",b,w,h,!0,null);w=this.renderPluginsPost;F=-1;x=t=null;A=B=u=P=M=-1;if(w.length)for(h=0,d=w.length;h<
d;h++)X=!0,w[h].render(a,b,R,N),F=-1,x=t=null,A=B=u=P=M=-1;this.setDepthTest(!0);this.setDepthWrite(!0)}};this.initWebGLObjects=function(a){a.__webglObjects||(a.__webglObjects=[],a.__webglObjectsImmediate=[],a.__webglSprites=[],a.__webglFlares=[]);if(a.__objectsAdded.length){for(;a.__objectsAdded.length;){var b=a.__objectsAdded[0],d=a,f=void 0,e=void 0,g=void 0,A=void 0;if(!b.__webglInit&&(b.__webglInit=!0,b._modelViewMatrix=new $3Dmol.Matrix4,b._normalMatrix=new $3Dmol.Matrix3,void 0!==b.geometry&&
void 0===b.geometry.__webglInit&&(b.geometry.__webglInit=!0,b.geometry.addEventListener("dispose",Z)),b instanceof $3Dmol.Mesh||b instanceof $3Dmol.Line))for(g=b.geometry,f=0,e=g.geometryGroups.length;f<e;f++)A=g.geometryGroups[f],A.id=C++,A.__webglVertexBuffer||(b instanceof $3Dmol.Mesh?(A.__webglVertexBuffer=H.createBuffer(),A.__webglNormalBuffer=H.createBuffer(),A.__webglColorBuffer=H.createBuffer(),A.__webglFaceBuffer=H.createBuffer(),A.__webglLineBuffer=H.createBuffer(),l.info.memory.geometries++,
g.elementsNeedUpdate=!0,g.normalsNeedUpdate=!0):b instanceof $3Dmol.Line&&(A.__webglVertexBuffer=H.createBuffer(),A.__webglColorBuffer=H.createBuffer(),l.info.memory.geometries++),g.verticesNeedUpdate=!0,g.colorsNeedUpdate=!0);if(!b.__webglActive){if(b instanceof $3Dmol.Mesh||b instanceof $3Dmol.Line)for(g=b.geometry,f=0,e=g.geometryGroups.length;f<e;f++)A=g.geometryGroups[f],d.__webglObjects.push({buffer:A,object:b,opaque:null,transparent:null});else b instanceof $3Dmol.Sprite&&d.__webglSprites.push(b);
b.__webglActive=!0}a.__objectsAdded.splice(0,1)}F=-1}for(;a.__objectsRemoved.length;){b=a.__objectsRemoved[0];d=a;if(b instanceof $3Dmol.Mesh||b instanceof $3Dmol.Line)for(d=d.__webglObjects,f=b,e=d.length-1;0<=e;--e)d[e].object===f&&d.splice(e,1);else if(b instanceof $3Dmol.Sprite)for(d=d.__webglSprites,f=b,e=d.length-1;0<=e;--e)d[e]===f&&d.splice(e,1);b.__webglActive=!1;a.__objectsRemoved.splice(0,1)}b=0;for(d=a.__webglObjects.length;b<d;b++)if(e=a.__webglObjects[b].object,f=e.geometry,A=void 0,
e instanceof $3Dmol.Mesh||e instanceof $3Dmol.Line){e=0;for(g=f.geometryGroups.length;e<g;e++)if(A=f.geometryGroups[e],f.verticesNeedUpdate||f.elementsNeedUpdate||f.colorsNeedUpdate||f.normalsNeedUpdate){var u=H.STATIC_DRAW,c=A.vertexArray,w=A.colorArray;H.bindBuffer(H.ARRAY_BUFFER,A.__webglVertexBuffer);H.bufferData(H.ARRAY_BUFFER,c,u);H.bindBuffer(H.ARRAY_BUFFER,A.__webglColorBuffer);H.bufferData(H.ARRAY_BUFFER,w,u);void 0!==A.normalArray&&void 0!==A.__webglNormalBuffer&&(c=A.normalArray,H.bindBuffer(H.ARRAY_BUFFER,
A.__webglNormalBuffer),H.bufferData(H.ARRAY_BUFFER,c,u));void 0!==A.faceArray&&void 0!==A.__webglFaceBuffer&&(c=A.faceArray,H.bindBuffer(H.ELEMENT_ARRAY_BUFFER,A.__webglFaceBuffer),H.bufferData(H.ELEMENT_ARRAY_BUFFER,c,u));void 0!==A.lineArray&&void 0!==A.__webglLineBuffer&&(c=A.lineArray,H.bindBuffer(H.ELEMENT_ARRAY_BUFFER,A.__webglLineBuffer),H.bufferData(H.ELEMENT_ARRAY_BUFFER,c,u))}f.verticesNeedUpdate=!1;f.elementsNeedUpdate=!1;f.normalsNeedUpdate=!1;f.colorsNeedUpdate=!1;f.buffersNeedUpdate=
!1}};this.setTexture=function(a,b){if(a.needsUpdate){a.__webglInit||(a.__webglInit=!0,a.addEventListener("dispose",ba),a.__webglTexture=H.createTexture(),l.info.memory.textures++);H.activeTexture(H.TEXTURE0+b);H.bindTexture(H.TEXTURE_2D,a.__webglTexture);H.pixelStorei(H.UNPACK_FLIP_Y_WEBGL,a.flipY);H.pixelStorei(H.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha);H.pixelStorei(H.UNPACK_ALIGNMENT,a.unpackAlignment);var f=a.image,f=p(f.width)&&p(f.height),d=z(a.format),e=z(a.type),A=H.TEXTURE_2D;f?
(H.texParameteri(A,H.TEXTURE_WRAP_S,z(a.wrapS)),H.texParameteri(A,H.TEXTURE_WRAP_T,z(a.wrapT)),H.texParameteri(A,H.TEXTURE_MAG_FILTER,z(a.magFilter)),H.texParameteri(A,H.TEXTURE_MIN_FILTER,z(a.minFilter))):(H.texParameteri(A,H.TEXTURE_WRAP_S,H.CLAMP_TO_EDGE),H.texParameteri(A,H.TEXTURE_WRAP_T,H.CLAMP_TO_EDGE),H.texParameteri(A,H.TEXTURE_MAG_FILTER,H.LINEAR),H.texParameteri(A,H.TEXTURE_MIN_FILTER,H.LINEAR));var g=a.mipmaps;if(0<g.length&&f){for(var u=0,c=g.length;u<c;u++)A=g[u],H.texImage2D(H.TEXTURE_2D,
u,d,d,e,A);a.generateMipmaps=!1}else H.texImage2D(H.TEXTURE_2D,0,d,d,e,a.image);a.generateMipmaps&&f&&H.generateMipmap(H.TEXTURE_2D);a.needsUpdate=!1;if(a.onUpdate)a.onUpdate()}else H.activeTexture(H.TEXTURE0+b),H.bindTexture(H.TEXTURE_2D,a.__webglTexture)};this.addPostPlugin(new $3Dmol.SpritePlugin)};$3Dmol.Scene=function(){$3Dmol.Object3D.call(this);this.overrideMaterial=this.fog=null;this.matrixAutoUpdate=!1;this.__objects=[];this.__lights=[];this.__objectsAdded=[];this.__objectsRemoved=[]};
$3Dmol.Scene.prototype=Object.create($3Dmol.Object3D.prototype);$3Dmol.Scene.prototype.__addObject=function(a){a instanceof $3Dmol.Light?(-1===this.__lights.indexOf(a)&&this.__lights.push(a),a.target&&void 0===a.target.parent&&this.add(a.target)):-1===this.__objects.indexOf(a)&&(this.__objects.push(a),this.__objectsAdded.push(a),-1!==this.__objectsRemoved.indexOf(a)&&this.__objectsRemoved.splice(b,1));for(var b=0;b<a.children.length;b++)this.__addObject(a.children[b])};
$3Dmol.Scene.prototype.__removeObject=function(a){var b;a instanceof $3Dmol.Light?(b=this.__lights.indexOf(a),-1!==b&&this.__lights.splice(b,1)):(b=this.__objects.indexOf(a),-1!==b&&(this.__objects.splice(b,1),this.__objectsRemoved.push(a),-1!==this.__objectsAdded.indexOf(a)&&this.__objectsAdded.splice(b,1)));for(b=0;b<a.children.length;b++)this.__removeObject(a.children[b])};$3Dmol.Fog=function(a,b,c){this.name="";this.color=new $3Dmol.Color(a);this.near=void 0!==b?b:1;this.far=void 0!==c?c:1E3};
$3Dmol.Fog.prototype.clone=function(){return new $3Dmol.Fog(this.color.getHex(),this.near,this.far)};$3Dmol.ShaderUtils={clone:function(a){var b,c={};for(b in a){c[b]={};c[b].type=a[b].type;var q=a[b].value;q instanceof $3Dmol.Color?c[b].value=q.clone():"number"===typeof q?c[b].value=q:q instanceof Array?c[b].value=[]:console.error("Error copying shader uniforms from ShaderLib: unknown type for uniform")}return c}};
$3Dmol.ShaderLib={basic:{fragmentShader:"uniform mat4 viewMatrix;\nuniform vec3 cameraPosition;\nuniform vec3 diffuse;\nuniform float opacity;\nuniform vec3 fogColor;\nuniform float fogNear;\nuniform float fogFar;\nvarying vec3 vColor;\nvoid main() {\n    gl_FragColor = vec4( diffuse, opacity );\n    gl_FragColor = gl_FragColor * vec4( vColor, opacity );\n    float depth = gl_FragCoord.z / gl_FragCoord.w;\n    float fogFactor = smoothstep( fogNear, fogFar, depth );\n    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n}",vertexShader:"uniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\nattribute vec3 position;\nattribute vec3 color;\nvarying vec3 vColor;\nvoid main() {\n    vColor = color;\n    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n    gl_Position = projectionMatrix * mvPosition;\n}",
uniforms:{opacity:{type:"f",value:1},diffuse:{type:"c",value:new $3Dmol.Color(1,1,1)},fogColor:{type:"c",value:new $3Dmol.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2E3}}},sphereimposter:{fragmentShader:"uniform mat4 viewMatrix;\nuniform vec3 cameraPosition;\nuniform vec3 diffuse;\nuniform float opacity;\nuniform vec3 fogColor;\nuniform float fogNear;\nuniform float fogFar;\nuniform float uDepth;\nvarying vec3 vColor;\nvarying vec2 mapping;\nvarying float rval;\nvoid main() {\n    float lensqr = dot(mapping,mapping);\n    float rsqr = rval*rval;\n    if(lensqr > rsqr)\n       discard;\n    float z = sqrt(rsqr-lensqr);\n    float zscale = z/rval;\n    gl_FragColor = vec4(zscale*vColor, 1 );\n    float depth = gl_FragCoord.z / gl_FragCoord.w;\n    gl_FragDepthEXT = gl_FragCoord.z-z/depth;\n    float fogFactor = smoothstep( fogNear, fogFar, depth );\n    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n}",
vertexShader:"uniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec3 color;\nvarying vec2 mapping;\nvarying vec3 vColor;\nvarying float rval;\nvoid main() {\n    vColor = color;\n    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n    vec4 projPosition = projectionMatrix * mvPosition;\n    vec4 adjust = projectionMatrix* vec4(normal,0.0); adjust.z = 0.0; adjust.w = 0.0;\n    mapping = normal.xy;\n    rval = abs(normal.x);\n    gl_Position = projPosition+adjust;\n}",
uniforms:{opacity:{type:"f",value:1},diffuse:{type:"c",value:new $3Dmol.Color(1,1,1)},fogColor:{type:"c",value:new $3Dmol.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2E3}}},lambert:{fragmentShader:"uniform mat4 viewMatrix;\nuniform vec3 cameraPosition;\nuniform float opacity;\nuniform vec3 fogColor;\nuniform float fogNear;\nuniform float fogFar;\nvarying vec3 vLightFront;\nvarying vec3 vColor;\nvoid main() {\n    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );\n    #ifndef WIREFRAME\n    gl_FragColor.xyz *= vLightFront;\n    #endif\n    gl_FragColor = gl_FragColor * vec4( vColor, opacity );\n    float depth = gl_FragCoord.z / gl_FragCoord.w;\n    float fogFactor = smoothstep( fogNear, fogFar, depth );\n    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n}",
vertexShader:"uniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\nuniform vec3 ambient;\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 ambientLightColor;\nuniform vec3 directionalLightColor[ 1 ];\nuniform vec3 directionalLightDirection[ 1 ];\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec3 color;\nvarying vec3 vColor;\nvarying vec3 vLightFront;\nvoid main() {\n    vColor = color;\n    vec3 objectNormal = normal;\n    vec3 transformedNormal = normalMatrix * objectNormal;\n    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n    vLightFront = vec3( 0.0 );\n    transformedNormal = normalize( transformedNormal );\n    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );\n    vec3 dirVector = normalize( lDirection.xyz );\n    float dotProduct = dot( transformedNormal, dirVector );\n    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );\n    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;\n    vLightFront = vLightFront * diffuse + ambient * ambientLightColor + emissive;\n    gl_Position = projectionMatrix * mvPosition;\n}",
uniforms:{opacity:{type:"f",value:1},diffuse:{type:"c",value:new $3Dmol.Color(1,1,1)},fogColor:{type:"c",value:new $3Dmol.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2E3},ambient:{type:"c",value:new $3Dmol.Color(1,1,1)},emissive:{type:"c",value:new $3Dmol.Color(1,1,1)},ambientLightColor:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}},outline:{fragmentShader:"uniform float opacity;\nuniform vec3 outlineColor;\nuniform vec3 fogColor;\nuniform float fogNear;\nuniform float fogFar;\nvoid main() {\n    gl_FragColor = vec4( outlineColor, 1 );\n}",
vertexShader:"uniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float outlineWidth;\nuniform float outlinePushback;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec3 color;\nvoid main() {\n    vec4 norm = modelViewMatrix*vec4(normalize(normal),0.0);\n    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n    mvPosition.xy += norm.xy*outlineWidth;\n    gl_Position = projectionMatrix * mvPosition;\n    mvPosition.z -= outlinePushback;\n    vec4 pushpos = projectionMatrix*mvPosition;\n    gl_Position.z = gl_Position.w*pushpos.z/pushpos.w;\n}",
uniforms:{opacity:{type:"f",value:1},diffuse:{type:"c",value:new $3Dmol.Color(1,1,1)},outlineColor:{type:"c",value:new $3Dmol.Color(0,0,0)},fogColor:{type:"c",value:new $3Dmol.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2E3},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1}}},lambertdouble:{fragmentShader:"uniform mat4 viewMatrix;\nuniform vec3 cameraPosition;\nuniform float opacity;\nuniform vec3 fogColor;\nuniform float fogNear;\nuniform float fogFar;\nvarying vec3 vLightFront;\nvarying vec3 vLightBack;\nvarying vec3 vColor;\nvoid main() {\n    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );\n    #ifndef WIREFRAME\n    if ( gl_FrontFacing )\n       gl_FragColor.xyz *= vLightFront;\n    else\n       gl_FragColor.xyz *= vLightBack;\n    #endif\n    gl_FragColor = gl_FragColor * vec4( vColor, opacity );\n    float depth = gl_FragCoord.z / gl_FragCoord.w;\n    float fogFactor = smoothstep( fogNear, fogFar, depth );\n    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n}",
vertexShader:"uniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\nuniform vec3 ambient;\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 ambientLightColor;\nuniform vec3 directionalLightColor[ 1 ];\nuniform vec3 directionalLightDirection[ 1 ];\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec3 color;\nvarying vec3 vColor;\nvarying vec3 vLightFront;\nvarying vec3 vLightBack;\nvoid main() {\n    vColor = color;\n    vec3 objectNormal = normal;\n    vec3 transformedNormal = normalMatrix * objectNormal;\n    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n    vLightFront = vec3( 0.0 );\n    vLightBack = vec3( 0.0 );\n    transformedNormal = normalize( transformedNormal );\n    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );\n    vec3 dirVector = normalize( lDirection.xyz );\n    float dotProduct = dot( transformedNormal, dirVector );\n    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );\n    vec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;\n    vLightBack += directionalLightColor[ 0 ] * directionalLightWeightingBack;\n    vLightFront = vLightFront * diffuse + ambient * ambientLightColor + emissive;\n    vLightBack = vLightBack * diffuse + ambient * ambientLightColor + emissive;\n    gl_Position = projectionMatrix * mvPosition;\n}",
uniforms:{opacity:{type:"f",value:1},diffuse:{type:"c",value:new $3Dmol.Color(1,1,1)},fogColor:{type:"c",value:new $3Dmol.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2E3},ambient:{type:"c",value:new $3Dmol.Color(1,1,1)},emissive:{type:"c",value:new $3Dmol.Color(1,1,1)},ambientLightColor:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}},sprite:{fragmentShader:"uniform vec3 color;\nuniform sampler2D map;\nuniform float opacity;\nuniform int fogType;\nuniform vec3 fogColor;\nuniform float fogDensity;\nuniform float fogNear;\nuniform float fogFar;\nuniform float alphaTest;\nvarying vec2 vUV;\nvoid main() {\n    vec4 texture = texture2D(map, vUV);\n    if (texture.a < alphaTest) discard;\n    gl_FragColor = vec4(color * texture.xyz, texture.a * opacity);\n    if (fogType > 0) {\n        float depth = gl_FragCoord.z / gl_FragCoord.w;\n        float fogFactor = 0.0;\n        if (fogType == 1) {\n            fogFactor = smoothstep(fogNear, fogFar, depth);\n        }\n        else {\n            const float LOG2 = 1.442695;\n            float fogFactor = exp2(- fogDensity * fogDensity * depth * depth * LOG2);\n            fogFactor = 1.0 - clamp(fogFactor, 0.0, 1.0);\n        }\n        gl_FragColor = mix(gl_FragColor, vec4(fogColor, gl_FragColor.w), fogFactor);\n    }\n}",
vertexShader:"uniform int useScreenCoordinates;\nuniform vec3 screenPosition;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float rotation;\nuniform vec2 scale;\nuniform vec2 alignment;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\n    vUV = uvOffset + uv * uvScale;\n    vec2 alignedPosition = position + alignment;\n    vec2 rotatedPosition;\n    rotatedPosition.x = ( cos(rotation) * alignedPosition.x - sin(rotation) * alignedPosition.y ) * scale.x;\n    rotatedPosition.y = ( sin(rotation) * alignedPosition.x + cos(rotation) * alignedPosition.y ) * scale.y;\n    vec4 finalPosition;\n    if(useScreenCoordinates != 0) {\n        finalPosition = vec4(screenPosition.xy + rotatedPosition, screenPosition.z, 1.0);\n    }\n    else {\n        finalPosition = projectionMatrix * modelViewMatrix * vec4(0.0, 0.0, 0.0, 1.0); finalPosition /= finalPosition.w;\n        finalPosition.xy += rotatedPosition; \n    }\n    gl_Position = finalPosition;\n}",
uniforms:{}}};"undefined"===typeof console&&(console={log:function(){}});
$3Dmol.ProteinSurface=function(){var a=0,b=0,c=0,q=2,p=0,z=0,w=0,E=0,d=null,g=null,f=null,e=0,D=0,s=0,G=0,h=0,l=0,y={H:1.2,Li:1.82,Na:2.27,K:2.75,C:1.7,N:1.55,O:1.52,F:1.47,P:1.8,S:1.8,CL:1.75,BR:1.85,SE:1.9,ZN:1.39,CU:1.4,NI:1.63,X:2},m=function(a){return a.elem&&"undefined"!=typeof y[a.elem]?a.elem:"X"},t={},B={},F,x,C=[new Int32Array([1,0,0]),new Int32Array([-1,0,0]),new Int32Array([0,1,0]),new Int32Array([0,-1,0]),new Int32Array([0,0,1]),new Int32Array([0,0,-1]),new Int32Array([1,1,0]),new Int32Array([1,
-1,0]),new Int32Array([-1,1,0]),new Int32Array([-1,-1,0]),new Int32Array([1,0,1]),new Int32Array([1,0,-1]),new Int32Array([-1,0,1]),new Int32Array([-1,0,-1]),new Int32Array([0,1,1]),new Int32Array([0,1,-1]),new Int32Array([0,-1,1]),new Int32Array([0,-1,-1]),new Int32Array([1,1,1]),new Int32Array([1,1,-1]),new Int32Array([1,-1,1]),new Int32Array([-1,1,1]),new Int32Array([1,-1,-1]),new Int32Array([-1,-1,1]),new Int32Array([-1,1,-1]),new Int32Array([-1,-1,-1])];this.getFacesAndVertices=function(e){var u=
{},w,h;w=0;for(h=e.length;w<h;w++)u[e[w]]=!0;e=x;w=0;for(h=e.length;w<h;w++)e[w].x=e[w].x/q-a,e[w].y=e[w].y/q-b,e[w].z=e[w].z/q-c;var D=[];w=0;for(h=F.length;w<h;w+=3){var l=F[w],m=F[w+1],s=F[w+2],C=e[m].atomid,t=e[s].atomid,E=e[l].atomid;C<E&&(E=C);t<E&&(E=t);u[E]&&l!==m&&m!==s&&l!==s&&(D.push(l),D.push(m),D.push(s))}f=g=d=null;return{vertices:e,faces:D}};this.initparm=function(A,u,m){1E6<m&&(q=1);m=1/q*5.5;e=A[0][0];G=A[1][0];D=A[0][1];h=A[1][1];s=A[0][2];l=A[1][2];u?(e-=1.4+m,D-=1.4+m,s-=1.4+m,
G+=1.4+m,h+=1.4+m,l+=1.4+m):(e-=m,D-=m,s-=m,G+=m,h+=m,l+=m);e=Math.floor(e*q)/q;D=Math.floor(D*q)/q;s=Math.floor(s*q)/q;G=Math.ceil(G*q)/q;h=Math.ceil(h*q)/q;l=Math.ceil(l*q)/q;a=-e;b=-D;c=-s;w=Math.ceil(q*(G-e))+1;z=Math.ceil(q*(h-D))+1;p=Math.ceil(q*(l-s))+1;this.boundingatom(u);E=1.4*q;d=new Uint8Array(w*z*p);g=new Float64Array(w*z*p);f=new Int32Array(w*z*p)};this.boundingatom=function(a){var b=[],f,d;flagradius=a;for(var e in y)if(y.hasOwnProperty(e))for(d=y[e],b[e]=a?(d+1.4)*q+.5:d*q+.5,d=b[e]*
b[e],B[e]=Math.floor(b[e])+1,t[e]=new Int32Array(B[e]*B[e]),j=indx=0;j<B[e];j++)for(k=0;k<B[e];k++)f=j*j+k*k,f>d?t[e][indx]=-1:(f=Math.sqrt(d-f),t[e][indx]=Math.floor(f)),indx++};this.fillvoxels=function(a,b){var e,u;e=0;for(u=d.length;e<u;e++)d[e]=0,g[e]=-1,f[e]=-1;for(e in b)u=a[b[e]],void 0!==u&&this.fillAtom(u,a);e=0;for(u=d.length;e<u;e++)d[e]&1&&(d[e]|=2)};this.fillAtom=function(e,g){var u,h,D,l,s,C,F,x,E,y,G,T,X,aa,Y,V,H;u=Math.floor(.5+q*(e.x+a));h=Math.floor(.5+q*(e.y+b));D=Math.floor(.5+
q*(e.z+c));var da=m(e),Z=0,ba=z*p;y=0;for(H=B[da];y<H;y++)for(G=0;G<H;G++){if(-1!=t[da][Z])for(aa=-1;2>aa;aa++)for(Y=-1;2>Y;Y++)for(V=-1;2>V;V++)if(0!==aa&&0!==Y&&0!==V)for(F=aa*y,E=V*G,T=0;T<=t[da][Z];T++)x=T*Y,l=u+F,s=h+x,X=D+E,0>l||0>s||0>X||l>=w||s>=z||X>=p||(X=l*ba+s*p+X,d[X]&1?(C=g[f[X]],C.serial!=e.serial&&(l=u+F-Math.floor(.5+q*(C.x+a)),s=h+x-Math.floor(.5+q*(C.y+b)),C=D+E-Math.floor(.5+q*(C.z+c)),F*F+x*x+E*E<l*l+s*s+C*C&&(f[X]=e.serial))):(d[X]|=1,f[X]=e.serial));Z++}};this.fillvoxelswaals=
function(a,b){var f,e;f=0;for(e=d.length;f<e;f++)d[f]&=-3;for(f in b)e=a[b[f]],void 0!==e&&this.fillAtomWaals(e,a)};this.fillAtomWaals=function(e,g){var u,h,D,l,s,C,F=0,x,E,y,G,T,X,aa,Y,V,H,da;u=Math.floor(.5+q*(e.x+a));h=Math.floor(.5+q*(e.y+b));D=Math.floor(.5+q*(e.z+c));var Z=m(e),ba=z*p;T=0;for(da=B[Z];T<da;T++)for(X=0;X<da;X++){if(-1!=t[Z][F])for(Y=-1;2>Y;Y++)for(V=-1;2>V;V++)for(H=-1;2>H;H++)if(0!==Y&&0!==V&&0!==H)for(x=Y*T,y=H*X,aa=0;aa<=t[Z][F];aa++)E=aa*V,l=u+x,s=h+E,G=D+y,0>l||0>s||0>G||
l>=w||s>=z||G>=p||(G=l*ba+s*p+G,d[G]&2?(C=g[f[G]],C.serial!=e.serial&&(l=u+x-Math.floor(.5+q*(C.x+a)),s=h+E-Math.floor(.5+q*(C.y+b)),C=D+y-Math.floor(.5+q*(C.z+c)),x*x+E*E+y*y<l*l+s*s+C*C&&(f[G]=e.serial))):(d[G]|=2,f[G]=e.serial));F++}};this.buildboundary=function(){var a=z*p;for(i=0;i<w;i++)for(j=0;j<p;j++)for(k=0;k<z;k++){var b=i*a+k*p+j;if(d[b]&1)for(var f=0;26>f;){var e=i+C[f][0],g=j+C[f][2],u=k+C[f][1];if(-1<e&&e<w&&-1<u&&u<z&&-1<g&&g<p&&!(d[e*a+u*p+g]&1)){d[b]|=4;break}else f++}}};var u=function(a,
b,f){var d=new Int32Array(a*b*f*3);this.set=function(a,e,g,u){a=3*((a*b+e)*f+g);d[a]=u.ix;d[a+1]=u.iy;d[a+2]=u.iz};this.get=function(a,e,g){a=3*((a*b+e)*f+g);return{ix:d[a],iy:d[a+1],iz:d[a+2]}}};this.fastdistancemap=function(){var a,b,f,e=new u(w,z,p),h=z*p,c=E*E,D=[];f=[];var l;for(a=0;a<w;a++)for(b=0;b<z;b++)for(f=0;f<p;f++)if(l=a*h+b*p+f,d[l]&=-3,d[l]&1&&d[l]&4){var m={ix:a,iy:b,iz:f};e.set(a,b,f,m);D.push(m);g[l]=0;d[l]|=2;d[l]&=-5}do for(f=this.fastoneshell(D,e),D=[],a=0,b=f.length;a<b;a++)l=
h*f[a].ix+p*f[a].iy+f[a].iz,d[l]&=-5,g[l]<=1.0404*c&&D.push({ix:f[a].ix,iy:f[a].iy,iz:f[a].iz});while(0!==D.length);a=q-.5;0>a&&(a=0);c-=.5/(.1+a);for(a=0;a<w;a++)for(b=0;b<z;b++)for(f=0;f<p;f++)l=a*h+b*p+f,d[l]&=-5,d[l]&1&&(!(d[l]&2)||d[l]&2&&g[l]>=c)&&(d[l]|=4)};this.fastoneshell=function(a,b){var f,e,u,c,h,l,D,m,s,F,x,t=[];if(0===a.length)return t;tnv={ix:-1,iy:-1,iz:-1};var E=z*p;D=0;for(s=a.length;D<s;D++)for(f=a[D].ix,e=a[D].iy,u=a[D].iz,F=b.get(f,e,u),m=0;6>m;m++)tnv.ix=f+C[m][0],tnv.iy=e+
C[m][1],tnv.iz=u+C[m][2],tnv.ix<w&&-1<tnv.ix&&tnv.iy<z&&-1<tnv.iy&&tnv.iz<p&&-1<tnv.iz&&(x=tnv.ix*E+p*tnv.iy+tnv.iz,d[x]&1&&!(d[x]&2)?(b.set(tnv.ix,tnv.iy,u+C[m][2],F),c=tnv.ix-F.ix,h=tnv.iy-F.iy,l=tnv.iz-F.iz,c=c*c+h*h+l*l,g[x]=c,d[x]|=2,d[x]|=4,t.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})):d[x]&1&&d[x]&2&&(c=tnv.ix-F.ix,h=tnv.iy-F.iy,l=tnv.iz-F.iz,c=c*c+h*h+l*l,c<g[x]&&(b.set(tnv.ix,tnv.iy,tnv.iz,F),g[x]=c,d[x]&4||(d[x]|=4,t.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})))));D=0;for(s=a.length;D<s;D++)for(f=
a[D].ix,e=a[D].iy,u=a[D].iz,F=b.get(f,e,u),m=6;18>m;m++)tnv.ix=f+C[m][0],tnv.iy=e+C[m][1],tnv.iz=u+C[m][2],tnv.ix<w&&-1<tnv.ix&&tnv.iy<z&&-1<tnv.iy&&tnv.iz<p&&-1<tnv.iz&&(x=tnv.ix*E+p*tnv.iy+tnv.iz,d[x]&1&&!(d[x]&2)?(b.set(tnv.ix,tnv.iy,u+C[m][2],F),c=tnv.ix-F.ix,h=tnv.iy-F.iy,l=tnv.iz-F.iz,c=c*c+h*h+l*l,g[x]=c,d[x]|=2,d[x]|=4,t.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})):d[x]&1&&d[x]&2&&(c=tnv.ix-F.ix,h=tnv.iy-F.iy,l=tnv.iz-F.iz,c=c*c+h*h+l*l,c<g[x]&&(b.set(tnv.ix,tnv.iy,tnv.iz,F),g[x]=c,d[x]&4||(d[x]|=
4,t.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})))));D=0;for(s=a.length;D<s;D++)for(f=a[D].ix,e=a[D].iy,u=a[D].iz,F=b.get(f,e,u),m=18;26>m;m++)tnv.ix=f+C[m][0],tnv.iy=e+C[m][1],tnv.iz=u+C[m][2],tnv.ix<w&&-1<tnv.ix&&tnv.iy<z&&-1<tnv.iy&&tnv.iz<p&&-1<tnv.iz&&(x=tnv.ix*E+p*tnv.iy+tnv.iz,d[x]&1&&!(d[x]&2)?(b.set(tnv.ix,tnv.iy,u+C[m][2],F),c=tnv.ix-F.ix,h=tnv.iy-F.iy,l=tnv.iz-F.iz,c=c*c+h*h+l*l,g[x]=c,d[x]|=2,d[x]|=4,t.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})):d[x]&1&&d[x]&2&&(c=tnv.ix-F.ix,h=tnv.iy-F.iy,l=tnv.iz-
F.iz,c=c*c+h*h+l*l,c<g[x]&&(b.set(tnv.ix,tnv.iy,tnv.iz,F),g[x]=c,d[x]&4||(d[x]|=4,t.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})))));return t};this.marchingcubeinit=function(a){for(var b=0,f=d.length;b<f;b++)1==a?d[b]&=-5:4==a?(d[b]&=-3,d[b]&4&&(d[b]|=2),d[b]&=-5):2==a?d[b]&4&&d[b]&2?d[b]&=-5:d[b]&4&&!(d[b]&2)&&(d[b]|=2):3==a&&(d[b]&=-5)};this.marchingcube=function(a){this.marchingcubeinit(a);x=[];F=[];$3Dmol.MarchingCube.march(d,x,F,{smooth:1,nX:w,nY:z,nZ:p});a=z*p;for(var b=0,e=x.length;b<e;b++)x[b].atomid=
f[x[b].x*a+p*x[b].y+x[b].z];$3Dmol.MarchingCube.laplacianSmooth(1,x,F)}};
$(document).ready(function(){void 0!==$(".viewer_3Dmoljs")[0]&&($3Dmol.autoinit=!0);if($3Dmol.autoinit){$3Dmol.viewers={};var a=0;$(".viewer_3Dmoljs").each(function(){var b=$(this),c=null,q="function"===typeof window[b.data("callback")]?window[b.data("callback")]:null,p=null;b.data("pdb")?(c="http://www.rcsb.org/pdb/files/"+b.data("pdb")+".pdb",p="pdb"):b.data("cid")?(p="sdf",c="http://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+b.data("cid")+"/SDF?record_type=3d"):b.data("href")&&(c=b.data("href"));
var z=$3Dmol.CC.color(b.data("backgroundcolor")),w={line:{}};b.data("style")&&(w=$3Dmol.specStringToObject(b.data("style")));var E={};b.data("select")&&(E=$3Dmol.specStringToObject(b.data("select")));var d=[],g=[],f=[],e=b.data(),D=/style(.+)/,s=/surface(.*)/,G=/labelres(.*)/,h=[],l;for(l in e)e.hasOwnProperty(l)&&h.push(l);h.sort();for(var y=0;y<h.length;y++){l=h[y];var m=D.exec(l);if(m){var m="select"+m[1],m=$3Dmol.specStringToObject(e[m]),t=$3Dmol.specStringToObject(e[l]);d.push([m,t])}if(m=s.exec(l))m=
"select"+m[1],m=$3Dmol.specStringToObject(e[m]),t=$3Dmol.specStringToObject(e[l]),g.push([m,t]);if(m=G.exec(l))m="select"+m[1],m=$3Dmol.specStringToObject(e[m]),t=$3Dmol.specStringToObject(e[l]),f.push([m,t])}var B=function(a){a.setStyle(E,w);for(var b=0;b<d.length;b++){var e=d[b][0]||{},c=d[b][1]||{line:{}};a.setStyle(e,c)}for(b=0;b<g.length;b++)e=g[b][0]||{},c=g[b][1]||{},a.addSurface($3Dmol.SurfaceType.VDW,c,e,e);for(b=0;b<f.length;b++)e=f[b][0]||{},c=f[b][1]||{},a.addResLabels(e,c);a.zoomTo();
a.render()},F=null;try{F=$3Dmol.viewers[this.id||a++]=$3Dmol.createViewer(b,{defaultcolors:$3Dmol.rasmolElementColors}),F.setBackgroundColor(z)}catch(x){window.location="http://get.webgl.org"}c?((p=b.data("type")||b.data("datatype")||p)||(p=c.substr(c.lastIndexOf(".")+1)),$.get(c,function(a){F.addModel(a,p);B(F);q&&q(F)},"text")):(b.data("element")&&(c=$("#"+b.data("element")).val()||"",p=b.data("type")||b.data("datatype"),p||(console.log("Warning: No type specified for embedded viewer with moldata from "+
b.data("element")+"\n assuming type 'pdb'"),p="pdb"),F.addModel(c,p)),B(F),q&&q(F))})}});(function(){$3Dmol.elementColors.greenCarbon.C=65280;$3Dmol.elementColors.cyanCarbon.C=65535;$3Dmol.elementColors.magentaCarbon.C=16711935;$3Dmol.elementColors.yellowCarbon.C=16776960;$3Dmol.elementColors.whiteCarbon.C=16777215;$3Dmol.elementColors.orangeCarbon.C=16737792;$3Dmol.elementColors.purpleCarbon.C=8388736;$3Dmol.elementColors.blueCarbon.C=255});
$3Dmol.CC={cache:{0:new $3Dmol.Color(0)},color:function color_(b){if(!b)return this.cache[0];if("undefined"!==typeof this.cache[b])return this.cache[b];if(b&&b.constructor===Array)return b.map(color_,this);b=this.getHex(b);if("number"===typeof b){var c=new $3Dmol.Color(b);return this.cache[b]=c}return b},colorTab:{white:16777215,silver:12632256,gray:8421504,grey:8421504,black:0,red:16711680,maroon:8388608,yellow:16776960,orange:16737792,olive:8421376,lime:65280,green:32768,aqua:65535,cyan:65535,teal:32896,
blue:255,navy:128,fuchsia:16711935,magenta:16711935,purple:8388736},getHex:function(a){return isNaN(parseInt(a))?"string"===typeof a?this.colorTab[a.trim().toLowerCase()]||0:a:parseInt(a)}};$3Dmol.CC=$3Dmol.CC;$3Dmol.CC.color=$3Dmol.CC.color;
$3Dmol.getColorFromStyle=function(a,b){var c=a.color;"undefined"!=typeof b.color&&"spectrum"!=b.color&&(c=b.color);if("undefined"!=typeof b.colorscheme)if("undefined"!=typeof $3Dmol.elementColors[b.colorscheme]){var q=$3Dmol.elementColors[b.colorscheme];"undefined"!=typeof q[a.elem]&&(c=q[a.elem])}else if("undefined"!=typeof b.colorscheme[a.elem])c=b.colorscheme[a.elem];else if("undefined"!=typeof b.colorscheme.prop&&"undefined"!=typeof b.colorscheme.gradient){var p=b.colorscheme.prop,q=b.colorscheme.gradient,
z=q.range()||[-1,1],p=$3Dmol.getAtomProperty(a,p);null!=p&&(c=q.valueToHex(p,z))}return $3Dmol.CC.color(c)};$3Dmol.elementColors=$3Dmol.elementColors||{};$3Dmol.elementColors.defaultColor=16716947;
$3Dmol.elementColors.Jmol={H:16777215,He:14286847,HE:14286847,Li:13402367,LI:13402367,B:16758197,C:9474192,N:3166456,O:16715021,F:9494608,Na:11230450,NA:11230450,Mg:9109248,MG:9109248,Al:12560038,AL:12560038,Si:1578E4,SI:1578E4,P:16744448,S:16777008,Cl:2093087,CL:2093087,Ca:4062976,CA:4062976,Ti:12567239,TI:12567239,Cr:9083335,CR:9083335,Mn:10255047,MN:10255047,Fe:14706227,FE:14706227,Ni:5296208,NI:5296208,Cu:13140019,CU:13140019,Zn:8224944,ZN:8224944,Br:10889513,BR:10889513,Ag:12632256,AG:12632256,
I:9699476,Ba:51456,BA:51456,Au:16765219,AU:16765219};
$3Dmol.elementColors.rasmol={H:16777215,He:16761035,HE:16761035,Li:11674146,LI:11674146,B:65280,C:13158600,N:9408511,O:15728640,F:14329120,Na:255,NA:255,Mg:2263842,MG:2263842,Al:8421520,AL:8421520,Si:14329120,SI:14329120,P:16753920,S:16762930,Cl:65280,CL:65280,Ca:8421520,CA:8421520,Ti:8421520,TI:8421520,Cr:8421520,CR:8421520,Mn:8421520,MN:8421520,Fe:16753920,FE:16753920,Ni:10824234,NI:10824234,Cu:10824234,CU:10824234,Zn:10824234,ZN:10824234,Br:10824234,BR:10824234,Ag:8421520,AG:8421520,I:10494192,
Ba:16753920,BA:16753920,Au:14329120,AU:14329120};$3Dmol.elementColors.defaultColors=$3Dmol.elementColors.rasmol;$3Dmol.elementColors.greenCarbon=$.extend({},$3Dmol.elementColors.defaultColors);$3Dmol.elementColors.greenCarbon.C=65280;$3Dmol.elementColors.cyanCarbon=$.extend({},$3Dmol.elementColors.defaultColors);$3Dmol.elementColors.cyanCarbon.C=65535;$3Dmol.elementColors.magentaCarbon=$.extend({},$3Dmol.elementColors.defaultColors);$3Dmol.elementColors.magentaCarbon.C=16711935;
$3Dmol.elementColors.yellowCarbon=$.extend({},$3Dmol.elementColors.defaultColors);$3Dmol.elementColors.yellowCarbon.C=16776960;$3Dmol.elementColors.whiteCarbon=$.extend({},$3Dmol.elementColors.defaultColors);$3Dmol.elementColors.whiteCarbon.C=16777215;$3Dmol.elementColors.orangeCarbon=$.extend({},$3Dmol.elementColors.defaultColors);$3Dmol.elementColors.orangeCarbon.C=16737792;$3Dmol.elementColors.purpleCarbon=$.extend({},$3Dmol.elementColors.defaultColors);$3Dmol.elementColors.purpleCarbon.C=8388736;
$3Dmol.elementColors.blueCarbon=$.extend({},$3Dmol.elementColors.defaultColors);$3Dmol.elementColors.blueCarbon.C=255;$3Dmol=$3Dmol||{};
$3Dmol.drawCartoon=function(){var a=function(a,b){var d=[],g=a,g=[];g.push(a[0]);var f,e,c,s,G,h;f=1;for(e=a.length-1;f<e;f++)s=a[f],G=a[f+1],s.smoothen?g.push(new $3Dmol.Vector3((s.x+G.x)/2,(s.y+G.y)/2,(s.z+G.z)/2)):g.push(s);g.push(a[a.length-1]);f=-1;for(e=g.length;f<=e-3;f++)if(c=g[-1===f?0:f],s=g[f+1],G=g[f+2],h=g[f===e-3?e-1:f+3],c=(new $3Dmol.Vector3).subVectors(G,c).multiplyScalar(.5),h=(new $3Dmol.Vector3).subVectors(h,s).multiplyScalar(.5),!G.skip)for(var l=0;l<b;l++){var y=1/b*l,y=new $3Dmol.Vector3(s.x+
y*c.x+y*y*(-3*s.x+3*G.x-2*c.x-h.x)+y*y*y*(2*s.x-2*G.x+c.x+h.x),s.y+y*c.y+y*y*(-3*s.y+3*G.y-2*c.y-h.y)+y*y*y*(2*s.y-2*G.y+c.y+h.y),s.z+y*c.z+y*y*(-3*s.z+3*G.z-2*c.z-h.z)+y*y*y*(2*s.z-2*G.z+c.z+h.z)),m=Math.floor((d.length+2)/b);void 0!==a[m]&&void 0!==a[m].atom&&(y.atom=a[m].atom);d.push(y)}d.push(g[g.length-1]);return d},b=function(a,b,d,g,f,e){f=new $3Dmol.Geometry(!0);for(var c,s,G,h,l=0,y=b.length;l<y;l++){h=Math.round(l*(g.length-1)/y);G=$3Dmol.CC.color(g[h]);geoGroup=f.updateGeoGroup(2);var m=
geoGroup.vertexArray,t=geoGroup.colorArray;h=geoGroup.faceArray;c=geoGroup.vertices;s=3*c;m[s]=b[l].x;m[s+1]=b[l].y;m[s+2]=b[l].z;m[s+3]=d[l].x;m[s+4]=d[l].y;m[s+5]=d[l].z;for(m=0;6>m;++m)t[s+3*m]=G.r,t[s+1+3*m]=G.g,t[s+2+3*m]=G.b;0<l&&(c=[c,c+1,c-1,c-2],s=geoGroup.faceidx,h[s]=c[0],h[s+1]=c[1],h[s+2]=c[3],h[s+3]=c[1],h[s+4]=c[2],h[s+5]=c[3],geoGroup.faceidx+=6);geoGroup.vertices+=2}f.initTypedArrays();f.setUpNormals();b=new $3Dmol.MeshDoubleLambertMaterial;"number"===typeof e&&0<=e&&1>e&&(b.transparent=
!0,b.opacity=e);b.vertexColors=$3Dmol.FaceColors;e=new $3Dmol.Mesh(f,b);a.add(e)},c=function(b,c,d,g,f){0!==c.length&&(f=void 0===f?5:f,g=new $3Dmol.Geometry,a(c,f),c=new $3Dmol.LineBasicMaterial({linewidth:d}),c.vertexColors=!0,c=new $3Dmol.Line(g,c),c.type=$3Dmol.LineStrip,b.add(c))},q=function(c,E,d,g,f,e,D){D&&"default"!==D||(D="rectangle");if("edged"===D){if(!(2>E.length)){var s,G;s=E[0];G=E[E.length-1];E=g||axisDIV;s=a(s,E);G=a(G,E);if(f){E=new $3Dmol.Geometry(!0);var h=[],l,y,m,t,B,F=[[0,2,
-6,-8],[-4,-2,6,4],[7,-1,-5,3],[-3,5,1,-7]],x,C,u,A,p,q,z,I;p=0;for(q=s.length;p<q;p++){C=Math.round(p*(d.length-1)/q);C=$3Dmol.CC.color(d[C]);h.push(y=s[p]);h.push(y);h.push(m=G[p]);h.push(m);p<q-1&&(l=s[p+1].clone().sub(s[p]),l=G[p].clone().sub(s[p]).cross(l).normalize().multiplyScalar(f));h.push(t=s[p].clone().add(l));h.push(t);h.push(B=G[p].clone().add(l));h.push(B);void 0!==y.atom&&(u=y.atom);D=E.updateGeoGroup(8);z=D.vertexArray;I=D.colorArray;var J=D.faceArray;g=D.vertices;x=3*g;z[x]=y.x;z[x+
1]=y.y;z[x+2]=y.z;z[x+3]=y.x;z[x+4]=y.y;z[x+5]=y.z;z[x+6]=m.x;z[x+7]=m.y;z[x+8]=m.z;z[x+9]=m.x;z[x+10]=m.y;z[x+11]=m.z;z[x+12]=t.x;z[x+13]=t.y;z[x+14]=t.z;z[x+15]=t.x;z[x+16]=t.y;z[x+17]=t.z;z[x+18]=B.x;z[x+19]=B.y;z[x+20]=B.z;z[x+21]=B.x;z[x+22]=B.y;z[x+23]=B.z;for(z=0;8>z;++z)I[x+3*z]=C.r,I[x+1+3*z]=C.g,I[x+2+3*z]=C.b;if(0<p)for(x=void 0!==A&&void 0!==u&&A.serial!==u.serial,z=0;4>z;z++)if(I=[g+F[z][0],g+F[z][1],g+F[z][2],g+F[z][3]],m=D.faceidx,J[m]=I[0],J[m+1]=I[1],J[m+2]=I[3],J[m+3]=I[1],J[m+4]=
I[2],J[m+5]=I[3],D.faceidx+=6,u.clickable||A.clickable){B=h[I[3]].clone();m=h[I[0]].clone();var L=h[I[2]].clone();t=h[I[1]].clone();B.atom=h[I[3]].atom||null;L.atom=h[I[2]].atom||null;m.atom=h[I[0]].atom||null;t.atom=h[I[1]].atom||null;if(x){var Q=B.clone().add(m).multiplyScalar(.5),R=L.clone().add(t).multiplyScalar(.5),N=B.clone().add(t).multiplyScalar(.5);0===z%2?(A.clickable&&(I=new $3Dmol.Triangle(Q,N,B),y=new $3Dmol.Triangle(R,L,N),B=new $3Dmol.Triangle(N,L,B),A.intersectionShape.triangle.push(I),
A.intersectionShape.triangle.push(y),A.intersectionShape.triangle.push(B)),u.clickable&&(I=new $3Dmol.Triangle(m,t,N),y=new $3Dmol.Triangle(t,R,N),B=new $3Dmol.Triangle(m,N,Q),u.intersectionShape.triangle.push(I),u.intersectionShape.triangle.push(y),u.intersectionShape.triangle.push(B))):(u.clickable&&(I=new $3Dmol.Triangle(Q,N,B),y=new $3Dmol.Triangle(R,L,N),B=new $3Dmol.Triangle(N,L,B),u.intersectionShape.triangle.push(I),u.intersectionShape.triangle.push(y),u.intersectionShape.triangle.push(B)),
A.clickable&&(I=new $3Dmol.Triangle(m,t,N),y=new $3Dmol.Triangle(t,R,N),B=new $3Dmol.Triangle(m,N,Q),A.intersectionShape.triangle.push(I),A.intersectionShape.triangle.push(y),A.intersectionShape.triangle.push(B)))}else u.clickable&&(I=new $3Dmol.Triangle(m,t,B),y=new $3Dmol.Triangle(t,L,B),u.intersectionShape.triangle.push(I),u.intersectionShape.triangle.push(y))}D.vertices+=8;A=u}d=h.length-8;D=E.updateGeoGroup(8);z=D.vertexArray;I=D.colorArray;J=D.faceArray;g=D.vertices;x=3*g;m=D.faceidx;for(p=
0;4>p;p++)h.push(h[2*p]),h.push(h[d+2*p]),f=h[2*p],u=h[d+2*p],z[x+6*p]=f.x,z[x+1+6*p]=f.y,z[x+2+6*p]=f.z,z[x+3+6*p]=u.x,z[x+4+6*p]=u.y,z[x+5+6*p]=u.z,I[x+6*p]=C.r,I[x+1+6*p]=C.g,I[x+2+6*p]=C.b,I[x+3+6*p]=C.r,I[x+4+6*p]=C.g,I[x+5+6*p]=C.b;I=[g,g+2,g+6,g+4];y=[g+1,g+5,g+7,g+3];J[m]=I[0];J[m+1]=I[1];J[m+2]=I[3];J[m+3]=I[1];J[m+4]=I[2];J[m+5]=I[3];J[m+6]=y[0];J[m+7]=y[1];J[m+8]=y[3];J[m+9]=y[1];J[m+10]=y[2];J[m+11]=y[3];D.faceidx+=12;D.vertices+=8;E.initTypedArrays();E.setUpNormals();d=new $3Dmol.MeshDoubleLambertMaterial;
d.vertexColors=$3Dmol.FaceColors;"number"===typeof e&&0<=e&&1>e&&(d.transparent=!0,d.opacity=e);e=new $3Dmol.Mesh(E,d);c.add(e)}else b(c,s,G,d,E,e)}}else if("rectangle"===D||"oval"===D||"parabola"===D)if(C=D,u=E.length,!(2>u||2>E[0].length)){g=g||axisDIV;for(A=0;A<u;A++)E[A]=a(E[A],g);l=E[0].length;if(f){g=new $3Dmol.Geometry(!0);D=[];J=[];F=[];for(x=0;x<u;x++)D.push(.25+1.5*Math.sqrt((u-1)*x-Math.pow(x,2))/(u-1)),J.push(.5),F.push(2*(Math.pow(x/u,2)-x/u)+.6);q=[];for(x=0;x<2*u-1;x++)q[x]=[x,x+1,
x+1-2*u,x-2*u];q[2*u-1]=[x,x+1-2*u,x+1-4*u,x-2*u];z=g.updateGeoGroup(2*u*l);for(A=0;A<l;A++){x=Math.round(A*(d.length-1)/l);m=$3Dmol.CC.color(d[x]);I=h;y=p;h=[];p=[];t=[];void 0!==E[0][A].atom&&(G=E[0][A].atom,"oval"===C?s=D:"rectangle"===C?s=J:"parabola"===C&&(s=F));s||(s=J);for(x=0;x<u;x++)B=A<l-1?E[x][A+1].clone().sub(E[x][A]):E[x][A-1].clone().sub(E[x][A]).negate(),L=x<u-1?E[x+1][A].clone().sub(E[x][A]):E[x-1][A].clone().sub(E[x][A]).negate(),t[x]=L.cross(B).normalize().multiplyScalar(f*s[x]);
for(x=0;x<u;x++)h[x]=E[x][A].clone().add(t[x].clone().negate());for(x=0;x<u;x++)p[x]=E[x][A].clone().add(t[x]);Q=z.vertexArray;R=z.colorArray;B=z.faceArray;t=z.vertices;L=3*t;for(x=0;x<u;x++)Q[L+3*x+0]=h[x].x,Q[L+3*x+1]=h[x].y,Q[L+3*x+2]=h[x].z;for(x=0;x<u;x++)Q[L+3*x+0+3*u]=p[u-1-x].x,Q[L+3*x+1+3*u]=p[u-1-x].y,Q[L+3*x+2+3*u]=p[u-1-x].z;for(x=0;x<2*u;++x)R[L+3*x+0]=m.r,R[L+3*x+1]=m.g,R[L+3*x+2]=m.b;if(0<A){for(x=0;x<2*u;x++)L=[t+q[x][0],t+q[x][1],t+q[x][2],t+q[x][3]],m=z.faceidx,B[m]=L[0],B[m+1]=
L[1],B[m+2]=L[3],B[m+3]=L[1],B[m+4]=L[2],B[m+5]=L[3],z.faceidx+=6;if(G.clickable)for(x in m=[],m.push(new $3Dmol.Triangle(I[0],h[0],h[u-1])),m.push(new $3Dmol.Triangle(I[0],h[u-1],I[u-1])),m.push(new $3Dmol.Triangle(I[u-1],h[u-1],p[u-1])),m.push(new $3Dmol.Triangle(I[u-1],p[u-1],y[u-1])),m.push(new $3Dmol.Triangle(p[0],y[0],y[u-1])),m.push(new $3Dmol.Triangle(p[u-1],p[0],y[u-1])),m.push(new $3Dmol.Triangle(h[0],I[0],y[0])),m.push(new $3Dmol.Triangle(p[0],h[0],y[0])),m)G.intersectionShape.triangle.push(m[x])}z.vertices+=
2*u}B=z.faceArray;t=z.vertices;for(A=0;A<u-1;A++)L=[A,A+1,2*u-2-A,2*u-1-A],m=z.faceidx,B[m]=L[0],B[m+1]=L[1],B[m+2]=L[3],B[m+3]=L[1],B[m+4]=L[2],B[m+5]=L[3],z.faceidx+=6;for(A=0;A<u-1;A++)L=[t-1-A,t-2-A,t-2*u+A+1,t-2*u+A],m=z.faceidx,B[m]=L[0],B[m+1]=L[1],B[m+2]=L[3],B[m+3]=L[1],B[m+4]=L[2],B[m+5]=L[3],z.faceidx+=6;g.initTypedArrays();g.setUpNormals();d=new $3Dmol.MeshDoubleLambertMaterial;d.vertexColors=$3Dmol.FaceColors;"number"===typeof e&&0<=e&&1>e&&(d.transparent=!0,d.opacity=e);e=new $3Dmol.Mesh(g,
d);c.add(e)}else b(c,E[0],E[u-1],d,g,e)}},p=function(a,b){return a&&b&&a.chain===b.chain&&a.reschain===b.reschain&&(a.resi===b.resi||a.resi===b.resi-1)},z=function(a,b,d,c,f,e,D,s,G){var h,l=f.sub(c);l.normalize();s=(s=s[parseInt(G)+{ALA:5,ARG:11,ASN:8,ASP:8,CYS:6,GLN:9,GLU:9,GLY:4,HIS:10,ILE:8,LEU:8,LYS:9,MET:8,PHE:11,PRO:7,SER:6,THR:7,TRP:14,TYR:12,VAL:7}[D.resn]])?new $3Dmol.Vector3(s.x,s.y,s.z):new $3Dmol.Vector3(0,0,0);s.sub(c);"arrow start"===D.ss&&(f=s.clone().multiplyScalar(.3).cross(f),c.add(f),
f=s.clone().cross(l).normalize(),l.rotateAboutVector(f,.43));D.style.cartoon.ribbon?f=D.style.cartoon.thickness||.4:D.style.cartoon.width?f=D.style.cartoon.width:"c"===D.ss?f="P"===D.atom?.8:.5:"arrow start"===D.ss?(f=1.3,h=!0):f="arrow end"===D.ss?.5:"h"===D.ss&&D.style.cartoon.tubes||"tube start"===D.ss?.5:1.3;null!=e&&0>l.dot(e)&&l.negate();l.multiplyScalar(f);for(e=0;e<b;e++)f=-1+2*e/(b-1),f=new $3Dmol.Vector3(c.x+f*l.x,c.y+f*l.y,c.z+f*l.z),f.atom=D,d&&"s"===D.ss&&(f.smoothen=!0),a[e].push(f);
if(h)for(l.multiplyScalar(2),e=0;e<b;e++)f=-1+2*e/(b-1),f=new $3Dmol.Vector3(c.x+f*l.x,c.y+f*l.y,c.z+f*l.z),f.atom=D,f.smoothen=!1,f.skip=!0,a[e].push(f);b=parseFloat(D.style.cartoon.opacity)||1;a.opacity?a.opacity!=b&&(console.log("Warning: a cartoon-style chain's opacity is ambiguous"),a.opacity=1):a.opacity=b;b=D.style.cartoon.style||"default";a.style?a.style!=b&&(console.log("Warning: a cartoon chain's strand-style is ambiguous"),a.style="default"):a.style=b;if("arrow start"===D.ss||"arrow end"===
D.ss)D.ss="s";return h};return function(a,b,d,g){g=parseInt(5*parseFloat(g))||5;var f=fill=!0,e=doNotSmoothen=!1,D=num=g;g=div=g;D=D||5;g=g||5;var s="CA O P OP2 O5' O3' C5' C2' N1 N3".split(" "),G=["DA","DG","A","G"],h=["DT","DC","U","C"],l=G.concat(h),y,m,t,B,F,x,C,u,A,P,M,K,I,J,L,Q,R,N=null,S=[],O=[];for(u=0;u<D;u++)O[u]=[];var U=A=!1;u=0;for(u in b)if(B=b[u],"C"===B.elem&&"CA"===B.atom){var T=p(t,B);T&&"s"===B.ss?A=!0:A&&(t&&m&&t.style.cartoon.arrows&&m.style.cartoon.arrows&&(t.ss="arrow end",
m.ss="arrow start"),A=!1);T&&"h"===t.ss?(!U&&B.style.cartoon.tubes&&(B.ss="tube start"),U=!0):U&&"tube start"!==t.ss&&(m&&m.style.cartoon.tubes&&(m.ss="tube end"),U=!1);m=t;t=B}t=void 0;for(u in b)if(B=b[u],void 0!==B&&-1!==$.inArray(B.atom,s)&&!B.hetflag)if(A=-1!=$.inArray(B.resn.trim(),l),m=B.style.cartoon,"trace"===m.style){if(N||(N=new $3Dmol.Geometry(!0)),"C"===B.elem&&"CA"===B.atom||A&&"P"===B.atom)x=d&&"spectrum"===m.color?d.valueToHex(B.resi,d.range()):$3Dmol.getColorFromStyle(B,m).getHex(),
S.push(x),C=$.isNumeric(m.thickness)?m.thickness:.4,t&&t.chain===B.chain&&t.resi+1===B.resi&&(x==F?(F=$3Dmol.CC.color(x),$3Dmol.GLDraw.drawCylinder(N,t,B,C,F,2,2)):(m=(new $3Dmol.Vector3).addVectors(t,B).multiplyScalar(.5),F=$3Dmol.CC.color(F),A=$3Dmol.CC.color(x),$3Dmol.GLDraw.drawCylinder(N,t,m,C,F,2,0),$3Dmol.GLDraw.drawCylinder(N,m,B,C,A,0,2))),t&&N&&(t.style.cartoon&&"trace"!=t.style.cartoon.style||t.chain!=B.chain)?(t=new $3Dmol.MeshDoubleLambertMaterial,t.vertexColors=$3Dmol.FaceColors,"number"===
typeof N.opacity&&0<=N.opacity&&1>N.opacity&&(t.transparent=!0,t.opacity=N.opacity,delete N.opacity),N=new $3Dmol.Mesh(N,t),a.add(N),N=null):t&&(N.opacity&&t.style.cartoon.opacity?N.opacity!=t.style.cartoon.opacity&&(console.log("Warning: a trace-style chain's opacity is ambiguous"),N.opacity=1):N.opacity=parseFloat(t.style.cartoon.opacity)||1),t=B,F=x}else{y||(y=new $3Dmol.Geometry(!0));if(B&&"C"===B.elem&&"CA"===B.atom||A&&("P"===B.atom||"O5'"===B.atom)){if(R)if("tube end"===B.ss)R=!1,A=new $3Dmol.Vector3(B.x,
B.y,B.z),$3Dmol.GLDraw.drawCylinder(y,Q,A,2,$3Dmol.CC.color(F),1,1),B.ss="h";else continue;if(t&&(!p(t,B)||t.style.cartoon.style!==B.style.cartoon.style||"tube start"===t.ss)){"tube start"===t.ss&&(R=!0,Q=new $3Dmol.Vector3(t.x,t.y,t.z),t.ss="h");L&&(A=I?(new $3Dmol.Vector3).addVectors(t,I).multiplyScalar(.5):new $3Dmol.Vector3(t.x,t.y,t.z),$3Dmol.GLDraw.drawCylinder(y,A,L,.4,$3Dmol.CC.color(L.color),0,2),A=z(O,D,!e,I,J,K,t,b,u),S.push(x),A&&S.push(x),L=null);for(u=0;!C&&u<D;u++)c(a,O[u],1,S,g,O.opacity);
f&&0<O[0].length&&q(a,O,S,g,C,O.opacity,O.style);null!=y&&0<y.vertices&&(u=new $3Dmol.MeshDoubleLambertMaterial,u.vertexColors=$3Dmol.FaceColors,"number"===typeof O.opacity&&0<=O.opacity&&1>O.opacity&&(u.transparent=!0,u.opacity=O.opacity),y=new $3Dmol.Mesh(y,u),a.add(y),y=null);O=[];for(u=0;u<D;u++)O[u]=[];S=[]}if(void 0===t||t.resi!=B.resi)L&&(A=(new $3Dmol.Vector3).addVectors(t,B).multiplyScalar(.5),x=A.clone().sub(L).multiplyScalar(.02),A.add(x),$3Dmol.GLDraw.drawCylinder(y,A,L,.4,$3Dmol.CC.color(L.color),
0,2),L=null),x=d&&"spectrum"===m.color?d.valueToHex(B.resi,d.range()):$3Dmol.getColorFromStyle(B,m).getHex(),S.push(x),C=$.isNumeric(m.thickness)?m.thickness:.4,t=B,P=new $3Dmol.Vector3(t.x,t.y,t.z),P.resi=t.resi,F=x;!0!==B.clickable||void 0!==B.intersectionShape&&void 0!==B.intersectionShape.triangle||(B.intersectionShape={sphere:null,cylinder:[],line:[],triangle:[]})}else if(t&&"C"===t.elem&&"CA"===t.atom&&"O"===B.atom||A&&"P"===t.atom&&"OP2"===B.atom||A&&"O5'"===t.atom&&"C5'"===B.atom)M=new $3Dmol.Vector3(B.x,
B.y,B.z),M.resi=B.resi,"OP2"===B.atom&&(J=new $3Dmol.Vector3(B.x,B.y,B.z));else if(A&&"O3'"===B.atom)I=new $3Dmol.Vector3(B.x,B.y,B.z);else if("N1"===B.atom&&-1!=$.inArray(B.resn.trim(),G)||"N3"===B.atom&&-1!=$.inArray(B.resn.trim(),h))L=new $3Dmol.Vector3(B.x,B.y,B.z),L.color=$3Dmol.getColorFromStyle(B,m).getHex();M&&P&&M.resi===P.resi&&(A=z(O,D,!e,P,M,K,t,b,u),K=M,M=P=null,S.push(x),A&&S.push(x))}L&&(A=I?(new $3Dmol.Vector3).addVectors(t,I).multiplyScalar(.5):new $3Dmol.Vector3(t.x,t.y,t.z),$3Dmol.GLDraw.drawCylinder(y,
A,L,.4,$3Dmol.CC.color(L.color),0,2),A=z(O,D,!e,I,J,K,t,b,u),S.push(x),A&&S.push(x));for(u=0;!C&&u<D;u++)c(a,O[u],1,S,g,O.opacity);f&&0<O[0].length&&q(a,O,S,g,C,O.opacity,O.style);null!=y&&0<y.vertices&&(u=new $3Dmol.MeshDoubleLambertMaterial,u.vertexColors=$3Dmol.FaceColors,"number"===typeof O.opacity&&0<=O.opacity&&1>O.opacity&&(u.transparent=!0,u.opacity=O.opacity),y=new $3Dmol.Mesh(y,u),a.add(y));null!=N&&0<N.vertices&&(t=new $3Dmol.MeshDoubleLambertMaterial,t.vertexColors=$3Dmol.FaceColors,"number"===
typeof N.opacity&&0<=N.opacity&&1>N.opacity&&(t.transparent=!0,t.opacity=N.opacity,delete N.opacity),N=new $3Dmol.Mesh(N,t),a.add(N))}}();$3Dmol=$3Dmol||{};
$3Dmol.GLDraw=function(){var a={},b=function(){var a=new $3Dmol.Vector3;return function(b){a.set(b[0],b[1],b[2]);var d=a.x,c=a.y,f=a.z,e=Math.sqrt(d*d+c*c);1E-4>e?(b=0,e=1):(b=-d/e,e=c/e);c=-b*d+e*c;d=Math.sqrt(c*c+f*f);1E-4>d?(f=0,c=1):(f/=d,c/=d);d=new Float32Array(9);d[0]=e;d[1]=b;d[2]=0;d[3]=-b*c;d[4]=e*c;d[5]=f;d[6]=b*f;d[7]=-e*f;d[8]=c;return d}}(),c=function(){var a=[],b=Math.pow(2,4),d,c=Math.pow(2,2),f=b/c,e;a[0]=new $3Dmol.Vector3(-1,0,0);a[f]=new $3Dmol.Vector3(0,0,1);a[2*f]=new $3Dmol.Vector3(1,
0,0);a[3*f]=new $3Dmol.Vector3(0,0,-1);for(d=3;4>=d;d++){c=Math.pow(2,d-1);f=b/c;for(e=0;e<c-1;e++)a[f/2+e*f]=a[e*f].clone().add(a[(e+1)*f]).normalize();e=c-1;a[f/2+e*f]=a[e*f].clone().add(a[0]).normalize()}return a}(),q={cache:{false:{},true:{}},getVerticesForRadius:function(a,b){if(void 0!==this.cache[b][a])return this.cache[b][a];new $3Dmol.Vector3(0,1,0);for(var d=c.length,g=[],f=[],e,D=0;D<d;D++)g.push(c[D].clone().multiplyScalar(a)),g.push(c[D].clone().multiplyScalar(a)),e=c[D].clone().normalize(),
f.push(e),f.push(e);var D=[],s=2*Math.PI,G=Math.PI,h,l,y=!1,m=!1;for(l=0;10>=l;l++){var y=0===l||10===l?!0:!1,m=5===l?!0:!1,t=[],p=[];for(h=0;h<=d;h++)if(m){var F=h<d?2*h:0;p.push(F+1);t.push(F)}else{e=h/d;var x=l/10;y&&0!==h?y&&t.push(g.length-1):h<d?(F=new $3Dmol.Vector3,F.x=-a*Math.cos(0+e*s)*Math.sin(0+x*G),F.y=b?0:a*Math.cos(0+x*G),F.z=a*Math.sin(0+e*s)*Math.sin(0+x*G),1E-5>Math.abs(F.x)&&(F.x=0),1E-5>Math.abs(F.y)&&(F.y=0),1E-5>Math.abs(F.z)&&(F.z=0),e=b?new $3Dmol.Vector3(0,Math.cos(0+x*G),
0):new $3Dmol.Vector3(F.x,F.y,F.z),e.normalize(),g.push(F),f.push(e),t.push(g.length-1)):t.push(g.length-d)}m&&D.push(p);D.push(t)}d={vertices:g,normals:f,verticesRows:D,w:d,h:10};return this.cache[b][a]=d}},p=0;a.drawCylinder=function(a,c,d,g,f,e,D){if(c&&d){p++;var s=e||D,G=1==e&&1==D?!0:!1;f=f||{r:0,g:0,b:0};var h=[d.x,d.y,d.z];h[0]-=c.x;h[1]-=c.y;h[2]-=c.z;var h=b(h),l=q.getVerticesForRadius(g,G);g=l.w;var G=l.h,y=s?G*g+2:2*g;a=a.updateGeoGroup(y);var m=l.vertices,t=l.normals,l=l.verticesRows,
B=l[G/2],F=l[G/2+1],x=a.vertices,C,u,A,z,M,K,I=a.vertexArray,J=a.normalArray,L=a.colorArray,Q=a.faceArray;for(A=0;A<g;++A)u=2*A,z=h[0]*m[u].x+h[3]*m[u].y+h[6]*m[u].z,M=h[1]*m[u].x+h[4]*m[u].y+h[7]*m[u].z,K=h[5]*m[u].y+h[8]*m[u].z,C=3*(x+u),u=a.faceidx,I[C]=z+c.x,I[C+1]=M+c.y,I[C+2]=K+c.z,I[C+3]=z+d.x,I[C+4]=M+d.y,I[C+5]=K+d.z,J[C]=z,J[C+3]=z,J[C+1]=M,J[C+4]=M,J[C+2]=K,J[C+5]=K,L[C]=f.r,L[C+3]=f.r,L[C+1]=f.g,L[C+4]=f.g,L[C+2]=f.b,L[C+5]=f.b,Q[u]=F[A]+x,Q[u+1]=F[A+1]+x,Q[u+2]=B[A]+x,Q[u+3]=B[A]+x,Q[u+
4]=F[A+1]+x,Q[u+5]=B[A+1]+x,a.faceidx+=6;if(s){e=e?G+1:G/2+1;var R,N,S,O,U,T,X,aa,Y,V,H,da,Z;for(M=D?0:G/2;M<e;M++)if(M!==G/2){var ba=M<=G/2?d:c;for(z=0;z<g;z++)u=a.faceidx,D=l[M][z+1],A=3*(D+x),s=l[M][z],K=3*(s+x),B=l[M+1][z],C=3*(B+x),F=l[M+1][z+1],Z=3*(F+x),R=h[0]*m[D].x+h[3]*m[D].y+h[6]*m[D].z,N=h[0]*m[s].x+h[3]*m[s].y+h[6]*m[s].z,S=h[0]*m[B].x+h[3]*m[B].y+h[6]*m[B].z,O=h[0]*m[F].x+h[3]*m[F].y+h[6]*m[F].z,U=h[1]*m[D].x+h[4]*m[D].y+h[7]*m[D].z,T=h[1]*m[s].x+h[4]*m[s].y+h[7]*m[s].z,X=h[1]*m[B].x+
h[4]*m[B].y+h[7]*m[B].z,aa=h[1]*m[F].x+h[4]*m[F].y+h[7]*m[F].z,Y=h[5]*m[D].y+h[8]*m[D].z,V=h[5]*m[s].y+h[8]*m[s].z,H=h[5]*m[B].y+h[8]*m[B].z,da=h[5]*m[F].y+h[8]*m[F].z,I[A]=R+ba.x,I[K]=N+ba.x,I[C]=S+ba.x,I[Z]=O+ba.x,I[A+1]=U+ba.y,I[K+1]=T+ba.y,I[C+1]=X+ba.y,I[Z+1]=aa+ba.y,I[A+2]=Y+ba.z,I[K+2]=V+ba.z,I[C+2]=H+ba.z,I[Z+2]=da+ba.z,L[A]=f.r,L[K]=f.r,L[C]=f.r,L[Z]=f.r,L[A+1]=f.g,L[K+1]=f.g,L[C+1]=f.g,L[Z+1]=f.g,L[A+2]=f.b,L[K+2]=f.b,L[C+2]=f.b,L[Z+2]=f.b,R=h[0]*t[D].x+h[3]*t[D].y+h[6]*t[D].z,N=h[0]*t[s].x+
h[3]*t[s].y+h[6]*t[s].z,S=h[0]*t[B].x+h[3]*t[B].y+h[6]*t[B].z,O=h[0]*t[F].x+h[3]*t[F].y+h[6]*t[F].z,U=h[1]*t[D].x+h[4]*t[D].y+h[7]*t[D].z,T=h[1]*t[s].x+h[4]*t[s].y+h[7]*t[s].z,X=h[1]*t[B].x+h[4]*t[B].y+h[7]*t[B].z,aa=h[1]*t[F].x+h[4]*t[F].y+h[7]*t[F].z,Y=h[5]*t[D].y+h[8]*t[D].z,V=h[5]*t[s].y+h[8]*t[s].z,H=h[5]*t[B].y+h[8]*t[B].z,da=h[5]*t[F].y+h[8]*t[F].z,0===M?(J[A]=R,J[C]=S,J[Z]=O,J[A+1]=U,J[C+1]=X,J[Z+1]=aa,J[A+2]=Y,J[C+2]=H,J[Z+2]=da,Q[u]=D+x,Q[u+1]=B+x,Q[u+2]=F+x,a.faceidx+=3):M===e-1?(J[A]=
R,J[K]=N,J[C]=S,J[A+1]=U,J[K+1]=T,J[C+1]=X,J[A+2]=Y,J[K+2]=V,J[C+2]=H,Q[u]=D+x,Q[u+1]=s+x,Q[u+2]=B+x,a.faceidx+=3):(J[A]=R,J[K]=N,J[Z]=O,J[A+1]=U,J[K+1]=T,J[Z+1]=aa,J[A+2]=Y,J[K+2]=V,J[Z+2]=da,J[K]=N,J[C]=S,J[Z]=O,J[K+1]=T,J[C+1]=X,J[Z+1]=aa,J[K+2]=V,J[C+2]=H,J[Z+2]=da,Q[u]=D+x,Q[u+1]=s+x,Q[u+2]=F+x,Q[u+3]=s+x,Q[u+4]=B+x,Q[u+5]=F+x,a.faceidx+=6)}}a.vertices+=y}};a.drawCone=function(a,p,d,g,f){if(p&&d){f=f||{r:0,g:0,b:0};var e=[d.x,d.y,d.z];e.x-=p.x;e.y-=p.y;e.z-=p.z;var D=b(e),s=c.length;a=a.updateGeoGroup(s+
2);var G=a.vertices,h,l,y,m=a.vertexArray,t=a.normalArray,B=a.colorArray,F=a.faceArray;h=3*G;e=(new $3Dmol.Vector3(e[0],e[1],e[2])).normalize();m[h]=p.x;m[h+1]=p.y;m[h+2]=p.z;t[h]=-e.x;t[h+1]=-e.y;t[h+2]=-e.z;B[h]=f.r;B[h+1]=f.g;B[h+2]=f.b;m[h+3]=d.x;m[h+4]=d.y;m[h+5]=d.z;t[h+3]=e.x;t[h+4]=e.y;t[h+5]=e.z;B[h+3]=f.r;B[h+4]=f.g;B[h+5]=f.b;h+=6;for(d=0;d<s;++d)y=c[d].clone(),y.multiplyScalar(g),e=D[0]*y.x+D[3]*y.y+D[6]*y.z,l=D[1]*y.x+D[4]*y.y+D[7]*y.z,y=D[5]*y.y+D[8]*y.z,m[h]=e+p.x,m[h+1]=l+p.y,m[h+
2]=y+p.z,t[h]=e,t[h+1]=l,t[h+2]=y,B[h]=f.r,B[h+1]=f.g,B[h+2]=f.b,h+=3;a.vertices+=s+2;p=a.faceidx;for(d=0;d<s;d++)g=G+2+d,f=G+2+(d+1)%s,F[p]=g,F[p+1]=f,F[p+2]=G,p+=3,F[p]=g,F[p+1]=f,F[p+2]=G+1,p+=3;a.faceidx+=6*s}};var z={cache:{},getVerticesForRadius:function(a){if("undefined"!==typeof this.cache[a])return this.cache[a];var b={vertices:[],verticesRows:[],normals:[]},d=16,c=10;1>a&&(d=10,c=8);var f=2*Math.PI,e=Math.PI,D,s;for(s=0;s<=c;s++){var p=[];for(D=0;D<=d;D++){var h=D/d,l=s/c,y={};y.x=-a*Math.cos(0+
h*f)*Math.sin(0+l*e);y.y=a*Math.cos(0+l*e);y.z=a*Math.sin(0+h*f)*Math.sin(0+l*e);h=new $3Dmol.Vector3(y.x,y.y,y.z);h.normalize();b.vertices.push(y);b.normals.push(h);p.push(b.vertices.length-1)}b.verticesRows.push(p)}return this.cache[a]=b}};a.drawSphere=function(a,b,d,c){new $3Dmol.Vector3(b.x,b.y,b.z);var f=z.getVerticesForRadius(d),e=f.vertices,D=f.normals;a=a.updateGeoGroup(e.length);for(var s=a.vertices,p=a.vertexArray,h=a.colorArray,l=a.faceArray,y=a.lineArray,m=a.normalArray,t=0,B=e.length;t<
B;++t){var F=3*(s+t),x=e[t];p[F]=x.x+b.x;p[F+1]=x.y+b.y;p[F+2]=x.z+b.z;h[F]=c.r;h[F+1]=c.g;h[F+2]=c.b}a.vertices+=e.length;f=f.verticesRows;p=f.length-1;for(c=0;c<p;c++)for(h=f[c].length-1,b=0;b<h;b++){var t=a.faceidx,B=a.lineidx,F=f[c][b+1]+s,x=3*F,C=f[c][b]+s,u=3*C,A=f[c+1][b]+s,q=3*A,M=f[c+1][b+1]+s,K=3*M,I=D[F-s],J=D[C-s],L=D[A-s],Q=D[M-s];Math.abs(e[F-s].y)===d?(m[x]=I.x,m[q]=L.x,m[K]=Q.x,m[x+1]=I.y,m[q+1]=L.y,m[K+1]=Q.y,m[x+2]=I.z,m[q+2]=L.z,m[K+2]=Q.z,l[t]=F,l[t+1]=A,l[t+2]=M,y[B]=F,y[B+1]=
A,y[B+2]=F,y[B+3]=M,y[B+4]=A,y[B+5]=M,a.faceidx+=3,a.lineidx+=6):Math.abs(e[A-s].y)===d?(m[x]=I.x,m[u]=J.x,m[q]=L.x,m[x+1]=I.y,m[u+1]=J.y,m[q+1]=L.y,m[x+2]=I.z,m[u+2]=J.z,m[q+2]=L.z,l[t]=F,l[t+1]=C,l[t+2]=A,y[B]=F,y[B+1]=C,y[B+2]=F,y[B+3]=A,y[B+4]=C,y[B+5]=A,a.faceidx+=3,a.lineidx+=6):(m[x]=I.x,m[u]=J.x,m[K]=Q.x,m[x+1]=I.y,m[u+1]=J.y,m[K+1]=Q.y,m[x+2]=I.z,m[u+2]=J.z,m[K+2]=Q.z,m[u]=J.x,m[q]=L.x,m[K]=Q.x,m[u+1]=J.y,m[q+1]=L.y,m[K+1]=Q.y,m[u+2]=J.z,m[q+2]=L.z,m[K+2]=Q.z,l[t]=F,l[t+1]=C,l[t+2]=M,l[t+
3]=C,l[t+4]=A,l[t+5]=M,y[B]=F,y[B+1]=C,y[B+2]=F,y[B+3]=M,y[B+4]=C,y[B+5]=A,y[B+6]=A,y[B+7]=M,a.faceidx+=6,a.lineidx+=8)}};return a}();$3Dmol=$3Dmol||{};
$3Dmol.GLModel=function(){var a={line:{}},b={H:1.2,Li:1.82,LI:1.82,Na:2.27,NA:2.27,K:2.75,C:1.7,N:1.55,O:1.52,F:1.47,P:1.8,S:1.8,CL:1.75,Cl:1.75,BR:1.85,Br:1.85,SE:1.9,Se:1.9,ZN:1.39,Zn:1.39,CU:1.4,Cu:1.4,NI:1.63,Ni:1.63},c="resn x y z color surfaceColor elem hetflag chain resi icode rescode serial atom bonds ss singleBonds bondOrder properties b pdbline clickable callback invert".split(" ").concat("model bonds predicate invert byres expand within".split(" ")),q=["line","cross","stick","sphere","cartoon"];
return function(p,z){var w=[],E=[],d=!1,g=null,f=null,e=null,D={},s=new $3Dmol.Matrix4,G,h=$3Dmol.elementColors.defaultColor,l=z?z:$3Dmol.elementColors.defaultColors,y=function(a,f){var d=1.5;"undefined"!=typeof f.radius?d=f.radius:b[a.elem]&&(d=b[a.elem]);"undefined"!=typeof f.scale&&(d*=f.scale);return d},m=function(a,b,f){var d=new $3Dmol.Vector3(a.x,a.y,a.z),e=(new $3Dmol.Vector3(b.x,b.y,b.z)).clone(),c=null;e.sub(d);1===a.bonds.length?1===b.bonds.length?(c=e.clone(),1E-4<Math.abs(c.x)?c.y+=1:
c.x+=1):(f=(f+1)%b.bonds.length,a=b.bonds[f],a=w[a],a=new $3Dmol.Vector3(a.x,a.y,a.z),a=a.clone(),a.sub(d),c=a.clone(),c.cross(e)):(f=(f+1)%a.bonds.length,a=a.bonds[f],a=w[a],a=new $3Dmol.Vector3(a.x,a.y,a.z),a=a.clone(),a.sub(d),c=a.clone(),c.cross(e));.01>c.lengthSq()&&(c=e.clone(),1E-4<Math.abs(c.x)?c.y+=1:c.x+=1);c.cross(e);c.normalize();return c},t=function(a,b,f,d,e,c){a[f]=d.x;a[f+1]=d.y;a[f+2]=d.z;b[f]=c.r;b[f+1]=c.g;b[f+2]=c.b;a[f+3]=e.x;a[f+4]=e.y;a[f+5]=e.z;b[f+3]=c.r;b[f+4]=c.g;b[f+5]=
c.b};this.getCrystData=function(){return D.cryst?D.cryst:null};this.getSymmetries=function(){"undefined"==typeof D.symmetries&&(D.symmetries=[s]);return D.symmetries};this.setSymmetries=function(a){D.symmetries="undefined"==typeof a?[s]:a};this.getID=function(){return p};this.getFrames=function(){return E};this.setFrame=function(a){0!=E.length&&(w=0<=a&&a<E.length?E[a]:E[E.length-1],g=null)};this.addFrame=function(a){E.push(a)};this.vibrate=function(a,b){var f=[];b=b||1;a=a||10;for(var d=0;d<w.length;d++){var e=
new $3Dmol.Vector3(w[d].dx,w[d].dy,w[d].dz);f.push(e)}a--;for(d=1;d<=a;d++){f=[];for(e=0;e<w.length;e++){var c=new $3Dmol.Vector3(w[e].dx,w[e].dy,w[e].dz),h=new $3Dmol.Vector3(w[e].x,w[e].y,w[e].z);c.sub(h);c.multiplyScalar(d*b/a);h.add(c);var c={},g;for(g in w[e])c[g]=w[e][g];c.x=h.x;c.y=h.y;c.z=h.z;f.push(c)}E.push(f)}E.unshift(w)};this.addMolData=function(b,f,d){d=d||{};f=f||"";G=!d.duplicateAssemblyAtoms;if(b){if(/\.gz$/.test(f)){f=f.replace(/\.gz$/,"");try{b=pako.inflate(b,{to:"string"})}catch(e){console.log(e)}}"undefined"==
typeof $3Dmol.Parsers[f]&&(f=f.split(".").pop(),"undefined"==typeof $3Dmol.Parsers[f]&&(console.log("Unknown format: "+f),f=b.match(/^@<TRIPOS>MOLECULE/gm)?"mol2":b.match(/^HETATM/gm)||b.match(/^ATOM/gm)?"pdb":b.match(/^.*\n.*\n.\s*(\d+)\s+(\d+)/gm)?"sdf":"xyz",console.log("Best guess: "+f)));b=(0,$3Dmol.Parsers[f])(b,d,D);if(0==E.length){for(d=0;d<b.length;d++)0!=b[d].length&&E.push(b[d]);E[0]&&(w=E[0])}else if(d.frames)for(d=0;d<b.length;d++)E.push(b[d]);else for(d=0;d<b.length;d++)this.addAtoms(b[d]);
for(d=0;d<E.length;d++){b=E[d];f=p;for(var c=0;c<b.length;c++){var g=b[c];g&&(g.style=g.style||a,g.color=g.color||l[g.elem]||h,g.model=f,g.clickable&&(g.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}))}}}};this.atomIsSelected=function(a,b){if("undefined"===typeof b)return!0;var f=!!b.invert,d=!0,e;for(e in b)if("predicate"===e){if(!b.predicate(a)){d=!1;break}}else if(b.hasOwnProperty(e)&&"props"!=e&&"invert"!=e&&"model"!=e&&"byres"!=e&&"expand"!=e&&"within"!=e){if("undefined"===typeof a[e]){d=
!1;break}var c=!1;if("bonds"===e){if(c=b[e],c!=a.bonds.length){d=!1;break}}else if($.isArray(b[e])){for(var g=b[e],h=0;h<g.length;h++)if(a[e]==g[h]){c=!0;break}if(!c){d=!1;break}}else if(c=b[e],a[e]!=c){d=!1;break}}return f?!d:d};this.selectedAtoms=function(a,b){var f=[];a=a||{};b||(b=w);for(var d=b.length,e=0;e<d;e++){var c=b[e];c&&this.atomIsSelected(c,a)&&f.push(c)}if(a.hasOwnProperty("expand")){var g;var h=parseFloat(a.expand);if(0>=h)g=f;else{e=$3Dmol.getExtent(f);d=[[],[],[]];for(c=0;3>c;c++)d[0][c]=
e[0][c]-h,d[1][c]=e[1][c]+h,d[2][c]=e[2][c];h=[];for(c=0;c<w.length;c++){g=w[c].x;var l=w[c].y,m=w[c].z;g>=d[0][0]&&g<=d[1][0]&&l>=d[0][1]&&l<=d[1][1]&&m>=d[0][2]&&m<=d[1][2]&&(g>=e[0][0]&&g<=e[1][0]&&l>=e[0][1]&&l<=e[1][1]&&m>=e[0][2]&&m<=e[1][2]||h.push(w[c]))}g=h}l=f.length;for(e=0;e<g.length;e++)for(d=0;d<l;d++)c=B(g[e],f[d]),h=Math.pow(a.expand,2),c<h&&0<c&&f.push(g[e])}if(a.hasOwnProperty("within")&&a.within.hasOwnProperty("sel")&&a.within.hasOwnProperty("distance")){g=this.selectedAtoms(a.within.sel,
w);l=[];for(e=0;e<g.length;e++)for(d=0;d<f.length;d++)c=B(g[e],f[d]),h=Math.pow(parseFloat(a.within.distance),2),c<h&&0<c&&l.push(f[d]);f=l}if(a.hasOwnProperty("byres"))for(h={},g=[],l=[],e=0;e<f.length;e++){var c=f[e],m=c.chain,D=c.resi;void 0===h[m]&&(h[m]={});if(c.hasOwnProperty("resi")&&void 0===h[m][D])for(h[m][D]=!0,l.push(c);0<l.length;)if(c=l.pop(),m=c.chain,D=c.resi,void 0===g[c.index])for(g[c.index]=!0,d=0;d<c.bonds.length;d++){var s=w[c.bonds[d]];void 0===g[s.index]&&s.hasOwnProperty("resi")&&
s.chain==m&&s.resi==D&&(l.push(s),f.push(s))}}return f};var B=function(a,b){var f=b.y-a.y,d=b.z-a.z;return Math.pow(b.x-a.x,2)+Math.pow(f,2)+Math.pow(d,2)};this.addAtoms=function(a){g=null;var b=w.length,f=[],d;for(d=0;d<a.length;d++)f[a[d].index]=b+d;for(d=0;d<a.length;d++){var b=a[d],e=f[b.index],c=$.extend(!1,{},b);c.index=e;c.bonds=[];c.bondOrder=[];for(e=0;e<b.bonds.length;e++){var h=f[b.bonds[e]];"undefined"!=typeof h&&(c.bonds.push(h),c.bondOrder.push(b.bondOrder[e]))}w.push(c)}};this.removeAtoms=
function(a){g=null;var b=[],f;for(f=0;f<a.length;f++)b[a[f].index]=!0;a=[];for(f=0;f<w.length;f++){var d=w[f];b[d.index]||a.push(d)}w=[];this.addAtoms(a)};this.setStyle=function(a,b,f){for(var d in a)-1===c.indexOf(d)&&console.log("Unknown selector "+d);for(d in b)-1===q.indexOf(d)&&console.log("Unknown style "+d);var e=!1,h=function(c){for(var h=l.selectedAtoms(a,c),g=0;g<c.length;g++)c[g]&&(c[g].capDrawn=!1);for(g=0;g<h.length;g++)for(d in e=!0,h[g].clickable&&(h[g].intersectionShape={sphere:[],
cylinder:[],line:[],triangle:[]}),f||(h[g].style={}),b)if(b.hasOwnProperty(d)){h[g].style[d]=h[g].style[d]||{};for(var m in b[d])h[g].style[d][m]=b[d][m]}},l=this;h(w);for(var m=0;m<E.length;m++)h(E[m]);e&&(g=null)};this.setClickable=function(a,b,f){for(var d in a)-1===c.indexOf(d)&&console.log("Unknown selector "+d);b=!!b;if(f&&"function"!=typeof f)console.log("Callback is not a function");else{d=this.selectedAtoms(a,w);var e=d.length;for(a=0;a<e;a++)d[a].intersectionShape={sphere:[],cylinder:[],
line:[],triangle:[]},d[a].clickable=b,f&&(d[a].callback=f);0<e&&(g=null)}};this.setColorByElement=function(a,b){var f;if(f=null!==g)f=e,f=b&&f?JSON.stringify(b)==JSON.stringify(f):b==f;if(!f){e=b;var d=this.selectedAtoms(a,d);0<d.length&&(g=null);for(f=0;f<d.length;f++){var c=d[f];"undefined"!==typeof b[c.elem]&&(c.color=b[c.elem])}}};this.setColorByProperty=function(a,b,f,d){var c=this.selectedAtoms(a,c);e=null;0<c.length&&(g=null);var h;d||(d=f.range());d||(d=$3Dmol.getPropertyRange(c,b));for(a=
0;a<c.length;a++)h=c[a],null!=$3Dmol.getAtomProperty(h,b)&&(h.color=f.valueToHex(parseFloat(h.properties[b]),[d[0],d[1]]))};this.toCDObject=function(a){var b={a:[],b:[]};a&&(b.s=[]);for(var f=0;f<w.length;f++){var d={},e=w[f];d.x=e.x;d.y=e.y;d.z=e.z;"C"!=e.elem&&(d.l=e.elem);if(a){for(var c=0;c<b.s.length&&JSON.stringify(e.style)!==JSON.stringify(b.s[c]);)c++;c===b.s.length&&b.s.push(e.style);0!==c&&(d.s=c)}b.a.push(d);for(d=0;d<e.bonds.length;d++){var c=f,h=e.bonds[d];c>=h||(c={b:c,e:h},h=e.bondOrder[d],
1!=h&&(c.o=h),b.b.push(c))}}return b};this.globj=function(a){if(null===g){var b=w,e=new $3Dmol.Object3D,c=[],h={},l={},s=new $3Dmol.Geometry(!0),p=new $3Dmol.Geometry(!0),B=new $3Dmol.Geometry(!0),q,z,E,R,N={},S=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];q=0;for(E=b.length;q<E;q++){var O=b[q];if(O&&O.style){O.clickable&&void 0===O.intersectionShape&&(O.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]});R={line:void 0,cross:void 0,stick:void 0,sphere:void 0};for(z in R)R[z]=O.style[z]?
O.style[z].opacity?parseFloat(O.style[z].opacity):1:void 0,N[z]?void 0!=R[z]&&N[z]!=R[z]&&(console.log("Warning: "+z+" opacity is ambiguous"),N[z]=1):N[z]=R[z];var U=O,T=s;if(U.style.sphere){var X=U.style.sphere;if(!X.hidden){var aa=$3Dmol.getColorFromStyle(U,X),Y=y(U,X);if(!0===U.clickable&&void 0!==U.intersectionShape){var V=new $3Dmol.Vector3(U.x,U.y,U.z);U.intersectionShape.sphere.push(new $3Dmol.Sphere(V,Y))}$3Dmol.GLDraw.drawSphere(T,U,Y,aa)}}var H=O,da=p;if(H.style.spherei){var Z=H.style.spherei;
if(!Z.hidden){for(var ba=y(H,Z),Ka=$3Dmol.getColorFromStyle(H,Z),ma=da.updateGeoGroup(4),Ja=ma.vertices,ga=3*Ja,Pa=ma.vertexArray,Ta=ma.colorArray,Ca=0;4>Ca;Ca++)Pa[ga+3*Ca]=H.x,Pa[ga+3*Ca+1]=H.y,Pa[ga+3*Ca+2]=H.z;for(var ya=ma.normalArray,Ta=ma.colorArray,Ca=0;4>Ca;Ca++)Ta[ga+3*Ca]=Ka.r,Ta[ga+3*Ca+1]=Ka.g,Ta[ga+3*Ca+2]=Ka.b;ya[ga+0]=-ba;ya[ga+1]=ba;ya[ga+2]=0;ya[ga+3]=-ba;ya[ga+4]=-ba;ya[ga+5]=0;ya[ga+6]=ba;ya[ga+7]=-ba;ya[ga+8]=0;ya[ga+9]=ba;ya[ga+10]=ba;ya[ga+11]=0;ma.vertices+=4;var Ua=ma.faceArray,
Va=ma.faceidx;Ua[Va+0]=Ja;Ua[Va+1]=Ja+1;Ua[Va+2]=Ja+2;Ua[Va+3]=Ja+2;Ua[Va+4]=Ja+3;Ua[Va+5]=Ja;ma.faceidx+=6}}var ua=O,mb=l;if(ua.style.cross){var fb=ua.style.cross;if(!fb.hidden){var nb=fb.linewidth||1;mb[nb]||(mb[nb]=new $3Dmol.Geometry);var gb=mb[nb].updateGeoGroup(6),Wa=y(ua,fb),Xa=[[Wa,0,0],[-Wa,0,0],[0,Wa,0],[0,-Wa,0],[0,0,Wa],[0,0,-Wa]],zb=ua.clickable;zb&&void 0===ua.intersectionShape&&(ua.intersectionShape={sphere:[],cylinder:[],line:[]});for(var ob=$3Dmol.getColorFromStyle(ua,fb),pb=gb.vertexArray,
qb=gb.colorArray,Ma=0;6>Ma;Ma++){var Ya=3*gb.vertices;gb.vertices++;pb[Ya]=ua.x+Xa[Ma][0];pb[Ya+1]=ua.y+Xa[Ma][1];pb[Ya+2]=ua.z+Xa[Ma][2];qb[Ya]=ob.r;qb[Ya+1]=ob.g;qb[Ya+2]=ob.b;if(zb){var Za=new $3Dmol.Vector3(Xa[Ma][0],Xa[Ma][1],Xa[Ma][2]);Za.multiplyScalar(.1);Za.set(Za.x+ua.x,Za.y+ua.y,Za.z+ua.z);ua.intersectionShape.line.push(Za)}}}}var ea=O,Hb=b,rb=h;if(ea.style.line){var Ab=ea.style.line;if(!Ab.hidden){var sb=Ab.linewidth||1;rb[sb]||(rb[sb]=new $3Dmol.Geometry);for(var ta=rb[sb].updateGeoGroup(6*
ea.bonds.length),ja=ta.vertexArray,ha=ta.colorArray,Fa=0;Fa<ea.bonds.length;Fa++){var Na=Hb[ea.bonds[Fa]];if(Na.style.line&&!(ea.serial>=Na.serial)){var Da=new $3Dmol.Vector3(ea.x,ea.y,ea.z),Qa=new $3Dmol.Vector3(Na.x,Na.y,Na.z),hb=Da.clone().add(Qa).multiplyScalar(.5),Bb=!1;ea.clickable&&(void 0===ea.intersectionShape&&(ea.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),ea.intersectionShape.line.push(Da),ea.intersectionShape.line.push(Qa));var pa=$3Dmol.getColorFromStyle(ea,ea.style.line),
Ga=$3Dmol.getColorFromStyle(Na,Na.style.line);if(ea.bondStyles&&ea.bondStyles[Fa]){var Oa=ea.bondStyles[Fa];if(!Oa.iswire)continue;Oa.radius&&(bondR=Oa.radius);Oa.singleBond&&(Bb=!0);"undefined"!=typeof Oa.color1&&(pa=$3Dmol.CC.color(Oa.color1));"undefined"!=typeof Oa.color2&&(Ga=$3Dmol.CC.color(Oa.color2))}var ka=3*ta.vertices;if(1<ea.bondOrder[Fa]&&4>ea.bondOrder[Fa]&&!Bb){var $a=m(ea,Na,Fa),Ea=Qa.clone();Ea.sub(Da);if(2==ea.bondOrder[Fa])if($a.multiplyScalar(.1),p1a=Da.clone(),p1a.add($a),p1b=
Da.clone(),p1b.sub($a),p2a=p1a.clone(),p2a.add(Ea),p2b=p1b.clone(),p2b.add(Ea),pa==Ga)ta.vertices+=4,t(ja,ha,ka,p1a,p2a,pa),t(ja,ha,ka+6,p1b,p2b,pa);else{ta.vertices+=8;Ea.multiplyScalar(.5);var Ra=p1a.clone();Ra.add(Ea);var Sa=p1b.clone();Sa.add(Ea);t(ja,ha,ka,p1a,Ra,pa);t(ja,ha,ka+6,Ra,p2a,Ga);t(ja,ha,ka+12,p1b,Sa,pa);t(ja,ha,ka+18,Sa,p2b,Ga)}else 3==ea.bondOrder[Fa]&&($a.multiplyScalar(.1),p1a=Da.clone(),p1a.add($a),p1b=Da.clone(),p1b.sub($a),p2a=p1a.clone(),p2a.add(Ea),p2b=p1b.clone(),p2b.add(Ea),
pa==Ga?(ta.vertices+=6,t(ja,ha,ka,Da,Qa,pa),t(ja,ha,ka+6,p1a,p2a,pa),t(ja,ha,ka+12,p1b,p2b,pa)):(ta.vertices+=12,Ea.multiplyScalar(.5),Ra=p1a.clone(),Ra.add(Ea),Sa=p1b.clone(),Sa.add(Ea),t(ja,ha,ka,Da,hb,pa),t(ja,ha,ka+6,hb,Qa,Ga),t(ja,ha,ka+12,p1a,Ra,pa),t(ja,ha,ka+18,Ra,p2a,Ga),t(ja,ha,ka+24,p1b,Sa,pa),t(ja,ha,ka+30,Sa,p2b,Ga)))}else pa==Ga?(ta.vertices+=2,t(ja,ha,ka,Da,Qa,pa)):(ta.vertices+=4,t(ja,ha,ka,Da,hb,pa),t(ja,ha,ka+6,hb,Qa,Ga))}}}}var W=O,Ib=b,ia=B;if(W.style.stick){var ib=W.style.stick;
if(!ib.hidden){var bb=ib.radius||.25,va=bb,Cb=ib.singleBonds||!1,cb=0,db=0,na=$3Dmol.getColorFromStyle(W,ib),la=void 0,za=void 0;!W.capDrawn&&4>W.bonds.length&&(cb=2);for(var oa=0;oa<W.bonds.length;oa++){var fa=Ib[W.bonds[oa]];if(W.serial<fa.serial){var Db=fa.style;if(Db.stick){var Ha=$3Dmol.getColorFromStyle(fa,Db.stick),va=bb,eb=Cb;if(W.bondStyles&&W.bondStyles[oa]){var Aa=W.bondStyles[oa];if(Aa.iswire)continue;Aa.radius&&(va=Aa.radius);Aa.singleBond&&(eb=!0);"undefined"!=typeof Aa.color1&&(na=
$3Dmol.CC.color(Aa.color1));"undefined"!=typeof Aa.color2&&(Ha=$3Dmol.CC.color(Aa.color2))}var qa=new $3Dmol.Vector3(W.x,W.y,W.z),Ba=new $3Dmol.Vector3(fa.x,fa.y,fa.z);if(1===W.bondOrder[oa]||eb){if(!fa.capDrawn&&4>fa.bonds.length&&(db=2),na!=Ha?(la=(new $3Dmol.Vector3).addVectors(qa,Ba).multiplyScalar(.5),$3Dmol.GLDraw.drawCylinder(ia,qa,la,va,na,cb,0),$3Dmol.GLDraw.drawCylinder(ia,la,Ba,va,Ha,0,db)):$3Dmol.GLDraw.drawCylinder(ia,qa,Ba,va,na,cb,db),W.clickable||fa.clickable){la=(new $3Dmol.Vector3).addVectors(qa,
Ba).multiplyScalar(.5);if(W.clickable){var Jb=new $3Dmol.Cylinder(qa,la,va),Kb=new $3Dmol.Sphere(qa,va);W.intersectionShape.cylinder.push(Jb);W.intersectionShape.sphere.push(Kb)}if(fa.clickable){var Lb=new $3Dmol.Cylinder(Ba,la,va),Mb=new $3Dmol.Sphere(Ba,va);fa.intersectionShape.cylinder.push(Lb);fa.intersectionShape.sphere.push(Mb)}}}else if(1<W.bondOrder[oa]){var La=0;mtoCap=0;va!=bb&&(mtoCap=La=2);var ab=Ba.clone(),Ia=null;ab.sub(qa);var ca,ra,sa,wa,xa,Ia=m(W,fa,oa);if(2==W.bondOrder[oa]){if(ca=
va/2.5,Ia=m(W,fa,oa),Ia.multiplyScalar(1.5*ca),ra=qa.clone(),ra.add(Ia),sa=qa.clone(),sa.sub(Ia),wa=ra.clone(),wa.add(ab),xa=sa.clone(),xa.add(ab),na!=Ha?(la=(new $3Dmol.Vector3).addVectors(ra,wa).multiplyScalar(.5),za=(new $3Dmol.Vector3).addVectors(sa,xa).multiplyScalar(.5),$3Dmol.GLDraw.drawCylinder(ia,ra,la,ca,na,La,0),$3Dmol.GLDraw.drawCylinder(ia,la,wa,ca,Ha,0,mtoCap),$3Dmol.GLDraw.drawCylinder(ia,sa,za,ca,na,La,0),$3Dmol.GLDraw.drawCylinder(ia,za,xa,ca,Ha,0,mtoCap)):($3Dmol.GLDraw.drawCylinder(ia,
ra,wa,ca,na,La,mtoCap),$3Dmol.GLDraw.drawCylinder(ia,sa,xa,ca,na,La,mtoCap)),W.clickable||fa.clickable)la=(new $3Dmol.Vector3).addVectors(ra,wa).multiplyScalar(.5),za=(new $3Dmol.Vector3).addVectors(sa,xa).multiplyScalar(.5),W.clickable&&(cylinder1a=new $3Dmol.Cylinder(ra,la,ca),cylinder1b=new $3Dmol.Cylinder(sa,za,ca),W.intersectionShape.cylinder.push(cylinder1a),W.intersectionShape.cylinder.push(cylinder1b)),fa.clickable&&(cylinder2a=new $3Dmol.Cylinder(wa,la,ca),cylinder2b=new $3Dmol.Cylinder(xa,
za,ca),fa.intersectionShape.cylinder.push(cylinder2a),fa.intersectionShape.cylinder.push(cylinder2b))}else 3==W.bondOrder[oa]&&(ca=va/4,Ia.cross(ab),Ia.normalize(),Ia.multiplyScalar(3*ca),ra=qa.clone(),ra.add(Ia),sa=qa.clone(),sa.sub(Ia),wa=ra.clone(),wa.add(ab),xa=sa.clone(),xa.add(ab),na!=Ha?(la=(new $3Dmol.Vector3).addVectors(ra,wa).multiplyScalar(.5),za=(new $3Dmol.Vector3).addVectors(sa,xa).multiplyScalar(.5),mp3=(new $3Dmol.Vector3).addVectors(qa,Ba).multiplyScalar(.5),$3Dmol.GLDraw.drawCylinder(ia,
ra,la,ca,na,La,0),$3Dmol.GLDraw.drawCylinder(ia,la,wa,ca,Ha,0,mtoCap),$3Dmol.GLDraw.drawCylinder(ia,qa,mp3,ca,na,cb,0),$3Dmol.GLDraw.drawCylinder(ia,mp3,Ba,ca,Ha,0,db),$3Dmol.GLDraw.drawCylinder(ia,sa,za,ca,na,La,0),$3Dmol.GLDraw.drawCylinder(ia,za,xa,ca,Ha,0,mtoCap)):($3Dmol.GLDraw.drawCylinder(ia,ra,wa,ca,na,La,mtoCap),$3Dmol.GLDraw.drawCylinder(ia,qa,Ba,ca,na,cb,db),$3Dmol.GLDraw.drawCylinder(ia,sa,xa,ca,na,La,mtoCap)),W.clickable||fa.clickable)&&(la=(new $3Dmol.Vector3).addVectors(ra,wa).multiplyScalar(.5),
za=(new $3Dmol.Vector3).addVectors(sa,xa).multiplyScalar(.5),mp3=(new $3Dmol.Vector3).addVectors(qa,Ba).multiplyScalar(.5),W.clickable&&(cylinder1a=new $3Dmol.Cylinder(ra.clone(),la.clone(),ca),cylinder1b=new $3Dmol.Cylinder(sa.clone(),za.clone(),ca),cylinder1c=new $3Dmol.Cylinder(qa.clone(),mp3.clone(),ca),W.intersectionShape.cylinder.push(cylinder1a),W.intersectionShape.cylinder.push(cylinder1b),W.intersectionShape.cylinder.push(cylinder1c)),fa.clickable&&(cylinder2a=new $3Dmol.Cylinder(wa.clone(),
la.clone(),ca),cylinder2b=new $3Dmol.Cylinder(xa.clone(),za.clone(),ca),cylinder2c=new $3Dmol.Cylinder(Ba.clone(),mp3.clone(),ca),fa.intersectionShape.cylinder.push(cylinder2a),fa.intersectionShape.cylinder.push(cylinder2b),fa.intersectionShape.cylinder.push(cylinder2c)))}}}}for(var tb=!1,ub=0,Eb=!1,oa=0;oa<W.bonds.length;oa++)eb=Cb,W.bondStyles&&W.bondStyles[oa]&&(Aa=W.bondStyles[oa],Aa.singleBond&&(eb=!0),Aa.radius&&Aa.radius!=bb&&(Eb=!0)),(eb||1==W.bondOrder[oa])&&ub++;Eb?0<ub&&(tb=!0):0==ub&&
0<W.bonds.length&&(tb=!0);tb&&(va=bb,$3Dmol.GLDraw.drawSphere(ia,W,va,na))}}"undefined"===typeof O.style.cartoon||O.style.cartoon.hidden||("spectrum"!==O.style.cartoon.color||"number"!==typeof O.resi||O.hetflag||(O.resi<S[0]&&(S[0]=O.resi),O.resi>S[1]&&(S[1]=O.resi)),c.push(O))}}if(0<c.length){var Fb=null;S[0]<S[1]&&(Fb=new $3Dmol.Gradient.Sinebow(S[0],S[1]));$3Dmol.drawCartoon(e,c,Fb)}if(0<s.vertices){var vb=new $3Dmol.MeshLambertMaterial({ambient:0,vertexColors:!0,reflectivity:0});1>N.sphere&&0<=
N.sphere&&(vb.transparent=!0,vb.opacity=N.sphere);s.initTypedArrays();var Nb=new $3Dmol.Mesh(s,vb);e.add(Nb)}if(0<p.vertices){var Ob=new $3Dmol.ImposterMaterial({ambient:0,vertexColors:!0,reflectivity:0});p.initTypedArrays();var Pb=new $3Dmol.Mesh(p,Ob);console.log("spherei geometry "+p.vertices.length);e.add(Pb)}if(0<B.vertices){var jb=new $3Dmol.MeshLambertMaterial({vertexColors:!0,ambient:0,reflectivity:0});1>N.stick&&0<=N.stick&&(jb.transparent=!0,jb.opacity=N.stick);B.initTypedArrays();jb.wireframe&&
B.setUpWireframe();var Qb=new $3Dmol.Mesh(B,jb);e.add(Qb)}for(q in h)if(h.hasOwnProperty(q)){var wb=q,xb=new $3Dmol.LineBasicMaterial({linewidth:wb,vertexColors:!0});1>N.line&&0<=N.line&&(xb.transparent=!0,xb.opacity=N.line);h[q].initTypedArrays();var Rb=new $3Dmol.Line(h[q],xb,$3Dmol.LinePieces);e.add(Rb)}for(q in l)if(l.hasOwnProperty(q)){var wb=q,yb=new $3Dmol.LineBasicMaterial({linewidth:wb,vertexColors:!0});1>N.cross&&0<=N.cross&&(yb.transparent=!0,yb.opacity=N.cross);l[q].initTypedArrays();
var Sb=new $3Dmol.Line(l[q],yb,$3Dmol.LinePieces);e.add(Sb)}if(G&&D.symmetries&&0<D.symmetries.length){var Gb=new $3Dmol.Object3D,kb;for(kb=0;kb<D.symmetries.length;kb++){var lb=new $3Dmol.Object3D,lb=e.clone();lb.matrix.copy(D.symmetries[kb]);lb.matrixAutoUpdate=!1;Gb.add(lb)}g=Gb}else g=e;f&&(a.remove(f),f=null);f=g.clone();d&&(f.setVisible(!1),g.setVisible(!1));a.add(f)}};this.removegl=function(a){f&&(void 0!==f.geometry&&f.geometry.dispose(),void 0!==f.material&&f.material.dispose(),a.remove(f),
f=null);g=null};this.hide=function(){d=!0;f&&f.setVisible(!1);g&&g.setVisible(!1)};this.show=function(){d=!1;f&&f.setVisible(!0);g&&g.setVisible(!0)};this.addResLabels=function(a,b,f){var d=this.selectedAtoms(a,d);a={};for(var e=0;e<d.length;e++){var c=d[e],h=c.chain,g=c.resn+""+c.resi;a[h]||(a[h]={});a[h][g]||(a[h][g]=[]);a[h][g].push(c)}f=$.extend(!0,{},f);for(h in a)if(a.hasOwnProperty(h)){var l=a[h];for(g in l)if(l.hasOwnProperty(g)){for(var d=l[g],m=new $3Dmol.Vector3(0,0,0),e=0;e<d.length;e++)c=
d[e],m.x+=c.x,m.y+=c.y,m.z+=c.z;m.divideScalar(d.length);f.position=m;b.addLabel(g,f)}}}}}();
$3Dmol.GLShape=function(){function a(a){a=a||{};$3Dmol.ShapeIDCount++;this.boundingSphere=new $3Dmol.Sphere;this.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]};q(this,a);var z=[],w=null,E=null,d=new $3Dmol.Geometry(!0),g=new $3Dmol.Geometry(!0);this.updateStyle=function(b){for(var d in b)a[d]=b[d];q(this,a)};this.addCustom=function(a){a.vertexArr=a.vertexArr||[];a.faceArr=a.faceArr||[];a.normalArr=a.normalArr||[];b(this,d,a)};this.addSphere=function(a){a.center=a.center||{x:0,y:0,z:0};
a.radius=a.radius?$3Dmol.Math.clamp(a.radius,0,Infinity):1.5;a.color=$3Dmol.CC.color(a.color);this.intersectionShape.sphere.push(new $3Dmol.Sphere(a.center,a.radius));var b=d.addGeoGroup();$3Dmol.GLDraw.drawSphere(d,a.center,a.radius,a.color);b.truncateArrayBuffers(!0,!0);z.push({id:b.id,geoGroup:b,centroid:new $3Dmol.Vector3(a.center.x,a.center.y,a.center.z)});c(this.boundingSphere,z,b.vertexArray)};this.addCylinder=function(a){a.start=a.start||{};a.end=a.end||{};var b=new $3Dmol.Vector3(a.start.x||
0,a.start.y||0,a.start.z||0),g=new $3Dmol.Vector3(a.end.x,a.end.y||0,a.end.z||0);"undefined"==typeof g.x&&(g.x=3);var s=a.radius||.1,p=$3Dmol.CC.color(a.color);this.intersectionShape.cylinder.push(new $3Dmol.Cylinder(b,g,s));var h=d.addGeoGroup();$3Dmol.GLDraw.drawCylinder(d,b,g,s,p,a.fromCap,a.toCap);h.truncateArrayBuffers(!0,!0);a=new $3Dmol.Vector3;z.push({id:h.id,geoGroup:h,centroid:a.addVectors(b,g).multiplyScalar(.5)});c(this.boundingSphere,z,h.vertexArray)};this.addLine=function(a){a.start=
a.start||{};a.end=a.end||{};var b=new $3Dmol.Vector3(a.start.x||0,a.start.y||0,a.start.z||0),c=new $3Dmol.Vector3(a.end.x,a.end.y||0,a.end.z||0);"undefined"==typeof c.x&&(c.x=3);a=d.addGeoGroup();var g=a.vertices,p=3*g,h=a.vertexArray;h[p]=b.x;h[p+1]=b.y;h[p+2]=b.z;h[p+3]=c.x;h[p+4]=c.y;h[p+5]=c.z;a.vertices+=2;b=a.lineArray;c=a.lineidx;b[c]=g;b[c+1]=g+1;a.lineidx+=2;a.truncateArrayBuffers(!0,!0)};this.addArrow=function(a){a.start=a.start||{};a.end=a.end||{};a.start=new $3Dmol.Vector3(a.start.x||
0,a.start.y||0,a.start.z||0);if(a.dir instanceof $3Dmol.Vector3&&a.length instanceof number){var b=a.dir.clone().multiplyScalar(a.length).add(start);a.end=b}else a.end=new $3Dmol.Vector3(a.end.x,a.end.y||0,a.end.z||0),"undefined"==typeof a.end.x&&(a.end.x=3);a.radius=a.radius||.1;a.radiusRatio=a.radiusRatio||1.618034;a.mid=0<a.mid&&1>a.mid?a.mid:.618034;b=d.addGeoGroup();var g=a.start,s=a.end,p=a.radius,h=a.radiusRatio,l=a.mid;if(g&&s){var y=s.clone();y.sub(g).multiplyScalar(l);var m=g.clone().add(y),
l=y.clone().negate();this.intersectionShape.cylinder.push(new $3Dmol.Cylinder(g.clone(),m.clone(),p));this.intersectionShape.sphere.push(new $3Dmol.Sphere(g.clone(),p));var t=[];t[0]=y.clone();1E-4<Math.abs(t[0].x)?t[0].y+=1:t[0].x+=1;t[0].cross(y);t[0].normalize();t[0]=t[0];t[4]=t[0].clone();t[4].crossVectors(t[0],y);t[4].normalize();t[8]=t[0].clone().negate();t[12]=t[4].clone().negate();t[2]=t[0].clone().add(t[4]).normalize();t[6]=t[4].clone().add(t[8]).normalize();t[10]=t[8].clone().add(t[12]).normalize();
t[14]=t[12].clone().add(t[0]).normalize();t[1]=t[0].clone().add(t[2]).normalize();t[3]=t[2].clone().add(t[4]).normalize();t[5]=t[4].clone().add(t[6]).normalize();t[7]=t[6].clone().add(t[8]).normalize();t[9]=t[8].clone().add(t[10]).normalize();t[11]=t[10].clone().add(t[12]).normalize();t[13]=t[12].clone().add(t[14]).normalize();t[15]=t[14].clone().add(t[0]).normalize();var w=b.vertices,q=b.vertexArray,x=b.faceArray,C=b.normalArray,u=b.lineArray,A,E,M;E=0;for(M=t.length;E<M;++E){A=3*(w+3*E);var K=t[E].clone().multiplyScalar(p).add(g),
I=t[E].clone().multiplyScalar(p).add(m),J=t[E].clone().multiplyScalar(p*h).add(m);q[A]=K.x;q[A+1]=K.y;q[A+2]=K.z;q[A+3]=I.x;q[A+4]=I.y;q[A+5]=I.z;q[A+6]=J.x;q[A+7]=J.y;q[A+8]=J.z;0<E&&(A=new $3Dmol.Vector3(q[A-3],q[A-2],q[A-1]),K=s.clone(),I=m.clone(),J=new $3Dmol.Vector3(J.x,J.y,J.z),this.intersectionShape.triangle.push(new $3Dmol.Triangle(J,K,A)),this.intersectionShape.triangle.push(new $3Dmol.Triangle(A.clone(),I,J.clone())))}b.vertices+=48;A=3*b.vertices;q[A]=g.x;q[A+1]=g.y;q[A+2]=g.z;q[A+3]=
m.x;q[A+4]=m.y;q[A+5]=m.z;q[A+6]=s.x;q[A+7]=s.y;q[A+8]=s.z;b.vertices+=3;var L,Q,R,N,S,O,U,T,X=b.vertices-3,aa=b.vertices-2,Y=b.vertices-1,V=3*X,H=3*aa,da=3*Y;E=0;for(M=t.length-1;E<M;++E)L=w+3*E,g=b.faceidx,s=b.lineidx,p=L,A=3*p,h=L+1,K=3*h,m=L+2,I=3*m,q=L+4,Q=3*q,J=L+5,R=3*J,L+=3,N=3*L,S=O=t[E],U=T=t[E+1],C[A]=S.x,C[K]=O.x,C[N]=T.x,C[A+1]=S.y,C[K+1]=O.y,C[N+1]=T.y,C[A+2]=S.z,C[K+2]=O.z,C[N+2]=T.z,C[K]=O.x,C[Q]=U.x,C[N]=T.x,C[K+1]=O.y,C[Q+1]=U.y,C[N+1]=T.y,C[K+2]=O.z,C[Q+2]=U.z,C[N+2]=T.z,C[I]=O.x,
C[R]=U.x,C[I+1]=O.y,C[R+1]=U.y,C[I+2]=O.z,C[R+2]=U.z,x[g]=p,x[g+1]=h,x[g+2]=L,x[g+3]=h,x[g+4]=q,x[g+5]=L,x[g+6]=p,x[g+7]=L,x[g+8]=X,x[g+9]=m,x[g+10]=aa,x[g+11]=J,x[g+12]=m,x[g+13]=Y,x[g+14]=J,u[s]=p,u[s+1]=h,u[s+2]=p,u[s+3]=L,u[s+4]=q,u[s+5]=L,u[s+6]=p,u[s+7]=L,u[s+8]=m,u[s+9]=h,u[s+10]=m,u[s+11]=J,u[s+12]=q,u[s+13]=J,u[s+14]=m,u[s+15]=Y,u[s+16]=m,u[s+17]=J,u[s+18]=Y,u[s+19]=J,b.faceidx+=15,b.lineidx+=20;w=[w+45,w+46,w+1,w,w+47,w+2];g=b.faceidx;s=b.lineidx;p=w[0];A=3*p;h=w[1];K=3*h;m=w[4];I=3*m;q=
w[2];Q=3*q;J=w[5];R=3*J;L=w[3];N=3*L;S=O=t[15];U=T=t[0];C[A]=S.x;C[K]=O.x;C[N]=T.x;C[A+1]=S.y;C[K+1]=O.y;C[N+1]=T.y;C[A+2]=S.z;C[K+2]=O.z;C[N+2]=T.z;C[K]=O.x;C[Q]=U.x;C[N]=T.x;C[K+1]=O.y;C[Q+1]=U.y;C[N+1]=T.y;C[K+2]=O.z;C[Q+2]=U.z;C[N+2]=T.z;C[I]=O.x;C[R]=U.x;C[I+1]=O.y;C[R+1]=U.y;C[I+2]=O.z;C[R+2]=U.z;y.normalize();l.normalize();C[V]=l.x;C[H]=C[da]=y.x;C[V+1]=l.y;C[H+1]=C[da+1]=y.y;C[V+2]=l.z;C[H+2]=C[da+2]=y.z;x[g]=p;x[g+1]=h;x[g+2]=L;x[g+3]=h;x[g+4]=q;x[g+5]=L;x[g+6]=p;x[g+7]=L;x[g+8]=X;x[g+9]=
m;x[g+10]=aa;x[g+11]=J;x[g+12]=m;x[g+13]=Y;x[g+14]=J;u[s]=p;u[s+1]=h;u[s+2]=p;u[s+3]=L;u[s+4]=q;u[s+5]=L;u[s+6]=p;u[s+7]=L;u[s+8]=m;u[s+9]=h;u[s+10]=m;u[s+11]=J;u[s+12]=q;u[s+13]=J;u[s+14]=m;u[s+15]=Y;u[s+16]=m;u[s+17]=J;u[s+18]=Y;u[s+19]=J;b.faceidx+=15;b.lineidx+=20}b.truncateArrayBuffers(!0,!0);y=new $3Dmol.Vector3;z.push({id:b.id,geoGroup:b,centroid:y.addVectors(a.start,a.end).multiplyScalar(.5)});c(this.boundingSphere,z,b.vertexArray)};this.addIsosurface=function(a,c){var g=void 0!==c.isoval&&
"number"===typeof c.isoval?c.isoval:0,s=c.voxel?!0:!1,p=void 0===c.smoothness?1:c.smoothness,h=a.size.x,l=a.size.y,y=a.size.z,m=new Int16Array(h*l*y),t=a.data,w,q;w=0;for(q=m.length;w<q;++w)m[w]=-1;m=new Uint8Array(h*l*y);w=0;for(q=t.length;w<q;++w)0<(0<=g?t[w]-g:g-t[w])&&(m[w]|=2);g=[];t=[];$3Dmol.MarchingCube.march(m,g,t,{fulltable:!0,voxel:s,unitCube:a.unit,origin:a.origin,nX:h,nY:l,nZ:y});s||$3Dmol.MarchingCube.laplacianSmooth(p,g,t);b(this,d,{vertexArr:g,faceArr:t,normalArr:[],clickable:c.clickable});
this.updateStyle(c)};this.addVolumetricData=function(a,b,d){a=new $3Dmol.VolumeData(a,b);this.addIsosurface(a,d)};this.globj=function(a){E&&(a.remove(E),E=null);if(!this.hidden){d.initTypedArrays();var b=this.color;b||$3Dmol.CC.color(b);d.colorsNeedUpdate=!0;var c,s,p;b.constructor!==Array&&(c=b.r,s=b.g,p=b.b);for(var h in d.geometryGroups)for(var l=d.geometryGroups[h],q=l.colorArray,m=0,l=l.vertices;m<l;++m)b.constructor===Array&&(p=b[m],c=p.r,s=p.g,p=p.b),q[3*m]=c,q[3*m+1]=s,q[3*m+2]=p;w=new $3Dmol.Object3D;
b=null;b=this.side==$3Dmol.DoubleSide?new $3Dmol.MeshDoubleLambertMaterial({wireframe:this.wireframe,side:this.side,transparent:1>this.opacity?!0:!1,opacity:this.opacity,wireframeLinewidth:this.linewidth}):new $3Dmol.MeshLambertMaterial({wireframe:this.wireframe,side:this.side,transparent:1>this.opacity?!0:!1,opacity:this.opacity,wireframeLinewidth:this.linewidth});b=new $3Dmol.Mesh(d,b);w.add(b);b=new $3Dmol.LineBasicMaterial({linewidth:this.linewidth,color:this.color});b=new $3Dmol.Line(g,b,$3Dmol.LinePieces);
w.add(b);E=w.clone();a.add(E)}};this.removegl=function(a){E&&(void 0!==E.geometry&&E.geometry.dispose(),void 0!==E.material&&E.material.dispose(),a.remove(E),E=null);w=null}}var b=function(a,b,w){var q=w.faceArr;0!==w.vertexArr.length&&0!==q.length||console.warn("Error adding custom shape component: No vertices and/or face indices supplied!");q=w.color;"undefined"==typeof q&&(q=a.color);for(var q=$3Dmol.CC.color(q),d=$3Dmol.splitMesh(w),g=0,f=d.length;g<f;g++){var e=a,D=b,s=d[g],G=d[g].colorArr?d[g].colorArr:
q,h=w.clickable,l=D.addGeoGroup(),y=s.vertexArr,m=s.normalArr,s=s.faceArr;l.vertices=y.length;l.faceidx=s.length;var t=void 0,B=void 0,F=void 0,x=void 0,C=B=void 0,u=void 0,A=l.vertexArray,F=l.colorArray;if(G.constructor!==Array)var P=G.r,M=G.g,x=G.b;C=0;for(u=l.vertices;C<u;++C)t=3*C,B=y[C],A[t]=B.x,A[t+1]=B.y,A[t+2]=B.z,G.constructor===Array&&(B=G[C],P=B.r,M=B.g,x=B.b),F[t]=P,F[t+1]=M,F[t+2]=x;l.truncateArrayBuffers(!0,!0);if(h)for(C=0,u=l.faceidx/3;C<u;++C){var t=3*C,F=s[t],x=s[t+1],B=s[t+2],t=
new $3Dmol.Vector3,G=new $3Dmol.Vector3,K=new $3Dmol.Vector3;e.intersectionShape.triangle.push(new $3Dmol.Triangle(t.copy(y[F]),G.copy(y[x]),K.copy(y[B])))}if(h){C=new $3Dmol.Vector3(0,0,0);for(M=u=0;M<D.geometryGroups.length;M++)C.add(D.geometryGroups[M].getCentroid()),u++;C.divideScalar(u);c(e.boundingSphere,{centroid:C},A)}l.faceArray=new Uint16Array(s);l.truncateArrayBuffers(!0,!0);if(m.length<l.vertices)l.setNormals();else for(e=l.normalArray=new Float32Array(3*l.vertices),D=void 0,C=0,u=l.vertices;C<
u;++C)t=3*C,D=m[C],e[t]=D.x,e[t+1]=D.y,e[t+2]=D.z;l.setLineIndices();l.lineidx=l.lineArray.length}},c=function(a,b,c){a.center.set(0,0,0);var q,d;if(0<b.length){q=0;for(d=b.length;q<d;++q)a.center.add(b[q].centroid);a.center.divideScalar(b.length)}b=a.radius*a.radius;q=0;for(d=c.length/3;q<d;q++){var g=a.center.distanceToSquared({x:c[3*q],y:c[3*q+1],z:c[3*q+2]});b=Math.max(b,g)}a.radius=Math.sqrt(b)},q=function(a,b){a.color=b.color||new $3Dmol.Color;b.color instanceof $3Dmol.Color||(a.color=$3Dmol.CC.color(b.color));
a.wireframe=b.wireframe?!0:!1;a.opacity=b.alpha?$3Dmol.Math.clamp(b.alpha,0,1):1;"undefined"!=typeof b.opacity&&(a.opacity=$3Dmol.Math.clamp(b.opacity,0,1));a.side=void 0!==b.side?b.side:$3Dmol.DoubleSide;a.linewidth="undefined"==typeof b.linewidth?1:b.linewidth;a.clickable=b.clickable?!0:!1;a.callback="function"===typeof b.callback?b.callback:null;a.hidden=b.hidden};Object.defineProperty(a.prototype,"position",{get:function(){return this.boundingSphere.center}});Object.defineProperty(a.prototype,
"x",{get:function(){return this.boundingSphere.center.x}});Object.defineProperty(a.prototype,"y",{get:function(){return this.boundingSphere.center.y}});Object.defineProperty(a.prototype,"z",{get:function(){return this.boundingSphere.center.z}});return a}();$3Dmol.ShapeIDCount=0;
$3Dmol.splitMesh=function(a){if(64E3>a.vertexArr.length)return[a];var b=[{vertexArr:[],normalArr:[],faceArr:[]}];a.colorArr&&(b.colorArr=[]);for(var c=[],q=[],p=0,z=a.faceArr,w=0,E=z.length;w<E;w+=3){for(var d=b[p],g=0;3>g;g++){var f=z[w+g];c[f]!==p&&(c[f]=p,q[f]=d.vertexArr.length,d.vertexArr.push(a.vertexArr[f]),a.normalArr&&a.normalArr[f]&&d.normalArr.push(a.normalArr[f]),a.colorArr&&a.colorArr[f]&&d.colorArr.push(a.colorArr[f]));d.faceArr.push(q[f])}64E3<=d.vertexArr.length&&(b.push({vertexArr:[],
normalArr:[],faceArr:[]}),a.colorArr&&(b.colorArr=[]),p++)}return b};
$3Dmol.GLViewer=function(){return function(a,b){function c(a){var b=[];"undefined"===typeof a&&(a={});var d=[],c;if("undefined"===typeof a.model)for(c=0;c<e.length;c++)e[c]&&d.push(e[c]);else d=a.model,$.isArray(d)||(d=[d]);for(c=0;c<d.length;c++)b=b.concat(d[c].selectedAtoms(a));return b}function q(a,b,d,c){var f=[];if("undefined"===typeof b.model)for(g=0;g<e.length;g++)e[g]&&f.push(e[g]);else f=b.model,$.isArray(f)||(f=[f]);for(var g=0;g<f.length;g++)if(f[g])f[g][a](b,d,c)}function p(a){var b=new $3Dmol.MeshLambertMaterial;
b.vertexColors=$3Dmol.VertexColors;for(var d in a)"color"!==d&&"map"!==d&&a.hasOwnProperty(d)&&(b[d]=a[d]);void 0!==a.opacity&&(b.transparent=1===a.opacity?!1:!0);return b}b=b||{};var z=b.callback,w=b.defaultcolors;w||(w=$3Dmol.elementColors.defaultColors);var E=b.nomouse,d=0;void 0!=typeof b.backgroundColor&&(d=$3Dmol.CC.color(b.backgroundColor).getHex());var g=this,f=a,e=[],D={},s=0,G=[],h=[],l=[],y=f.width(),m=f.height(),t=y/m,B=new $3Dmol.Renderer({antialias:!0,preserveDrawingBuffer:!0,premultipliedAlpha:!1});
B.domElement.style.width="100%";B.domElement.style.height="100%";B.domElement.style.padding="0";B.domElement.style.position="absolute";B.domElement.style.top="0px";B.domElement.style.left="0px";B.domElement.style.zIndex="0";var F=new $3Dmol.Camera(20,t,1,800);F.position=new $3Dmol.Vector3(0,0,150);var x=new $3Dmol.Vector3;F.lookAt(x);var C=new $3Dmol.Raycaster(new $3Dmol.Vector3(0,0,0),new $3Dmol.Vector3(0,0,0)),u=new $3Dmol.Projector,A=new $3Dmol.Vector3(0,0,0),P=null,M=null,K=null,I=-50,J=50,L=
new $3Dmol.Quaternion(0,0,0,1),Q=new $3Dmol.Quaternion(0,0,0,1),R=!1,N=!1,S=0,O=0,U=0,T=0,X=0,aa=0,Y=0,V=function(){if(P){var a=F.position.z-M.position.z;1>a&&(a=1);F.near=a+I;1>F.near&&(F.near=1);F.far=a+J;F.near+1>F.far&&(F.far=F.near+1);F instanceof $3Dmol.Camera?F.fov=20:(F.right=a*Math.tan(Math.PI/180*20),F.left=-F.right,F.top=F.right/t,F.bottom=-F.top);F.updateProjectionMatrix();P.fog.near=F.near+.4*(F.far-F.near);P.fog.far=F.far;B.render(P,F)}};(function(){P=new $3Dmol.Scene;P.fog=new $3Dmol.Fog(d,
100,200);K=new $3Dmol.Object3D;M=new $3Dmol.Object3D;M.useQuaternion=!0;M.quaternion=new $3Dmol.Quaternion(0,0,0,1);M.add(K);P.add(M);var a=new $3Dmol.Light(16777215);a.position=(new $3Dmol.Vector3(.2,.2,1)).normalize();a.intensity=1;P.add(a)})();B.setClearColorHex(d,1);P.fog.color=$3Dmol.CC.color(d);var H=null,da=function(a){var b=a.originalEvent.targetTouches[0].pageX-a.originalEvent.targetTouches[1].pageX;a=a.originalEvent.targetTouches[0].pageY-a.originalEvent.targetTouches[1].pageY;return Math.sqrt(b*
b+a*a)},Z=function(a){var b=a.pageX,d=a.pageY;a.originalEvent.targetTouches&&a.originalEvent.targetTouches[0]?(b=a.originalEvent.targetTouches[0].pageX,d=a.originalEvent.targetTouches[0].pageY):a.originalEvent.changedTouches&&a.originalEvent.changedTouches[0]&&(b=a.originalEvent.changedTouches[0].pageX,d=a.originalEvent.changedTouches[0].pageY);return[b,d]};$("body").bind("mouseup touchend",function(a){if(N&&P){var b=Z(a),d=b[0],b=b[1];if(d==S&&b==O){var c=$("canvas",f).offset(),d=(d-c.left)/y*2-
1,b=2*-((b-c.top)/m)+1;0!=l.length&&(A.set(d,b,-1),u.unprojectVector(A,F),A.sub(F.position).normalize(),C.set(F.position,A),d=[],d=C.intersectObjects(K,l),d.length&&(d=d[0].clickable,void 0!==d.callback&&"function"===typeof d.callback&&d.callback(d,g,a,f)))}}N=!1});var ba=function(a){f=a;y=f.width();m=f.height();t=y/m;B.setSize(y,m);f.append(B.domElement);H=$(B.domElement);E||(H.bind("mousedown touchstart",function(a){a.preventDefault();if(P){var b=Z(a),d=b[0],b=b[1];void 0!==d&&(N=!0,mouseButton=
a.which,S=d,O=b,U=0,a.originalEvent.targetTouches&&2==a.originalEvent.targetTouches.length&&(U=da(a)),L=M.quaternion,X=M.position.z,T=K.position.clone(),aa=I,Y=J)}}),H.bind("DOMMouseScroll mousewheel",function(a){a.preventDefault();if(P){var b=.85*(150-M.position.z);a.originalEvent.detail?M.position.z+=b*a.originalEvent.detail/10:a.originalEvent.wheelDelta&&(M.position.z-=b*a.originalEvent.wheelDelta/400);150<M.position.z&&(M.position.z=149.85);V()}}),H.bind("contextmenu",function(a){a.preventDefault()}),
H.bind("mousemove touchmove",function(a){a.preventDefault();if(P&&N){var b=0,d=Z(a),c=d[0],d=d[1];if(void 0!==c){var f=(c-S)/y,e=(d-O)/m;0!=U&&a.originalEvent.targetTouches&&2==a.originalEvent.targetTouches.length?(e=da(a),b=2,e=2*(U-e)/(y+m)):a.originalEvent.targetTouches&&3==a.originalEvent.targetTouches.length&&(b=1);var g=Math.sqrt(f*f+e*e);3==b||3==mouseButton&&a.ctrlKey?(I=aa+100*f,J=Y+100*e):2==b||3==mouseButton||a.shiftKey?(a=.85*(150-M.position.z),80>a&&(a=80),M.position.z=X-e*a,150<M.position.z&&
(M.position.z=149.85)):1==b||2==mouseButton||a.ctrlKey?(a=(c-S)/y,b=(d-O)/m,c=M.quaternion,d=new $3Dmol.Vector3(0,0,M.position.z),u.projectVector(d,F),d.x+=2*a,d.y-=2*b,u.unprojectVector(d,F),d.z=0,d.applyQuaternion(c),K.position.addVectors(T,d)):0!==b&&1!=mouseButton||0===g||(a=Math.sin(g*Math.PI)/g,Q.x=Math.cos(g*Math.PI),Q.y=0,Q.z=a*f,Q.w=-a*e,M.quaternion=new $3Dmol.Quaternion(1,0,0,0),M.quaternion.multiply(Q),M.quaternion.multiply(L));V()}}}))};ba(f);this.setContainer=function(a){"string"===
$.type(a)&&(a=$("#"+a));a||(a=f);ba(a)};this.setBackgroundColor=function(a,b){if("undefined"==typeof b)b=1;else if(0>b||1<b)b=1;var c=$3Dmol.CC.color(a);P.fog.color=c;d=c.getHex();B.setClearColorHex(c.getHex(),b);V()};this.setViewStyle=function(a){if("outline"===a.style){var b={};a.color&&(b.color=$3Dmol.CC.color(a.color));a.width&&(b.width=a.width);B.enableOutline(b)}else B.disableOutline()};b.style&&this.setViewStyle(b.style);this.setWidth=function(a){y=a||y;B.setSize(y,m)};this.setHeight=function(a){m=
a||m;B.setSize(y,m)};this.resize=function(){y=f.width();m=f.height();t=y/m;B.setSize(y,m);F.aspect=t;F.updateProjectionMatrix();V()};$(window).resize(this.resize);this.getModel=function(a){a=a||e.length-1;return e[a]};this.rotate=function(a,b){"undefined"===typeof b&&(b="y");var d=0,c=0,f=0,e=Math.PI*a/180,g=Math.sin(e/2),e=Math.cos(e/2);"x"==b&&(d=g);"y"==b&&(c=g);"z"==b&&(f=g);d=(new $3Dmol.Quaternion(d,c,f,e)).normalize();M.quaternion.multiply(d);V()};this.getView=function(){if(!K)return[0,0,0,
0,0,0,0,1];var a=K.position,b=M.quaternion;return[a.x,a.y,a.z,M.position.z,b.x,b.y,b.z,b.w]};this.setView=function(a){void 0!==a&&(a instanceof Array||8!==a.length)&&K&&M&&(K.position.x=a[0],K.position.y=a[1],K.position.z=a[2],M.position.z=a[3],M.quaternion.x=a[4],M.quaternion.y=a[5],M.quaternion.z=a[6],M.quaternion.w=a[7],"undefined"!=typeof a[8]&&(M.position.x=a[8],M.position.y=a[9]),V())};this.render=function(){l=[];var a,b;a=0;for(b=e.length;a<b;a++){var d=e[a];d&&(d=d.selectedAtoms({clickable:!0}),
l=l.concat(d))}a=0;for(b=G.length;a<b;a++)(d=G[a])&&d.clickable&&l.push(d);a=this.getView();for(b=0;b<e.length;b++)e[b]&&e[b].globj(K);for(b=0;b<G.length;b++)G[b]&&G[b].globj(K);for(b in D)if(D.hasOwnProperty(b))for(var c=D[b],d=0;d<c.length;d++)if(c.hasOwnProperty(d)){var f=c[d].geo;if(!c[d].finished){f.verticesNeedUpdate=!0;f.elementsNeedUpdate=!0;f.normalsNeedUpdate=!0;f.colorsNeedUpdate=!0;f.buffersNeedUpdate=!0;f.boundingSphere=null;c[d].done&&(c[d].finished=!0);c[d].lastGL&&K.remove(c[d].lastGL);
var g=null,g=c[d].mat instanceof $3Dmol.LineBasicMaterial?new $3Dmol.Line(f,c[d].mat):new $3Dmol.Mesh(f,c[d].mat);g.visible=c[d].mat.transparent&&0==c[d].mat.opacity?!1:!0;if(1<c[d].symmetries.length||1==c[d].symmetries.length&&!c[d].symmetries[d].isIdentity()){for(var h=new $3Dmol.Object3D,f=0;f<c[d].symmetries.length;f++){var m=g.clone();m.matrix=c[d].symmetries[f];m.matrixAutoUpdate=!1;h.add(m)}c[d].lastGL=h;K.add(h)}else c[d].lastGL=g,K.add(g)}}this.setView(a)};this.selectedAtoms=function(a){return c(a)};
this.pdbData=function(a){a=c(a);for(var b="",d=0,f=a.length;d<f;++d)b+=a[d].pdbline+"\n";return b};this.zoom=function(a){M.position.z=150-(150-M.position.z)/(a||2);V()};this.translate=function(a,b){var d=a/y,c=b/m,f=new $3Dmol.Vector3(0,0,-150);u.projectVector(f,F);f.x-=d;f.y-=c;u.unprojectVector(f,F);f.z=0;x.add(f);F.lookAt(x);V()};this.zoomTo=function(a){var b;a=a||{};var d=c(a),f=$3Dmol.getExtent(d);$.isEmptyObject(a)?($.each(G,function(a,b){b&&b.boundingSphere&&b.boundingSphere.center&&d.push(b.boundingSphere.center)}),
f=$3Dmol.getExtent(d),a=d,b=f):(a=c({}),b=$3Dmol.getExtent(a));a=new $3Dmol.Vector3(f[2][0],f[2][1],f[2][2]);K.position=a.clone().multiplyScalar(-1);var e=b[1][0]-b[0][0],g=b[1][1]-b[0][1];b=b[1][2]-b[0][2];e=Math.sqrt(e*e+g*g+b*b);5>e&&(e=5);I=-e/1.9;J=e/2;e=f[1][0]-f[0][0];g=f[1][1]-f[0][1];b=f[1][2]-f[0][2];e=Math.sqrt(e*e+g*g+b*b);5>e&&(e=5);f=25;for(e=0;e<d.length;e++)d[e]&&(g=a.distanceToSquared(d[e]),g>f&&(f=g));e=2*Math.sqrt(f);M.position.z=-(.5*e/Math.tan(Math.PI/180*F.fov/2)-150);V()};this.addLabel=
function(a,b){var d=new $3Dmol.Label(a,b);d.setContext();K.add(d.sprite);h.push(d);V();return d};this.addResLabels=function(a,b){q("addResLabels",a,this,b)};this.removeLabel=function(a){for(var b=0;b<h.length;b++)if(h[b]==a){h.splice(b,1);a.dispose();K.remove(a.sprite);break}};this.removeAllLabels=function(){for(var a=0;a<h.length;a++)K.remove(h[a].sprite);h=[]};this.setLabelStyle=function(a,b){K.remove(a.sprite);a.dispose();a.stylespec=b;a.setContext();K.add(a.sprite);V();return a};this.setLabelText=
function(a,b){K.remove(a.sprite);a.dispose();a.text=b;a.setContext();K.add(a.sprite);V();return a};this.addShape=function(a){a=a||{};a=new $3Dmol.GLShape(a);a.shapePosition=G.length;G.push(a);return a};this.removeShape=function(a){if(a)for(a.removegl(K),delete G[a.shapePosition];0<G.length&&"undefined"===typeof G[G.length-1];)G.pop()};this.removeAllShapes=function(){for(var a=0;a<G.length;a++)G[a].removegl(K);G=[]};this.addSphere=function(a){a=a||{};var b=new $3Dmol.GLShape(a);b.shapePosition=G.length;
b.addSphere(a);G.push(b);return b};this.addArrow=function(a){a=a||{};var b=new $3Dmol.GLShape(a);b.shapePosition=G.length;b.addArrow(a);G.push(b);return b};this.addCylinder=function(a){a=a||{};var b=new $3Dmol.GLShape(a);b.shapePosition=G.length;b.addCylinder(a);G.push(b);return b};this.addLine=function(a){a=a||{};a.wireframe=!0;var b=new $3Dmol.GLShape(a);b.shapePosition=G.length;if(a.dashed){a.dashLength=a.dashLength||.5;a.gapLength=a.gapLength||.5;a.start=a.start||{};a.end=a.end||{};var d=new $3Dmol.Vector3(a.start.x||
0,a.start.y||0,a.start.z||0),c=new $3Dmol.Vector3(a.end.x,a.end.y||0,a.end.z||0),f=new $3Dmol.Vector3,e=new $3Dmol.Vector3,g=new $3Dmol.Vector3,h,l,m=d.clone(),s=0;f.subVectors(c,d);h=f.length();f.normalize();e=f.clone();g=f.clone();e.multiplyScalar(a.dashLength);g.multiplyScalar(a.gapLength);f=e.length();for(l=g.length();s<h;){if(s+f>h){a.start=d;a.end=c;b.addLine(a);break}m.addVectors(d,e);a.start=d;a.end=m;b.addLine(a);d=m.clone();s+=f;m.addVectors(d,g);d=m.clone();s+=l}}else b.addLine(a);G.push(b);
return b};this.addUnitCell=function(a){var b=new $3Dmol.GLShape({wireframe:!0});b.shapePosition=G.length;var d=a.getCrystData();if(d){a=d.a;var c=d.b,f=d.c,e=d.alpha,g=d.beta,d=d.gamma,e=e*Math.PI/180,g=g*Math.PI/180,d=d*Math.PI/180,h;h=Math.cos(g);e=(Math.cos(e)-Math.cos(g)*Math.cos(d))/Math.sin(d);g=Math.sqrt(Math.max(0,1-h*h-e*e));a=new $3Dmol.Matrix4(a,c*Math.cos(d),f*h,0,0,c*Math.sin(d),f*e,0,0,0,f*g,0,0,0,0,1);c=[new $3Dmol.Vector3(0,0,0),new $3Dmol.Vector3(1,0,0),new $3Dmol.Vector3(0,1,0),
new $3Dmol.Vector3(0,0,1),new $3Dmol.Vector3(1,1,0),new $3Dmol.Vector3(0,1,1),new $3Dmol.Vector3(1,0,1),new $3Dmol.Vector3(1,1,1)];for(f=0;f<c.length;f++)c[f]=c[f].applyMatrix4(a);b.addLine({start:c[0],end:c[1]});b.addLine({start:c[0],end:c[2]});b.addLine({start:c[1],end:c[4]});b.addLine({start:c[2],end:c[4]});b.addLine({start:c[0],end:c[3]});b.addLine({start:c[3],end:c[5]});b.addLine({start:c[2],end:c[5]});b.addLine({start:c[1],end:c[6]});b.addLine({start:c[4],end:c[7]});b.addLine({start:c[6],end:c[7]});
b.addLine({start:c[3],end:c[6]});b.addLine({start:c[5],end:c[7]})}G.push(b);return b};this.addCustom=function(a){a=a||{};var b=new $3Dmol.GLShape(a);b.shapePosition=G.length;b.addCustom(a);G.push(b);return b};this.addVolumetricData=function(a,b,d){d=d||{};var c=new $3Dmol.GLShape(d);c.shapePosition=G.length;c.addVolumetricData(a,b,d);G.push(c);return c};this.addIsosurface=function(a,b){b=b||{};var d=new $3Dmol.GLShape(b);d.shapePosition=G.length;d.addIsosurface(a,b);G.push(d);return d};this.setFrame=
function(a){for(var b=0;b<e.length;b++)e[b].setFrame(a)};this.getFrames=function(){for(var a=0,b=0;b<e.length;b++)e[b].getFrames().length>a&&(a=e[b].getFrames().length);return a};this.animate=function(a){R=!0;var b=100,d="forward",c=0;a=a||{};a.interval&&(b=a.interval);a.loop&&(d=a.loop);a.reps&&(c=a.reps);var f=this.getFrames(),e=this,g=0,h=1,l=0,m=f*c,s=setInterval(function(){var a=d;"forward"==a?(e.setFrame(g),g=(g+h)%f):"backward"==a?(e.setFrame(f-1-g),g=(g+h)%f):(e.setFrame(g),g+=h,h*=0==g%(f-
1)?-1:1);e.render();++l!=m&&e.isAnimated()||clearInterval(s)},b)};this.stopAnimate=function(){R=!1};this.isAnimated=function(){return R};this.addModel=function(a,b,d){var c=new $3Dmol.GLModel(e.length,w);c.addMolData(a,b,d);e.push(c);return c};this.addModels=function(a,b,d){d=d||{};d.multimodel=!0;d.frames=!0;var c=new $3Dmol.GLModel(e.length,w);c.addMolData(a,b,d);a=c.getFrames();this.removeModel(c);for(c=0;c<a.length;c++)b=new $3Dmol.GLModel(e.length,w),b.addFrame(a[c]),b.setFrame(0),e.push(b);
return e};this.addModelsAsFrames=function(a,b,d){d=d||{};d.multimodel=!0;d.frames=!0;var c=new $3Dmol.GLModel(e.length,w);c.addMolData(a,b,d);e.push(c);return c};this.addAsOneMolecule=function(a,b,d){d=d||{};d.multimodel=!0;d.onemol=!0;var c=new $3Dmol.GLModel(e.length,w);c.addMolData(a,b,d);e.push(c);return c};this.removeModel=function(a){if(a)for(a.removegl(K),delete e[a.getID()];0<e.length&&"undefined"===typeof e[e.length-1];)e.pop()};this.removeAllModels=function(){for(var a=0;a<e.length;a++)e[a].removegl(K);
e=[]};this.exportJSON=function(a,b){var d={};d.m=void 0===b?e.map(function(b){return b.toCDObject(a)}):[model[b].toCDObject()];return JSON.stringify(d)};this.createModelFrom=function(a,b){for(var d=new $3Dmol.GLModel(e.length,w),c=0;c<e.length;c++)if(e[c]){var f=e[c].selectedAtoms(a);d.addAtoms(f);b&&e[c].removeAtoms(f)}e.push(d);return d};this.setStyle=function(a,b){q("setStyle",a,b,!1)};this.addStyle=function(a,b){q("setStyle",a,b,!0)};this.setClickable=function(a,b,d){q("setClickable",a,b,d)};
this.setColorByProperty=function(a,b,d){q("setColorByProperty",a,b,d)};this.setColorByElement=function(a,b){q("setColorByElement",a,b)};var Ka=function(a,b){for(var d=[],c=0;c<a.length;c++){var f=a[c];"undefined"!=typeof f&&(f.x<b[0][0]||f.x>b[1][0]||f.y<b[0][1]||f.y>b[1][1]||f.z<b[0][2]||f.z>b[1][2]||d.push(c))}return d},ma=function(a){return(a[1][0]-a[0][0])*(a[1][1]-a[0][1])*(a[1][2]-a[0][2])},Ja=function(a,b,d){var c=[],f=function(a){var b=[];b[0]=[a[0][0],a[0][1],a[0][2]];b[1]=[a[1][0],a[1][1],
a[1][2]];return b},e=function(a){if(64E3>ma(a))return[a];var b=a[1][0]-a[0][0],d=a[1][1]-a[0][1],c=a[1][2]-a[0][2],d=b>d&&b>c?0:d>b&&d>c?1:2,c=f(a),b=f(a);a=(a[1][d]-a[0][d])/2+a[0][d];c[1][d]=a;b[0][d]=a;a=e(c);b=e(b);return a.concat(b)};a=e(a);for(var g=0,h=a.length;g<h;g++){var l=f(a[g]);l[0][0]-=6;l[0][1]-=6;l[0][2]-=6;l[1][0]+=6;l[1][1]+=6;l[1][2]+=6;var l=Ka(b,l),m=Ka(d,a[g]);c.push({extent:a[g],atoms:l,toshow:m})}return c},ga=function(a,b,d){for(var c=new $3Dmol.Geometry(!0),f=c.updateGeoGroup(0),
e=[],g=0,h=a.length;g<h;g++){var l=a[g];l&&("undefined"!=typeof l.surfaceColor?e[g]=l.surfaceColor:l.color&&(e[g]=$3Dmol.CC.color(l.color)))}var m=f.vertexArray,l=b.vertices,g,h;g=0;for(h=l.length;g<h;g++)a=3*f.vertices,m[a]=l[g].x,m[a+1]=l[g].y,m[a+2]=l[g].z,f.vertices++;m=f.colorArray;if(d.voldata&&d.volscheme){var e=d.volscheme,s=d.voldata,t=e.range()||[-1,1];g=0;for(h=l.length;g<h;g++){a=s.getVal(l[g].x,l[g].y,l[g].z);var p=$3Dmol.CC.color(e.valueToHex(a,t));a=3*g;m[a]=p.r;m[a+1]=p.g;m[a+2]=p.b}}else if(0<
e.length)for(g=0,h=l.length;g<h;g++)s=l[g].atomid,a=3*g,m[a]=e[s].r,m[a+1]=e[s].g,m[a+2]=e[s].b;b=b.faces;f.faceidx=b.length;c.initTypedArrays();var l=f.vertexArray,m=f.normalArray,u;g=0;for(h=b.length;g<h;g+=3)e=b[g+1],s=b[g+2],a=3*b[g],e*=3,s*=3,t=new $3Dmol.Vector3(l[a],l[a+1],l[a+2]),p=new $3Dmol.Vector3(l[e],l[e+1],l[e+2]),u=new $3Dmol.Vector3(l[s],l[s+1],l[s+2]),u.subVectors(u,p),t.subVectors(t,p),u.cross(t),t=u,t.normalize(),m[a]+=t.x,m[e]+=t.x,m[s]+=t.x,m[a+1]+=t.y,m[e+1]+=t.y,m[s+1]+=t.y,
m[a+2]+=t.z,m[e+2]+=t.z,m[s+2]+=t.z;f.faceArray=new Uint16Array(b);d=new $3Dmol.Mesh(c,d);d.doubleSided=!0;return d};this.addMesh=function(a){a={geo:a.geometry,mat:a.material,done:!0,finished:!1};var b=s++;D[b]=a;return b};var Pa=function(a){var b=[];$.each(a,function(a,d){b[a]=$.extend({},d)});return b};this.addSurface=function(a,b,d,f,h){var l=null,m=null;d=Pa(c(d));var l=f?Pa(c(f)):d,t=!1;for(f=0;f<e.length;f++)if(e[f]){var u=e[f].getSymmetries();if(1<u.length||1==u.length&&!u[0].isIdentity()){t=
!0;break}}var q=function(d,f,e){m=h?Pa(c(h)):e;var l,s=$3Dmol.getExtent(e,!0),t,p;b.map&&b.map.prop&&(t=b.map.prop,p=b.map.scheme||b.map.gradient||new $3Dmol.Gradient.RWB,(l=p.range())||(l=$3Dmol.getPropertyRange(e,t)),b.colorscheme={prop:t,gradient:p});t=0;for(p=f.length;t<p;t++)l=f[t],l.surfaceColor=$3Dmol.getColorFromStyle(l,b);var u=ma(s),q=Ja(s,f,e);if(m&&m.length&&0<m.length){var D=$3Dmol.getExtent(m,!0);q.sort(function(a,b){var d=function(a,b){var d=a.extent,c=d[1][1]-d[0][1],f=d[1][2]-d[0][2],
d=d[1][0]-d[0][0]-b[2][0],c=c-b[2][1],f=f-b[2][2];return d*d+c*c+f*f},c=d(a,D),d=d(b,D);return c-d})}var y=[];t=0;for(p=f.length;t<p;t++)l=f[t],y[t]={x:l.x,y:l.y,z:l.z,serial:t,elem:l.elem};if($3Dmol.syncSurface)setTimeout(function ha(b){if(!(b>=q.length)){var c;c=a;var e=q[b].extent,h=q[b].atoms,l=q[b].toshow,m=new $3Dmol.ProteinSurface;m.initparm(e,1===c?!1:!0,u);m.fillvoxels(y,h);m.buildboundary();c==$3Dmol.SurfaceType.SES&&(m.fastdistancemap(),m.boundingatom(!1),m.fillvoxelswaals(y,h));m.marchingcube(c);
c=m.getFacesAndVertices(l);c=ga(f,c,w);$3Dmol.mergeGeos(d.geo,c);g.render();setTimeout(ha,1,b+1)}},1,0);else{e=[];0>a&&(a=0);t=0;for(p=4;t<p;t++)s=new Worker($3Dmol.SurfaceWorker),e.push(s),s.postMessage({type:-1,atoms:y,volume:u});var x=0,s=function(a){a=$3Dmol.splitMesh({vertexArr:a.data.vertices,faceArr:a.data.faces});for(var b=0,c=a.length;b<c;b++){var e=ga(f,{vertices:a[b].vertexArr,faces:a[b].faceArr},w);$3Dmol.mergeGeos(d.geo,e);g.render()}x++;x==q.length&&(d.done=!0)};p=function(a){console.log(a.message+
" ("+a.filename+":"+a.lineno+")")};for(t=0;t<q.length;t++)l=e[t%e.length],l.onmessage=s,l.onerror=p,l.postMessage({type:a,expandedExtent:q[t].extent,extendedAtoms:q[t].atoms,atomsToShow:q[t].toshow})}};b=b||{};var w=p(b),u=[];if(t){var t={},y={};for(f=0;f<e.length;f++)t[f]=[],y[f]=[];for(f=0;f<l.length;f++)t[l[f].model].push(l[f]);for(f=0;f<d.length;f++)y[d[f].model].push(d[f]);for(f=0;f<e.length;f++)u.push({geo:new $3Dmol.Geometry(!0),mat:w,done:!1,finished:!1,symmetries:e[f].getSymmetries()}),q(u[f],
t[f],y[f])}else u.push({geo:new $3Dmol.Geometry(!0),mat:w,done:!1,finished:!1,symmetries:[new $3Dmol.Matrix4]}),q(u[u.length-1],l,d);l=s++;D[l]=u;return l};this.setSurfaceMaterialStyle=function(a,b){if(D[a]){surfArr=D[a];for(var d=0;d<surfArr.length;d++)surfArr[d].mat=p(b),surfArr[d].mat.side=$3Dmol.FrontSide,surfArr[d].finished=!1}};this.removeSurface=function(a){for(var b=D[a],d=0;d<b.length;d++)b[d]&&b[d].lastGL&&(void 0!==b[d].geo&&b[d].geo.dispose(),void 0!==b[d].mat&&b[d].mat.dispose(),K.remove(b[d].lastGL));
delete D[a];V()};this.removeAllSurfaces=function(){for(n in D)if(D.hasOwnProperty(n)){for(var a=D[n],b=0;b<a.length;b++)a[b]&&a[b].lastGL&&(void 0!==a[b].geo&&a[b].geo.dispose(),void 0!==a[b].mat&&a[b].mat.dispose(),K.remove(a[b].lastGL));delete D[n]}V()};this.jmolMoveTo=function(){var a=K.position,a="center { "+-a.x+" "+-a.y+" "+-a.z+" }; ",b=M.quaternion;return a+="moveto .5 quaternion { "+b.x+" "+b.y+" "+b.z+" "+b.w+" };"};this.clear=function(){this.removeAllSurfaces();this.removeAllModels();this.removeAllLabels();
this.removeAllShapes();V()};this.mapAtomProperties=function(a,b){b=b||{};var d=c(b);if("function"==typeof a)for(var f=0,g=d.length;f<g;f++){var h=d[f];a(h)}else for(f=0,g=d.length;f<g;f++)for(var h=d[f],l=0,m=a.length;l<m;l++){var s=a[l];if(s.props)for(var t in s.props)if(s.props.hasOwnProperty(t)){var p;a:{p=h;var u=s;"undefined"===typeof u&&(u={});var q=[],D=void 0;if("undefined"===typeof u.model)for(D=0;D<e.length;D++)e[D]&&q.push(e[D]);else q=u.model,$.isArray(q)||(q=[q]);for(D=0;D<q.length;D++)if(q[D].atomIsSelected(p,
u)){p=!0;break a}p=!1}p&&(h.properties||(h.properties={}),h.properties[t]=s.props[t])}}};try{"function"===typeof z&&z(this)}catch(Ta){console.log("error with glviewer callback: "+Ta)}}}();$3Dmol.glmolViewer=$3Dmol.GLViewer;$3Dmol=$3Dmol||{};$3Dmol.Gradient=function(a,b){};$3Dmol.Gradient.valueToHex=function(a,b){};$3Dmol.Gradient.range=function(){};
$3Dmol.Gradient.RWB=function(a,b){"undefined"==typeof b&&$.isArray(a)&&2<=a.length&&(b=a[1],a=a[0]);this.valueToHex=function(c,q){var p,z;q?(p=q[0],z=q[1]):(p=a,z=b);if(void 0===c)return 16777215;c<p&&(c=p);c>z&&(c=z);var w=(z+p)/2;c<=w?(p=Math.floor(255*Math.sqrt((c-p)/(w-p))),p=16711680+256*p+p):(p=Math.floor(255*Math.sqrt(1-(c-w)/(z-w))),p=65536*p+256*p+255);return p};this.range=function(){return"undefined"!=typeof a&&"undefined"!=typeof b?[a,b]:null}};
$3Dmol.Gradient.ROYGB=function(a,b){"undefined"==typeof b&&$.isArray(a)&&2<=a.length&&(b=a[1],a=a[0]);this.valueToHex=function(c,q){var p,z;q?(p=q[0],z=q[1]):(p=a,z=b);if("undefined"==typeof c)return 16777215;c<p&&(c=p);c>z&&(c=z);var w=(p+z)/2,E=(p+w)/2,d=(w+z)/2;c<E?(p=Math.floor(255*Math.sqrt((c-p)/(E-p))),p=256*p+16711680):c<w?(p=Math.floor(255*Math.sqrt(1-(c-E)/(w-E))),p=65536*p+65280):c<d?(p=Math.floor(255*Math.sqrt((c-w)/(d-w))),p=65280+1*p):(p=Math.floor(255*Math.sqrt(1-(c-d)/(z-d))),p=256*
p+255);return p};this.range=function(){return"undefined"!=typeof a&&"undefined"!=typeof b?[a,b]:null}};
$3Dmol.Gradient.Sinebow=function(a,b){"undefined"==typeof b&&$.isArray(a)&&2<=a.length&&(b=a[1],a=a[0]);this.valueToHex=function(c,q){var p,z;q?(p=q[0],z=q[1]):(p=a,z=b);if("undefined"==typeof c)return 16777215;c<p&&(c=p);c>z&&(c=z);var w=(c-p)/(z-p)*5/6+.5;p=Math.sin(Math.PI*w);p*=255*p;z=Math.sin(Math.PI*(w+1/3));z*=255*z;w=Math.sin(Math.PI*(w+2/3));return 65536*Math.floor(p)+256*Math.floor(255*w*w)+1*Math.floor(z)};this.range=function(){return"undefined"!=typeof a&&"undefined"!=typeof b?[a,b]:
null}};$3Dmol.LabelCount=0;$3Dmol.Label=function(a,b){this.id=$3Dmol.LabelCount++;this.stylespec=b||{};this.canvas=document.createElement("canvas");this.canvas.width=134;this.canvas.height=35;this.context=this.canvas.getContext("2d");this.sprite=new $3Dmol.Sprite;this.text=a};
$3Dmol.Label.prototype={constructor:$3Dmol.Label,getStyle:function(){return this.stylespec},setContext:function(){var a=function(a,c,q){"undefined"!=typeof a&&(q=a instanceof $3Dmol.Color?a.scaled():$3Dmol.CC.color(a).scaled());"undefined"!=typeof c&&(q.a=parseFloat(c));return q};return function(){var b=this.stylespec,c="undefined"==typeof b.useScreen?!1:b.useScreen,q=b.showBackground;if("0"===q||"false"===q)q=!1;"undefined"==typeof q&&(q=!0);var p=b.font?b.font:"sans-serif",z=parseInt(b.fontSize)?
parseInt(b.fontSize):18,w=a(b.fontColor,b.fontOpacity,{r:255,g:255,b:255,a:1}),E=b.padding?b.padding:4,d=b.borderThickness?b.borderThickness:0,g=a(b.backgroundColor,b.backgroundOpacity,{r:0,g:0,b:0,a:1}),f=a(b.borderColor,b.borderOpacity,g),e=b.position?b.position:{x:-10,y:1,z:1},D=void 0!==b.inFront?b.inFront:!0;if("false"===D||"0"===D)D=!1;var s=b.alignment||$3Dmol.SpriteAlignment.topLeft,G="";b.bold&&(G="bold ");this.context.font=G+z+"px  "+p;var h=this.context.measureText(this.text).width;q||
(d=0);var l=h+2.5*d+2*E,y=1.25*z+2*d+2*E;if(b.backgroundImage){var G=b.backgroundImage,m=b.backgroundWidth?b.backgroundWidth:G.width,t=b.backgroundHeight?b.backgroundHeight:G.height;m>l&&(l=m);t>y&&(y=t)}this.canvas.width=l;this.canvas.height=y;this.context.clearRect(0,0,this.canvas.width,this.canvas.height);G="";b.bold&&(G="bold ");this.context.font=G+z+"px  "+p;this.context.fillStyle="rgba("+g.r+","+g.g+","+g.b+","+g.a+")";this.context.strokeStyle="rgba("+f.r+","+f.g+","+f.b+","+f.a+")";this.context.lineWidth=
d;q&&(q=this.context,g=p=d,l-=2*d,y-=2*d,f=0<d,q.beginPath(),q.moveTo(p+6,g),q.lineTo(p+l-6,g),q.quadraticCurveTo(p+l,g,p+l,g+6),q.lineTo(p+l,g+y-6),q.quadraticCurveTo(p+l,g+y,p+l-6,g+y),q.lineTo(p+6,g+y),q.quadraticCurveTo(p,g+y,p,g+y-6),q.lineTo(p,g+6),q.quadraticCurveTo(p,g,p+6,g),q.closePath(),q.fill(),f&&q.stroke());b.backgroundImage&&(G=b.backgroundImage,m=b.backgroundWidth?b.backgroundWidth:G.width,t=b.backgroundHeight?b.backgroundHeight:G.height,this.context.drawImage(G,0,0,m,t));this.context.fillStyle=
"rgba("+w.r+","+w.g+","+w.b+","+w.a+")";this.context.fillText(this.text,d+E,z+d+E,h);b=new $3Dmol.Texture(this.canvas);b.needsUpdate=!0;this.sprite.material=new $3Dmol.SpriteMaterial({map:b,useScreenCoordinates:c,alignment:s,depthTest:!D});this.sprite.scale.set(1,1,1);this.sprite.position.set(e.x,e.y,e.z)}}(),dispose:function(){void 0!==this.sprite.material.map&&this.sprite.material.map.dispose();void 0!==this.sprite.material&&this.sprite.material.dispose()}};$3Dmol=$3Dmol||{};
$3Dmol.MarchingCubeInitializer=function(){var a={march:function(a,w,E,d){var g=!!d.fulltable,f=d.hasOwnProperty("origin")&&d.origin.hasOwnProperty("x")?d.origin:{x:0,y:0,z:0},e=!!d.voxel,D=d.nX||0,s=d.nY||0,G=d.nZ||0,h=d.scale||1,l=null,l=d.unitCube?d.unitCube:{x:h,y:h,z:h},y=new Int32Array(D*s*G);d=0;for(h=y.length;d<h;++d)y[d]=-1;var h=function(a,b,d,c,g,h){var m={x:f.x,y:f.y,z:f.z},t=g;c&1<<g||!(c&1<<h)||(t=h);t&1&&d++;t&2&&b++;t&4&&a++;m.x+=l.x*a;m.y+=l.y*b;m.z+=l.z*d;a=(s*a+b)*G+d;if(e)return w.push(m),
w.length-1;0>y[a]&&(y[a]=w.length,w.push(m));return y[a]},m=new Int32Array(12),t=g?q:b,g=g?p:c;for(d=0;d<D-1;++d)for(var B=0;B<s-1;++B)for(var F=0;F<G-1;++F){for(var x=0,C=0;8>C;++C)x|=!!(a[(s*(d+((C&4)>>2))+B+((C&2)>>1))*G+F+(C&1)]&2)<<C;if(0!==x&&255!==x){var u=t[x];if(0!==u)for(C=g[x],u&1&&(m[0]=h(d,B,F,x,0,1)),u&2&&(m[1]=h(d,B,F,x,1,3)),u&4&&(m[2]=h(d,B,F,x,3,2)),u&8&&(m[3]=h(d,B,F,x,2,0)),u&16&&(m[4]=h(d,B,F,x,4,5)),u&32&&(m[5]=h(d,B,F,x,5,7)),u&64&&(m[6]=h(d,B,F,x,7,6)),u&128&&(m[7]=h(d,B,F,
x,6,4)),u&256&&(m[8]=h(d,B,F,x,0,4)),u&512&&(m[9]=h(d,B,F,x,1,5)),u&1024&&(m[10]=h(d,B,F,x,3,7)),u&2048&&(m[11]=h(d,B,F,x,2,6)),x=0;x<C.length;x+=3){var u=m[C[x]],A=m[C[x+1]],P=m[C[x+2]];e&&3<=x&&(w.push(w[u]),u=w.length-1,w.push(w[A]),A=w.length-1,w.push(w[P]),P=w.length-1);E.push(u);E.push(A);E.push(P)}}}},laplacianSmooth:function(a,b,c){var d=Array(b.length),g,f,e,p;g=0;for(f=b.length;g<f;g++)d[g]={x:0,y:0,z:0};var s=Array(20),q;for(g=0;20>g;g++)s[g]=Array(b.length);g=0;for(f=b.length;g<f;g++)s[0][g]=
0;g=0;for(f=c.length/3;g<f;g++){var h=3*g,l=3*g+1,y=3*g+2;q=!0;e=0;for(p=s[0][c[h]];e<p;e++)if(c[l]==s[e+1][c[h]]){q=!1;break}q&&(s[0][c[h]]++,s[s[0][c[h]]][c[h]]=c[l]);q=!0;e=0;for(p=s[0][c[h]];e<p;e++)if(c[y]==s[e+1][c[h]]){q=!1;break}q&&(s[0][c[h]]++,s[s[0][c[h]]][c[h]]=c[y]);q=!0;e=0;for(p=s[0][c[l]];e<p;e++)if(c[h]==s[e+1][c[l]]){q=!1;break}q&&(s[0][c[l]]++,s[s[0][c[l]]][c[l]]=c[h]);q=!0;e=0;for(p=s[0][c[l]];e<p;e++)if(c[y]==s[e+1][c[l]]){q=!1;break}q&&(s[0][c[l]]++,s[s[0][c[l]]][c[l]]=c[y]);
q=!0;for(e=0;e<s[0][c[y]];e++)if(c[h]==s[e+1][c[y]]){q=!1;break}q&&(s[0][c[y]]++,s[s[0][c[y]]][c[y]]=c[h]);q=!0;e=0;for(p=s[0][c[y]];e<p;e++)if(c[l]==s[e+1][c[y]]){q=!1;break}q&&(s[0][c[y]]++,s[s[0][c[y]]][c[y]]=c[l])}for(c=0;c<a;c++){g=0;for(f=b.length;g<f;g++)if(3>s[0][g])d[g].x=b[g].x,d[g].y=b[g].y,d[g].z=b[g].z;else if(3==s[0][g]||4==s[0][g]){d[g].x=0;d[g].y=0;e=d[g].z=0;for(p=s[0][g];e<p;e++)d[g].x+=b[s[e+1][g]].x,d[g].y+=b[s[e+1][g]].y,d[g].z+=b[s[e+1][g]].z;d[g].x+=.5*b[g].x;d[g].y+=.5*b[g].y;
d[g].z+=.5*b[g].z;d[g].x/=.5+s[0][g];d[g].y/=.5+s[0][g];d[g].z/=.5+s[0][g]}else{d[g].x=0;d[g].y=0;e=d[g].z=0;for(p=s[0][g];e<p;e++)d[g].x+=b[s[e+1][g]].x,d[g].y+=b[s[e+1][g]].y,d[g].z+=b[s[e+1][g]].z;d[g].x+=1*b[g].x;d[g].y+=1*b[g].y;d[g].z+=1*b[g].z;d[g].x/=1+s[0][g];d[g].y/=1+s[0][g];d[g].z/=1+s[0][g]}g=0;for(f=b.length;g<f;g++)b[g].x=d[g].x,b[g].y=d[g].y,b[g].z=d[g].z}},edgeTable:[0,0,0,0,0,0,0,2816,0,0,0,1792,0,3328,3584,3840,0,0,0,138,0,21,0,134,0,0,0,652,0,2067,3865,3600,0,0,0,42,0,0,0,294,
0,0,21,28,0,3875,1049,3360,0,168,162,170,0,645,2475,2210,0,687,293,172,4010,3747,3497,3232,0,0,0,0,0,69,0,900,0,0,0,1792,138,131,1608,1920,0,81,0,2074,84,85,84,86,0,81,0,3676,330,1105,1881,1616,0,0,0,42,0,69,0,502,0,0,21,3580,138,2035,1273,1520,2816,104,2337,106,840,581,367,102,2816,3695,3429,3180,1898,1635,1385,1120,0,0,0,0,0,0,0,3910,0,0,69,588,42,2083,41,2880,0,0,0,1722,0,2293,4095,3830,0,255,757,764,2538,2291,3065,2800,0,0,81,338,0,3925,1119,3414,84,855,85,340,2130,2899,89,2384,1792,712,194,1162,
4036,3781,3535,3270,708,719,197,204,3018,2755,2505,2240,0,0,0,0,168,420,168,1958,162,162,676,2988,170,163,680,928,3328,3096,3328,3642,52,53,1855,1590,2340,2111,2869,2620,298,51,825,560,3584,3584,3090,3482,1668,1941,1183,1430,146,2975,2069,2460,154,915,153,400,3840,3592,3329,3082,1796,1541,1295,1030,2818,2575,2309,2060,778,515,265,0]},b=new Uint32Array(a.edgeTable),c=a.triTable=[[],[],[],[],[],[],[],[11,9,8],[],[],[],[8,10,9],[],[10,8,11],[9,11,10],[8,10,9,8,11,10],[],[],[],[1,7,3],[],[4,2,0],[],[2,
1,7],[],[],[],[2,7,3,2,9,7],[],[1,4,11,1,0,4],[3,8,0,11,9,4,11,10,9],[4,11,9,11,10,9],[],[],[],[5,3,1],[],[],[],[2,5,8,2,1,5],[],[],[2,4,0],[3,2,4],[],[0,9,1,8,10,5,8,11,10],[3,4,0,3,10,4],[5,8,10,8,11,10],[],[3,5,7],[7,1,5],[1,7,3,1,5,7],[],[9,2,0,9,7,2],[0,3,8,1,7,11,1,5,7],[11,1,7,1,5,7],[],[9,1,0,5,3,2,5,7,3],[8,2,5,8,0,2],[2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[],[],[],[],[],[0,6,2],[],[7,2,9,7,9,8],[],[],[],[8,10,9],[7,1,3],
[7,1,0],[6,9,3,6,10,9],[7,10,8,10,9,8],[],[6,0,4],[],[11,1,4,11,3,1],[2,4,6],[2,0,4,2,4,6],[2,4,6],[1,4,2,4,6,2],[],[6,0,4],[],[2,11,3,6,9,4,6,10,9],[8,6,1,8,1,3],[10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[],[],[],[5,3,1],[],[0,6,2],[],[7,4,8,5,2,1,5,6,2],[],[],[2,4,0],[7,4,8,2,11,3,10,5,6],[7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[9,11,8],[3,5,6],[0,5,11,0,11,8],[6,3,5,3,1,5],[3,9,6,3,8,9],[9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[9,11,8],[1,0,9,6,10,5,11,
3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[],[],[],[],[],[],[],[1,10,2,9,11,6,9,8,11],[],[],[6,0,2],[3,6,9,3,2,6],[3,5,1],[0,5,1,0,11,5],[0,3,5],[6,9,11,9,8,11],[],[],[],[4,5,9,7,1,10,7,3,1],[],[11,6,7,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[],[],[0,6,4],[8,6,4,8,1,6],
[],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[4,2,6],[1,0,9,2,4,8,2,6,4],[2,4,0,2,6,4],[8,2,4,2,6,4],[11,4,1,11,6,4],[0,9,1,4,11,6,4,8,11],[3,6,0,6,4,0],[8,6,4,8,11,6],[10,8,9],[6,3,9,6,7,3],[6,7,1],[10,7,1,7,3,1],[7,11,6,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2],[1,0,9,3,6,7,3,2,6],[7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[],[],[],[],[5,3,7],[8,5,2,8,7,5],[5,3,7],[1,10,2,
5,8,7,5,9,8],[1,7,5],[1,7,5],[9,2,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[0,7,1,7,5,1],[9,3,5,3,7,5],[9,7,5,9,8,7],[8,10,11],[3,4,10,3,10,11],[8,10,11],[5,9,4,1,11,3,1,10,11],[2,4,5],[5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[2,8,5,2,11,8],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[11,9,10],[11,9,10],[1,11,4,1,10,11],[8,7,4,11,1,10,11,3,1],[2,7,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[1,7,4],
[3,2,11,4,8,7,9,1,0],[11,4,2,4,0,2],[2,11,3,7,4,8],[4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[3,9,11,9,10,11],[0,10,8,10,11,8],[10,3,1,10,11,3],[2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]],q=[0,265,515,778,2060,2309,2575,2822,1030,1295,1541,1804,3082,3331,3593,3840,400,153,915,666,2460,2197,2975,2710,1430,1183,1941,1692,3482,3219,3993,3728,560,825,51,314,2620,2869,2111,2358,
1590,1855,1077,1340,3642,3891,3129,3376,928,681,419,170,2988,2725,2479,2214,1958,1711,1445,1196,4010,3747,3497,3232,2240,2505,2755,3018,204,453,719,966,3270,3535,3781,4044,1226,1475,1737,1984,2384,2137,2899,2650,348,85,863,598,3414,3167,3925,3676,1370,1107,1881,1616,2800,3065,2291,2554,764,1013,255,502,3830,4095,3317,3580,1786,2035,1273,1520,2912,2665,2403,2154,876,613,367,102,3942,3695,3429,3180,1898,1635,1385,1120,1120,1385,1635,1898,3180,3429,3695,3942,102,367,613,876,2154,2403,2665,2912,1520,
1273,2035,1786,3580,3317,4095,3830,502,255,1013,764,2554,2291,3065,2800,1616,1881,1107,1370,3676,3925,3167,3414,598,863,85,348,2650,2899,2137,2384,1984,1737,1475,1226,4044,3781,3535,3270,966,719,453,204,3018,2755,2505,2240,3232,3497,3747,4010,1196,1445,1711,1958,2214,2479,2725,2988,170,419,681,928,3376,3129,3891,3642,1340,1077,1855,1590,2358,2111,2869,2620,314,51,825,560,3728,3993,3219,3482,1692,1941,1183,1430,2710,2975,2197,2460,666,915,153,400,3840,3593,3331,3082,1804,1541,1295,1030,2822,2575,2309,
2060,778,515,265,0],p=[[],[8,3,0],[9,0,1],[8,3,1,8,1,9],[11,2,3],[11,2,0,11,0,8],[11,2,3,0,1,9],[2,1,11,1,9,11,11,9,8],[10,1,2],[8,3,0,1,2,10],[9,0,2,9,2,10],[3,2,8,2,10,8,8,10,9],[10,1,3,10,3,11],[1,0,10,0,8,10,10,8,11],[0,3,9,3,11,9,9,11,10],[8,10,9,8,11,10],[8,4,7],[3,0,4,3,4,7],[1,9,0,8,4,7],[9,4,1,4,7,1,1,7,3],[2,3,11,7,8,4],[7,11,4,11,2,4,4,2,0],[3,11,2,4,7,8,9,0,1],[2,7,11,2,1,7,1,4,7,1,9,4],[10,1,2,8,4,7],[2,10,1,0,4,7,0,7,3],[4,7,8,0,2,10,0,10,9],[2,7,3,2,9,7,7,9,4,2,10,9],[8,4,7,11,10,1,
11,1,3],[11,4,7,1,4,11,1,11,10,1,0,4],[3,8,0,7,11,4,11,9,4,11,10,9],[7,11,4,4,11,9,11,10,9],[9,5,4],[3,0,8,4,9,5],[5,4,0,5,0,1],[4,8,5,8,3,5,5,3,1],[11,2,3,9,5,4],[9,5,4,8,11,2,8,2,0],[3,11,2,1,5,4,1,4,0],[8,5,4,2,5,8,2,8,11,2,1,5],[2,10,1,9,5,4],[0,8,3,5,4,9,10,1,2],[10,5,2,5,4,2,2,4,0],[3,4,8,3,2,4,2,5,4,2,10,5],[5,4,9,1,3,11,1,11,10],[0,9,1,4,8,5,8,10,5,8,11,10],[3,4,0,3,10,4,4,10,5,3,11,10],[4,8,5,5,8,10,8,11,10],[9,5,7,9,7,8],[0,9,3,9,5,3,3,5,7],[8,0,7,0,1,7,7,1,5],[1,7,3,1,5,7],[11,2,3,8,9,
5,8,5,7],[9,2,0,9,7,2,2,7,11,9,5,7],[0,3,8,2,1,11,1,7,11,1,5,7],[2,1,11,11,1,7,1,5,7],[1,2,10,5,7,8,5,8,9],[9,1,0,10,5,2,5,3,2,5,7,3],[5,2,10,8,2,5,8,5,7,8,0,2],[10,5,2,2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[11,7,6],[0,8,3,11,7,6],[9,0,1,11,7,6],[7,6,11,3,1,9,3,9,8],[2,3,7,2,7,6],[8,7,0,7,6,0,0,6,2],[1,9,0,3,7,6,3,6,2],[7,6,2,7,2,9,2,1,9,7,9,8],[1,2,10,6,11,7],[2,10,1,7,6,11,8,3,0],[11,7,6,10,9,0,10,0,2],[7,6,11,3,2,8,8,2,10,8,10,
9],[6,10,7,10,1,7,7,1,3],[6,10,1,6,1,7,7,1,0,7,0,8],[9,0,3,6,9,3,6,10,9,6,3,7],[6,10,7,7,10,8,10,9,8],[8,4,6,8,6,11],[11,3,6,3,0,6,6,0,4],[0,1,9,4,6,11,4,11,8],[1,9,4,11,1,4,11,3,1,11,4,6],[3,8,2,8,4,2,2,4,6],[2,0,4,2,4,6],[1,9,0,3,8,2,2,8,4,2,4,6],[9,4,1,1,4,2,4,6,2],[10,1,2,11,8,4,11,4,6],[10,1,2,11,3,6,6,3,0,6,0,4],[0,2,10,0,10,9,4,11,8,4,6,11],[2,11,3,6,9,4,6,10,9],[8,4,6,8,6,1,6,10,1,8,1,3],[1,0,10,10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[9,5,4,7,6,11],[4,9,5,3,0,8,11,7,6],[6,11,7,
4,0,1,4,1,5],[6,11,7,4,8,5,5,8,3,5,3,1],[4,9,5,6,2,3,6,3,7],[9,5,4,8,7,0,0,7,6,0,6,2],[4,0,1,4,1,5,6,3,7,6,2,3],[7,4,8,5,2,1,5,6,2],[6,11,7,1,2,10,9,5,4],[11,7,6,8,3,0,1,2,10,9,5,4],[11,7,6,10,5,2,2,5,4,2,4,0],[7,4,8,2,11,3,10,5,6],[4,9,5,6,10,7,7,10,1,7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[5,6,9,6,11,9,9,11,8],[0,9,5,0,5,3,3,5,6,3,6,11],[0,1,5,0,5,11,5,6,11,0,11,8],[11,3,6,6,3,5,3,1,5],[9,5,6,3,9,6,3,8,9,3,6,2],[5,6,9,9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[1,2,
10,5,6,9,9,6,11,9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[10,6,5],[8,3,0,10,6,5],[0,1,9,5,10,6],[10,6,5,9,8,3,9,3,1],[3,11,2,10,6,5],[6,5,10,2,0,8,2,8,11],[1,9,0,6,5,10,11,2,3],[1,10,2,5,9,6,9,11,6,9,8,11],[1,2,6,1,6,5],[0,8,3,2,6,5,2,5,1],[5,9,6,9,0,6,6,0,2],[9,6,5,3,6,9,3,9,8,3,2,6],[11,6,3,6,5,3,3,5,1],[0,5,1,0,11,5,5,11,6,0,8,11],[0,5,9,0,3,5,3,6,5,3,11,6],[5,9,6,6,9,11,9,8,11],[10,6,5,4,7,8],[5,10,6,7,3,0,
7,0,4],[5,10,6,0,1,9,8,4,7],[4,5,9,6,7,10,7,1,10,7,3,1],[7,8,4,2,3,11,10,6,5],[11,6,7,10,2,5,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[7,8,4,5,1,2,5,2,6],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,8,0,7,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,4,5,8,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[10,6,4,10,4,9],[8,3,0,9,10,6,9,6,4],[1,10,0,10,6,0,0,6,4],[8,6,4,8,1,6,6,1,10,8,3,1],[2,3,11,6,4,9,6,9,10],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,11,6,3,6,0,3,6,4,0],[10,
2,1,11,4,8,11,6,4],[9,1,4,1,2,4,4,2,6],[1,0,9,3,2,8,2,4,8,2,6,4],[2,4,0,2,6,4],[3,2,8,8,2,4,2,6,4],[1,4,9,11,4,1,11,1,3,11,6,4],[0,9,1,4,11,6,4,8,11],[11,6,3,3,6,0,6,4,0],[8,6,4,8,11,6],[6,7,10,7,8,10,10,8,9],[9,3,0,6,3,9,6,9,10,6,7,3],[6,1,10,6,7,1,7,0,1,7,8,0],[6,7,10,10,7,1,7,3,1],[7,11,6,3,8,2,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2,2,9,1,7,8,9],[1,0,9,3,6,7,3,2,6],[8,0,7,7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,
6,7],[11,6,7],[11,7,5,11,5,10],[3,0,8,7,5,10,7,10,11],[9,0,1,10,11,7,10,7,5],[3,1,9,3,9,8,7,10,11,7,5,10],[10,2,5,2,3,5,5,3,7],[5,10,2,8,5,2,8,7,5,8,2,0],[9,0,1,10,2,5,5,2,3,5,3,7],[1,10,2,5,8,7,5,9,8],[2,11,1,11,7,1,1,7,5],[0,8,3,2,11,1,1,11,7,1,7,5],[9,0,2,9,2,7,2,11,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[8,7,0,0,7,1,7,5,1],[0,3,9,9,3,5,3,7,5],[9,7,5,9,8,7],[4,5,8,5,10,8,8,10,11],[3,0,4,3,4,10,4,5,10,3,10,11],[0,1,9,4,5,8,8,5,10,8,10,11],[5,9,4,1,11,3,1,10,11],[3,8,4,3,4,2,2,4,5,2,5,10],[10,
2,5,5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[8,4,5,2,8,5,2,11,8,2,5,1],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[4,5,8,8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[7,4,11,4,9,11,11,9,10],[3,0,8,7,4,11,11,4,9,11,9,10],[11,7,4,1,11,4,1,10,11,1,4,0],[8,7,4,11,1,10,11,3,1],[2,3,7,2,7,9,7,4,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[2,11,7,2,7,1,1,7,4,1,4,9],[3,2,11,4,8,7,9,1,0],[7,4,11,11,4,2,4,0,2],[2,11,3,7,4,8],[9,1,4,4,1,7,1,3,7],[1,0,9,8,7,
4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[0,9,3,3,9,11,9,10,11],[1,10,0,0,10,8,10,11,8],[10,3,1,10,11,3],[3,8,2,2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[2,11,1,1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]];return a};$3Dmol.MarchingCube=$3Dmol.MarchingCubeInitializer();
$3Dmol.Parsers=function(){var a={},b=function(a){var b=a.slice(0),c,e;c=0;for(e=a.length;c<e;c++)a[c].index||(a[c].index=c);b.sort(function(a,b){return a.z-b.z});c=0;for(e=b.length;c<e;c++){var p=b[c];for(a=c+1;a<e;a++){var s=b[a];if(4.725<s.z-p.z)break;else 4.725<Math.abs(s.x-p.x)||4.725<Math.abs(s.y-p.y)||!w(p,s)||-1!=p.bonds.indexOf(s.index)||(p.bonds.push(s.index),p.bondOrder.push(1),s.bonds.push(p.index),s.bondOrder.push(1))}}},c=function(a){var c=[],f=[],e,p;e=0;for(p=a.length;e<p;e++){var s=
a[e];s.index=e;s.hetflag?f.push(s):c.push(s)}b(f);c.sort(function(a,b){return a.chain!=b.chain?a.chain<b.chain?-1:1:a.resi-b.resi});var f=a=-1,q;e=0;for(p=c.length;e<p;e++){s=c[e];s.resi!==a&&(a=s.resi,q||f++,q=!1);s.reschain=f;for(var h=e+1;h<c.length;h++){var l=c[h];if(l.chain!=s.chain)break;if(1<l.resi-s.resi)break;w(s,l)&&(-1===s.bonds.indexOf(l.index)&&(s.bonds.push(l.index),s.bondOrder.push(1),l.bonds.push(s.index),l.bondOrder.push(1)),s.resi!==l.resi&&(q=!0))}}},q=function(a){var b=[],c,e;
c=0;for(e=a.length;c<e;c++){a[c].index=c;var p=a[c];p.hetflag||"N"!==p.atom&&"O"!==p.atom||(b.push(p),p.hbondOther=null,p.hbondDistanceSq=Number.POSITIVE_INFINITY)}b.sort(function(a,b){return a.z-b.z});c=0;for(e=b.length;c<e;c++)for(p=b[c],a=c+1;a<e;a++){var s=b[a],q=s.z-p.z;if(3.2<q)break;if(s.atom!=p.atom){var h=Math.abs(s.y-p.y);if(!(3.2<h)){var l=Math.abs(s.x-p.x);3.2<l||(q=l*l+h*h+q*q,10.24<q||s.chain==p.chain&&4>Math.abs(s.resi-p.resi)||(q<p.hbondDistanceSq&&(p.hbondOther=s,p.hbondDistanceSq=
q),q<s.hbondDistanceSq&&(s.hbondOther=p,s.hbondDistanceSq=q)))}}}},p=function(a){q(a);var b={},c,e,p,s,w;c=0;for(e=a.length;c<e;c++)s=a[c],"undefined"===typeof b[s.chain]&&(b[s.chain]=[]),isFinite(s.hbondDistanceSq)&&(4===Math.abs(s.hbondOther.resi-s.resi)?b[s.chain][s.resi]="h":b[s.chain][s.resi]="s");for(p in b){for(c=1;c<b[p].length-1;c++)e=b[p][c-1],s=b[p][c+1],w=b[p][c],e==s&&w!=e&&(b[p][c]=e);for(c=0;c<b[p].length;c++)w=b[p][c],"h"!=w&&"s"!=w||b[p][c-1]==w||b[p][c+1]==w||delete b[p][c]}c=0;
for(e=a.length;c<e;c++)s=a[c],w=b[s.chain][s.resi],"undefined"!=typeof w&&(s.ss=w,b[s.chain][s.resi-1]!=w&&(s.ssbegin=!0),b[s.chain][s.resi+1]!=w&&(s.ssend=!0))};a.cube=a.CUBE=function(a,c){var f=[[]],e=a.replace(/^\s+/,"").split(/[\n\r]+/);if(6>e.length)return f;for(var p=e[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),s=Math.abs(parseFloat(p[0])),p=e[3].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),p=0<parseFloat(p[0])?.529177:1,e=e.splice(6,s),s=f[f.length-1].length,q=s+e.length,h=s;h<
q;++h){var l={};l.serial=h;var y=e[h-s].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");6==y[0]?l.elem="C":1==y[0]?l.elem="H":8==y[0]?l.elem="O":17==y[0]&&(l.elem="Cl");l.x=parseFloat(y[2])*p;l.y=parseFloat(y[3])*p;l.z=parseFloat(y[4])*p;l.hetflag=!0;l.bonds=[];l.bondOrder=[];l.properties={};f[f.length-1].push(l)}for(h=0;h<f.length;h++)b(f[h]);return f};a.xyz=a.XYZ=function(a,c){for(var f=[[]],e=a.split(/\r?\n/);0<e.length&&!(3>e.length);){var p=parseInt(e[0].substr(0,3));if(isNaN(p)||0>=p)break;
if(e.length<p+2)break;for(var s=2,q=f[f.length-1].length,p=q+p;q<p;q++){var h=e[s++].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),l={};l.serial=q;var y=h[0];l.atom=l.elem=y[0].toUpperCase()+y.substr(1).toLowerCase();l.x=parseFloat(h[1]);l.y=parseFloat(h[2]);l.z=parseFloat(h[3]);l.hetflag=!0;l.bonds=[];l.bondOrder=[];l.properties={};f[f.length-1][q]=l;7<=h.length&&(l.dx=parseFloat(h[4]),l.dy=parseFloat(h[5]),l.dz=parseFloat(h[6]))}if(c.multimodel)f.push([]),e.splice(0,s);else break}for(q=0;q<
f.length;q++)b(f[q]);if(c.onemol)for(e=f,f=[],f.push(e[0]),q=1;q<e.length;q++)for(s=f[0].length,p=0;p<e[q].length;p++){h=e[q][p];for(l=0;l<h.bonds.length;l++)h.bonds[l]+=s;h.index=f[0].length;h.serial=f[0].length;f[0].push(h)}return f};a.sdf=a.SDF=function(a,b){var c=[[]],e=!1;"undefined"!==typeof b.keepH&&(e=!b.keepH);for(var p=a.split(/\r?\n/);0<p.length&&!(4>p.length);){var s=parseInt(p[3].substr(0,3));if(isNaN(s)||0>=s)break;var q=parseInt(p[3].substr(3,3)),h=4;if(p.length<4+s+q)break;for(var l=
[],y=c[c.length-1].length,m=y+s,t,s=y;s<m;s++,h++){t=p[h];var w={},z=t.substr(31,3).replace(/ /g,"");w.atom=w.elem=z[0].toUpperCase()+z.substr(1).toLowerCase();"H"==w.elem&&e||(w.serial=s,l[s]=c[c.length-1].length,w.x=parseFloat(t.substr(0,10)),w.y=parseFloat(t.substr(10,10)),w.z=parseFloat(t.substr(20,10)),w.hetflag=!0,w.bonds=[],w.bondOrder=[],w.properties={},w.index=c[c.length-1].length,c[c.length-1].push(w))}for(s=0;s<q;s++,h++)t=p[h],m=l[parseInt(t.substr(0,3))-1+y],w=l[parseInt(t.substr(3,3))-
1+y],t=parseInt(t.substr(6,3)),"undefined"!=typeof m&&"undefined"!=typeof w&&(c[c.length-1][m].bonds.push(w),c[c.length-1][m].bondOrder.push(t),c[c.length-1][w].bonds.push(m),c[c.length-1][w].bondOrder.push(t));if(b.multimodel){for(b.onemol||c.push([]);"$$$$"!=p[h];)h++;p.splice(0,++h)}else break}return c};a.cdjson=a.json=function(a,b,c){c=[[]];"string"===typeof a&&(a=JSON.parse(a));var e=a.m,p=e[0].a;a=e[0].b;var s=e[0].s,q=void 0!==b&&void 0!==b.parseStyle?b.parseStyle:void 0!==s;b=c[c.length-1].length;
for(e=0;e<p.length;e++){var h=p[e],l={};l.id=h.i;l.x=h.x;l.y=h.y;l.z=h.z||0;l.bonds=[];l.bondOrder=[];var w=h.l||"C";l.elem=w[0].toUpperCase()+w.substr(1).toLowerCase();l.serial=c[c.length-1].length;q&&(l.style=s[h.s||0]);c[c.length-1].push(l)}for(e=0;e<a.length;e++)q=a[e],p=q.b+b,s=q.e+b,q=q.o||1,h=c[c.length-1][p],l=c[c.length-1][s],h.bonds.push(s),h.bondOrder.push(q),l.bonds.push(p),l.bondOrder.push(q);return c};a.mcif=a.cif=function(a,c,f){function e(a,b){for(var c=[],d=0,f=0;f<a.length;){for(;a.substr(f,
b.length)!==b&&f<a.length;){if("'"===a[f])for(f++;f<a.length&&"'"!==a[f];)f++;else if('"'===a[f])for(f++;f<a.length&&'"'!==a[f];)f++;f++}c.push(a.substr(d,f-d));d=f+=b.length}return c}function q(a,b,c){return{x:x[0][0]*a+x[0][1]*b+x[0][2]*c,y:x[1][0]*a+x[1][1]*b+x[1][2]*c,z:x[2][0]*a+x[2][1]*b+x[2][2]*c}}function s(a){var b=a.match("-");a=a.replace(/[-xyz]/g,"");a=a.split("/");var c;c=void 0===a[1]?1:parseInt(a[1]);return(""===a[0]?1:parseInt(a[0]))/c*(b?-1:1)}var w=[[]],h=!c.doAssembly;c=!c.duplicateAssemblyAtoms;
f.symmetries=[];a=a.split(/\r?\n/);for(var l=[],y=!1,m=0;m<a.length;m++){var t=a[m].split("#")[0];y?";"===t[0]&&(y=!1):";"===t[0]&&(y=!0);if(y||""!==t){if(!y&&(t=t.trim(),"_"===t[0])){var B=t.split(/\s/)[0].indexOf(".");-1<B&&(t[B]="_",t=t.substr(0,B)+"_"+t.substr(B+1))}l.push(t)}}a={};for(m=0;m<l.length;)if(void 0===l[m][0])m++;else if("_"===l[m][0]){B=l[m].split(/\s/)[0].toLowerCase();t=a[B]=a[B]||[];y=l[m].substr(l[m].indexOf(B)+B.length);if(""===y)if(m++,";"===l[m][0]){y=l[m].substr(1);for(m++;";"!==
l[m];)y=y+"\n"+l[m],m++;t.push(y)}else t.push(l[m]);else t.push(y.trim());m++}else if("loop_"===l[m].substr(0,5)){m++;for(y=[];""===l[m]||"_"===l[m][0];)""!==l[m]&&(B=l[m].split(/\s/)[0].toLowerCase(),t=a[B]=a[B]||[],y.push(t)),m++;for(B=0;m<l.length&&"_"!==l[m][0]&&"loop_"!==l[m].substr(0,5);){for(var t=e(l[m]," "),z=0;z<t.length;z++)""!==t[z]&&(y[B].push(t[z]),B=(B+1)%y.length);m++}}else m++;var m=[],y=0,t=void 0!==a._atom_site_id?a._atom_site_id.length:a._atom_site_label.length,x;if(void 0!==a._cell_length_a){var l=
parseFloat(a._cell_length_a),B=parseFloat(a._cell_length_b),z=parseFloat(a._cell_length_c),C=parseFloat(a._cell_angle_alpha)||90,u=parseFloat(a._cell_angle_beta)||90,A=parseFloat(a._cell_angle_gamma)||90,P=u*Math.PI/180,M=A*Math.PI/180,K=Math.cos(C*Math.PI/180),P=Math.cos(P),I=Math.cos(M),M=Math.sin(M);x=[[l,B*I,z*P],[0,B*M,z*(K-P*I)/M],[0,0,z*Math.sqrt(1-K*K-P*P-I*I+2*K*P*I)/M]];f.cryst={a:l,b:B,c:z,alpha:C,beta:u,gamma:A}}for(l=0;l<t;l++)if(void 0===a._atom_site_group_pdb||"TER"!==a._atom_site_group_pdb[l])B=
{},void 0!==a._atom_site_cartn_x?(B.x=parseFloat(a._atom_site_cartn_x[l]),B.y=parseFloat(a._atom_site_cartn_y[l]),B.z=parseFloat(a._atom_site_cartn_z[l])):(z=q(parseFloat(a._atom_site_fract_x[l]),parseFloat(a._atom_site_fract_y[l]),parseFloat(a._atom_site_fract_z[l])),B.x=z.x,B.y=z.y,B.z=z.z),B.chain=a._atom_site_auth_asym_id?a._atom_site_auth_asym_id[l]:void 0,B.resi=a._atom_site_auth_seq_id?parseInt(a._atom_site_auth_seq_id[l]):void 0,B.resn=a._atom_site_auth_comp_id?a._atom_site_auth_comp_id[l].trim():
void 0,B.atom=a._atom_site_auth_atom_id?a._atom_site_auth_atom_id[l].replace(/"/gm,""):void 0,B.hetflag=!a._atom_site_group_pdb||"HETA"===a._atom_site_group_pdb[l]||"HETATM"===a._atom_site_group_pdb[l],z=a._atom_site_type_symbol[l],B.elem=z[0].toUpperCase()+z.substr(1).toLowerCase(),B.bonds=[],B.ss="c",B.serial=l,B.bondOrder=[],B.properties={},B.index=y++,m[B.index]=B;y={};for(l=0;l<t;l++)B=(a._atom_site_label_alt_id||[])[l],void 0===B&&(B="."),z=(a._atom_site_label_asym_id||[])[l],void 0===z&&(z=
"."),C=(a._atom_site_label_atom_id||[])[l],void 0===C&&(C="."),u=(a._atom_site_label_seq_id||[])[l],void 0===u&&(u="."),void 0===y[B]&&(y[B]={}),void 0===y[B][z]&&(y[B][z]={}),void 0===y[B][z][C]&&(y[B][z][C]={}),y[B][z][C][u]=l;for(l=0;l<m.length;l++)delete m[l].index,w[w.length-1].push(m[l]);for(l=0;l<w.length;l++)b(w[l]),p(w[l]);if(void 0!==a._pdbx_struct_oper_list_id&&!h){for(l=0;l<a._pdbx_struct_oper_list_id.length;l++)h=parseFloat(a["_pdbx_struct_oper_list_matrix[1][1]"][l]),m=parseFloat(a["_pdbx_struct_oper_list_matrix[1][2]"][l]),
t=parseFloat(a["_pdbx_struct_oper_list_matrix[1][3]"][l]),y=parseFloat(a["_pdbx_struct_oper_list_vector[1]"][l]),B=parseFloat(a["_pdbx_struct_oper_list_matrix[2][1]"][l]),z=parseFloat(a["_pdbx_struct_oper_list_matrix[2][2]"][l]),C=parseFloat(a["_pdbx_struct_oper_list_matrix[2][3]"][l]),u=parseFloat(a["_pdbx_struct_oper_list_vector[2]"][l]),A=parseFloat(a["_pdbx_struct_oper_list_matrix[3][1]"][l]),K=parseFloat(a["_pdbx_struct_oper_list_matrix[3][2]"][l]),M=parseFloat(a["_pdbx_struct_oper_list_matrix[3][3]"][l]),
P=parseFloat(a["_pdbx_struct_oper_list_vector[3]"][l]),h=new $3Dmol.Matrix4(h,m,t,y,B,z,C,u,A,K,M,P),f.symmetries.push(h);for(l=0;l<w.length;l++)E(f.symmetries,c,w[l])}if(void 0!==a._symmetry_equiv_pos_as_xyz){for(l=0;l<a._symmetry_equiv_pos_as_xyz.length;l++){m=a._symmetry_equiv_pos_as_xyz[l].replace(/["' ]/g,"").split(",").map(function(a){return a.replace(/-/g,"+-")});h=new $3Dmol.Matrix4(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1);for(t=0;3>t;t++)for(y=m[t].split("+"),B=0;B<y.length;B++)z=y[B],""!==z&&(C=
s(z),z.match("x")?h.elements[t+0]=C:z.match("y")?h.elements[t+4]=C:z.match("z")?h.elements[t+8]=C:h.elements[t+12]=C);m=new $3Dmol.Matrix4(x[0][0],x[0][1],x[0][2],0,x[1][0],x[1][1],x[1][2],0,x[2][0],x[2][1],x[2][2],0);t=(new $3Dmol.Matrix4).getInverse(m,!0);h=(new $3Dmol.Matrix4).multiplyMatrices(h,t);h=(new $3Dmol.Matrix4).multiplyMatrices(m,h);f.symmetries.push(h)}for(l=0;l<w.length;l++)E(f.symmetries,c,w[l])}return w};a.mol2=a.MOL2=function(a,b){var c=[[]],e=!1;"undefined"!==typeof b.keepH&&(e=
!b.keepH);for(var p=a.substr(s,a.length).split(/\r?\n/);0<p.length;){var s=a.search(/@<TRIPOS>MOLECULE/),q=a.search(/@<TRIPOS>ATOM/);if(-1==s||-1==q)break;var s=[],h=p[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),l=parseInt(h[0]),q=0;1<h.length&&(q=parseInt(h[1]));var w=4,m;for(m=3;m<p.length;m++)if("@<TRIPOS>ATOM"==p[m]){w=m+1;break}m=c[c.length-1].length;for(l=m+l;m<l;m++){var h=p[w++],h=h.replace(/^\s+/,"").replace(/\s+/g," ").split(" "),t={},z=h[5].split(".")[0];t.atom=t.elem=z[0].toUpperCase()+
z.substr(1).toLowerCase();if("H"!=t.elem||!e){var z=c[c.length-1].length,E=parseInt(h[0]);t.serial=E;t.x=parseFloat(h[2]);t.y=parseFloat(h[3]);t.z=parseFloat(h[4]);t.atom=h[5];h=parseFloat(h[8]);t.index=z;t.bonds=[];t.bondOrder=[];t.properties={charge:h,partialCharge:h};s[E]=z;c[c.length-1].push(t)}}for(m=!1;w<p.length;)if("@<TRIPOS>BOND"==p[w++]){m=!0;break}if(m&&q)for(m=0;m<q;m++)h=p[w++],h=h.replace(/^\s+/,"").replace(/\s+/g," ").split(" "),l=parseInt(h[1]),fromAtom=c[c.length-1][s[l]],t=parseInt(h[2]),
toAtom=c[c.length-1][s[t]],h=parseInt(h[3]),isNaN(h)&&(h=1),void 0!==fromAtom&&void 0!==toAtom&&(fromAtom.bonds.push(s[t]),fromAtom.bondOrder.push(h),toAtom.bonds.push(s[l]),toAtom.bondOrder.push(h));if(b.multimodel)b.onemol||c.push([]),p.splice(0,w),a=p.join("\n");else break}return c};var z={H:.37,He:.32,Li:1.34,Be:.9,B:.82,C:.77,N:.75,O:.73,F:.71,Ne:.69,Na:1.54,Mg:1.3,Al:1.18,Si:1.11,P:1.06,S:1.02,Cl:.99,Ar:.97,K:1.96,Ca:1.74,Sc:1.44,Ti:1.56,V:1.25,Mn:1.39,Fe:1.25,Co:1.26,Ni:1.21,Cu:1.38,Zn:1.31,
Ga:1.26,Ge:1.22,Se:1.16,Br:1.14,Kr:1.1,Rb:2.11,Sr:1.92,Y:1.62,Zr:1.48,Nb:1.37,Mo:1.45,Tc:1.56,Ru:1.26,Rh:1.35,Pd:1.31,Ag:1.53,Cd:1.48,In:1.44,Sn:1.41,Sb:1.38,Te:1.35,I:1.33,Xe:1.3,Cs:2.25,Ba:1.98,Lu:1.6,Hf:1.5,Ta:1.38,W:1.46,Re:1.59,Os:1.44,Ir:1.37,Pt:1.28,Au:1.44,Hg:1.49,Tl:1.48,Pb:1.47,Bi:1.46,Rn:1.45},w=function(a,b){var c=(z[a.elem]||1.6)+(z[b.elem]||1.6),c=c*c*1.1,e=a.x-b.x,e=e*e;if(e>c)return!1;var p=a.y-b.y,p=p*p;if(p>c)return!1;var s=a.z-b.z,s=s*s;if(s>c)return!1;e=e+p+s;return isNaN(e)?!1:
.5>e?!1:e>c?!1:!0},E=function(a,b,c){var e=c.length,p=e,s,q;if(!b)for(b=0;b<a.length;b++){if(!a[b].isIdentity()){var h=new $3Dmol.Vector3;for(q=0;q<e;q++){var l=[];for(s=0;s<c[q].bonds.length;s++)l.push(c[q].bonds[s]+p);h.set(c[q].x,c[q].y,c[q].z);h.applyMatrix4(a[b]);s={};for(var w in c[q])s[w]=c[q][w];s.x=h.x;s.y=h.y;s.z=h.z;s.bonds=l;c.push(s)}p=c.length}}else if(1<a.length)for(b=0;b<c.length;b++){e=[];for(s=0;s<a.length;s++)a[s].isIdentity()||(p=new $3Dmol.Vector3,p.set(c[b].x,c[b].y,c[b].z),
p.applyMatrix4(a[s]),e.push(p));c[b].symmetries=e}};a.pdb=a.PDB=a.pdbqt=a.PDBQT=function(a,b,f){var e=[[]],q=!b.keepH,s=!b.noSecondaryStructure,w=!b.doAssembly,h=!b.duplicateAssemblyAtoms;f.symmetries=[];var l=e[e.length-1].length,y,m=[],t=[],B=!1,F=[];a=a.split(/\r?\n/);var x,C,u;for(x=0;x<a.length;x++){u=a[x].replace(/^\s*/,"");C=u.substr(0,6);var A;if(0==C.indexOf("END"))if(b.multimodel)b.onemol||e.push([]);else break;else if("ATOM  "==C||"HETATM"==C){var P,M,K,I,J,L,Q,R,N;C=u.substr(16,1);if(" "==
C||"A"==C)N=parseInt(u.substr(6,5)),y=u.substr(12,4).replace(/ /g,""),A=u.substr(17,3),P=u.substr(21,1),M=parseInt(u.substr(22,4)),K=u.substr(26,1),I=parseFloat(u.substr(30,8)),J=parseFloat(u.substr(38,8)),L=parseFloat(u.substr(46,8)),C=parseFloat(u.substr(60,8)),R=u.substr(76,2).replace(/ /g,""),""===R?(R=u.substr(12,2).replace(/ /g,""),0<R.length&&"H"==R[0]&&"Hg"!=R&&(R="H"),1<R.length&&(R=R[0].toUpperCase()+R.substr(1).toLowerCase(),"undefined"===typeof z[R]?R=R[0]:"A"==u[0]&&"Ca"==R&&(R="C"))):
R=R[0].toUpperCase()+R.substr(1).toLowerCase(),"H"==R&&q||(Q="H"==u[0]?!0:!1,F[N]=e[e.length-1].length,e[e.length-1].push({resn:A,x:I,y:J,z:L,elem:R,hetflag:Q,chain:P,resi:M,icode:K,rescode:M+(" "!=K?"^"+K:""),serial:N,atom:y,bonds:[],ss:"c",bondOrder:[],properties:{},b:C,pdbline:u}))}else if("SHEET "==C)B=!0,C=u.substr(21,1),y=parseInt(u.substr(22,4)),A=u.substr(32,1),u=parseInt(u.substr(33,4)),m.push([C,y,A,u]);else if("CONECT"==C)for(C=parseInt(u.substr(6,5)),y=e[e.length-1][F[C]],C=0;4>C;C++)A=
parseInt(u.substr([11,16,21,26][C],5)),P=e[e.length-1][F[A]],void 0!==y&&void 0!==P&&(A=F[A],y.bonds[y.bonds.length-1]!=A&&(y.bonds.push(A),y.bondOrder.push(1)));else if("HELIX "==C)B=!0,C=u.substr(19,1),y=parseInt(u.substr(21,4)),A=u.substr(31,1),u=parseInt(u.substr(33,4)),t.push([C,y,A,u]);else if(w||"REMARK"!=C||"BIOMT"!=u.substr(13,5))"CRYST1"==C&&(y=parseFloat(u.substr(7,8)),C=parseFloat(u.substr(16,8)),A=parseFloat(u.substr(25,8)),P=parseFloat(u.substr(34,6)),M=parseFloat(u.substr(41,6)),u=
parseFloat(u.substr(48,6)),f.cryst={a:y,b:C,c:A,alpha:P,beta:M,gamma:u});else{C=new $3Dmol.Matrix4;for(A=1;3>=A;A++)if(u=a[x].replace(/^\s*/,""),parseInt(u.substr(18,1))==A)C.elements[A-1]=parseFloat(u.substr(23,10)),C.elements[A-1+4]=parseFloat(u.substr(33,10)),C.elements[A-1+8]=parseFloat(u.substr(43,10)),C.elements[A-1+12]=parseFloat(u.substr(53)),x++;else for(;"BIOMT"==u.substr(13,5);)x++,u=a[x].replace(/^\s*/,"");C.elements[3]=0;C.elements[7]=0;C.elements[11]=0;C.elements[15]=1;f.symmetries.push(C);
x--}}(new Date).getTime();for(A=0;A<e.length;A++){c(e[A]);w||E(f.symmetries,h,e[A]);if(s||!B)(new Date).getTime(),p(e[A]);for(x=l;x<e[A].length;x++)if(y=e[A][x],void 0!==y){for(C=0;C<m.length;C++)y.chain!=m[C][0]||y.resi<m[C][1]||y.resi>m[C][3]||(y.ss="s",y.resi==m[C][1]&&(y.ssbegin=!0),y.resi==m[C][3]&&(y.ssend=!0));for(C=0;C<t.length;C++)y.chain!=t[C][0]||y.resi<t[C][1]||y.resi>t[C][3]||(y.ss="h",y.resi==t[C][1]?y.ssbegin=!0:y.resi==t[C][3]&&(y.ssend=!0))}}return e};a.pqr=a.PQR=function(a,b){var f=
[[]],e,q=!b.noSecondaryStructure,s=[],w=a.split(/\r?\n/),h,l;for(h=0;h<w.length;h++)if(l=w[h].replace(/^\s*/,""),e=l.substr(0,6),0==e.indexOf("END"))if(b.multimodel)b.onemol||f.push([]);else break;else if("ATOM  "==e||"HETATM"==e){var y=parseInt(l.substr(6,5));e=l.substr(12,4).replace(/ /g,"");var m=l.substr(17,3),t=l.substr(21,1),z=parseInt(l.substr(22,4)),E=l.substr(30).trim().split(/\s+/),x=parseFloat(E[0]),C=parseFloat(E[1]),u=parseFloat(E[2]),A=parseFloat(E[3]),E=parseFloat(E[4]),P=e[0];1<e.length&&
e[1].toUpperCase()!=e[1]&&(P=e.substr(0,2));hetflag="H"==l[0]?!0:!1;s[y]=f[f.length-1].length;f[f.length-1].push({resn:m,x:x,y:C,z:u,elem:P,hetflag:hetflag,chain:t,resi:z,serial:y,atom:e,bonds:[],ss:"c",bondOrder:[],properties:{charge:A,partialCharge:A,radius:E},pdbline:l})}else if("CONECT"==e)for(e=parseInt(l.substr(6,5)),y=f[f.length-1][s[e]],e=0;4>e;e++)m=parseInt(l.substr([11,16,21,26][e],5)),t=f[f.length-1][s[m]],void 0!==y&&void 0!==t&&(y.bonds.push(s[m]),y.bondOrder.push(1));for(h=0;h<f.length;h++)c(f[h]),
q&&p(f[h]);return f};return a}();$3Dmol=$3Dmol||{};
$3Dmol.partialCharges={"ALA:N":-.15,"ALA:CA":.1,"ALA:CB":0,"ALA:C":.6,"ALA:O":-.55,"ARG:N":-.15,"ARG:CA":.1,"ARG:CB":0,"ARG:CG":0,"ARG:CD":.1,"ARG:NE":-.1,"ARG:CZ":.5,"ARG:NH1":.25,"ARG:NH2":.25,"ARG:C":.6,"ARG:O":-.55,"ASN:N":-.15,"ASN:CA":.1,"ASN:CB":0,"ASN:CG":.55,"ASN:OD1":-.55,"ASN:ND2":0,"ASN:C":.6,"ASN:O":-.55,"ASP:N":-.15,"ASP:CA":.1,"ASP:CB":0,"ASP:CG":.14,"ASP:OD1":-.57,"ASP:OD2":-.57,"ASP:C":.6,"ASP:O":-.55,"CYS:N":-.15,"CYS:CA":.1,"CYS:CB":.19,"CYS:SG":-.19,"CYS:C":.6,"CYS:O":-.55,"GLN:N":-.15,
"GLN:CA":.1,"GLN:CB":0,"GLN:CG":0,"GLN:CD":.55,"GLN:OE1":-.55,"GLN:NE2":0,"GLN:C":.6,"GLN:O":-.55,"GLU:N":-.15,"GLU:CA":.1,"GLU:CB":0,"GLU:CG":0,"GLU:CD":.14,"GLU:OE1":-.57,"GLU:OE2":-.57,"GLU:C":.6,"GLU:O":-.55,"GLY:N":-.15,"GLY:CA":.1,"GLY:C":.6,"GLY:O":-.55,"HIS:N":-.15,"HIS:CA":.1,"HIS:CB":0,"HIS:CG":.1,"HIS:ND1":-.1,"HIS:CD2":.1,"HIS:NE2":-.4,"HIS:CE1":.3,"HIS:C":.6,"HIS:O":-.55,"ILE:N":-.15,"ILE:CA":.1,"ILE:CB":0,"ILE:CG2":0,"ILE:CG1":0,"ILE:CD":0,"ILE:C":.6,"ILE:O":-.55,"LEU:N":-.15,"LEU:CA":.1,
"LEU:CB":0,"LEU:CG":0,"LEU:CD1":0,"LEU:CD2":0,"LEU:C":.6,"LEU:O":-.55,"LYS:N":-.15,"LYS:CA":.1,"LYS:CB":0,"LYS:CG":0,"LYS:CD":0,"LYS:CE":.25,"LYS:NZ":.75,"LYS:C":.6,"LYS:O":-.55,"MET:N":-.15,"MET:CA":.1,"MET:CB":0,"MET:CG":.06,"MET:SD":-.12,"MET:CE":.06,"MET:C":.6,"MET:O":-.55,"PHE:N":-.15,"PHE:CA":.1,"PHE:CB":0,"PHE:CG":0,"PHE:CD1":0,"PHE:CD2":0,"PHE:CE1":0,"PHE:CE2":0,"PHE:CZ":0,"PHE:C":.6,"PHE:O":-.55,"PRO:N":-.25,"PRO:CD":.1,"PRO:CA":.1,"PRO:CB":0,"PRO:CG":0,"PRO:C":.6,"PRO:O":-.55,"SER:N":-.15,
"SER:CA":.1,"SER:CB":.25,"SER:OG":-.25,"SER:C":.6,"SER:O":-.55,"THR:N":-.15,"THR:CA":.1,"THR:CB":.25,"THR:OG1":-.25,"THR:CG2":0,"THR:C":.6,"THR:O":-.55,"TRP:N":-.15,"TRP:CA":.1,"TRP:CB":0,"TRP:CG":-.03,"TRP:CD2":.1,"TRP:CE2":-.04,"TRP:CE3":-.03,"TRP:CD1":.06,"TRP:NE1":-.06,"TRP:CZ2":0,"TRP:CZ3":0,"TRP:CH2":0,"TRP:C":.6,"TRP:O":-.55,"TYR:N":-.15,"TYR:CA":.1,"TYR:CB":0,"TYR:CG":0,"TYR:CD1":0,"TYR:CE1":0,"TYR:CD2":0,"TYR:CE2":0,"TYR:CZ":.25,"TYR:OH":-.25,"TYR:C":.6,"TYR:O":-.55,"VAL:N":-.15,"VAL:CA":.1,
"VAL:CB":0,"VAL:CG1":0,"VAL:CG2":0,"VAL:C":.6,"VAL:O":-.55};$3Dmol.applyPartialCharges=function(a,b){b&&"undefined"!==typeof a.partialCharge||a.resn&&a.atom&&(a.properties.partialCharge=$3Dmol.partialCharges[a.resn+":"+a.atom])};(function(){});$3Dmol.VolumeData=function(a,b){this.unit={x:1,y:1,z:1};this.origin={x:0,y:0,z:0};this.size={x:0,y:0,z:0};this.data=new Float32Array([]);b=b.toLowerCase();if(this[b])this[b](a)};
$3Dmol.VolumeData.prototype.getVal=function(a,b,c){a-=this.origin.x;b-=this.origin.y;c-=this.origin.z;a/=this.unit.x;b/=this.unit.y;c/=this.unit.z;a=Math.round(a);b=Math.round(b);c=Math.round(c);return 0>a||a>=this.size.x||0>b||b>=this.size.y||0>c||c>=this.size.z?0:this.data[a*this.size.y*this.size.z+b*this.size.z+c]};
$3Dmol.VolumeData.prototype.cube=function(a){a=a.replace(/^\s+/,"").split(/[\n\r]+/);if(!(6>a.length)){var b=a[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),c=parseFloat(b[0]),q=Math.abs(c),p=this.origin=new $3Dmol.Vector3(parseFloat(b[1]),parseFloat(b[2]),parseFloat(b[3])),b=a[3].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),z=0<b[0]?.529177:1;p.multiplyScalar(z);var p=Math.abs(b[0]),w=(new $3Dmol.Vector3(parseFloat(b[1]),parseFloat(b[2]),parseFloat(b[3]))).multiplyScalar(z),b=a[4].replace(/^\s+/,
"").replace(/\s+/g," ").split(" "),E=Math.abs(b[0]),d=(new $3Dmol.Vector3(parseFloat(b[1]),parseFloat(b[2]),parseFloat(b[3]))).multiplyScalar(z),b=a[5].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),g=Math.abs(b[0]),b=(new $3Dmol.Vector3(parseFloat(b[1]),parseFloat(b[2]),parseFloat(b[3]))).multiplyScalar(z);this.size={x:p,y:E,z:g};this.unit=new $3Dmol.Vector3(w.x,d.y,b.z);0==w.y&&0==w.z&&0==d.x&&0==d.z&&0==b.x&&0==b.y||console.log("Warning: Cube file is not axis aligned.  This isn't going to look right.");
b=6;0>c&&b++;a=a.splice(q+b).join(" ");a=a.replace(/^\s+/,"");a=a.split(/[\s\r]+/);this.data=new Float32Array(a)}};
$3Dmol.workerString=function(){self.onmessage=function(a){a=a.data;var b=a.type;if(0>b)self.atomData=a.atoms,self.volume=a.volume,self.ps=new ProteinSurface;else{var c=self.ps;c.initparm(a.expandedExtent,1==b?!1:!0,self.volume);c.fillvoxels(self.atomData,a.extendedAtoms);c.buildboundary();if(4===b||2===b)c.fastdistancemap(),c.boundingatom(!1),c.fillvoxelswaals(self.atomData,a.extendedAtoms);c.marchingcube(b);a=c.getFacesAndVertices(a.atomsToShow);self.postMessage(a)}}}.toString().replace(/(^.*?\{|\}$)/g,
"");$3Dmol.workerString+="; var ProteinSurface="+$3Dmol.ProteinSurface.toString().replace(/\$3Dmol.MarchingCube./g,"MarchingCube.");$3Dmol.workerString+=",MarchingCube=("+$3Dmol.MarchingCubeInitializer.toString()+")();";$3Dmol.SurfaceWorker=window.URL.createObjectURL(new Blob([$3Dmol.workerString],{type:"text/javascript"}));$3Dmol.workerString=$3Dmol.workerString;$3Dmol.SurfaceWorker=$3Dmol.SurfaceWorker;
