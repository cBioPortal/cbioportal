(self.webpackChunkcbioportal_frontend=self.webpackChunkcbioportal_frontend||[]).push([[113],{93080:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>ms,initStore:()=>ps});var r=n(88034),o=n(57930),i=n.n(o),a=n(77906),l=n.n(a),s=n(11e3),u=n(27808),c=n(78566),p=n(84232),d=n(21015),f=n(79280),m=n(95920),h=n(59280),y=n(76127),b=n.n(y),g=n(49572),v=n(74418),S=n(5933);var C=n(56066),E=n(64577),w=n(65587),T=n(15757),P=n(95497),O=n(67461),k=n(77906);function A(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function I(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function D(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function x(e,t){return(x=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function M(e){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var N=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":M(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},L=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))};function R(e){return i().round(100*e,2)}function j(e){var t=e[0].map((function(e){return e.x})),n=e.reduce((function(e,t){return t.forEach((function(t){e[t.x]=e[t.x]||0,e[t.x]+=t.y})),e}),{});return t.map((function(e){return{x:e,y:n[e],alterationType:"whatever"}}))}var G=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=function(e,t){return!t||"object"!==M(t)&&"function"!=typeof t?D(e):t}(this,_(t).call(this,e)),Object.defineProperty(D(n),"barPlotTooltipModel",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(D(n),"scatterPlotTooltipModel",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(D(n),"barToolTipCounter",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(D(n),"isBarPlotTooltipHovered",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(D(n),"shouldUpdatePosition",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(D(n),"mousePosition",{enumerable:!0,configurable:!0,writable:!0,value:{x:0,y:0}}),Object.defineProperty(D(n),"plotSvg",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(D(n),"dummyScrollPane",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(D(n),"scrollPane",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(D(n),"scrollingDummyPane",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(D(n),"plotElementWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),(0,c.makeObservable)(D(n)),n}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&x(e,t)}(t,e),n=t,(o=[{key:"getSvg",value:function(){return this.plotSvg}},{key:"assignScrollPaneRef",value:function(e){this.scrollPane=e,e&&(this.synchronizeScrollPanes(),k(e).scroll(this.synchronizeScrollPanes))}},{key:"assignDummyScrollPaneRef",value:function(e){var t=this;this.dummyScrollPane=e,e&&(this.synchronizeScrollPanes(),k(e).scroll(this.synchronizeScrollPanes),k(e).on("mousedown",(function(){t.scrollingDummyPane=!0})),k(e).on("mouseup",(function(){t.scrollingDummyPane=!1})))}},{key:"assignPlotSvgRef",value:function(e){this.plotSvg=e,this.plotElementWidth=e?e.scrollWidth:0}},{key:"synchronizeScrollPanes",value:function(){this.scrollPane&&this.dummyScrollPane&&(this.scrollingDummyPane?this.scrollPane.scrollLeft=this.dummyScrollPane.scrollLeft:this.dummyScrollPane.scrollLeft=this.scrollPane.scrollLeft)}},{key:"tooltipMouseEnter",value:function(){this.isBarPlotTooltipHovered=!0}},{key:"tooltipMouseLeave",value:function(){this.isBarPlotTooltipHovered=!1,this.barPlotTooltipModel=null}},{key:"queryStudy",value:function(e){return L(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.props.gene!=ve&&(n=this.props.gene),this.props.handleStudyLinkout&&this.props.handleStudyLinkout(e,n);case 2:case"end":return t.stop()}}),t,this)})))}},{key:"formatStudyLink",value:function(e){return s.format({pathname:"/"+P._.Study,query:{id:e}})}},{key:"onMouseMove",value:function(e){this.shouldUpdatePosition&&(this.mousePosition.x=e.pageX,this.mousePosition.y=e.pageY)}},{key:"barWidth",value:function(){return 20}},{key:"barSeparation",value:function(){return 8}},{key:"tickFormat",value:function(){return this.props.isPercentage?function(e){return"".concat(e,"%")}:function(e){return e}}},{key:"domainPadding",value:function(){return 20}},{key:"categoryAxisDomainPadding",value:function(){return this.domainPadding()}},{key:"countAxisDomainPadding",value:function(){return this.domainPadding()}},{key:"chartDomainPadding",value:function(){return{y:this.countAxisDomainPadding(),x:this.categoryAxisDomainPadding()}}},{key:"barChartHeight",value:function(){return 400}},{key:"getData",value:function(e){var t=this.convertDataToDownloadData(this.props.data);return(0,v.n5)([[this.props.xAxisString,this.yAxisLabel,"Alteration Type","Alteration Count"]].concat(t))}},{key:"convertDataToDownloadData",value:function(e){for(var t=[],n=e.length,r=e[0].length,o=0;o<r;o++)for(var i=0;i<n;i++)0!=e[i][o].y&&t.push([e[i][o].x,e[i][o].y.toString(),e[i][o].alterationType,e[i][o].alterationCount.toString()]);return t}},{key:"getChart",value:function(){return r.createElement("div",{style:this.overflowStyle,className:"borderedChart"},r.createElement(O.Z,{plotElementWidth:this.plotElementWidth,assignDummyScrollPaneRef:this.assignDummyScrollPaneRef,scrollPane:this.scrollPane},r.createElement("div",{style:{overflowX:"auto",overflowY:"hidden"},className:"hideScrollbar",ref:this.assignScrollPaneRef},r.createElement("svg",{style:{width:this.svgWidth,height:this.svgHeight,pointerEvents:"all"},height:this.svgHeight,width:this.svgWidth,role:"img",viewBox:"0 0 ".concat(this.svgWidth," ").concat(this.svgHeight),ref:this.assignPlotSvgRef,onMouseMove:this.onMouseMove},r.createElement("g",{transform:"translate(".concat(this.leftPadding,", 0)")},r.createElement(g.VictoryChart,{theme:w.Nv,width:this.chartWidth,height:this.barChartHeight(),standalone:!1,domainPadding:this.chartDomainPadding(),singleQuadrantDomainPadding:{y:!0,x:!1}},r.createElement(g.VictoryAxis,{dependentAxis:!0,axisLabelComponent:r.createElement(g.VictoryLabel,{dy:-50}),label:this.yAxisLabel,tickFormat:this.tickFormat,offsetX:50,orientation:"left"}),r.createElement(g.VictoryAxis,{tickValues:this.props.xLabels,style:{ticks:{size:0,strokeWidth:0},tickLabels:{fontSize:0},grid:{stroke:0}}}),r.createElement(g.VictoryStack,{colorScale:this.colorArray},this.barPlots),!this.props.hideGenomicAlterations&&r.createElement(g.VictoryLegend,{x:10,y:this.svgHeight-30,orientation:"horizontal",data:this.legendData}))),r.createElement("g",{transform:"translate(".concat(this.leftPadding,", ").concat(this.scatterPlotTopPadding,")")},r.createElement(g.VictoryChart,{theme:w.Nv,width:this.chartWidth,height:this.scatterChartHeight,standalone:!1,domainPadding:this.chartDomainPadding(),singleQuadrantDomainPadding:{y:!0,x:!1}},r.createElement(g.VictoryAxis,{orientation:"bottom",crossAxis:!1,tickValues:this.props.xLabels,style:{axis:{strokeWidth:0},ticks:{size:0,strokeWidth:0},grid:{stroke:0}},tickLabelComponent:r.createElement(g.VictoryLabel,{angle:50,verticalAnchor:"start",textAnchor:"start"})}),r.createElement(g.VictoryAxis,{orientation:"left",dependentAxis:!0,crossAxis:!1,style:{axis:{strokeWidth:0},ticks:{size:0,strokeWidth:0},grid:{stroke:0}}}),r.createElement(g.VictoryScatter,{size:this.barWidth()/5,style:{data:{fill:"black",cursor:function(e){return e.cursor}}},data:this.scatterData,events:this.scatterPlotMouseEvents})))))),r.createElement(w.t_,{getSvg:this.getSvg,getData:this.getData,filename:"cancer_types_summary",dontFade:!0,type:"button",buttons:["SVG","PNG","PDF","Data"],style:{position:"absolute",top:10,right:10}}))}},{key:"render",value:function(){return r.createElement("div",{"data-test":"cancerTypeSummaryChart"},r.createElement(u.Observer,null,this.getChart),this.scatterPlotTooltipComponent,this.barPlotTooltipComponent)}},{key:"scatterPlotTooltipComponent",get:function(){if(this.scatterPlotTooltipModel){var e=this.scatterPlotTooltipModel.datum.profiledCount,t="Not profiled";e>0&&(t="".concat(e," ").concat((0,w._6)("sample",e),"  profiled"));var n=this.mousePosition.x>E.Z.size.width-400?"left":"right";return C.createPortal(r.createElement(f.Popover,{arrowOffsetTop:T.wD,className:b()("cbioportal-frontend","cbioTooltip"),positionLeft:this.mousePosition.x+("left"===n?-T.lw:T.lw),positionTop:this.mousePosition.y-T.wD,style:{transform:"left"===n?"translate(-100%,0%)":void 0,maxWidth:400},placement:n},r.createElement("div",{style:{whiteSpace:"normal"}},t)),document.body)}return null}},{key:"barPlotTooltipComponent",get:function(){var e=this;if(this.barPlotTooltipModel){var t=this.barPlotTooltipModel,n=this.mousePosition.x>E.Z.size.width-400?"left":"right";return C.createPortal(r.createElement(f.Popover,{onMouseLeave:this.tooltipMouseLeave,onMouseEnter:this.tooltipMouseEnter,arrowOffsetTop:T.wD,className:b()("cbioportal-frontend","cbioTooltip"),positionLeft:this.mousePosition.x+("left"===n?-T.lw:T.lw),positionTop:this.mousePosition.y-T.wD,style:{transform:"left"===n?"translate(-100%,0%)":void 0,maxWidth:400},placement:n},r.createElement("div",null,r.createElement(h.If,{condition:this.props.showLinks},r.createElement(h.Then,null,r.createElement("strong",null,r.createElement("a",{href:this.formatStudyLink(t.studyId),target:"_blank"},t.groupName,"Â ",r.createElement("i",{className:"fa fa-external-link",style:{fontWeight:"bold"}})))),r.createElement(h.Else,null,r.createElement("strong",null,"Summary for ",t.groupName))),r.createElement("p",null,"Gene altered in"," ",R(t.alterationData.alteredSampleCount/t.alterationData.profiledSampleTotal),"% of"," ",t.alterationData.profiledSampleTotal," ","cases"),r.createElement("table",{className:"table table-striped"},r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",null,"Alteration"),r.createElement("th",null,"Frequency"))),r.createElement("tbody",null,i().reduce(this.props.alterationTypes,(function(e,n,o){if(o in t.alterationData.alterationTypeCounts&&t.alterationData.alterationTypeCounts[o]>0){var i=t.alterationData.alterationTypeCounts[o];e.push(r.createElement("tr",null,r.createElement("td",null,n),r.createElement("td",null,R(t.alterationData.alterationTypeCounts[o]/t.alterationData.profiledSampleTotal),"% (",i," ",(0,w._6)("case",i),")")))}return e}),[]).reverse())),r.createElement(h.If,{condition:this.props.showLinks},r.createElement("div",{className:"btn btn-primary btn-xs",onClick:function(){e.queryStudy(t.studyId)}},"Query this study",this.props.gene==ve?"":" for ".concat(this.props.gene))))),document.body)}return null}},{key:"svgWidth",get:function(){return this.chartWidth+this.rightPadding+this.leftPadding}},{key:"chartWidth",get:function(){return this.props.xLabels.length*(this.barWidth()+this.barSeparation())+100}},{key:"svgHeight",get:function(){return this.barChartHeight()+this.scatterChartHeight+this.bottomPadding-100}},{key:"rightPadding",get:function(){return Math.max(200,this.legendWidth-this.chartWidth+20)}},{key:"legendWidth",get:function(){var e=this.legendData.map((function(e){return e.name}));return 6*e.join("").length+40*e.length}},{key:"leftPadding",get:function(){return Math.max(50,4*Math.max.apply(Math,A(this.scatterData.map((function(e){return e.y.length})))))}},{key:"bottomPadding",get:function(){return 5*(e=this.props.xLabels,t=e.map((function(e){var t=e.match(/[A-Z]/g)||[],n=e.match(/[a-z]/g)||[],r=e.match(/\s/g)||[],o=e.length-t.length-n.length-r.length;return 2*t.length+1*n.length+2*r.length+1*o})),i().max(t)||0)+40;var e,t}},{key:"colorArray",get:function(){var e=this;return i().map(this.props.alterationTypes,(function(t,n){return e.props.colors[n]}))}},{key:"legendData",get:function(){var e=this;return i().reduce(this.props.alterationTypes,(function(t,n,r){return r in e.props.representedAlterations&&t.push({name:n,symbol:{fill:e.props.colors[r]}}),t}),[]).reverse()}},{key:"yAxisLabel",get:function(){return this.props.isPercentage?"Alteration Frequency":"Absolute Counts"}},{key:"barPlotEvents",get:function(){var e=this;return[{target:"data",eventHandlers:{onMouseEnter:function(){return[{target:"data",mutation:function(t){e.shouldUpdatePosition=!0,t.datum.xKey in e.props.countsByGroup?(e.barPlotTooltipModel=Object.assign(Object.assign({},t),{groupName:t.datum.x,alterationData:e.props.countsByGroup[t.datum.xKey],studyId:t.datum.xKey}),e.barToolTipCounter++):e.barPlotTooltipModel=null}}]},onMouseLeave:function(){return[{target:"data",mutation:function(){e.shouldUpdatePosition=!1,setTimeout((function(){e.isBarPlotTooltipHovered||1!==e.barToolTipCounter||(e.barPlotTooltipModel=null),e.barToolTipCounter--}),100)}}]}}}]}},{key:"scatterPlotMouseEvents",get:function(){var e=this;return[{target:"data",eventHandlers:{onMouseOver:function(){return[{target:"data",mutation:function(t){t.datum&&(e.scatterPlotTooltipModel=t)}}]},onMouseOut:function(){return[{target:"data",mutation:function(){e.scatterPlotTooltipModel=null}}]},onMouseEnter:function(){return[{target:"data",mutation:function(){e.shouldUpdatePosition=!0}}]},onMouseLeave:function(){return[{target:"data",mutation:function(){e.shouldUpdatePosition=!1}}]}}}]}},{key:"overflowStyle",get:function(){return{position:"relative",display:"inline-block",width:this.props.xLabels.length>37?"100%":"auto"}}},{key:"scatterChartHeight",get:function(){var e=i().uniqBy(this.scatterData,(function(e){return e.y})).length;return e>0?e*(this.barWidth()+this.barSeparation())+100:100}},{key:"scatterPlotTopPadding",get:function(){return this.barChartHeight()-100}},{key:"scatterData",get:function(){return i().map(this.props.alterationTypeDataCounts,(function(e){return Object.assign(Object.assign({},e),{symbol:e.profiledCount>0?"plus":"minus"})}))}},{key:"barPlots",get:function(){var e=this;return(this.props.hideGenomicAlterations?[j(this.props.data)]:this.props.data).map((function(t,n){return r.createElement(g.VictoryBar,{style:{data:{width:e.barWidth}},events:e.barPlotEvents,data:t,key:n})}))}}])&&I(n.prototype,o),a&&I(n,a),t}(r.Component);N([c.observable.ref],G.prototype,"barPlotTooltipModel",void 0),N([c.observable.ref],G.prototype,"scatterPlotTooltipModel",void 0),N([c.observable],G.prototype,"barToolTipCounter",void 0),N([c.observable],G.prototype,"isBarPlotTooltipHovered",void 0),N([c.observable],G.prototype,"shouldUpdatePosition",void 0),N([c.observable],G.prototype,"mousePosition",void 0),N([c.observable],G.prototype,"plotElementWidth",void 0),N([S.default],G.prototype,"getSvg",null),N([S.default],G.prototype,"assignScrollPaneRef",null),N([S.default],G.prototype,"assignDummyScrollPaneRef",null),N([S.default],G.prototype,"assignPlotSvgRef",null),N([S.default],G.prototype,"synchronizeScrollPanes",null),N([c.action.bound],G.prototype,"tooltipMouseEnter",null),N([c.action.bound],G.prototype,"tooltipMouseLeave",null),N([c.computed],G.prototype,"scatterPlotTooltipComponent",null),N([c.computed],G.prototype,"barPlotTooltipComponent",null),N([c.action.bound],G.prototype,"onMouseMove",null),N([S.default],G.prototype,"tickFormat",null),N([c.computed],G.prototype,"scatterChartHeight",null),N([c.computed],G.prototype,"scatterPlotTopPadding",null),N([c.computed],G.prototype,"scatterData",null),N([c.computed],G.prototype,"barPlots",null),N([S.default],G.prototype,"getData",null),N([S.default],G.prototype,"convertDataToDownloadData",null),N([S.default],G.prototype,"getChart",null),G=N([u.observer],G);var V=n(22680),F=n(77906);function B(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function U(e){return(U=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function H(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function W(e,t){return(W=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Y(e){return(Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var K=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":Y(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Q={multiple:"Multiple Alterations",protExpressionLow:"Protein Low",protExpressionHigh:"Protein High",mrnaExpressionLow:"mRNA Low",mrnaExpressionHigh:"mRNA High",hetloss:"Shallow Deletion",homdel:"Deep Deletion",gain:"Gain",amp:"Amplification",structuralVariant:"Structural Variant",mutated:"Mutation"},X={protein:"Protein data",expression:"mRNA data",cna:"CNA data",mutation:"Mutation data",structuralVariant:"Structural variant data"},Z={mutated:"#008000",amp:"#ff0000",homdel:"#0000ff",hetloss:"#8fd8d8",gain:"rgb(255,182,193)",structuralVariant:"#8B00C9",mrnaExpressionHigh:"#FF989A",mrnaExpressionLow:"#529AC8",protExpressionHigh:"#FF989A",protExpressionLow:"#E0FFFF",multiple:"#666"},z=[{value:"studyId",label:"Cancer Study"},{value:"cancerType",label:"Cancer Type"},{value:"cancerTypeDetailed",label:"Cancer Type Detailed"}];function $(e,t){return e/t*100}var J=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=function(e,t){return!t||"object"!==Y(t)&&"function"!=typeof t?H(e):t}(this,U(t).call(this,e)),Object.defineProperty(H(n),"inputYAxisEl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(H(n),"inputXAxisEl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(H(n),"totalCasesMinDefaultValue",{enumerable:!0,configurable:!0,writable:!0,value:10}),Object.defineProperty(H(n),"tempAltCasesInputValue",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(H(n),"tempTotalCasesInputValue",{enumerable:!0,configurable:!0,writable:!0,value:n.totalCasesMin}),Object.defineProperty(H(n),"pngAnchor",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(H(n),"pdf",{enumerable:!0,configurable:!0,writable:!0,value:{anchor:"",width:0,height:0}}),Object.defineProperty(H(n),"showControls",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(H(n),"hideGenomicAlterations",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(H(n),"yAxis",{enumerable:!0,configurable:!0,writable:!0,value:"alt-freq"}),Object.defineProperty(H(n),"xAxis",{enumerable:!0,configurable:!0,writable:!0,value:"y-axis"}),Object.defineProperty(H(n),"altCasesValue",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(H(n),"totalCasesValue",{enumerable:!0,configurable:!0,writable:!0,value:n.totalCasesMin}),Object.defineProperty(H(n),"tempTotalCasesValue",{enumerable:!0,configurable:!0,writable:!0,value:n.totalCasesMin}),Object.defineProperty(H(n),"tempAltCasesValue",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(H(n),"viewCountsByCancerSubType",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(H(n),"chartComponent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),(0,c.makeObservable)(H(n)),n.handleYAxisChange=n.handleYAxisChange.bind(H(n)),n.handleXAxisChange=n.handleXAxisChange.bind(H(n)),n.handleGenomicCheckboxChange=n.handleGenomicCheckboxChange.bind(H(n)),n.handleCancerTypeCheckboxChange=n.handleCancerTypeCheckboxChange.bind(H(n)),n.handleAltSliderChange=n.handleAltSliderChange.bind(H(n)),n.handleTotalSliderChange=n.handleTotalSliderChange.bind(H(n)),n.handleAltSliderChangeComplete=n.handleAltSliderChangeComplete.bind(H(n)),n.handleTotalSliderChangeComplete=n.handleTotalSliderChangeComplete.bind(H(n)),n.handleAltInputChange=n.handleAltInputChange.bind(H(n)),n.handleAltInputKeyPress=n.handleAltInputKeyPress.bind(H(n)),n.handleTotalInputChange=n.handleTotalInputChange.bind(H(n)),n.handleTotalInputKeyPress=n.handleTotalInputKeyPress.bind(H(n)),n.setPngAnchor=n.setPngAnchor.bind(H(n)),n}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&W(e,t)}(t,e),n=t,(o=[{key:"componentDidMount",value:function(){this.initializeSliderValue()}},{key:"getYValue",value:function(e,t){return"abs-count"===this.yAxis?e:e/t*100}},{key:"determineSorterAndDirection",value:function(){var e,t,n=this;return"x-axis"===this.xAxis?(e=function(e){return e},t="asc"):(e="abs-count"===this.yAxis?function(e){return n.countsData[e].alteredSampleCount}:function(e){var t=n.countsData[e];return t.alteredSampleCount/t.profiledSampleTotal},t="desc"),{sorter:e,dir:t}}},{key:"transformLabel",value:function(e){return this.props.labelTransformer?this.props.labelTransformer(e):e}},{key:"handleYAxisChange",value:function(e){this.yAxis=e.target.value,this.altCasesValue=0,this.handleAltSliderChange(0)}},{key:"handleXAxisChange",value:function(e){this.xAxis=e.target.value}},{key:"handleCancerTypeCheckboxChange",value:function(){this.viewCountsByCancerSubType=!1===this.viewCountsByCancerSubType}},{key:"handleGenomicCheckboxChange",value:function(){this.hideGenomicAlterations=!this.hideGenomicAlterations}},{key:"handleAltSliderChange",value:function(e){this.tempAltCasesValue=e,this.tempAltCasesInputValue=e}},{key:"handleTotalSliderChange",value:function(e){this.tempTotalCasesValue=e,this.tempTotalCasesInputValue=e}},{key:"handleAltInputKeyPress",value:function(e){if(13===e.charCode){if(isNaN(this.tempAltCasesInputValue))return void(this.tempAltCasesInputValue=0);this.tempAltCasesInputValue=Number(this.tempAltCasesInputValue),this.tempAltCasesValue=this.tempAltCasesInputValue,this.handleAltSliderChangeComplete()}}},{key:"handleTotalInputKeyPress",value:function(e){13===e.charCode&&(isNaN(this.tempTotalCasesInputValue)?this.tempTotalCasesInputValue=this.totalCasesMin:this.tempTotalCasesInputValue>this.totalCasesMax?(this.tempTotalCasesInputValue=this.totalCasesMax,this.tempTotalCasesValue=this.totalCasesMax):(this.tempTotalCasesInputValue=Number(this.tempTotalCasesInputValue),this.tempTotalCasesValue=this.tempTotalCasesInputValue),this.handleTotalSliderChangeComplete())}},{key:"handleAltInputChange",value:function(e){this.tempAltCasesInputValue=e.target.value.replace(/[^0-9\.]/g,"")}},{key:"handleTotalInputChange",value:function(e){this.tempTotalCasesInputValue=e.target.value.replace(/[^0-9\.]/g,"")}},{key:"handleAltSliderChangeComplete",value:function(){this.altCasesValue=this.tempAltCasesValue}},{key:"handleTotalSliderChangeComplete",value:function(){this.totalCasesValue=this.tempTotalCasesValue}},{key:"initializeSliderValue",value:function(){this.tempAltCasesValue=0,this.tempAltCasesInputValue=0,this.altCasesValue=0,this.tempTotalCasesValue=this.totalCasesMin,this.tempTotalCasesInputValue=this.totalCasesMin,this.totalCasesValue=this.totalCasesMin}},{key:"setPngAnchor",value:function(e){this.pngAnchor=e}},{key:"render",value:function(){var e=this;return this.alterationTypeDataCounts.length?r.createElement(V.z,{offset:60},r.createElement(h.If,{condition:this.hasAlterations},r.createElement(h.Then,null,r.createElement("div",{"data-test":"cancerTypesSummaryDiv"},r.createElement("div",{className:"cancer-summary--main-options"},r.createElement(f.ButtonGroup,null,z.map((function(t,n){return r.createElement(f.Radio,{checked:t.value===e.props.groupAlterationsBy,onChange:function(t){e.initializeSliderValue(),e.props.handlePivotChange(F(t.target).attr("data-value"))},inline:!0,"data-value":t.value},t.label)})))),r.createElement("div",{className:b()("inlineBlock",{hidden:!this.showControls},"cancer-summary-secondary-options")},this.controls),r.createElement("div",{className:b()("alert","alert-success",{hidden:!this.totalCaseChanged&&!this.altCaseChanged})},r.createElement("span",{style:{verticalAlign:"middle"}},"".concat(this.chartData.labels.length," of ").concat(this.groupKeysSorted.length," categories (").concat(i().keyBy(z,"value")[this.props.groupAlterationsBy].label,") are shown based on filtering."))),r.createElement(G,{gene:this.props.gene,key:Date.now(),data:this.chartData.data,alterationTypeDataCounts:this.chartData.alterationTypeDataCounts,ref:function(t){return e.chartComponent=t},countsByGroup:this.countsData,representedAlterations:this.chartData.representedAlterations,alterationTypes:Q,isPercentage:"alt-freq"===this.yAxis,showLinks:this.showStudyTooltipLinks,colors:Z,hideGenomicAlterations:this.hideGenomicAlterations,xLabels:this.chartData.labels,xAxisString:(z.find((function(t){return t.value==e.props.groupAlterationsBy}))||{}).label||"Cancer",handleStudyLinkout:this.props.handleStudyLinkout}))),r.createElement(h.Else,null,r.createElement("div",{className:"alert alert-info"},"There are no alterations in this gene.")))):r.createElement("div",{className:"alert alert-info"},"No data to plot.")}},{key:"countsData",get:function(){return this.props.groupedAlterationData}},{key:"groupKeysSorted",get:function(){var e=this.determineSorterAndDirection(),t=e.dir,n=e.sorter;return i().chain(this.countsData).keys().orderBy(n,[t]).value()}},{key:"alterationTypeDataCounts",get:function(){var e=this,t=[];return i().forEach(this.groupKeysSorted,(function(n){var r,o=e.countsData[n],a=i().chain(o.profiledSamplesCounts).values().sum().value(),l=$(o.alteredSampleCount,o.profiledSampleTotal);r="abs-count"===e.yAxis?o.alteredSampleCount>=e.tempAltCasesValue:l>=e.tempAltCasesValue;var s=o.profiledSampleTotal>=e.totalCasesValue;a>0&&r&&s&&i().forEach(i().keys(X),(function(r){var i=o.profiledSamplesCounts[r],a=o.notProfiledSamplesCounts[r];i+a>0&&t.push({x:e.props.labelTransformer?e.props.labelTransformer(n):n,y:X[r],profiledCount:i,notProfiledCount:a})}))})),t}},{key:"chartData",get:function(){var e=this,t={},n=0,r=0,o=0,a=[],l=i().map(Q,(function(l,s){return i().reduce(e.groupKeysSorted,(function(l,u){var c,p=e.countsData[u],d=i().chain(p.profiledSamplesCounts).values().sum().value(),f=$(p.alteredSampleCount,p.profiledSampleTotal);c="abs-count"===e.yAxis?p.alteredSampleCount>=e.tempAltCasesValue:f>=e.tempAltCasesValue;var m=p.profiledSampleTotal>=e.totalCasesValue;if(d>0&&c&&m){var h=e.props.labelTransformer?e.props.labelTransformer(u):u;a.push(h),n=f>n?f:n,r=p.alteredSampleCount>r?p.alteredSampleCount:r,o=p.profiledSampleTotal>o?p.profiledSampleTotal:o;var y=p.alterationTypeCounts[s];y>0&&(t[s]=!0),l.push({alterationType:s,alterationCount:y,x:h,xKey:u,y:e.getYValue(y,p.profiledSampleTotal)})}return l}),[])}));return{labels:i().uniq(a),data:l,alterationTypeDataCounts:this.alterationTypeDataCounts,representedAlterations:t,maxPercentage:n,maxAbsoluteCount:r,maxSampleCount:o}}},{key:"altCasesMax",get:function(){return"abs-count"===this.yAxis?this.chartData.maxAbsoluteCount:this.chartData.maxPercentage}},{key:"totalCasesMax",get:function(){return this.chartData.maxSampleCount}},{key:"totalCasesMin",get:function(){return this.totalCasesMax>10?this.totalCasesMinDefaultValue:0}},{key:"hasAlterations",get:function(){return i().reduce(this.countsData,(function(e,t){return e+t.alterationTotal}),0)>0}},{key:"totalCaseChanged",get:function(){return this.totalCasesValue>0}},{key:"altCaseChanged",get:function(){return this.altCasesValue>0}},{key:"showStudyTooltipLinks",get:function(){return"studyId"===this.props.groupAlterationsBy&&this.chartData.labels.length>1}},{key:"controls",get:function(){var e=this,t="alt-freq"===this.yAxis?"%":"";return r.createElement("div",{className:"cancer-summary--form-controls"},r.createElement("table",null,r.createElement("tr",null,r.createElement("td",null,r.createElement(f.ControlLabel,null,"Y-Axis Value:")),r.createElement("td",{className:"dashed-border-right"},r.createElement(f.FormControl,{componentClass:"select","data-test":"cancerSummaryYAxisSelect",onChange:this.handleYAxisChange,ref:function(t){return e.inputYAxisEl=t}},r.createElement("option",{value:"alt-freq"},"Alteration Frequency"),r.createElement("option",{value:"abs-count"},"Absolute Counts"))),r.createElement("td",null,r.createElement(f.ControlLabel,null,"Min. # Total Cases:")),r.createElement("td",null,r.createElement("div",{className:"slider-holder"},r.createElement("div",{className:"slider custom-labels"},r.createElement(m.default,{min:0,max:this.totalCasesMax,value:this.tempTotalCasesValue,labels:B({0:0},this.totalCasesMax,this.totalCasesMax),onChange:this.handleTotalSliderChange,onChangeComplete:this.handleTotalSliderChangeComplete})))),r.createElement("td",{className:b()(this.totalCaseChanged?"highlightInput":"","dashed-border-right","slider-input")},r.createElement(f.FormControl,{type:"text",value:this.tempTotalCasesInputValue,"data-test":"sampleTotalThresholdInput",onChange:this.handleTotalInputChange,onKeyPress:this.handleTotalInputKeyPress})),r.createElement("td",null,r.createElement(f.Checkbox,{checked:!this.hideGenomicAlterations,onChange:this.handleGenomicCheckboxChange},"Show Genomic Alteration Types"))),r.createElement("tr",null,r.createElement("td",null,r.createElement(f.ControlLabel,null,"Sort X-Axis By:")),r.createElement("td",{className:"dashed-border-right"},r.createElement(f.FormControl,{componentClass:"select","data-test":"cancerSummaryXAxisSelect",onChange:this.handleXAxisChange,ref:function(t){return e.inputXAxisEl=t}},r.createElement("option",{value:"y-axis"},"Y-Axis Values"),r.createElement("option",{value:"x-axis"},"Alphabetically"))),r.createElement("td",null,r.createElement(f.ControlLabel,null,"Min. ".concat("alt-freq"===this.yAxis?"%":"#"," Altered Cases:"))),r.createElement("td",null,r.createElement("div",{className:"slider-holder"},r.createElement("div",{className:"slider custom-labels"},r.createElement(m.default,{min:0,max:this.altCasesMax,value:this.tempAltCasesValue,labels:B({0:0+t},this.altCasesMax,Math.ceil(this.altCasesMax)+t),format:function(e){return e+t},onChange:this.handleAltSliderChange,onChangeComplete:this.handleAltSliderChangeComplete})))),r.createElement("td",{className:b()(this.altCaseChanged?"highlightInput":"","dashed-border-right","slider-input")},r.createElement(f.FormControl,{type:"text",value:this.tempAltCasesInputValue+t,onChange:this.handleAltInputChange,"data-test":"alterationThresholdInput",onKeyPress:this.handleAltInputKeyPress})))))}}])&&q(n.prototype,o),a&&q(n,a),t}(r.Component);K([c.observable],J.prototype,"tempAltCasesInputValue",void 0),K([c.observable],J.prototype,"tempTotalCasesInputValue",void 0),K([c.observable],J.prototype,"pngAnchor",void 0),K([c.observable],J.prototype,"pdf",void 0),K([c.observable],J.prototype,"showControls",void 0),K([c.observable],J.prototype,"hideGenomicAlterations",void 0),K([c.observable],J.prototype,"yAxis",void 0),K([c.observable],J.prototype,"xAxis",void 0),K([c.observable],J.prototype,"altCasesValue",void 0),K([c.observable],J.prototype,"totalCasesValue",void 0),K([c.observable],J.prototype,"tempTotalCasesValue",void 0),K([c.observable],J.prototype,"tempAltCasesValue",void 0),K([c.observable],J.prototype,"viewCountsByCancerSubType",void 0),K([c.computed],J.prototype,"alterationTypeDataCounts",null),K([c.computed],J.prototype,"chartData",null),K([c.computed],J.prototype,"altCasesMax",null),K([c.computed],J.prototype,"totalCasesMax",null),K([c.computed],J.prototype,"totalCasesMin",null),K([c.computed],J.prototype,"hasAlterations",null),K([c.computed],J.prototype,"totalCaseChanged",null),K([c.computed],J.prototype,"altCaseChanged",null),K([c.computed],J.prototype,"showStudyTooltipLinks",null),K([c.action],J.prototype,"handleTotalInputKeyPress",null),K([c.action],J.prototype,"initializeSliderValue",null),K([c.computed],J.prototype,"controls",null),J=K([u.observer],J);var ee=n(36903),te=n(85157);function ne(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function re(e,t,n,r,o){return i().mapValues(e,(function(e,a){var l={mutated:0,amp:0,homdel:0,hetloss:0,gain:0,structuralVariant:0,mrnaExpressionHigh:0,mrnaExpressionLow:0,protExpressionHigh:0,protExpressionLow:0,multiple:0},s={mutation:0,cna:0,expression:0,protein:0,structuralVariant:0},u={mutation:0,cna:0,expression:0,protein:0,structuralVariant:0},c={profiledSampleTotal:0,alterationTotal:0,alterationTypeCounts:l,alteredSampleCount:0,parentCancerType:e[0].cancerType,profiledSamplesCounts:s,notProfiledSamplesCounts:u};return i().forEach(e,(function(e){var a=!1;if(i().forEach(n,(function(t,n){var l=i().some((0,te.n0)(e.uniqueSampleKey,i().map(t,(function(e){return e.molecularProfileId})),r,o));switch(a=a||l,n){case p.YK.COPY_NUMBER_ALTERATION:l?s.cna++:u.cna++;break;case p.YK.MRNA_EXPRESSION:l?s.expression++:u.expression++;break;case p.YK.PROTEIN_LEVEL:l?s.protein++:u.protein++;break;case p.YK.MUTATION_EXTENDED:l?s.mutation++:u.mutation++;break;case p.YK.STRUCTURAL_VARIANT:l?s.structuralVariant++:u.structuralVariant++}})),a&&(c.profiledSampleTotal+=1),e.uniqueSampleKey in t){var d=t[e.uniqueSampleKey],f=i().uniqBy(d,(function(e){return e.alterationType}));c.alterationTotal+=f.length,f.length>0&&(c.alteredSampleCount+=1),f.length>1?l.multiple++:i().forEach(f,(function(e){switch(e.alterationType){case p.YK.COPY_NUMBER_ALTERATION:l[e.alterationSubType]++;break;case p.YK.MRNA_EXPRESSION:"high"===e.alterationSubType&&l.mrnaExpressionHigh++,"low"===e.alterationSubType&&l.mrnaExpressionLow++;break;case p.YK.PROTEIN_LEVEL:"high"===e.alterationSubType&&l.protExpressionHigh++,"low"===e.alterationSubType&&l.protExpressionLow++;break;case p.YK.MUTATION_EXTENDED:l.mutated++;break;case p.YK.STRUCTURAL_VARIANT:l.structuralVariant++}}))}})),c}))}var oe=n(50558),ie=n(41940),ae=n(71198),le=n(41359),se=n(62524),ue=n(79431),ce=n(71780);function pe(){return(pe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function de(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function me(e){return(me=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function he(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ye(e,t){return(ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function be(e){return(be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ge=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":be(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},ve="all",Se=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=function(e,t){return!t||"object"!==be(t)&&"function"!=typeof t?he(e):t}(this,me(t).call(this,e)),Object.defineProperty(he(n),"activeTab",{enumerable:!0,configurable:!0,writable:!0,value:ve}),Object.defineProperty(he(n),"resultsViewPageWidth",{enumerable:!0,configurable:!0,writable:!0,value:1150}),Object.defineProperty(he(n),"groupAlterationsBy_userSelection",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(he(n),"resultsViewPageContent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),(0,c.makeObservable)(he(n)),n.handleTabClick=n.handleTabClick.bind(he(n)),n.pivotData=n.pivotData.bind(he(n)),n.mapStudyIdToName=n.mapStudyIdToName.bind(he(n)),n}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ye(e,t)}(t,e),n=t,(o=[{key:"handleTabClick",value:function(e){this.activeTab=e}},{key:"pivotData",value:function(e){this.groupAlterationsBy_userSelection=e}},{key:"mapStudyIdToName",value:function(e){return e in this.props.store.physicalStudySet?(0,ce.C8)(this.props.store.physicalStudySet[e].name):e}},{key:"handleStudyLinkout",value:function(e,t){var n,r=Object.assign({},this.props.store.urlWrapper.query,(de(n={},le.O.cancer_study_list,e),de(n,le.O.gene_list,t||this.props.store.urlWrapper.query.gene_list),n));window.open((0,se.gN)("/results")).clientPostedData=r}},{key:"render",value:function(){var e=this;switch((0,ie.CX)(this.props.store.filteredSamplesExtendedWithClinicalData,this.props.store.oqlFilteredAlterationsByGeneBySampleKey,this.props.store.studies,this.props.store.filteredSequencedSampleKeysByGene,this.props.store.selectedMolecularProfileIdsByAlterationType,this.props.store.coverageInformation)){case"pending":return r.createElement(ee.Z,{isLoading:!0,center:!0,size:"big"});case"error":return null;case"complete":return r.createElement("div",{ref:function(t){return e.resultsViewPageContent=t},"data-test":"cancerTypeSummaryWrapper"},r.createElement("div",{className:"tabMessageContainer"},r.createElement(oe.Z,{className:"cancer-types-summary-oql-status-banner",store:this.props.store,tabReflectsOql:!0}),r.createElement(ae.Z,{store:this.props.store}),r.createElement(ue.Z,{store:this.props.store})),r.createElement(d.Kh,{onTabClick:this.handleTabClick,unmountOnHide:!0,arrowStyle:{"line-height":.8},tabButtonStyle:"pills",activeTabId:this.activeTab,className:"pillTabs"},this.tabs))}}},{key:"defaultTabId",get:function(){return ve}},{key:"groupAlterationsBy",get:function(){return void 0===this.groupAlterationsBy_userSelection?this.props.store.studies.result.length>1?"studyId":1===i().chain(this.props.store.filteredSamplesExtendedWithClinicalData.result).map((function(e){return e.cancerType})).uniq().value().length?"cancerTypeDetailed":"cancerType":this.groupAlterationsBy_userSelection}},{key:"tabs",get:function(){var e,t,n,o,a,l=this,s="studyId"===this.groupAlterationsBy?this.mapStudyIdToName:void 0,u=(e=this.props.store.oqlFilteredAlterationsByGeneBySampleKey.result,t=this.props.store.filteredSamplesExtendedWithClinicalData.result,n=this.groupAlterationsBy,o=this.props.store.selectedMolecularProfileIdsByAlterationType.result,a=this.props.store.coverageInformation.result,i().mapValues(e,(function(e,r){return re(i().groupBy(t,(function(e){return e[n]})),e,o,a,r)}))),c=i().map(this.props.store.genes.result,(function(e){var t=u[e.hugoGeneSymbol],n=0===i().reduce(t,(function(e,t){return e+t.alterationTotal}),0)?{color:"#bbb"}:void 0;return r.createElement(d.l6,pe({key:e.hugoGeneSymbol,id:"summaryTab"+e.hugoGeneSymbol,linkText:e.hugoGeneSymbol},{anchorStyle:n}),r.createElement(J,{groupedAlterationData:u[e.hugoGeneSymbol],handleStudyLinkout:l.handleStudyLinkout,groupAlterationsBy:l.groupAlterationsBy,gene:e.hugoGeneSymbol,labelTransformer:s,handlePivotChange:l.pivotData,width:l.resultsViewPageWidth}))}));if(c.length>1){var p=function(e,t,n,r,o){var a=i().groupBy(t,(function(e){return e[n]})),l=i().flatMap(e,(function(e){return e}));return re(a,i().mergeWith.apply(i(),[{}].concat(ne(l),[function(e,t){if(i().isArray(e))return e.concat(t)}])),r,o)}(this.props.store.oqlFilteredAlterationsByGeneBySampleKey.result,this.props.store.filteredSamplesExtendedWithClinicalData.result,this.groupAlterationsBy,this.props.store.selectedMolecularProfileIdsByAlterationType.result,this.props.store.coverageInformation.result);c.unshift(r.createElement(d.l6,{key:ve,id:"allGenes",linkText:"All Queried Genes"},r.createElement(J,{gene:ve,width:this.resultsViewPageWidth,groupedAlterationData:p,handlePivotChange:this.pivotData,labelTransformer:s,groupAlterationsBy:this.groupAlterationsBy,handleStudyLinkout:this.handleStudyLinkout})))}return c}}])&&fe(n.prototype,o),a&&fe(n,a),t}(r.Component);ge([c.observable],Se.prototype,"activeTab",void 0),ge([c.observable],Se.prototype,"resultsViewPageWidth",void 0),ge([c.observable],Se.prototype,"groupAlterationsBy_userSelection",void 0),ge([c.computed],Se.prototype,"tabs",null),ge([S.default],Se.prototype,"handleStudyLinkout",null);const Ce=Se=ge([u.observer],Se);var Ee=n(19483),we=n(54615),Te=n(79054),Pe=n(75508);function Oe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ke(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ae(e,t,n){return t&&ke(e.prototype,t),n&&ke(e,n),e}function Ie(e,t){return!t||"object"!==Ne(t)&&"function"!=typeof t?_e(e):t}function _e(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function De(e){return(De=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xe(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Me(e,t)}function Me(e,t){return(Me=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ne(e){return(Ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Le=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":Ne(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Re=function(e){function t(){return Oe(this,t),Ie(this,De(t).apply(this,arguments))}return xe(t,e),Ae(t,[{key:"render",value:function(){return r.createElement("span",{onClick:this.props.onClickFilter,style:{color:this.props.isActive?"#0000ff":Pe.LN,display:"inline-block",cursor:"pointer",visibility:"hidden",marginLeft:5,marginTop:-1}},r.createElement("i",{className:"fa fa-filter"}))}}]),t}(r.Component),je=function(e){function t(){var e;return Oe(this,t),e=Ie(this,De(t).apply(this,arguments)),Object.defineProperty(_e(e),"pullRight",{enumerable:!0,configurable:!0,writable:!0,value:!1}),e}return xe(t,e),Ae(t,[{key:"componentDidUpdate",value:function(){var e=document.getElementById(this.props.id).getBoundingClientRect();e.right>window.innerWidth&&(this.pullRight=!0);var t=0,n=window.innerHeight;e.bottom>n&&(t=e.bottom-n+15),window.scroll(window.scrollX,window.scrollY+t)}},{key:"render",value:function(){return r.createElement("div",{id:this.props.id,className:b()("dropdown-menu",this.pullRight?"pull-right":"pull-left"),style:{transform:this.pullRight?"translateX(10px)":"translateX(-5px)",visibility:this.props.isOpen?"visible":"hidden"}},r.createElement("div",{style:{margin:"6px",marginBottom:"0px"}},this.props.id,r.createElement("div",{style:{marginTop:"10px"}},this.props.menuComponent),r.createElement("button",{className:"btn btn-default btn-xs",onClick:this.props.onClickRemove,disabled:!this.props.isActive,style:{marginTop:"10px",float:"right"}},"Remove filter")))}}]),t}(r.Component);Le([c.observable],je.prototype,"pullRight",void 0);var Ge=function(e){function t(e){var n;return Oe(this,t),n=Ie(this,De(t).call(this,e)),Object.defineProperty(_e(n),"isOpen",{enumerable:!0,configurable:!0,writable:!0,value:!1}),(0,c.makeObservable)(_e(n)),n}return xe(t,e),Ae(t,[{key:"hide",value:function(){this.isOpen=!1}},{key:"onClickRemove",value:function(){this.isOpen=!1,this.props.deactivateFilter()}},{key:"onClickFilter",value:function(){this.isOpen=!this.isOpen,this.props.filterIsActive||this.props.setupFilter()}},{key:"render",value:function(){return r.createElement(Te.zx,{onRootClose:this.hide},r.createElement(f.Dropdown,{id:this.props.id+" filterIconModal",open:this.isOpen},r.createElement(Re,{bsRole:"toggle",isActive:this.props.filterIsActive,onClickFilter:this.onClickFilter}),r.createElement(je,{bsRole:"menu",id:this.props.id,isOpen:this.isOpen,isActive:this.props.filterIsActive,onClickRemove:this.onClickRemove,menuComponent:this.props.menuComponent})))}}]),t}(r.Component);Le([c.observable],Ge.prototype,"isOpen",void 0),Le([c.action.bound],Ge.prototype,"hide",null),Le([c.action.bound],Ge.prototype,"onClickRemove",null),Le([c.action.bound],Ge.prototype,"onClickFilter",null);const Ve=Ge=Le([u.observer],Ge);var Fe=n(66072);function Be(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qe(e){return(qe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ue(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function He(e,t){return(He=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function We(e){return(We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Ye=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":We(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Ke="135px",Qe=Math.pow(10,10),Xe=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=function(e,t){return!t||"object"!==We(t)&&"function"!=typeof t?Ue(e):t}(this,qe(t).call(this,e)),Object.defineProperty(Ue(n),"justReleasedHandle",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),(0,c.makeObservable)(Ue(n)),n.justReleasedHandle=!1,n.state={lowerValue:n.props.lowerValue||n.min,upperValue:n.props.upperValue||n.max},n}var n,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&He(e,t)}(t,e),n=t,(o=[{key:"componentDidMount",value:function(){this.syncValues(!0),this.syncValues(!1)}},{key:"componentDidUpdate",value:function(e){e!==this.props?this.setState({lowerValue:this.props.lowerValue||this.min,upperValue:this.props.upperValue||this.max}):(this.syncValues(!0),this.syncValues(!1))}},{key:"syncValues",value:function(e,t){if(e){this.LH.value=""+this.state.lowerValue,this.LB.value=""+this.state.lowerValue;var n=(this.state.lowerValue-this.min)/(this.max-this.min);this.MID.style.left=100*n+"%",t&&this.props.callbackLowerValue(this.state.lowerValue)}else{this.UH.value=""+this.state.upperValue,this.UB.value=""+this.state.upperValue;var r=(this.max-this.state.upperValue)/(this.max-this.min);this.MID.style.right=100*r+"%",t&&this.props.callbackUpperValue(this.state.upperValue)}this.updateInputBoxWidth(e)}},{key:"updateInputBoxWidth",value:function(e){e?this.LB.style.width=7*(this.LB.value.length+3)+"px":this.UB.style.width=7*(this.UB.value.length+3)+"px"}},{key:"onChangeInputBox",value:function(e,t,n,r,o,i){return(0,Fe._)((function(a){!a||n(+a)?o(e):r(+a)?o(t):isNaN(+a)?i():o(+a)}),300)}},{key:"onChangeSlider",value:function(e,t,n){var r=this;return function(o){if(r.justReleasedHandle)r.justReleasedHandle=!1,r.syncValues(e);else{var i=e?r.state.upperValue:r.state.lowerValue,a=t(+o.target.value)?i:+o.target.value;n(a)}}}},{key:"render",value:function(){var e=this;return r.createElement("div",{style:{width:Ke,margin:"auto",display:"flex",flexDirection:"column"}},r.createElement("div",{className:"slider"},r.createElement("div",{className:"mainTrack"}),r.createElement("div",{id:this.MIDId,className:"middleTrack"}),r.createElement("input",{type:"range",id:this.LHId,className:"handle",min:this.min,max:this.max,step:this.defaultStepSize,defaultValue:""+this.state.lowerValue,onMouseUp:function(t){e.justReleasedHandle=!0,e.setState({lowerValue:+t.target.value},(function(){return e.syncValues(!0,!0)}))},onChange:this.onChangeSlider(!0,(function(t){return t>e.state.upperValue}),(function(t){return e.setState({lowerValue:t},(function(){return e.syncValues(!0)}))}))}),r.createElement("input",{type:"range",id:this.UHId,className:"handle",min:this.min,max:this.max,step:this.defaultStepSize,defaultValue:""+this.state.upperValue,onMouseUp:function(t){e.justReleasedHandle=!0,e.setState({upperValue:+t.target.value},(function(){return e.syncValues(!1,!0)}))},onChange:this.onChangeSlider(!1,(function(t){return t<e.state.lowerValue}),(function(t){return e.setState({upperValue:t},(function(){return e.syncValues(!1)}))}))})),r.createElement("div",{style:{marginTop:"13px"}},r.createElement("input",{id:this.LBId,className:"form-control input-sm",style:{float:"left",maxWidth:Ke},defaultValue:""+this.state.lowerValue,onChange:this.onChangeInputBox(this.min,this.state.upperValue,(function(t){return t<e.min}),(function(t){return t>e.state.upperValue}),(function(t){return e.setState({lowerValue:t},(function(){return e.syncValues(!0,!0)}))}),(function(){return e.syncValues(!0)})),onInput:function(){return e.updateInputBoxWidth(!0)}}),r.createElement("input",{id:this.UBId,className:"form-control input-sm",style:{float:"right",maxWidth:Ke},defaultValue:""+this.state.upperValue,onChange:this.onChangeInputBox(this.max,this.state.lowerValue,(function(t){return t>e.max}),(function(t){return t<e.state.lowerValue}),(function(t){return e.setState({upperValue:t},(function(){return e.syncValues(!1,!0)}))}),(function(){return e.syncValues(!1)})),onInput:function(){return e.updateInputBoxWidth(!1)}})))}},{key:"min",get:function(){var e=+(+this.props.min).toFixed(11);return Math.floor(Qe*e)/Qe}},{key:"max",get:function(){var e=+(+this.props.max).toFixed(11);return Math.ceil(Qe*e)/Qe}},{key:"id",get:function(){return this.props.id.replace(/\s+/,"_")}},{key:"LHId",get:function(){return this.id+"-lowerValue-handle"}},{key:"UHId",get:function(){return this.id+"-upperValue-handle"}},{key:"LBId",get:function(){return this.id+"-lowerValue-box"}},{key:"UBId",get:function(){return this.id+"-upperValue-box"}},{key:"MIDId",get:function(){return this.id+"-middleTrack"}},{key:"LH",get:function(){return document.getElementById(this.LHId)}},{key:"UH",get:function(){return document.getElementById(this.UHId)}},{key:"LB",get:function(){return document.getElementById(this.LBId)}},{key:"UB",get:function(){return document.getElementById(this.UBId)}},{key:"MID",get:function(){for(var e=document.getElementsByClassName("middleTrack"),t=0;t<e.length;t++)if(e[t].id===this.MIDId)return e[t];return e[0]}},{key:"defaultStepSize",get:function(){var e=this.props.min,t=this.props.max;return"string"==typeof e&&e.includes(".")||"string"==typeof t&&t.includes(".")?(this.max-this.min)/100:1}}])&&Be(n.prototype,o),i&&Be(n,i),t}(r.Component);function Ze(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ze(e){return(ze=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $e(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Je(e,t){return(Je=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function et(e){return(et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Ye([c.computed],Xe.prototype,"min",null),Ye([c.computed],Xe.prototype,"max",null),Ye([c.computed],Xe.prototype,"id",null),Ye([c.computed],Xe.prototype,"defaultStepSize",null),Ye([c.action],Xe.prototype,"onChangeInputBox",null),Ye([c.action],Xe.prototype,"onChangeSlider",null);var tt=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":et(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},nt=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=function(e,t){return!t||"object"!==et(t)&&"function"!=typeof t?$e(e):t}(this,ze(t).call(this,e)),Object.defineProperty($e(n),"filterString",{enumerable:!0,configurable:!0,writable:!0,value:""}),(0,c.makeObservable)($e(n)),n}var n,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Je(e,t)}(t,e),n=t,(o=[{key:"componentDidUpdate",value:function(){this.props.emptyFilterString&&(this.filterString="")}},{key:"onChangeFilterCondition",value:function(e){var t=e.target.value;this.props.updateFilterCondition(t)}},{key:"onChangeFilterString",value:function(e){var t=this,n=e.target.value;this.filterString=n,window.setTimeout((function(){t.props.updateFilterString(n)}),400)}},{key:"selectAll",value:function(){var e=this,t=new Set;this.props.allSelections.forEach((function(n){e.props.currSelections.has(n)||t.add(n)})),this.props.toggleSelections(t),this.forceUpdate()}},{key:"deselectAll",value:function(){var e=this,t=new Set;this.props.allSelections.forEach((function(n){e.props.currSelections.has(n)&&t.add(n)})),this.props.toggleSelections(t),this.forceUpdate()}},{key:"onChangeSelection",value:function(e){var t=e.currentTarget.getAttribute("data-id");void 0!==t&&(this.props.toggleSelections(new Set([t])),this.forceUpdate())}},{key:"render",value:function(){return r.createElement("div",{style:{margin:"auto",display:"flex",flexDirection:"column"}},r.createElement("div",{style:{display:"flex"}},this.filterConditionDropdown,this.filterStringInputBox),r.createElement("div",{style:{marginTop:10}},this.selectDeselectAllButtons),r.createElement("div",{style:{marginTop:10,paddingLeft:10,maxHeight:250,maxWidth:320,overflow:"auto",whiteSpace:"nowrap"}},this.selectionCheckboxes))}},{key:"filterConditionDropdown",get:function(){return r.createElement("select",{className:"form-control input-sm",onChange:this.onChangeFilterCondition,style:{width:"160px"}},r.createElement("option",{value:"contains"},"Contains"),r.createElement("option",{value:"doesNotContain"},"Does Not Contain"),r.createElement("option",{value:"equals"},"Equals"),r.createElement("option",{value:"doesNotEqual"},"Does Not Equal"),r.createElement("option",{value:"beginsWith"},"Begins With"),r.createElement("option",{value:"doesNotBeginWith"},"Does Not Begin With"),r.createElement("option",{value:"endsWith"},"Ends With"),r.createElement("option",{value:"doesNotEndWith"},"Does Not End With"),r.createElement("option",{value:"regex"},"Regular Expression"))}},{key:"filterStringInputBox",get:function(){return r.createElement("input",{className:"form-control input-sm",value:this.filterString,onChange:this.onChangeFilterString,style:{width:"160px"},"data-test":"categorical-filter-menu-search-input"})}},{key:"selectDeselectAllButtons",get:function(){var e=this.props.currSelections.size!==this.props.allSelections.size,t=0!==this.props.currSelections.size;return r.createElement("div",{style:{display:"flex",alignItems:"baseline"}},e&&r.createElement("button",{className:"btn btn-default btn-xs",onClick:this.selectAll},"Select all (".concat(this.props.allSelections.size,")")),t&&r.createElement("button",{className:"btn btn-default btn-xs",onClick:this.deselectAll},"Deselect all"))}},{key:"sortedSelections",get:function(){return Array.from(this.props.allSelections).sort()}},{key:"selectionCheckboxes",get:function(){var e=this;return this.sortedSelections.map((function(t){return r.createElement(f.Checkbox,{"data-id":t,onChange:e.onChangeSelection,checked:e.props.currSelections.has(t)},r.createElement(w.Ld,{maxLength:37,text:t,tooltip:r.createElement("div",{style:{maxWidth:300}},t)}))}))}}])&&Ze(n.prototype,o),i&&Ze(n,i),t}(r.Component);tt([c.observable],nt.prototype,"filterString",void 0),tt([c.action.bound],nt.prototype,"onChangeFilterCondition",null),tt([c.computed],nt.prototype,"filterConditionDropdown",null),tt([c.action.bound],nt.prototype,"onChangeFilterString",null),tt([c.computed],nt.prototype,"filterStringInputBox",null),tt([c.action.bound],nt.prototype,"selectAll",null),tt([c.action.bound],nt.prototype,"deselectAll",null),tt([c.computed],nt.prototype,"selectDeselectAllButtons",null),tt([c.action.bound],nt.prototype,"onChangeSelection",null),tt([c.computed],nt.prototype,"sortedSelections",null),tt([c.computed],nt.prototype,"selectionCheckboxes",null);const rt=nt=tt([u.observer],nt);var ot=n(65463),it=n.n(ot),at=n(28775),lt=n(22157);function st(){return(st=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ut(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ct(e){return(ct=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dt(e,t){return(dt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ft(e){return(ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var mt=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":ft(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};function ht(e){return e.description?r.createElement("span",null,e.title,r.createElement(w.ZD,{placement:"right",overlay:r.createElement("span",null,e.description)},r.createElement("i",{className:"fa fa-info-circle",style:{marginLeft:"0.2rem"}}))):e.title}var yt=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=function(e,t){return!t||"object"!==ft(t)&&"function"!=typeof t?pt(e):t}(this,ct(t).call(this,e)),(0,c.makeObservable)(pt(n)),n}var n,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dt(e,t)}(t,e),n=t,(o=[{key:"render",value:function(){return void 0===this.props.germlineContent?r.createElement(r.Fragment,null,this.somaticInfo,this.germlinePlaceholder):r.createElement(Ee.PY,st({badgeSelectorOptions:this.mutationStatusFilterOptions},this.props))}},{key:"mutationStatusFilterOptions",get:function(){var e=[{value:"Somatic",label:ht(this.props.somaticContent),badgeStyleOverride:Ee.nk,badgeStyleSelectedOverride:Ee.nk}];return this.props.germlineContent&&e.push({value:"Germline",label:ht(this.props.germlineContent),badgeStyleOverride:Ee.nk,badgeStyleSelectedOverride:Ee.nk}),e}},{key:"somaticInfo",get:function(){return this.props.rates?r.createElement(Ee.Bo,{label:ht(this.props.somaticContent),badgeContent:"".concat((0,ie.C_)(this.props.rates.Somatic),"%"),badgeStyleOverride:this.mutationStatusFilterOptions[0].badgeStyleOverride}):null}},{key:"germlinePlaceholder",get:function(){return r.createElement("div",{"data-test":"germlineMutationRate",className:"invisible",style:{display:"none"}},"%")}}])&&ut(n.prototype,o),i&&ut(n,i),t}(r.Component);mt([c.computed],yt.prototype,"mutationStatusFilterOptions",null);const bt=yt=mt([u.observer],yt);function gt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vt(e){return(vt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function St(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ct(e,t){return(Ct=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Et(e){return(Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var wt=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":Et(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Tt=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=function(e,t){return!t||"object"!==Et(t)&&"function"!=typeof t?St(e):t}(this,vt(t).call(this,e)),(0,c.makeObservable)(St(n)),n}var n,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ct(e,t)}(t,e),n=t,(o=[{key:"render",value:function(){return r.createElement("span",{"data-test":"mutation-rate-summary"},r.createElement(bt,{filter:this.props.mutationStatusFilter,onSelect:this.props.onMutationStatusSelect,rates:{Germline:this.germlineMutationRate,Somatic:this.somaticMutationRate},somaticContent:{title:"Somatic Mutation Frequency",description:"Percentage of samples with a somatic mutation in ".concat(this.props.hugoGeneSymbol)},germlineContent:this.germlineMutationRate>0?{title:"Germline Mutation Frequency",description:"Percentage of samples with a germline mutation in ".concat(this.props.hugoGeneSymbol)}:void 0}))}},{key:"germlineMutationRate",get:function(){var e;return"pending"!==this.props.germlineConsentedSamples.status&&(e=this.props.germlineConsentedSamples&&this.props.germlineConsentedSamples.result&&this.props.germlineConsentedSamples.result.length>0?this.props.germlineConsentedSamples.result:this.props.samples),e?(0,we.Ho)(this.props.hugoGeneSymbol,this.props.mutations,this.props.molecularProfileIdToMolecularProfile.result,e):0}},{key:"somaticMutationRate",get:function(){return this.props.samples.length>0?(0,we.F)(this.props.hugoGeneSymbol,this.props.mutations,this.props.molecularProfileIdToMolecularProfile.result,this.props.samples):0}}])&&gt(n.prototype,o),i&&gt(n,i),t}(r.Component);wt([c.computed],Tt.prototype,"germlineMutationRate",null),wt([c.computed],Tt.prototype,"somaticMutationRate",null);const Pt=Tt=wt([u.observer],Tt);var Ot=n(62043),kt=n(74944),At=n(17328),It=n(90860),_t=n(1765),Dt=n(64015),xt=n(52638),Mt=n(97392);function Nt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Lt(e){return(Lt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Rt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jt(e,t){return(jt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Gt(e){return(Gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Vt,Ft=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":Gt(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};!function(e){e.MUTATIONS="Mutations",e.CLINICAL="Clinical"}(Vt||(Vt={}));var Bt=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=function(e,t){return!t||"object"!==Gt(t)&&"function"!=typeof t?Rt(e):t}(this,Lt(t).call(this,e)),Object.defineProperty(Rt(n),"tabId",{enumerable:!0,configurable:!0,writable:!0,value:Vt.MUTATIONS}),(0,c.makeObservable)(Rt(n)),n}var n,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jt(e,t)}(t,e),n=t,(o=[{key:"updateTabId",value:function(e){this.tabId=e}},{key:"addAll",value:function(e,t){if(this.props.onColumnToggled&&t.length>0){var n=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var l=i.value;!l.selected&&e.includes(l.key)&&this.props.onColumnToggled(l.key)}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}}}},{key:"clearAll",value:function(e,t){if(this.props.onColumnToggled&&t.length>0){var n=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var l=i.value;l.selected&&e.includes(l.key)&&this.props.onColumnToggled(l.key)}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}}}},{key:"toggle",value:function(e){this.props.onColumnToggled&&this.props.onColumnToggled(e)}},{key:"getTextPixel",value:function(e,t){return Math.floor((0,w.mY)(e,"Helvetica Neue",t))}},{key:"render",value:function(){var e=this.mutationsOptions.length>0,t=this.clinicalOptions.length>0,n=e||t;return r.createElement("div",{style:{float:"right"}},r.createElement(xt.Z,{bsStyle:"default",title:this.dropdownButtonText,id:"addColumnsDropdown",className:this.props.className,styles:{minWidth:400,width:"auto"},buttonClassName:"btn btn-default btn-sm"},r.createElement("div",{style:{display:"flex",flexDirection:"column"}},n&&r.createElement(d.Kh,{activeTabId:this.tabId,onTabClick:this.updateTabId,unmountOnHide:!1,className:"mainTabs mutationsTabAddColumnsDropdown"},e&&r.createElement(d.l6,{key:0,id:Vt.MUTATIONS,linkText:this.mutationsTabText},this.mutationsTabContent),t&&r.createElement(d.l6,{key:1,id:Vt.CLINICAL,linkText:this.clinicalTabText},this.clinicalTabContent)),n&&this.props.showResetColumnsButton&&r.createElement("button",{style:{position:"absolute",top:11,right:12,zIndex:2},className:"btn btn-primary btn-xs",onClick:this.props.resetColumnVisibility},"Reset columns"))))}},{key:"clinicalAttributeIds",get:function(){var e=new Set;return this.props.clinicalAttributes.forEach((function(t){return e.add(t.clinicalAttributeId)})),e.add("CANCER_STUDY").add("CANCER_TYPE_DETAILED").add("MUTATION_COUNT")}},{key:"mutationsOptions",get:function(){var e=this;return this.props.columnVisibility?this.props.columnVisibility.filter((function(t){return!e.clinicalAttributeIds.has(t.id)})).map((function(e){return{key:e.id,label:e.name,selected:e.visible}})):[]}},{key:"numSelectedMutationsOptions",get:function(){return this.mutationsOptions.filter((function(e){return e.selected})).length}},{key:"mutationsTabContent",get:function(){var e=this;return r.createElement(Mt.Z,{options:this.mutationsOptions,onAddAll:function(t){return e.addAll(t,e.mutationsOptions)},onClearAll:function(t){return e.clearAll(t,e.mutationsOptions)},onToggleOption:this.toggle,optionsGivenInSortedOrder:!0,width:this.dropdownWidth})}},{key:"clinicalOptions",get:function(){var e=this;return this.props.columnVisibility?this.props.columnVisibility.filter((function(t){return e.clinicalAttributeIds.has(t.id)})).map((function(e){return{key:e.id,label:e.name,selected:e.visible}})):[]}},{key:"numSelectedClinicalOptions",get:function(){return this.clinicalOptions.filter((function(e){return e.selected})).length}},{key:"clinicalTabContent",get:function(){var e=this;return r.createElement(Mt.Z,{options:this.clinicalOptions,freqPromise:this.props.clinicalAttributeIdToAvailableFrequency,onAddAll:function(t){return e.addAll(t,e.clinicalOptions)},onClearAll:function(t){return e.clearAll(t,e.clinicalOptions)},onToggleOption:this.toggle,optionsGivenInSortedOrder:!1,width:this.dropdownWidth})}},{key:"mutationsTabText",get:function(){return r.createElement("span",{style:{marginTop:"3px",marginBottom:"3px"}},Vt.MUTATIONS,r.createElement("span",{style:{paddingLeft:5}},r.createElement("span",{className:"oncoprintDropdownCount"},this.numSelectedMutationsOptions," /"," ",this.mutationsOptions.length)))}},{key:"clinicalTabText",get:function(){return r.createElement("span",{style:{marginTop:"3px",marginBottom:"3px"}},Vt.CLINICAL,r.createElement("span",{style:{paddingLeft:5}},r.createElement("span",{className:"oncoprintDropdownCount"},this.numSelectedClinicalOptions," /"," ",this.clinicalOptions.length)))}},{key:"dropdownButtonText",get:function(){var e=this.numSelectedMutationsOptions+this.numSelectedClinicalOptions,t=this.mutationsOptions.length+this.clinicalOptions.length;return"Columns (".concat(e," / ").concat(t,")")}},{key:"dropdownWidth",get:function(){var e=40;return e+=this.getTextPixel(Vt.CLINICAL,"14px")+14+(this.getTextPixel(this.clinicalOptions.length.toString(),"11px")+17),Math.max(e,400)}}])&&Nt(n.prototype,o),i&&Nt(n,i),t}(r.Component);Ft([c.observable],Bt.prototype,"tabId",void 0),Ft([c.action.bound],Bt.prototype,"updateTabId",null),Ft([c.action.bound],Bt.prototype,"addAll",null),Ft([c.action.bound],Bt.prototype,"clearAll",null),Ft([c.action.bound],Bt.prototype,"toggle",null),Ft([c.computed],Bt.prototype,"clinicalAttributeIds",null),Ft([c.computed],Bt.prototype,"mutationsOptions",null),Ft([c.computed],Bt.prototype,"numSelectedMutationsOptions",null),Ft([c.computed],Bt.prototype,"mutationsTabContent",null),Ft([c.computed],Bt.prototype,"clinicalOptions",null),Ft([c.computed],Bt.prototype,"numSelectedClinicalOptions",null),Ft([c.computed],Bt.prototype,"clinicalTabContent",null),Ft([c.computed],Bt.prototype,"mutationsTabText",null),Ft([c.computed],Bt.prototype,"clinicalTabText",null),Ft([c.computed],Bt.prototype,"dropdownButtonText",null),Ft([c.computed],Bt.prototype,"dropdownWidth",null);const qt=Bt=Ft([u.observer],Bt);var Ut=n(45985);function Ht(e){return(Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Yt(e,t){return!t||"object"!==Ht(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Kt(e,t,n){return(Kt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Qt(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Qt(e){return(Qt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xt(e,t){return(Xt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Zt=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Yt(this,Qt(t).call(this,e))).props.columnVisibilityProps.customDropdown=function(e){return r.createElement(qt,{className:e.className,columnVisibility:e.columnVisibility,onColumnToggled:e.onColumnToggled,resetColumnVisibility:function(){e.resetColumnVisibility&&e.resetColumnVisibility(),n.props.storeColumnVisibility&&n.props.storeColumnVisibility(void 0)},showResetColumnsButton:e.showResetColumnsButton,clinicalAttributes:n.props.mutationsTabClinicalAttributes.result,clinicalAttributeIdToAvailableFrequency:n.props.clinicalAttributeIdToAvailableFrequency})},n}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xt(e,t)}(t,e),n=t,(o=[{key:"componentWillUpdate",value:function(e){this._columns[Ot.wc.STUDY].visible=!!(e.studyIdToStudy&&Object.keys(e.studyIdToStudy).length>1)}},{key:"generateColumns",value:function(){var e=this;Kt(Qt(t.prototype),"generateColumns",this).call(this);for(var n=this.props.mutationsTabClinicalAttributes.result,o=function(t){var o=n[t].clinicalAttributeId;e.props.columns&&!e.props.columns.includes(o)&&e.props.columns.push(o),e._columns[o]={id:o,name:n[t].displayName,render:_t.Z.makeRenderFunction(n[t],e.props.clinicalAttributeCache),download:function(r){return _t.Z.getTextValue(r,n[t],e.props.clinicalAttributeCache)},sortBy:function(r){return _t.Z.sortBy(r,n[t],e.props.clinicalAttributeCache)},filter:function(r,o,i){return _t.Z.filter(r,i,n[t],e.props.clinicalAttributeCache)},tooltip:r.createElement("span",null,n[t].description),visible:!1,order:300}},a=0;a<n.length;a++)o(a);var l=(0,Ut.T)(this.props.namespaceColumns);i().forIn(l,(function(t,n){e._columns[n]=t})),this._columns[Ot.wc.CANCER_TYPE_DETAILED].visible=kt.Z.isVisible(this.props.dataStore?this.props.dataStore.allData:this.props.data,this.props.uniqueSampleKeyToTumorType),this._columns[Ot.wc.TUMOR_ALLELE_FREQ].visible=At.Z.isVisible(this.props.dataStore?this.props.dataStore.allData:this.props.data),this._columns[Ot.wc.ANNOTATION].shouldExclude=function(){return!1===e.props.isCanonicalTranscript},this._columns[Ot.wc.STUDY].order=0,this._columns[Ot.wc.SAMPLE_ID].order=10,"CANCER_TYPE"in this._columns&&(this._columns.CANCER_TYPE.order=14,this._columns.CANCER_TYPE.resizable=!0,this._columns.CANCER_TYPE.truncateOnResize=!0),this._columns[Ot.wc.CANCER_TYPE_DETAILED].order=15,this._columns[Ot.wc.PROTEIN_CHANGE].order=20,this._columns[Ot.wc.ANNOTATION].order=30,this._columns[Ot.wc.FUNCTIONAL_IMPACT].order=38,this._columns[Ot.wc.MUTATION_TYPE].order=40,this._columns[Ot.wc.VARIANT_TYPE].order=45,this._columns[Ot.wc.ASCN_METHOD].order=46,this._columns[Ot.wc.CLONAL].order=47,this._columns[Ot.wc.CANCER_CELL_FRACTION].order=48,this._columns[Ot.wc.EXPECTED_ALT_COPIES].order=49,this._columns[Ot.wc.ASCN_COPY_NUM].order=50,this._columns[Ot.wc.COPY_NUM].order=51,this._columns[Ot.wc.COSMIC].order=60,this._columns[Ot.wc.MUTATION_STATUS].order=70,this._columns[Ot.wc.VALIDATION_STATUS].order=80,this._columns[Ot.wc.CENTER].order=100,this._columns[Ot.wc.CHROMOSOME].order=110,this._columns[Ot.wc.START_POS].order=120,this._columns[Ot.wc.END_POS].order=130,this._columns[Ot.wc.REF_ALLELE].order=140,this._columns[Ot.wc.VAR_ALLELE].order=150,this._columns[Ot.wc.HGVSG].order=151,this._columns[Ot.wc.HGVSC].order=152,this._columns[Ot.wc.TUMOR_ALLELE_FREQ].order=160,this._columns[Ot.wc.NORMAL_ALLELE_FREQ].order=170,this._columns[Ot.wc.VAR_READS].order=180,this._columns[Ot.wc.REF_READS].order=190,this._columns[Ot.wc.VAR_READS_N].order=200,this._columns[Ot.wc.REF_READS_N].order=210,this._columns[Ot.wc.NUM_MUTATIONS].order=220,this._columns[Ot.wc.EXON].order=230,this._columns[Ot.wc.GNOMAD].order=260,this._columns[Ot.wc.CLINVAR].order=270,this._columns[Ot.wc.DBSNP].order=280,this._columns[Ot.wc.SIGNAL].order=290,this._columns[Ot.wc.CANCER_TYPE_DETAILED].shouldExclude=function(){return!e.props.uniqueSampleKeyToTumorType},this._columns[Ot.wc.CLONAL].shouldExclude=function(){return!e.props.existsSomeMutationWithAscnProperty[Dt.Y.CCF_EXPECTED_COPIES_STRING]},this._columns[Ot.wc.ASCN_METHOD].shouldExclude=function(){return!e.props.existsSomeMutationWithAscnProperty[Dt.Y.ASCN_METHOD_STRING]},this._columns[Ot.wc.CANCER_CELL_FRACTION].shouldExclude=function(){return!e.props.existsSomeMutationWithAscnProperty[Dt.Y.CCF_EXPECTED_COPIES_STRING]},this._columns[Ot.wc.EXPECTED_ALT_COPIES].shouldExclude=function(){return!e.props.existsSomeMutationWithAscnProperty[Dt.Y.EXPECTED_ALT_COPIES_STRING]},this._columns[Ot.wc.ASCN_COPY_NUM].shouldExclude=function(){return!e.props.existsSomeMutationWithAscnProperty[Dt.Y.ASCN_INTEGER_COPY_NUMBER_STRING]||!e.props.existsSomeMutationWithAscnProperty[Dt.Y.TOTAL_COPY_NUMBER_STRING]||!e.props.existsSomeMutationWithAscnProperty[Dt.Y.MINOR_COPY_NUMBER_STRING]},this._columns[Ot.wc.NUM_MUTATIONS].shouldExclude=function(){return!e.props.mutationCountCache},this._columns[Ot.wc.EXON].render=function(t){return It.Z.renderFunction(t,e.props.genomeNexusCache,!1)},this._columns[Ot.wc.EXON].headerRender=function(){return r.createElement("span",{style:{display:"inline-block"}},"Exon",r.createElement("br",null),"(",e.props.totalNumberOfExons," in total)")}}}])&&Wt(n.prototype,o),a&&Wt(n,a),t}(Ot.ZP);Object.defineProperty(Zt,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:Object.assign(Object.assign({},Ot.ZP.defaultProps),{columns:[Ot.wc.STUDY,Ot.wc.SAMPLE_ID,Ot.wc.COPY_NUM,Ot.wc.ASCN_METHOD,Ot.wc.ASCN_COPY_NUM,Ot.wc.ANNOTATION,Ot.wc.HGVSG,Ot.wc.FUNCTIONAL_IMPACT,Ot.wc.REF_READS_N,Ot.wc.VAR_READS_N,Ot.wc.REF_READS,Ot.wc.VAR_READS,Ot.wc.START_POS,Ot.wc.END_POS,Ot.wc.REF_ALLELE,Ot.wc.VAR_ALLELE,Ot.wc.MUTATION_STATUS,Ot.wc.VALIDATION_STATUS,Ot.wc.CENTER,Ot.wc.CHROMOSOME,Ot.wc.PROTEIN_CHANGE,Ot.wc.MUTATION_TYPE,Ot.wc.VARIANT_TYPE,Ot.wc.CLONAL,Ot.wc.CANCER_CELL_FRACTION,Ot.wc.EXPECTED_ALT_COPIES,Ot.wc.COSMIC,Ot.wc.TUMOR_ALLELE_FREQ,Ot.wc.NORMAL_ALLELE_FREQ,Ot.wc.CANCER_TYPE_DETAILED,Ot.wc.NUM_MUTATIONS,Ot.wc.EXON,Ot.wc.HGVSC,Ot.wc.GNOMAD,Ot.wc.CLINVAR,Ot.wc.DBSNP,Ot.wc.SIGNAL],columnVisibilityProps:{}})});var zt=n(40416),$t=n(22773);function Jt(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function en(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tn(e){return(tn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function nn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rn(e,t){return(rn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function on(e){return(on="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var an=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":on(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},ln=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=function(e,t){return!t||"object"!==on(t)&&"function"!=typeof t?nn(e):t}(this,tn(t).call(this,e)),Object.defineProperty(nn(n),"minMaxColumns",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(nn(n),"allUniqDataColumns",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(nn(n),"deactivateColumnFilter",{enumerable:!0,configurable:!0,writable:!0,value:function(e){(0,Ee.UK)([],!0,n.store.dataStore,e,(0,we.WP)(e))}}),Object.defineProperty(nn(n),"setupColumnFilter",{enumerable:!0,configurable:!0,writable:!0,value:function(e){var t=e.name;n.props.store.numericalFilterColumns.has(t)?n.minMaxColumns.add(e):n.props.store.categoricalFilterColumns.has(t)&&n.allUniqDataColumns.add(e)}}),Object.defineProperty(nn(n),"columnToHeaderFilterIconModal",{enumerable:!0,configurable:!0,writable:!0,value:function(e){var t,o=e.name,i=n.props.store.numericalFilterColumns.has(o),a=n.props.store.categoricalFilterColumns.has(o);if(i||a)return i&&n.minMaxColumns.has(e)?t=n.numericalFilterComponents[o]:a&&n.allUniqDataColumns.has(e)&&(t=n.categoricalFilterComponents[o]),r.createElement(Ve,{id:o,filterIsActive:n.columnFilterIsActive(o),deactivateFilter:function(){return n.deactivateColumnFilter(o)},setupFilter:function(){return n.setupColumnFilter(e)},menuComponent:t})}}),(0,c.makeObservable)(nn(n)),n.minMaxColumns=new Set,n.allUniqDataColumns=new Set,n}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rn(e,t)}(t,e),n=t,(o=[{key:"getMutationRateSummary",value:function(){return this.props.store.germlineConsentedSamples&&this.props.store.germlineConsentedSamples.result&&this.props.store.mutationData.isComplete&&this.props.store.mutationData.result.length>0&&this.props.store.samples.isComplete&&this.props.store.samples.result&&this.props.store.samples.result.length>0?r.createElement(Pt,{hugoGeneSymbol:this.props.store.gene.hugoGeneSymbol,molecularProfileIdToMolecularProfile:this.props.store.molecularProfileIdToMolecularProfile,mutations:this.props.store.mutationData.result,samples:this.props.store.samples.result,germlineConsentedSamples:this.props.store.germlineConsentedSamples,onMutationStatusSelect:this.onMutationStatusSelect,mutationStatusFilter:this.mutationStatusFilter}):null}},{key:"onMutationStatusSelect",value:function(e,t){(0,Ee.UK)(e,t,this.store.dataStore,Ee.O7.MUTATION_STATUS,lt.lD)}},{key:"columnFilterIsActive",value:function(e){return e in this.getFilters}},{key:"resolveMutationToColumnValue",value:function(e,t){return("Mutation Type"===t.name&&t.sortBy?""+(i().flatten([t.sortBy(e)])[0]||""):i().flatten([t.download(e)])[0])||"(Blanks)"}},{key:"isDefaultNumericalFilter",value:function(e){var t=this.getFilters[e],n=this.columnMinMax[e];return+t.values[0].lowerBound==+n.min&&+t.values[0].upperBound==+n.max&&!1===t.values[0].hideEmptyValues}},{key:"isDefaultCategoricalFilter",value:function(e){var t=this.getFilters[e];return"contains"===t.values[0].filterCondition&&""===t.values[0].filterString&&i().isEqual(t.values[0].selections,this.allUniqColumnData[e])}},{key:"activateNumericalFilter",value:function(e,t,n,r){var o=+this.columnMinMax[e].min,i=+this.columnMinMax[e].max;(0,Ee.UK)([{lowerBound:void 0===t?o:t,upperBound:void 0===n?i:n,hideEmptyValues:void 0!==r&&r}],!1,this.store.dataStore,e,(0,we.WP)(e))}},{key:"activateCategoricalFilter",value:function(e,t,n,r){(0,Ee.UK)([{filterCondition:t||"contains",filterString:n||"",selections:r||this.allUniqColumnData[e]}],!1,this.store.dataStore,e,(0,we.WP)(e))}},{key:"filterResetPanel",get:function(){var e=this,t=this.props.store.dataStore,n="Showing ".concat(t.tableData.length," of ").concat(t.allData.length," mutations.");if(this.props.store.queriedStudies.isComplete){var o=r.createElement("a",{onClick:function(){(0,zt.Bu)(e.props.store.queriedStudies.result,t.tableDataSamples,!0)}},(0,zt.Fq)(t.tableDataSamples,t.tableDataPatients));n=r.createElement("span",null,"Showing ".concat(t.tableData.length," of ").concat(t.allData.length," mutations in "),o,".")}return r.createElement(Ee.$S,{resetFilters:function(){return t.resetFilters()},filterInfo:n,className:b()("alert","alert-success",it().filterResetPanel),buttonClass:"btn btn-default btn-xs"})}},{key:"mutationStatusFilter",get:function(){return this.store.dataStore.dataFilters.find((function(e){return e.id===lt.lD}))}},{key:"isMutationTableDataLoading",get:function(){return"pending"===(0,ie.CX)(this.props.store.clinicalDataForSamples,this.props.store.studiesForSamplesWithoutCancerTypeClinicalData,this.props.store.canonicalTranscript,this.props.store.mutationData,this.props.store.indexedVariantAnnotations,this.props.store.activeTranscript,this.props.store.clinicalDataGroupedBySampleMap,this.props.store.mutationsTabClinicalAttributes)}},{key:"totalExonNumber",get:function(){var e=this.props.store.canonicalTranscript.result&&this.props.store.canonicalTranscript.result.transcriptId,t=this.props.store.activeTranscript.result&&this.props.store.activeTranscript.result===e?this.props.store.canonicalTranscript.result:this.props.store.transcriptsByTranscriptId[this.props.store.activeTranscript.result];return t&&t.exons&&t.exons.length>0?t.exons.length.toString():"None"}},{key:"mutationTableComponent",get:function(){return r.createElement(Zt,{uniqueSampleKeyToTumorType:this.props.store.uniqueSampleKeyToTumorType,oncoKbCancerGenes:this.props.store.oncoKbCancerGenes,discreteCNACache:this.props.discreteCNACache,studyIdToStudy:this.props.store.studyIdToStudy.result,molecularProfileIdToMolecularProfile:this.props.store.molecularProfileIdToMolecularProfile.result,pubMedCache:this.props.pubMedCache,mutationCountCache:this.props.mutationCountCache,clinicalAttributeCache:this.props.clinicalAttributeCache,genomeNexusCache:this.props.genomeNexusCache,genomeNexusMutationAssessorCache:this.props.genomeNexusMutationAssessorCache,dataStore:this.props.store.dataStore,itemsLabelPlural:this.itemsLabelPlural,downloadDataFetcher:this.props.store.downloadDataFetcher,myCancerGenomeData:this.props.store.myCancerGenomeData,hotspotData:this.props.store.indexedHotspotData,indexedVariantAnnotations:this.props.store.indexedVariantAnnotations,indexedMyVariantInfoAnnotations:this.props.store.indexedMyVariantInfoAnnotations,cosmicData:this.props.store.cosmicData.result,oncoKbData:this.props.store.oncoKbData,usingPublicOncoKbInstance:this.props.store.usingPublicOncoKbInstance,mergeOncoKbIcons:this.props.mergeOncoKbIcons,onOncoKbIconToggle:this.props.onOncoKbIconToggle,civicGenes:this.props.store.civicGenes,civicVariants:this.props.store.civicVariants,userEmailAddress:this.props.userEmailAddress,enableOncoKb:this.props.enableOncoKb,enableFunctionalImpact:this.props.enableGenomeNexus,enableHotspot:this.props.enableHotspot,enableMyCancerGenome:this.props.enableMyCancerGenome,enableCivic:this.props.enableCivic,totalNumberOfExons:this.totalExonNumber,generateGenomeNexusHgvsgUrl:this.props.store.generateGenomeNexusHgvsgUrl,isCanonicalTranscript:this.props.store.isCanonicalTranscript,selectedTranscriptId:this.props.store.activeTranscript.result,columnVisibility:this.props.columnVisibility,storeColumnVisibility:this.props.storeColumnVisibility,sampleIdToClinicalDataMap:this.props.store.clinicalDataGroupedBySampleMap,existsSomeMutationWithAscnProperty:this.props.existsSomeMutationWithAscnProperty,mutationsTabClinicalAttributes:this.props.store.mutationsTabClinicalAttributes,clinicalAttributeIdToAvailableFrequency:this.props.store.clinicalAttributeIdToAvailableFrequency,columnToHeaderFilterIconModal:this.columnToHeaderFilterIconModal,deactivateColumnFilter:this.deactivateColumnFilter,namespaceColumns:this.props.store.namespaceColumnConfig,columns:this.columns})}},{key:"columns",get:function(){var e=(0,$t.Tt)(this.props.store.namespaceColumnConfig);return i().concat(Zt.defaultProps.columns,e)}},{key:"mutationTable",get:function(){return r.createElement("span",null,!this.isMutationTableDataLoading&&this.mutationTableComponent)}},{key:"dataFilterColumns",get:function(){return[].concat(Jt(this.props.store.numericalFilterColumns),Jt(this.props.store.categoricalFilterColumns))}},{key:"getFilters",get:function(){var e=this,t={},n=!0,r=!1,o=void 0;try{for(var i,a=function(){var n=i.value,r=e.store.dataStore.dataFilters.find((function(e){return e.type===n}));r&&(t[n]=r)},l=this.dataFilterColumns[Symbol.iterator]();!(n=(i=l.next()).done);n=!0)a()}catch(e){r=!0,o=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw o}}return t}},{key:"columnMinMax",get:function(){var e={},t=!0,n=!1,r=void 0;try{for(var o,a=this.minMaxColumns[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var l=o.value,s=l.name,u="0",c="100",p=!1;if(l.sortBy){var d=1/0,f=-1/0,m=void 0,h=void 0,y=!0,b=!1,g=void 0;try{for(var v,S=this.store.dataStore.allData[Symbol.iterator]();!(y=(v=S.next()).done);y=!0){var C=v.value,E=l.sortBy(C);null!==E?(+E<d&&(d=+E,m=C),+E>f&&(f=+E,h=C)):p=!0}}catch(e){b=!0,g=e}finally{try{y||null==S.return||S.return()}finally{if(b)throw g}}m&&h&&(l.download&&(u=i().flatten([l.download(m)])[0],c=i().flatten([l.download(h)])[0]),(!l.download||isNaN(+u)||isNaN(+c))&&(u=""+d,c=""+f))}e[s]={min:u,max:c,hasEmptyValues:p}}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return e}},{key:"allUniqColumnData",get:function(){var e={},t=!0,n=!1,r=void 0;try{for(var o,i=this.allUniqDataColumns[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value,l=a.name;if(a.download){e[l]=new Set;var s=!0,u=!1,c=void 0;try{for(var p,d=this.store.dataStore.allData[Symbol.iterator]();!(s=(p=d.next()).done);s=!0){var f=p.value,m=this.resolveMutationToColumnValue(f,a);e[l].add(m)}}catch(e){u=!0,c=e}finally{try{s||null==d.return||d.return()}finally{if(u)throw c}}}else e[l]=new Set}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return e}},{key:"allUniqColumnDataFiltered",get:function(){var e={},t=!0,n=!1,r=void 0;try{for(var o,i=this.allUniqDataColumns[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value,l=a.name;if(a.download){e[l]=new Set;var s=!0,u=!1,c=void 0;try{for(var p,d=this.store.dataStore.sortedFilteredData[Symbol.iterator]();!(s=(p=d.next()).done);s=!0){var f=p.value,m=this.resolveMutationToColumnValue(f,a);e[l].add(m)}}catch(e){u=!0,c=e}finally{try{s||null==d.return||d.return()}finally{if(u)throw c}}if(this.columnFilterIsActive(l)){var h=this.getFilters[l],y=!0,b=!1,g=void 0;try{for(var v,S=this.store.dataStore.allData[Symbol.iterator]();!(y=(v=S.next()).done);y=!0){var C=v.value,E=this.resolveMutationToColumnValue(C,a);(0,we.iR)(E,h.values[0])&&!h.values[0].selections.has(E)&&e[l].add(E)}}catch(e){b=!0,g=e}finally{try{y||null==S.return||S.return()}finally{if(b)throw g}}}}else e[l]=new Set}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return e}},{key:"numericalFilterComponents",get:function(){var e=this,t={},n=!0,o=!1,i=void 0;try{for(var a,l=function(){var n=a.value.name,o=e.columnFilterIsActive(n)?e.getFilters[n]:void 0;t[n]=r.createElement("div",null,r.createElement(Xe,{id:n,min:e.columnMinMax[n].min,max:e.columnMinMax[n].max,lowerValue:null==o?void 0:o.values[0].lowerBound,upperValue:null==o?void 0:o.values[0].upperBound,callbackLowerValue:function(t){o?(o.values[0].lowerBound=t,e.isDefaultNumericalFilter(n)&&e.deactivateColumnFilter(n)):e.activateNumericalFilter(n,t)},callbackUpperValue:function(t){o?(o.values[0].upperBound=t,e.isDefaultNumericalFilter(n)&&e.deactivateColumnFilter(n)):e.activateNumericalFilter(n,void 0,t)}}),e.columnMinMax[n].hasEmptyValues&&r.createElement("label",{style:{fontWeight:100}},r.createElement("input",{type:"checkbox",style:{marginTop:"10px",marginLeft:"5px",marginRight:"4px"},checked:!!o&&o.values[0].hideEmptyValues,onChange:function(t){o?(o.values[0].hideEmptyValues=!o.values[0].hideEmptyValues,e.isDefaultNumericalFilter(n)&&e.deactivateColumnFilter(n)):e.activateNumericalFilter(n,void 0,void 0,!0)},"data-test":"numerical-filter-menu-remove-empty-rows"}),"Hide empty values"))},s=this.minMaxColumns[Symbol.iterator]();!(n=(a=s.next()).done);n=!0)l()}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return t}},{key:"categoricalFilterComponents",get:function(){var e=this,t={},n=!0,o=!1,i=void 0;try{for(var a,l=function(){var n=a.value.name,o=e.columnFilterIsActive(n)?e.getFilters[n]:void 0;t[n]=r.createElement(rt,{id:n,emptyFilterString:!o,currSelections:o?o.values[0].selections:e.allUniqColumnDataFiltered[n],allSelections:e.allUniqColumnDataFiltered[n],updateFilterCondition:function(t){o?(o.values[0].filterCondition=t,e.isDefaultCategoricalFilter(n)&&e.deactivateColumnFilter(n)):e.activateCategoricalFilter(n,t)},updateFilterString:function(t){o?(o.values[0].filterString=t,e.isDefaultCategoricalFilter(n)&&e.deactivateColumnFilter(n)):e.activateCategoricalFilter(n,void 0,t)},toggleSelections:function(t){if(o){var r=o.values[0].selections;t.forEach((function(e){r.has(e)?r.delete(e):r.add(e)})),e.isDefaultCategoricalFilter(n)&&e.deactivateColumnFilter(n)}else{var i=e.allUniqColumnData[n];t.forEach((function(e){i.delete(e)})),e.activateCategoricalFilter(n,void 0,void 0,i)}}})},s=this.allUniqDataColumns[Symbol.iterator]();!(n=(a=s.next()).done);n=!0)l()}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return t}}])&&en(n.prototype,o),a&&en(n,a),t}(at.Z);an([c.observable],ln.prototype,"minMaxColumns",void 0),an([c.observable],ln.prototype,"allUniqDataColumns",void 0),an([c.computed],ln.prototype,"mutationStatusFilter",null),an([c.computed],ln.prototype,"columns",null),an([c.action.bound],ln.prototype,"onMutationStatusSelect",null),an([c.computed],ln.prototype,"dataFilterColumns",null),an([c.computed],ln.prototype,"getFilters",null),an([c.computed],ln.prototype,"columnMinMax",null),an([c.computed],ln.prototype,"allUniqColumnData",null),an([c.computed],ln.prototype,"allUniqColumnDataFiltered",null),an([c.computed],ln.prototype,"numericalFilterComponents",null),an([c.computed],ln.prototype,"categoricalFilterComponents",null);const sn=ln=an([u.observer],ln);var un=n(83724),cn=n(2213),pn=n(26942),dn=n(9337);function fn(){return(fn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function mn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hn(e){return(hn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bn(e,t){return(bn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gn(e){return(gn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var vn=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":gn(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Sn=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=function(e,t){return!t||"object"!==gn(t)&&"function"!=typeof t?yn(e):t}(this,hn(t).call(this,e)),Object.defineProperty(yn(n),"userSelectionStore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),(0,c.makeObservable)(yn(n)),n.userSelectionStore=new cn.Z,n}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bn(e,t)}(t,e),n=t,(o=[{key:"onToggleOql",value:function(){this.props.store.mutationsTabFilteringSettings.useOql=!this.props.store.mutationsTabFilteringSettings.useOql}},{key:"onToggleVUS",value:function(){this.props.store.mutationsTabFilteringSettings.excludeVus=!this.props.store.mutationsTabFilteringSettings.excludeVus}},{key:"onToggleGermline",value:function(){this.props.store.mutationsTabFilteringSettings.excludeGermline=!this.props.store.mutationsTabFilteringSettings.excludeGermline}},{key:"setSelectedGeneSymbol",value:function(e){this.props.urlWrapper.updateURL({mutations_gene:e})}},{key:"render",value:function(){var e=this,t=this.selectedGeneSymbol;return r.createElement("div",{"data-test":"mutationsTabDiv"},this.props.store.mutationsByGene.isComplete&&r.createElement(d.Kh,{id:"mutationsPageTabs",activeTabId:t,onTabClick:function(t){return e.handleTabChange(t)},className:"pillTabs resultsPageMutationsGeneTabs",arrowStyle:{"line-height":.8},tabButtonStyle:"pills",unmountOnHide:!0},this.generateTabs(this.props.store.hugoGeneSymbols,this.props.store.mutationsByGene.result)),this.props.store.mutationsByGene.isPending&&r.createElement(ee.Z,{center:!0,size:"big",isLoading:!0}))}},{key:"generateTabs",value:function(e,t){var n=this,o=[];return e.forEach((function(e){if(t[e]){var i=t[e].length>0?void 0:{color:"#bbb"};o.push(r.createElement(d.l6,{key:e,id:e,linkText:e,anchorStyle:i},n.selectedGeneSymbol===e&&n.geneTabContent))}})),o}},{key:"handleTabChange",value:function(e){this.setSelectedGeneSymbol(e)}},{key:"handleOncoKbIconToggle",value:function(e){this.userSelectionStore.mergeOncoKbIcons=e,(0,dn.qu)({mergeIcons:e})}},{key:"onTranscriptChange",value:function(e){this.props.urlWrapper.updateURL({mutations_transcript_id:e})}},{key:"onClickSettingMenu",value:function(e){this.props.store.isSettingsMenuVisible=e}},{key:"selectedGeneSymbol",get:function(){return this.props.urlWrapper.query.mutations_gene&&this.props.store.hugoGeneSymbols.includes(this.props.urlWrapper.query.mutations_gene)?this.props.urlWrapper.query.mutations_gene:this.props.store.hugoGeneSymbols[0]}},{key:"selectedGene",get:function(){var e=this;return i().find(this.props.store.genes.result,(function(t){return t.hugoGeneSymbol===e.selectedGeneSymbol}))}},{key:"geneTabContent",get:function(){if(this.selectedGene&&this.props.store.getMutationMapperStore(this.selectedGene)){var e=this.props.store.getMutationMapperStore(this.selectedGene);return r.createElement("div",null,r.createElement("div",{className:"tabMessageContainer"},r.createElement(oe.Z,{className:"mutations-oql-status-banner",store:this.props.store,tabReflectsOql:this.props.store.mutationsTabFilteringSettings.useOql,isUnaffected:!this.props.store.queryContainsMutationOql,onToggle:this.onToggleOql}),r.createElement(ae.Z,{store:this.props.store,mutationsTabModeSettings:{excludeVUS:this.props.store.mutationsTabFilteringSettings.excludeVus,excludeGermline:this.props.store.mutationsTabFilteringSettings.excludeGermline,toggleExcludeVUS:this.onToggleVUS,toggleExcludeGermline:this.onToggleGermline,hugoGeneSymbol:this.selectedGene.hugoGeneSymbol}}),r.createElement(ue.Z,{store:this.props.store})),r.createElement(sn,fn({},(0,un.R)(Object.assign(Object.assign({},(0,pn.Ib)()),{ensembl_transcript_url:this.props.store.ensemblLink,show_oncokb:!!e.isCanonicalTranscript&&(0,pn.Ib)().show_oncokb,show_hotspot:!!e.isCanonicalTranscript&&(0,pn.Ib)().show_hotspot})),{oncoKbPublicApiUrl:(0,se.ID)(),mergeOncoKbIcons:this.userSelectionStore.mergeOncoKbIcons,onOncoKbIconToggle:this.handleOncoKbIconToggle,store:e,isPutativeDriver:this.props.store.driverAnnotationSettings.driversAnnotated?function(e){return e.putativeDriver}:void 0,trackVisibility:this.userSelectionStore.trackVisibility,columnVisibility:this.userSelectionStore.columnVisibility,storeColumnVisibility:this.userSelectionStore.storeColumnVisibility,discreteCNACache:this.props.store.discreteCNACache,pubMedCache:this.props.store.pubMedCache,cancerTypeCache:this.props.store.cancerTypeCache,mutationCountCache:this.props.store.mutationCountCache,clinicalAttributeCache:this.props.store.clinicalAttributeCache,genomeNexusCache:this.props.store.genomeNexusCache,genomeNexusMutationAssessorCache:this.props.store.genomeNexusMutationAssessorCache,pdbHeaderCache:this.props.store.pdbHeaderCache,userEmailAddress:this.props.appStore.userName,generateGenomeNexusHgvsgUrl:this.props.store.generateGenomeNexusHgvsgUrl,existsSomeMutationWithAscnProperty:this.props.store.existsSomeMutationWithAscnProperty,mutationAlignerUrlTemplate:(0,se.Rb)(),showTranscriptDropDown:(0,pn.Ib)().show_transcript_dropdown,onTranscriptChange:this.onTranscriptChange,onClickSettingMenu:this.onClickSettingMenu,compactStyle:!0,ptmSources:(0,pn.Ib)().ptmSources})))}return null}}])&&mn(n.prototype,o),a&&mn(n,a),t}(r.Component);vn([c.computed],Sn.prototype,"selectedGeneSymbol",null),vn([c.computed],Sn.prototype,"selectedGene",null),vn([S.default],Sn.prototype,"onToggleOql",null),vn([S.default],Sn.prototype,"onToggleVUS",null),vn([S.default],Sn.prototype,"onToggleGermline",null),vn([c.action],Sn.prototype,"setSelectedGeneSymbol",null),vn([S.default],Sn.prototype,"handleTabChange",null),vn([c.action.bound],Sn.prototype,"handleOncoKbIconToggle",null),vn([c.computed],Sn.prototype,"geneTabContent",null),vn([c.action.bound],Sn.prototype,"onTranscriptChange",null),vn([c.action.bound],Sn.prototype,"onClickSettingMenu",null);const Cn=Sn=vn([u.observer],Sn);var En=n(6303),wn=n(65497),Tn=n.n(wn),Pn=n(50619),On=n(30256),kn=n(8152),An=n(6240),In=n(60878);function _n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Dn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xn(e,t){return!t||"object"!==Rn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Mn(e){return(Mn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Nn(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ln(e,t)}function Ln(e,t){return(Ln=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Rn(e){return(Rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var jn=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":Rn(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Gn=function(e){function t(){return Dn(this,t),xn(this,Mn(t).apply(this,arguments))}return Nn(t,e),t}(An.ZP),Vn=function(e){function t(){return Dn(this,t),xn(this,Mn(t).apply(this,arguments))}var n,o,i;return Nn(t,e),n=t,(o=[{key:"render",value:function(){return r.createElement(Gn,{data:this.props.geneAlterationData,columns:[{name:"Gene Symbol",render:function(e){return r.createElement("span",null,e.gene)},download:function(e){return e.gene},sortBy:function(e){return e.gene},filter:function(e,t,n){return e.gene.toUpperCase().indexOf(n)>-1}},{name:"OQL Line",visible:!1,render:function(e){return r.createElement("span",null,e.oqlLine)},download:function(e){return e.oqlLine},sortBy:function(e){return e.oqlLine},filter:function(e,t,n){return e.oqlLine.toUpperCase().indexOf(n)>-1}},{name:"Num Samples Altered",render:function(e){return r.createElement("span",null,e.sequenced?e.altered:"Not Profiled")},download:function(e){return e.sequenced?"".concat(e.altered):"N/P"},sortBy:function(e){return e.altered}},{name:"Percent Samples Altered",render:function(e){return e.sequenced?r.createElement(In.Z,{barWidth:200,textWidth:45,counts:[e.altered],totalCount:e.sequenced}):r.createElement("span",null,"Not Profiled")},download:function(e){return e.percentAltered},sortBy:function(e){return e.altered/e.sequenced}}],initialSortColumn:"Percent Samples Altered",initialSortDirection:"desc",showPagination:!0,initialItemsPerPage:10,showColumnVisibility:!0,showFilter:!0,showCopyDownload:!0,copyDownloadProps:{downloadFilename:"gene_alteration_frequency.tsv"}})}}])&&_n(n.prototype,o),i&&_n(n,i),t}(r.Component);const Fn=Vn=jn([u.observer],Vn);var Bn=n(23280),qn=n(24433),Un=n.n(qn),Hn=n(43752),Wn=n.n(Hn),Yn=n(24639),Kn=n(8974),Qn=n(72903);function Xn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Zn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zn(e,t){return!t||"object"!==tr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $n(e){return($n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Jn(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&er(e,t)}function er(e,t){return(er=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function tr(e){return(tr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var nr=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":tr(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};function rr(e){var t=function(t){return e?"".concat(t.proteinChange).concat(t.isGermline?" [germline]":"").concat(t.putativeDriver?" (driver)":""):r.createElement("span",null,r.createElement("span",null,t.proteinChange),t.isGermline&&r.createElement("span",{className:Wn().germline},"Germline"),t.putativeDriver&&r.createElement("span",{className:Wn().driver},"(Driver)"))};return function(e){return e.map(t)}}function or(e){var t=function(t){return e?"".concat(t.type).concat(t.putativeDriver?" (driver)":""):r.createElement("span",null,r.createElement("span",null,t.type),t.putativeDriver&&r.createElement("span",{className:Wn().driver},"(Driver)"))};return function(e){return e.map(t)}}function ir(e,t,n,r){if(!i().isEmpty(e)&&e[t])return function(e,t,n){var r,o=function(e){return e.map((function(e){return e.type}))},i=void 0;switch(0!==e.alterationTypes.length&&e.alterationTypes.includes(t)||(i={summaryContent:"no alteration",summaryClass:Un().noAlterationSpan,summaryAlteredStatus:Yn.Ug.UNALTERED}),t){case"MUT":r={label:"MUT",getAlterationData:function(e){return e.mutation},isNotProfiled:function(e){return e.isMutationNotProfiled},getValues:rr(n)};break;case"FUSION":r={label:"FUSION",getAlterationData:function(e){return e.structuralVariant},isNotProfiled:function(e){return e.isStructuralVariantNotProfiled},getValues:function(e){return e}};break;case"CNA":r={label:"CNA",getAlterationData:function(e){return e.cna},isNotProfiled:function(e){return e.isCnaNotProfiled},getValues:or(n)};break;case"EXP":r={label:"EXP",getAlterationData:function(e){return e.mrnaExp},isNotProfiled:function(e){return e.isMrnaExpNotProfiled},getValues:o};break;case"PROT":r={label:"PROT",getAlterationData:function(e){return e.proteinLevel},isNotProfiled:function(e){return e.isProteinLevelNotProfiled},getValues:o}}if(r){var a=r.getAlterationData(e);if(a.length>0){var l=(0,Qn.E)(", ",r.getValues(a));i={summaryContent:n?l.join(""):l,summaryClass:Un().alterationSpan,summaryAlteredStatus:Yn.Ug.ALTERED}}r.isNotProfiled(e)&&(i={summaryContent:"not profiled",summaryClass:Un().notProfiledSpan,summaryAlteredStatus:Yn.Ug.UNPROFILED})}return i||void 0}(e[t],n,r)}function ar(e,t,n,r){var o=i().map(n,(function(n){return ir(e,t,n,r)})),a=i().filter(o,(function(e){return!!e&&e.summaryAlteredStatus===Yn.Ug.UNPROFILED}));if(a&&a.length===n.length)return{summaryContent:"not profiled",summaryClass:Un().notProfiledSpan,summaryAlteredStatus:Yn.Ug.UNPROFILED};var l=i().filter(o,(function(e){return!!e&&e.summaryAlteredStatus===Yn.Ug.ALTERED})),s=(0,Qn.E)(", ",i().map(l,(function(e){return e.summaryContent})));return l.length>0?{summaryContent:r?s.join(""):s,summaryClass:Un().alterationSpan,summaryAlteredStatus:Yn.Ug.ALTERED}:{summaryContent:"no alteration",summaryClass:Un().noAlterationSpan,summaryAlteredStatus:Yn.Ug.UNALTERED}}var lr=function(e){function t(){return Zn(this,t),zn(this,$n(t).apply(this,arguments))}return Jn(t,e),t}(An.ZP),sr=function(e){function t(){return Zn(this,t),zn(this,$n(t).apply(this,arguments))}var n,o,a;return Jn(t,e),n=t,(o=[{key:"render",value:function(){var e=this,t=[{name:"Study ID",render:function(e){return r.createElement("span",{style:{whiteSpace:"nowrap"}},r.createElement(Bn._,{studyId:e.studyId},e.studyId))},download:function(e){return e.studyId},sortBy:function(e){return e.studyId},filter:function(e,t){return new RegExp(t,"i").test(e.studyId)}},{name:"Sample ID",render:function(e){return r.createElement("span",{style:{whiteSpace:"nowrap"}},r.createElement("a",{href:(0,se.Qk)(e.studyId,e.sampleId),target:"_blank"},e.sampleId))},download:function(e){return"".concat(e.sampleId)},sortBy:function(e){return e.sampleId},filter:function(e,t){return new RegExp(t,"i").test(e.sampleId)}},{name:"Patient ID",render:function(e){return r.createElement("span",{style:{whiteSpace:"nowrap"}},r.createElement("a",{href:(0,se.WU)(e.studyId,e.patientId),target:"_blank"},e.patientId))},download:function(e){return"".concat(e.patientId)},sortBy:function(e){return e.patientId},filter:function(e,t){return new RegExp(t,"i").test(e.patientId)}},{name:"Altered",tooltip:r.createElement("span",null,"1 = Sample harbors alteration in one of the input genes"),render:function(e){return r.createElement("span",null,e.altered?"1":"0")},download:function(e){return e.altered?"1":"0"},sortBy:function(e){return e.altered?1:0}}];i().forEach(this.props.trackLabels,(function(n){t.push({name:"".concat(n),headerDownload:function(e){return"".concat(n)},render:function(t){var o=ar(t.oqlData,n,e.props.trackAlterationTypesMap[n]);return r.createElement("span",{className:o.summaryClass},o.summaryContent)},download:function(t){return ar(t.oqlData,n,e.props.trackAlterationTypesMap[n],!0).summaryContent},sortBy:function(t){return ar(t.oqlData,n,e.props.trackAlterationTypesMap[n]).summaryContent},filter:function(t,r){return new RegExp(r,"i").test(ar(t.oqlData,n,e.props.trackAlterationTypesMap[n]).summaryContent)},visible:!0})}));var n=i().uniq(i().map(this.props.oqls,(function(e){return e.gene})));return i().forEach(n,(function(n){e.props.geneAlterationTypesMap[n].forEach((function(e){var o=(0,Kn.Ig)(e),a=e.alteration_type.toUpperCase(),l="".concat(n,": ").concat(o);i().isEmpty(t.find((function(e){return e.name===l})))&&t.push({name:"".concat(n,": ").concat(o),headerDownload:function(e){return"".concat(n,": ").concat(o)},render:function(e){var t=ir(e.oqlDataByGene,n,a);return r.createElement("span",{className:t.summaryClass},t.summaryContent)},download:function(e){return ir(e.oqlDataByGene,n,a,!0).summaryContent},sortBy:function(e){return ir(e.oqlDataByGene,n,a).summaryContent},filter:function(e,t){return new RegExp(t,"i").test(ir(e.oqlDataByGene,n,a).summaryContent)},visible:!1})}))})),r.createElement(lr,{data:this.props.caseAlterationData,columns:t,initialSortColumn:"Altered",initialSortDirection:"desc",initialItemsPerPage:20,showPagination:!0,showColumnVisibility:!0,showFilter:!0,showCopyDownload:!0,enableHorizontalScroll:!0,copyDownloadProps:{downloadFilename:"alterations_across_samples.tsv"}})}}])&&Xn(n.prototype,o),a&&Xn(n,a),t}(r.Component);const ur=sr=nr([u.observer],sr);var cr=n(44429),pr=n(93527),dr=n(13654),fr=n(8506),mr=n.n(fr),hr=n(49199);function yr(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function br(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gr(e){return(gr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Sr(e,t){return(Sr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Cr(e){return(Cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Er=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":Cr(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},wr=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=function(e,t){return!t||"object"!==Cr(t)&&"function"!=typeof t?vr(e):t}(this,gr(t).call(this,e)),Object.defineProperty(vr(n),"geneAlterationData",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[n.props.store.oqlFilteredCaseAggregatedDataByOQLLine,n.props.store.filteredSequencedSampleKeysByGene]},invoke:function(){return Promise.resolve((0,cr.eo)(n.props.store.oqlFilteredCaseAggregatedDataByOQLLine.result,n.props.store.filteredSequencedSampleKeysByGene.result))}})}),Object.defineProperty(vr(n),"geneAlterationDataByGene",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[n.geneAlterationData]},invoke:function(){return Promise.resolve(i().keyBy(n.geneAlterationData.result,"gene"))}})}),Object.defineProperty(vr(n),"caseAlterationData",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[n.props.store.selectedMolecularProfiles,n.props.store.oqlFilteredCaseAggregatedDataByOQLLine,n.props.store.oqlFilteredCaseAggregatedDataByUnflattenedOQLLine,n.props.store.coverageInformation,n.props.store.filteredSamples,n.geneAlterationDataByGene,n.props.store.molecularProfileIdToMolecularProfile,n.props.store.defaultOQLQueryAlterations]},invoke:function(){return Promise.resolve((0,cr.gz)(n.props.store.oqlText,n.props.store.defaultOQLQueryAlterations.result,n.props.store.selectedMolecularProfiles.result,n.props.store.oqlFilteredCaseAggregatedDataByOQLLine.result,n.props.store.oqlFilteredCaseAggregatedDataByUnflattenedOQLLine.result,n.props.store.coverageInformation.result,n.props.store.filteredSamples.result,n.geneAlterationDataByGene.result,n.props.store.molecularProfileIdToMolecularProfile.result))}})}),Object.defineProperty(vr(n),"mutationData",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[n.props.store.nonOqlFilteredCaseAggregatedData]},invoke:function(){return Promise.resolve((0,cr.D8)(n.props.store.nonOqlFilteredCaseAggregatedData.result))}})}),Object.defineProperty(vr(n),"mutationDownloadData",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[n.mutationData,n.props.store.samples,n.props.store.genes,n.props.store.coverageInformation,n.props.store.studyToSelectedMolecularProfilesMap]},invoke:function(){return Promise.resolve((0,cr.HV)(n.mutationData.result,n.props.store.samples.result,n.props.store.genes.result,(0,cr.S9)(p.YK.MUTATION_EXTENDED,n.props.store.studyToSelectedMolecularProfilesMap.result,n.props.store.coverageInformation.result)))}})}),Object.defineProperty(vr(n),"genericAssayProfileDownloadDataGroupByProfileIdSuffix",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[n.props.store.samples,n.props.store.genericAssayEntityStableIdsGroupByProfileIdSuffix,n.props.store.genericAssayDataGroupByProfileIdSuffix,n.props.store.genericAssayProfilesGroupByProfileIdSuffix,n.props.store.genericAssayStableIdToMeta]},invoke:function(){var e=i().mapValues(n.props.store.genericAssayDataGroupByProfileIdSuffix.result,(function(e,t){var r={samples:i().groupBy(e,(function(e){return e.uniqueSampleKey}))};return(0,cr.HG)(n.props.store.genericAssayProfilesGroupByProfileIdSuffix.result[t].map((function(e){return e.molecularProfileId})),r)}));return Promise.resolve(i().mapValues(e,(function(e,t){return(0,cr._$)(e,n.props.store.samples.result,n.props.store.genericAssayEntityStableIdsGroupByProfileIdSuffix.result[t],n.props.store.genericAssayStableIdToMeta.result)})))}})}),Object.defineProperty(vr(n),"mrnaData",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[n.props.store.nonOqlFilteredCaseAggregatedData]},invoke:function(){return Promise.resolve((0,cr.Yq)(n.props.store.nonOqlFilteredCaseAggregatedData.result))}})}),Object.defineProperty(vr(n),"mrnaDownloadData",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[n.mrnaData,n.props.store.samples,n.props.store.genes,n.props.store.coverageInformation,n.props.store.studyToSelectedMolecularProfilesMap]},invoke:function(){return Promise.resolve((0,cr.Mg)(n.mrnaData.result,n.props.store.samples.result,n.props.store.genes.result,(0,cr.S9)(p.YK.MRNA_EXPRESSION,n.props.store.studyToSelectedMolecularProfilesMap.result,n.props.store.coverageInformation.result)))}})}),Object.defineProperty(vr(n),"proteinData",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[n.props.store.nonOqlFilteredCaseAggregatedData]},invoke:function(){return Promise.resolve((0,cr.$9)(n.props.store.nonOqlFilteredCaseAggregatedData.result))}})}),Object.defineProperty(vr(n),"proteinDownloadData",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[n.proteinData,n.props.store.samples,n.props.store.genes,n.props.store.coverageInformation,n.props.store.studyToSelectedMolecularProfilesMap]},invoke:function(){return Promise.resolve((0,cr.Mg)(n.proteinData.result,n.props.store.samples.result,n.props.store.genes.result,(0,cr.S9)(p.YK.PROTEIN_LEVEL,n.props.store.studyToSelectedMolecularProfilesMap.result,n.props.store.coverageInformation.result)))}})}),Object.defineProperty(vr(n),"cnaData",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[n.props.store.nonOqlFilteredCaseAggregatedData]},invoke:function(){return Promise.resolve((0,cr.eh)(n.props.store.nonOqlFilteredCaseAggregatedData.result))}})}),Object.defineProperty(vr(n),"cnaDownloadData",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[n.cnaData,n.props.store.samples,n.props.store.genes,n.props.store.coverageInformation,n.props.store.studyToSelectedMolecularProfilesMap]},invoke:function(){return Promise.resolve((0,cr.Mg)(n.cnaData.result,n.props.store.samples.result,n.props.store.genes.result,(0,cr.S9)(p.YK.COPY_NUMBER_ALTERATION,n.props.store.studyToSelectedMolecularProfilesMap.result,n.props.store.coverageInformation.result)))}})}),Object.defineProperty(vr(n),"structuralVariantData",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[n.props.store.nonOqlFilteredCaseAggregatedData]},invoke:function(){return Promise.resolve((0,cr.u9)(n.props.store.nonOqlFilteredCaseAggregatedData.result))}})}),Object.defineProperty(vr(n),"structuralVariantDownloadData",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[n.structuralVariantData,n.props.store.samples,n.props.store.genes,n.props.store.coverageInformation,n.props.store.studyToSelectedMolecularProfilesMap]},invoke:function(){return Promise.resolve((0,cr.GM)(n.structuralVariantData.result,n.props.store.samples.result,n.props.store.genes.result,(0,cr.S9)(p.YK.STRUCTURAL_VARIANT,n.props.store.studyToSelectedMolecularProfilesMap.result,n.props.store.coverageInformation.result)))}})}),Object.defineProperty(vr(n),"alteredCaseAlterationData",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[n.caseAlterationData]},invoke:function(){return Promise.resolve(n.caseAlterationData.result.filter((function(e){return e.altered})))}})}),Object.defineProperty(vr(n),"unalteredCaseAlterationData",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[n.caseAlterationData]},invoke:function(){return Promise.resolve(n.caseAlterationData.result.filter((function(e){return!e.altered})))}})}),Object.defineProperty(vr(n),"sampleMatrix",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[n.caseAlterationData]},invoke:function(){var e=[];return i().map(n.caseAlterationData.result,(function(t){if(i().isEmpty(e)){var n=i().keys(t.oqlDataByGene);e.push(["studyID:sampleId","Altered"].concat(yr(n)))}var r=i().map(t.oqlDataByGene,(function(e){return i().isEmpty(e.alterationTypes)?"0":"1"}));e.push(["".concat(t.studyId,":").concat(t.sampleId),t.altered?"1":"0"].concat(yr(r)))})),Promise.resolve(e)}})}),Object.defineProperty(vr(n),"sampleMatrixText",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[n.sampleMatrix]},invoke:function(){return Promise.resolve((0,cr.xd)(n.sampleMatrix.result))}})}),Object.defineProperty(vr(n),"oqls",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[n.props.store.oqlFilteredCaseAggregatedDataByOQLLine]},invoke:function(){return Promise.resolve(n.props.store.oqlFilteredCaseAggregatedDataByOQLLine.result.map((function(e){return e.oql})))}})}),Object.defineProperty(vr(n),"trackLabels",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[n.props.store.oqlFilteredCaseAggregatedDataByUnflattenedOQLLine,n.props.store.defaultOQLQueryAlterations]},invoke:function(){var e=[];return n.props.store.oqlFilteredCaseAggregatedDataByUnflattenedOQLLine.result.forEach((function(t,r){void 0===t.mergedTrackOqlList?e.push((0,Pn.hR)(r,n.props.store.oqlText,t.oql,n.props.store.defaultOQLQueryAlterations.result)):e.push((0,Pn.Tj)(t.oql))})),Promise.resolve(e)}})}),Object.defineProperty(vr(n),"trackAlterationTypesMap",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[n.props.store.oqlFilteredCaseAggregatedDataByUnflattenedOQLLine,n.props.store.defaultOQLQueryAlterations]},invoke:function(){var e={};return n.props.store.oqlFilteredCaseAggregatedDataByUnflattenedOQLLine.result.forEach((function(t,r){if(void 0===t.mergedTrackOqlList){var o=t.oql,a=(0,Pn.hR)(r,n.props.store.oqlText,t.oql,n.props.store.defaultOQLQueryAlterations.result);o.parsed_oql_line.alterations&&(e[a]=i().uniq(i().map(o.parsed_oql_line.alterations,(function(e){return e.alteration_type.toUpperCase()}))))}else{var l=t.oql,s=(0,Pn.Tj)(t.oql),u=[];i().forEach(l.list,(function(e){if(e.parsed_oql_line.alterations){var t=i().map(e.parsed_oql_line.alterations,(function(e){return e.alteration_type.toUpperCase()}));u.push.apply(u,yr(t))}})),e[s]=i().uniq(u)}})),Promise.resolve(e)}})}),Object.defineProperty(vr(n),"geneAlterationMap",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[n.props.store.oqlFilteredCaseAggregatedDataByUnflattenedOQLLine]},invoke:function(){var e={};return n.props.store.oqlFilteredCaseAggregatedDataByUnflattenedOQLLine.result.forEach((function(t,n){if(void 0===t.mergedTrackOqlList){var r=t.oql;r.parsed_oql_line.alterations&&(e[r.gene]=i().chain(r.parsed_oql_line.alterations).union(e[r.gene]).uniq().value())}else{var o=t.oql;i().forEach(o.list,(function(t){if(t.parsed_oql_line.alterations){i().map(t.parsed_oql_line.alterations,(function(e){return e.alteration_type}));e[t.gene]=i().chain(t.parsed_oql_line.alterations).union(e[t.gene]).uniq().value()}}))}})),Promise.resolve(e)}})}),(0,c.makeObservable)(vr(n)),n.handleMutationDownload=n.handleMutationDownload.bind(vr(n)),n.handleTransposedMutationDownload=n.handleTransposedMutationDownload.bind(vr(n)),n.handleCnaDownload=n.handleCnaDownload.bind(vr(n)),n.handleTransposedCnaDownload=n.handleTransposedCnaDownload.bind(vr(n)),n.handleMrnaDownload=n.handleMrnaDownload.bind(vr(n)),n.handleTransposedMrnaDownload=n.handleTransposedMrnaDownload.bind(vr(n)),n.handleProteinDownload=n.handleProteinDownload.bind(vr(n)),n.handleTransposedProteinDownload=n.handleTransposedProteinDownload.bind(vr(n)),n}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sr(e,t)}(t,e),n=t,(o=[{key:"render",value:function(){switch((0,ie.CX)(this.geneAlterationData,this.caseAlterationData,this.oqls,this.trackLabels,this.trackAlterationTypesMap,this.geneAlterationMap,this.cnaData,this.mutationData,this.structuralVariantData,this.mrnaData,this.proteinData,this.unalteredCaseAlterationData,this.alteredCaseAlterationData,this.props.store.virtualStudyParams,this.sampleMatrixText,this.props.store.nonSelectedDownloadableMolecularProfilesGroupByName,this.props.store.studies,this.props.store.selectedMolecularProfiles,this.props.store.genericAssayDataGroupByProfileIdSuffix)){case"pending":return r.createElement(ee.Z,{isLoading:!0,center:!0,size:"big"});case"error":return r.createElement(pr.Z,null);case"complete":return r.createElement(V.z,{"data-test":"downloadTabDiv",offset:60},r.createElement("div",{className:"tabMessageContainer"},r.createElement(oe.Z,{className:"download-oql-status-banner",store:this.props.store,tabReflectsOql:!0}),r.createElement(ae.Z,{store:this.props.store}),r.createElement(ue.Z,{store:this.props.store})),r.createElement("div",null,r.createElement(On.Z,{title:"Downloadable Data Files",className:"forceHeaderStyle h4",isLoading:!1,style:{marginBottom:15}}),r.createElement("table",{className:b()("table","table-striped",Un().downloadCopyTable)},r.createElement("tbody",null,(0,cr.J1)(this.cnaData.result)&&this.cnaDownloadControls(),(0,cr.pk)(this.mutationData.result)&&this.mutationDownloadControls(),(0,cr.eZ)(this.structuralVariantData.result)&&this.structuralVariantDownloadControls(),(0,cr.J1)(this.mrnaData.result)&&this.mrnaExprDownloadControls(this.props.store.selectedMolecularProfiles.result.find((function(e){return e.molecularAlterationType===p.YK.MRNA_EXPRESSION})).name),(0,cr.J1)(this.proteinData.result)&&this.proteinExprDownloadControls(this.props.store.selectedMolecularProfiles.result.find((function(e){return e.molecularAlterationType===p.YK.PROTEIN_LEVEL})).name),this.alteredSamplesDownloadControls(this.alteredCaseAlterationData.result,this.props.store.virtualStudyParams.result),this.unalteredSamplesDownloadControls(this.unalteredCaseAlterationData.result,this.props.store.virtualStudyParams.result),this.sampleMatrixDownloadControls(this.sampleMatrixText.result),this.props.store.doNonSelectedDownloadableMolecularProfilesExist&&this.nonSelectedProfileDownloadRow(this.props.store.nonSelectedDownloadableMolecularProfilesGroupByName.result),1===this.props.store.studies.result.length&&!i().isEmpty(this.props.store.genericAssayProfilesGroupByProfileIdSuffix.result)&&this.genericAssayProfileDownloadRows(this.props.store.genericAssayProfilesGroupByProfileIdSuffix.result,i().keys(this.props.store.genericAssayDataGroupByProfileIdSuffix.result))))),r.createElement("hr",null),r.createElement("div",{className:Un()["tables-container"],"data-test":"dataDownloadGeneAlterationTable"},r.createElement(On.Z,{title:"Gene Alteration Frequency",isLoading:!1,className:"pull-left forceHeaderStyle h4"}),r.createElement(Fn,{geneAlterationData:this.geneAlterationData.result})),r.createElement("hr",null),r.createElement("div",{className:Un()["tables-container"]},r.createElement(On.Z,{title:"Type of Genetic Alterations Across All Samples",isLoading:!1,className:"pull-left forceHeaderStyle h4"}),r.createElement(ur,{caseAlterationData:this.caseAlterationData.result,oqls:this.oqls.result,trackLabels:this.trackLabels.result,trackAlterationTypesMap:this.trackAlterationTypesMap.result,geneAlterationTypesMap:this.geneAlterationMap.result})));default:return r.createElement(pr.Z,null)}}},{key:"cnaDownloadControls",value:function(){return this.downloadControlsRow("Copy-number Alterations (OQL is not in effect)",this.handleCnaDownload,this.handleTransposedCnaDownload)}},{key:"mutationDownloadControls",value:function(){return this.downloadControlsRow("Mutations (OQL is not in effect)",this.handleMutationDownload,this.handleTransposedMutationDownload)}},{key:"structuralVariantDownloadControls",value:function(){return this.downloadControlsRow("Structural Variants (OQL is not in effect)",this.handleStructuralVariantDownload,this.handleTransposedStructuralVariantDownload)}},{key:"mrnaExprDownloadControls",value:function(e){return this.downloadControlsRow(e,this.handleMrnaDownload,this.handleTransposedMrnaDownload)}},{key:"proteinExprDownloadControls",value:function(e){return this.downloadControlsRow(e,this.handleProteinDownload,this.handleTransposedProteinDownload)}},{key:"downloadControlsRow",value:function(e,t,n){return r.createElement("tr",null,r.createElement("td",{style:{width:500}},e),r.createElement("td",null,r.createElement("a",{onClick:function(n){return t(e)}},r.createElement("i",{className:"fa fa-cloud-download",style:{marginRight:5}}),"Tab Delimited Format"),r.createElement("span",{style:{margin:"0px 10px"}},"|"),r.createElement("a",{onClick:function(t){return n(e)}},r.createElement("i",{className:"fa fa-cloud-download",style:{marginRight:5}}),"Transposed Matrix")))}},{key:"nonSelectedProfileDownloadRow",value:function(e){var t=this,n=i().map(e,(function(e,n){return 1===t.props.store.studies.result.length?{name:n,description:e[0].description}:{name:n}}));return i().map(n,(function(e){return r.createElement("tr",null,r.createElement("td",{style:{width:500}},r.createElement("div",{style:{display:"flex",alignItems:"center"}},e.name,e.description&&r.createElement(w.ZD,{mouseEnterDelay:0,placement:"right",overlay:r.createElement("div",{className:Un().tooltip},e.description)},r.createElement(mr(),{className:Un().infoIcon,name:"info-circle"})))),r.createElement("td",null,r.createElement("div",null,r.createElement("a",{onClick:function(){return t.handleNonSelectedMolecularProfileDownload(e.name)}},r.createElement("i",{className:"fa fa-cloud-download",style:{marginRight:5}}),"Tab Delimited Format"),r.createElement("span",{style:{margin:"0px 10px"}},"|"),r.createElement("a",{onClick:function(){return t.handleTransposedNonSelectedMolecularProfileDownload(e.name)}},r.createElement("i",{className:"fa fa-cloud-download",style:{marginRight:5}}),"Transposed Matrix"))))}))}},{key:"genericAssayProfileDownloadRows",value:function(e,t){var n=this,o=i().map(e,(function(e,t){var n=e[0];return{name:n.name,description:n.description,profileIdSuffix:t}}));return i().map(o,(function(e){return r.createElement("tr",null,r.createElement("td",{style:{width:500}},r.createElement("div",{style:{display:"flex",alignItems:"center"}},e.name,e.description&&r.createElement(w.ZD,{mouseEnterDelay:0,placement:"right",overlay:r.createElement("div",{className:Un().tooltip},e.description)},r.createElement(mr(),{className:Un().infoIcon,name:"info-circle"})))),r.createElement("td",null,r.createElement("div",null,r.createElement(h.If,{condition:t.includes(e.profileIdSuffix)},r.createElement(h.Then,null,r.createElement("a",{onClick:function(){return n.handleGenericAssayProfileDownload(e.name,e.profileIdSuffix)}},r.createElement("i",{className:"fa fa-cloud-download",style:{marginRight:5}}),"Tab Delimited Format"),r.createElement("span",{style:{margin:"0px 10px"}},"|"),r.createElement("a",{onClick:function(){return n.handleTransposedGenericAssayProfileDownload(e.name,e.profileIdSuffix)}},r.createElement("i",{className:"fa fa-cloud-download",style:{marginRight:5}}),"Transposed Matrix")),r.createElement(h.Else,null,"Tracks added in theÂ ",r.createElement("a",{onClick:function(){return n.props.store.handleTabChange(hr.PC.ONCOPRINT)}},"OncoPrint tab"),"Â can be downloaded here.")))))}))}},{key:"copyDownloadControlsRow",value:function(e,t,n){return r.createElement("tr",null,r.createElement("td",null,e),r.createElement("td",null,r.createElement(kn.h,{controlsStyle:"LINK",downloadData:t,downloadFilename:n})))}},{key:"copyDownloadQueryControlsRow",value:function(e,t,n,o,i){return r.createElement("tr",null,r.createElement("td",null,e),r.createElement("td",null,r.createElement(kn.h,{controlsStyle:"QUERY",downloadData:t,downloadFilename:n,handleQuery:o,virtualStudyParams:i})))}},{key:"alteredSamplesDownloadControls",value:function(e,t){var n=this,r=i().map(e,(function(e){return"".concat(e.studyId,":").concat(e.sampleId)})),o="".concat(r.length," altered samples from:\n\n");t.studyWithSamples.forEach((function(e){o+=e.name+"\n"}));var a={user:t.user,name:t.name,description:o,studyWithSamples:t.studyWithSamples,selectedSamples:i().filter(t.selectedSamples,(function(e){return r.includes("".concat(e.studyId,":").concat(e.sampleId))})),filter:t.filter,attributesMetaSet:t.attributesMetaSet};return this.copyDownloadQueryControlsRow("Altered samples",(function(){return r.join("\n")}),"altered_samples.txt",(function(){return n.handleQueryButtonClick(r)}),a)}},{key:"unalteredSamplesDownloadControls",value:function(e,t){var n=this,r=i().map(e,(function(e){return"".concat(e.studyId,":").concat(e.sampleId)})),o="".concat(r.length," unaltered samples from:\n\n");t.studyWithSamples.forEach((function(e){o+=e.name+"\n"}));var a={user:t.user,name:t.name,description:o,studyWithSamples:t.studyWithSamples,selectedSamples:i().filter(t.selectedSamples,(function(e){return r.includes("".concat(e.studyId,":").concat(e.sampleId))})),filter:t.filter,attributesMetaSet:t.attributesMetaSet};return this.copyDownloadQueryControlsRow("Unaltered samples",(function(){return r.join("\n")}),"unaltered_samples.txt",(function(){return n.handleQueryButtonClick(r)}),a)}},{key:"sampleMatrixDownloadControls",value:function(e){return this.copyDownloadControlsRow("Sample matrix: List of all samples where 1=altered and 0=unaltered",(function(){return e}),"sample_matrix.txt")}},{key:"handleMutationDownload",value:function(){(0,w.XE)(this.mutationDownloadData,(function(e){var t=(0,cr.Nk)(e);Tn()(t,"mutations.txt")}))}},{key:"handleTransposedMutationDownload",value:function(){(0,w.XE)(this.mutationDownloadData,(function(e){var t=(0,cr.Nk)((0,cr.TJ)(e));Tn()(t,"mutations_transposed.txt")}))}},{key:"handleStructuralVariantDownload",value:function(){(0,w.XE)(this.structuralVariantDownloadData,(function(e){var t=(0,cr.Nk)(e);Tn()(t,"structural_variants.txt")}))}},{key:"handleTransposedStructuralVariantDownload",value:function(){(0,w.XE)(this.structuralVariantDownloadData,(function(e){var t=(0,cr.Nk)((0,cr.TJ)(e));Tn()(t,"structural_variants_transposed.txt")}))}},{key:"handleMrnaDownload",value:function(e){(0,w.XE)(this.mrnaDownloadData,(function(t){var n=(0,cr.Nk)(t);Tn()(n,"".concat(e,".txt"))}))}},{key:"handleTransposedMrnaDownload",value:function(e){(0,w.XE)(this.mrnaDownloadData,(function(t){var n=(0,cr.Nk)((0,cr.TJ)(t));Tn()(n,"".concat(e,".txt"))}))}},{key:"handleProteinDownload",value:function(e){(0,w.XE)(this.proteinDownloadData,(function(t){var n=(0,cr.Nk)(t);Tn()(n,"".concat(e,".txt"))}))}},{key:"handleTransposedProteinDownload",value:function(e){(0,w.XE)(this.proteinDownloadData,(function(t){var n=(0,cr.Nk)((0,cr.TJ)(t));Tn()(n,"".concat(e,".txt"))}))}},{key:"handleCnaDownload",value:function(){(0,w.XE)(this.cnaDownloadData,(function(e){var t=(0,cr.Nk)(e);Tn()(t,"cna.txt")}))}},{key:"handleTransposedCnaDownload",value:function(){(0,w.XE)(this.cnaDownloadData,(function(e){var t=(0,cr.Nk)((0,cr.TJ)(e));Tn()(t,"cna_transposed.txt")}))}},{key:"handleNonSelectedMolecularProfileDownload",value:function(e){(0,w.XE)([this.props.store.nonSelectedDownloadableMolecularProfiles,this.props.store.samples,this.props.store.genes],(function(t,n,r){var o=t.filter((function(t){return t.name===e}));(0,cr.cO)(e,o,n,r)}))}},{key:"handleTransposedNonSelectedMolecularProfileDownload",value:function(e){(0,w.XE)([this.props.store.nonSelectedDownloadableMolecularProfiles,this.props.store.samples,this.props.store.genes],(function(t,n,r){var o=t.filter((function(t){return t.name===e}));(0,cr.cO)(e,o,n,r,!0)}))}},{key:"handleGenericAssayProfileDownload",value:function(e,t){(0,w.XE)(this.genericAssayProfileDownloadDataGroupByProfileIdSuffix,(function(n){var r=(0,cr.oC)(n);Tn()(r[t],"".concat(e,".txt"))}))}},{key:"handleTransposedGenericAssayProfileDownload",value:function(e,t){(0,w.XE)(this.genericAssayProfileDownloadDataGroupByProfileIdSuffix,(function(n){var r=(0,cr.oC)((0,cr.q)(n));Tn()(r[t],"".concat(e,".txt"))}))}},{key:"handleQueryButtonClick",value:function(e){var t={selectedSampleListId:dr.K1,selectedSampleIds:e,caseIdsMode:"sample"};this.props.store.modifyQueryParams=t,this.props.store.queryFormVisible=!0}}])&&br(n.prototype,o),a&&br(n,a),t}(r.Component);Er([S.default],wr.prototype,"handleStructuralVariantDownload",null),Er([S.default],wr.prototype,"handleTransposedStructuralVariantDownload",null),Er([S.default],wr.prototype,"handleNonSelectedMolecularProfileDownload",null),Er([S.default],wr.prototype,"handleTransposedNonSelectedMolecularProfileDownload",null),Er([S.default],wr.prototype,"handleGenericAssayProfileDownload",null),Er([S.default],wr.prototype,"handleTransposedGenericAssayProfileDownload",null),Er([c.action],wr.prototype,"handleQueryButtonClick",null);const Tr=wr=Er([u.observer],wr);var Pr=n(32434),Or=n(5374),kr=n(86002),Ar=n(54721);function Ir(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _r(e){return(_r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Dr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xr(e,t){return(xr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Mr(e){return(Mr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Nr=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":Mr(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Lr=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=function(e,t){return!t||"object"!==Mr(t)&&"function"!=typeof t?Dr(e):t}(this,_r(t).call(this,e)),Object.defineProperty(Dr(n),"renderingComplete",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Dr(n),"selectedLocus",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Dr(n),"segmentTrackMaxHeight",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Dr(n),"chromosome",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[n.props.store.hugoGeneSymbolToReferenceGene]},invoke:function(){return Promise.resolve(n.props.store.hugoGeneSymbolToReferenceGene.result[n.activeLocus].chromosome)}})}),(0,c.makeObservable)(Dr(n)),n.segmentTrackMaxHeight=.7*E.Z.size.height,n}var n,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xr(e,t)}(t,e),n=t,(o=[{key:"render",value:function(){var e=this;return r.createElement("div",{className:"pillTabs"},r.createElement(ee.Z,{isLoading:this.isHidden,size:"big",center:!0},r.createElement(Ar.Z,{getItems:function(){return e.progressItems},show:this.isHidden,sequential:!0})),r.createElement(Or.Z,{promise:this.props.store.cnSegments,filename:this.filename}),r.createElement("div",{className:"tabMessageContainer"},r.createElement(ue.Z,{store:this.props.store})),r.createElement(f.Nav,{bsStyle:"pills",activeKey:this.activeLocus,onSelect:this.onTabSelect},r.createElement(f.NavItem,{eventKey:kr.jt},"Whole Genome"),this.props.store.genes.result&&this.props.store.genes.result.map((function(e){return r.createElement(f.NavItem,{eventKey:e.hugoGeneSymbol},e.hugoGeneSymbol)}))),this.tooManySamplesForWholeGenome&&r.createElement("span",null,"Too many samples (",">".concat(this.props.sampleThreshold),") for the whole genome view. Try to select a different sample list."),r.createElement("div",{style:this.isHidden||this.tooManySamplesForWholeGenome?{opacity:0}:void 0},r.createElement(Pr.Z,{tracks:[Object.assign(Object.assign({},(0,kr.O4)()),{height:this.segmentTrackHeight,features:this.features})],genome:this.props.store.referenceGenome,locus:this.activeLocus,onRenderingStart:this.onIgvRenderingStart,onRenderingComplete:this.onIgvRenderingComplete,disableSearch:this.activeLocus!==kr.jt,isVisible:this.props.store.tabId===hr.PC.CN_SEGMENTS&&!this.isHidden&&!this.tooManySamplesForWholeGenome})))}},{key:"onTabSelect",value:function(e){this.selectedLocus=e}},{key:"onIgvRenderingStart",value:function(){this.renderingComplete=!1}},{key:"onIgvRenderingComplete",value:function(){this.renderingComplete=!0}},{key:"segmentTrackHeight",get:function(){return(0,kr.SG)(this.features,this.segmentTrackMaxHeight)}},{key:"activeLocus",get:function(){var e=this.selectedLocus;return e||(e=this.props.store.genes.result?this.props.store.genes.result[0].hugoGeneSymbol:kr.jt),e}},{key:"features",get:function(){var e=this.activePromise&&this.activePromise.result||[];return(0,kr.cG)(e)}},{key:"filename",get:function(){return"".concat(this.props.store.downloadFilenamePrefix,"segments.seg")}},{key:"isHidden",get:function(){return this.isLoading||!this.renderingComplete}},{key:"isSampleCountWithinThreshold",get:function(){return!this.props.store.filteredSamples.result||!this.props.sampleThreshold||this.props.store.filteredSamples.result.length<=this.props.sampleThreshold}},{key:"tooManySamplesForWholeGenome",get:function(){return this.activeLocus===kr.jt&&!this.isSampleCountWithinThreshold}},{key:"isLoading",get:function(){return!this.tooManySamplesForWholeGenome&&(!this.activePromise||this.activePromise.isPending)}},{key:"activePromise",get:function(){return this.activeLocus===kr.jt?this.props.store.filteredSamples.result&&this.isSampleCountWithinThreshold?this.props.store.cnSegments:void 0:this.props.store.cnSegmentsByChromosome.result&&this.chromosome?this.props.store.cnSegmentsByChromosome.result[this.chromosome.result]:void 0}},{key:"indicatorPromises",get:function(){var e=[this.props.store.studies,this.props.store.genes];return this.activeLocus!==kr.jt&&e.push(this.props.store.cnSegmentsByChromosome),this.activePromise&&e.push(this.activePromise),e}},{key:"progressItems",get:function(){return[{label:"Loading copy number segments data...",promises:this.indicatorPromises},{label:"Rendering"}]}}])&&Ir(n.prototype,o),i&&Ir(n,i),t}(r.Component);Object.defineProperty(Lr,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{sampleThreshold:2e4}}),Nr([c.observable],Lr.prototype,"renderingComplete",void 0),Nr([c.observable.ref],Lr.prototype,"selectedLocus",void 0),Nr([c.observable],Lr.prototype,"segmentTrackMaxHeight",void 0),Nr([c.computed],Lr.prototype,"segmentTrackHeight",null),Nr([c.computed],Lr.prototype,"activeLocus",null),Nr([c.computed],Lr.prototype,"features",null),Nr([c.computed],Lr.prototype,"filename",null),Nr([c.computed],Lr.prototype,"isHidden",null),Nr([c.computed],Lr.prototype,"isSampleCountWithinThreshold",null),Nr([c.computed],Lr.prototype,"tooManySamplesForWholeGenome",null),Nr([c.computed],Lr.prototype,"isLoading",null),Nr([c.computed],Lr.prototype,"activePromise",null),Nr([c.computed],Lr.prototype,"indicatorPromises",null),Nr([c.computed],Lr.prototype,"progressItems",null),Nr([c.action.bound],Lr.prototype,"onTabSelect",null),Nr([c.action.bound],Lr.prototype,"onIgvRenderingStart",null),Nr([c.action.bound],Lr.prototype,"onIgvRenderingComplete",null);const Rr=Lr=Nr([u.observer],Lr);var jr=n(33986);const Gr=function(e){var t=e.message,n=t!==e.loadingMessage;return r.createElement("div",{"data-test":"pathwayMapperMessageBox",className:"alert "+(n?"alert-warning":"alert-success"),style:{marginLeft:"1%",marginBottom:"0px",marginTop:"5px",color:"black",maxHeight:"32px",overflowY:"auto",display:0==t.length?"none":"block"}},r.createElement("button",{type:"button",className:"close",onClick:e.onClearMessage},r.createElement(mr(),{name:"times"})),n&&r.createElement("i",{className:"fa fa-md fa-exclamation-triangle",style:{marginRight:"6px",marginBottom:"1px"}}),t)};var Vr=n(4098),Fr=n(80686);function Br(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qr(e){return(qr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ur(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Hr(e,t){return(Hr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Wr(e){return(Wr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Yr=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":Wr(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Kr=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))},Qr="Loading alteration data...",Xr=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==Wr(t)&&"function"!=typeof t?Ur(e):t}(this,qr(t).call(this,e)),Object.defineProperty(Ur(r),"accumulatedAlterationFrequencyDataForNonQueryGenes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Ur(r),"accumulatedValidGenes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Ur(r),"selectedPathway",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(Ur(r),"newGenesFromPathway",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Ur(r),"warningMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Ur(r),"validNonQueryGenes",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({invoke:function(){return Kr(Ur(r),void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,Vr.Kn)(this.newGenesFromPathway);case 2:return t=e.sent,e.abrupt("return",t.map((function(e){return e.hugoGeneSymbol})));case 4:case"end":return e.stop()}}),e,this)})))}})}),Object.defineProperty(Ur(r),"addGenomicData",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Ur(r),"PathwayMapperComponent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),(0,c.makeObservable)(Ur(r)),r.accumulatedValidGenes={},r.accumulatedAlterationFrequencyDataForNonQueryGenes=[],Promise.all([n.e(524),n.e(771)]).then(n.t.bind(n,93524,23)).then((function(e){r.PathwayMapperComponent=e.default})),r}var o,a,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hr(e,t)}(t,e),o=t,(a=[{key:"render",value:function(){return this.isNewStoreReady&&this.addGenomicData(this.alterationFrequencyData),this.PathwayMapperComponent?r.createElement("div",{className:"pathwayMapper"},r.createElement("div",{"data-test":"pathwayMapperTabDiv",className:"cBioMode",style:{width:"99%"}},r.createElement(f.Row,null,r.createElement(r.Fragment,null,r.createElement(oe.Z,{className:"coexp-oql-status-banner",store:this.props.store,tabReflectsOql:!0}),r.createElement(this.PathwayMapperComponent,{isCBioPortal:!0,isCollaborative:!1,genes:this.props.store.genes.result,cBioAlterationData:this.alterationFrequencyData,onAddGenes:this.handleAddGenes,changePathwayHandler:this.handlePathwayChange,addGenomicDataHandler:this.addGenomicDataHandler,messageBanner:this.renderBanner,tableComponent:this.renderTable,validGenes:this.validGenes,showMessage:this.updateMessage}))))):null}},{key:"addGenomicDataHandler",value:function(e){this.addGenomicData=e}},{key:"handlePathwayChange",value:function(e){this.newGenesFromPathway=e}},{key:"handleAddGenes",value:function(e){(0,hr.AO)(this.props.urlWrapper,e)}},{key:"updateMessage",value:function(e){this.warningMessage=e}},{key:"clearMessage",value:function(){this.warningMessage=null}},{key:"renderBanner",value:function(){return r.createElement(Gr,{message:this.message,loadingMessage:Qr,onClearMessage:this.clearMessage})}},{key:"renderTable",value:function(e,t,n){return r.createElement(jr.ZP,{data:e,selectedPathway:t,changePathway:n,onSelectedPathwayChange:this.clearMessage})}},{key:"alterationFrequencyData",get:function(){return this.alterationFrequencyDataForQueryGenes.concat(this.alterationFrequencyDataForNonQueryGenes)}},{key:"message",get:function(){return this.isNewStoreReady&&this.warningMessage===Qr?"":!this.isNewStoreReady&&this.validNonQueryGenes.isComplete&&this.validNonQueryGenes.result.length>0?Qr:this.warningMessage?this.warningMessage:""}},{key:"alterationFrequencyDataForQueryGenes",get:function(){var e=this,t=[];return this.props.store.oqlFilteredCaseAggregatedDataByUnflattenedOQLLine.result.forEach((function(n){var r=(0,Fr.DA)(e.props.store.samples.result,e.props.store.patients.result,e.props.store.coverageInformation.result,e.props.store.filteredSequencedSampleKeysByGene.result,e.props.store.filteredSequencedPatientKeysByGene.result,e.props.store.selectedMolecularProfiles.result,n,!0,e.props.store.genes.result);r&&t.push(r)})),t}},{key:"alterationFrequencyDataForNonQueryGenes",get:function(){var e=this,t=[];return this.isNewStoreReady&&this.storeForAllData.oqlFilteredCaseAggregatedDataByUnflattenedOQLLine.result.forEach((function(n){var r=(0,Fr.DA)(e.storeForAllData.samples.result,e.storeForAllData.patients.result,e.storeForAllData.coverageInformation.result,e.storeForAllData.filteredSequencedSampleKeysByGene.result,e.storeForAllData.filteredSequencedPatientKeysByGene.result,e.storeForAllData.selectedMolecularProfiles.result,n,!1,e.props.store.genes.result);r&&t.push(r)})),this.accumulatedAlterationFrequencyDataForNonQueryGenes=this.accumulatedAlterationFrequencyDataForNonQueryGenes.concat(t),this.accumulatedAlterationFrequencyDataForNonQueryGenes}},{key:"isNewStoreReady",get:function(){return this.storeForAllData&&this.storeForAllData.oqlFilteredCaseAggregatedDataByUnflattenedOQLLine.isComplete&&this.storeForAllData.samples.isComplete&&this.storeForAllData.patients.isComplete&&this.storeForAllData.coverageInformation.isComplete&&this.storeForAllData.filteredSequencedSampleKeysByGene.isComplete&&this.storeForAllData.filteredSequencedPatientKeysByGene.isComplete&&this.storeForAllData.selectedMolecularProfiles.isComplete}},{key:"storeForAllData",get:function(){return!this.urlWrapperForAllGenes||this.urlWrapperForAllGenes.hasSessionId&&this.urlWrapperForAllGenes.remoteSessionData.isPending?void 0:ps(this.props.appStore,this.urlWrapperForAllGenes)}},{key:"urlWrapperForAllGenes",get:function(){var e;if(this.validNonQueryGenes.isComplete&&this.validNonQueryGenes.result.length>0){var t=i().cloneDeep(this.props.urlWrapper.query);t.gene_list=this.validNonQueryGenes.result.join(" "),e={query:t}}return e}},{key:"validGenes",get:function(){var e=this;return this.validNonQueryGenes.isComplete&&this.validNonQueryGenes.result.forEach((function(t){e.accumulatedValidGenes[t]=!0})),this.accumulatedValidGenes}}])&&Br(o.prototype,a),l&&Br(o,l),t}(r.Component);Yr([c.observable],Xr.prototype,"selectedPathway",void 0),Yr([c.observable],Xr.prototype,"newGenesFromPathway",void 0),Yr([c.observable],Xr.prototype,"warningMessage",void 0),Yr([c.observable],Xr.prototype,"addGenomicData",void 0),Yr([c.observable.ref],Xr.prototype,"PathwayMapperComponent",void 0),Yr([c.computed],Xr.prototype,"alterationFrequencyData",null),Yr([c.computed],Xr.prototype,"message",null),Yr([c.computed],Xr.prototype,"alterationFrequencyDataForQueryGenes",null),Yr([c.computed],Xr.prototype,"alterationFrequencyDataForNonQueryGenes",null),Yr([c.computed],Xr.prototype,"isNewStoreReady",null),Yr([c.computed],Xr.prototype,"storeForAllData",null),Yr([c.computed],Xr.prototype,"urlWrapperForAllGenes",null),Yr([c.computed],Xr.prototype,"validGenes",null),Yr([c.action.bound],Xr.prototype,"addGenomicDataHandler",null),Yr([c.action.bound],Xr.prototype,"handlePathwayChange",null),Yr([c.action.bound],Xr.prototype,"handleAddGenes",null),Yr([c.action.bound],Xr.prototype,"updateMessage",null),Yr([c.action.bound],Xr.prototype,"clearMessage",null),Yr([S.default],Xr.prototype,"renderBanner",null),Yr([S.default],Xr.prototype,"renderTable",null);const Zr=Xr=Yr([u.observer],Xr);var zr=n(20947),$r=n(32096),Jr=n(60138);function eo(e,t,n,r,o,i,a,l,s){var u="sample"===l?"SAMPLE_DATA_":"PATIENT_DATA_";Tn()(function(e,t,n,r,o,i,a,l,s){function u(e,t){return"".concat(e," (").concat(t,")")}var c=i.map(a),p={CLINICAL:{},CNA:{},MUTATIONS:{},MRNA:{},PROTEIN:{},STRUCTURAL_VARIANT:{}},d={amp:"Amplification",gain:"Gain",hetloss:"Shallow Deletion",homdel:"Deep Deletion"},f={};f=s?{inframe:"Inframe Mutation (putative passenger)",inframe_rec:"Inframe Mutation (putative driver)",missense:"Missense Mutation (putative passenger)",missense_rec:"Missense Mutation (putative driver)",promoter:"Promoter Mutation",promoter_rec:"Promoter Mutation",trunc:"Truncating mutation (putative passenger)",trunc_rec:"Truncating mutation (putative driver)"}:{inframe:"Inframe Mutation",inframe_rec:"Inframe Mutation",missense:"Missense Mutation",missense_rec:"Missense Mutation",promoter:"Promoter Mutation",promoter_rec:"Promoter Mutation",trunc:"Truncating mutation",trunc_rec:"Truncating mutation"};var m={high:"mRNA High",low:"mRNA Low"},h={low:"Protein Low",high:"Protein High"},y={true:"Structural Variant"},b=!0,g=!1,v=void 0;try{for(var S,C=e[Symbol.iterator]();!(b=(S=C.next()).done);b=!0){var E=S.value.data,w=E[0].trackLabel;void 0===p.CNA[w]&&(p.CNA[w]={}),void 0===p.MUTATIONS[w]&&(p.MUTATIONS[w]={}),void 0===p.MRNA[w]&&(p.MRNA[w]={}),void 0===p.PROTEIN[w]&&(p.PROTEIN[w]={}),void 0===p.STRUCTURAL_VARIANT[w]&&(p.STRUCTURAL_VARIANT[w]={});var T=!0,P=!1,O=void 0;try{for(var k,A=E[Symbol.iterator]();!(T=(k=A.next()).done);T=!0){var I=k.value,_="sample"===l?I.sample:I.patient;p.CNA[w][_]="",p.MUTATIONS[w][_]="",p.MRNA[w][_]="",p.PROTEIN[w][_]="",p.STRUCTURAL_VARIANT[w][_]="",void 0!==I.disp_cna&&(p.CNA[w][_]=d[I.disp_cna]?d[I.disp_cna]:I.disp_cna),void 0!==I.disp_structuralVariant&&(p.STRUCTURAL_VARIANT[w][_]=y[I.disp_structuralVariant+""]?y[I.disp_structuralVariant+""]:I.disp_structuralVariant),void 0!==I.disp_mrna&&(p.MRNA[w][_]=m[I.disp_mrna]?m[I.disp_mrna]:I.disp_mrna),void 0!==I.disp_prot&&(p.PROTEIN[w][_]=h[I.disp_prot]?h[I.disp_prot]:I.disp_prot),void 0!==I.disp_mut&&(p.MUTATIONS[w][_]=f[I.disp_mut]?f[I.disp_mut]:I.disp_mut)}}catch(e){P=!0,O=e}finally{try{T||null==A.return||A.return()}finally{if(P)throw O}}}}catch(e){g=!0,v=e}finally{try{b||null==C.return||C.return()}finally{if(g)throw v}}var D=!0,x=!1,M=void 0;try{for(var N,L=t[Symbol.iterator]();!(D=(N=L.next()).done);D=!0){var R=N.value,j=R.data,G=R.label;if("counts"===R.datatype){var V=!0,F=!1,B=void 0;try{for(var q,U=R.countsCategoryLabels[Symbol.iterator]();!(V=(q=U.next()).done);V=!0){var H=u(G,q.value);p.CLINICAL[H]=p.CLINICAL[H]||{}}}catch(e){F=!0,B=e}finally{try{V||null==U.return||U.return()}finally{if(F)throw B}}}else void 0===p.CLINICAL[G]&&(p.CLINICAL[G]={});var W=!0,Y=!1,K=void 0;try{for(var Q,X=j[Symbol.iterator]();!(W=(Q=X.next()).done);W=!0){var Z=Q.value,z="sample"===l?Z.sample:Z.patient;if("counts"===R.datatype){var $=!0,J=!1,ee=void 0;try{for(var te,ne=R.countsCategoryLabels[Symbol.iterator]();!($=(te=ne.next()).done);$=!0){var re=te.value;p.CLINICAL[u(G,re)][z]=Z.attr_val?Z.attr_val[re]:""}}catch(e){J=!0,ee=e}finally{try{$||null==ne.return||ne.return()}finally{if(J)throw ee}}}else p.CLINICAL[G][z]="",p.CLINICAL[G][z]=(0,Jr.Z)(Z.attr_val,"")}}catch(e){Y=!0,K=e}finally{try{W||null==X.return||X.return()}finally{if(Y)throw K}}}}catch(e){x=!0,M=e}finally{try{D||null==L.return||L.return()}finally{if(x)throw M}}var oe=n.concat(r).concat(o),ie=!0,ae=!1,le=void 0;try{for(var se,ue=oe[Symbol.iterator]();!(ie=(se=ue.next()).done);ie=!0){var ce=se.value,pe=ce.label,de="HEATMAP "+ce.molecularAlterationType+" "+ce.datatype,fe=ce.data,me=!0,he=!1,ye=void 0;try{for(var be,ge=fe[Symbol.iterator]();!(me=(be=ge.next()).done);me=!0){var ve=be.value;void 0===p[de]&&(p[de]={}),void 0===p[de][pe]&&(p[de][pe]={});var Se="sample"===l?ve.sample:ve.patient;p[de][pe][Se]=null===ve.profile_data?"":ve.profile_data}}catch(e){he=!0,ye=e}finally{try{me||null==ge.return||ge.return()}finally{if(he)throw ye}}}}catch(e){ae=!0,le=e}finally{try{ie||null==ue.return||ue.return()}finally{if(ae)throw le}}for(var Ce="track_name\ttrack_type",Ee=0;Ee<c.length;Ee++)Ce+="\t"+c[Ee];return Ce+="\n",Object.keys(p).forEach((function(e){Object.keys(p[e]).forEach((function(t){Ce+=t+"\t"+e;for(var n=0;n<c.length;n++)Ce+="\t"+p[e][t][c[n]];Ce+="\n"}))})),Ce}(e,t,n,r,o,i,a,l,s),u+"oncoprint.tsv")}var to=n(4377),no=n(34965),ro=n(3335),oo=n(92421),io=n(22872),ao=n(63276),lo={missense:p.YK.MUTATION_EXTENDED,inframe:p.YK.MUTATION_EXTENDED,structuralVariant:p.YK.STRUCTURAL_VARIANT,promoter:p.YK.MUTATION_EXTENDED,trunc:p.YK.MUTATION_EXTENDED,splice:p.YK.MUTATION_EXTENDED,other:p.YK.MUTATION_EXTENDED,amp:p.YK.COPY_NUMBER_ALTERATION,homdel:p.YK.COPY_NUMBER_ALTERATION,gain:p.YK.COPY_NUMBER_ALTERATION,hetloss:p.YK.COPY_NUMBER_ALTERATION,mrnaHigh:p.YK.MRNA_EXPRESSION,mrnaLow:p.YK.MRNA_EXPRESSION,protHigh:p.YK.PROTEIN_LEVEL,protLow:p.YK.PROTEIN_LEVEL};function so(e,t,n){var r=function(e){var t=null;switch(e.molecularProfileAlterationType){case p.YK.MUTATION_EXTENDED:t=(0,oo.JJ)(e);break;case p.YK.STRUCTURAL_VARIANT:t="structuralVariant";break;case p.YK.COPY_NUMBER_ALTERATION:t=io.Lm[e.value];break;case p.YK.MRNA_EXPRESSION:"high"===e.alterationSubType?t="mrnaHigh":"low"===e.alterationSubType&&(t="mrnaLow");break;case p.YK.PROTEIN_LEVEL:"high"===e.alterationSubType?t="protHigh":"low"===e.alterationSubType&&(t="protLow")}return t}(e);if(r){var o={};return o.sampleId=n,o.hugoGeneSymbol=e.hugoGeneSymbol,o.trackName=t,o.alteration=r,o.proteinChange=e.proteinChange,o.eventInfo=e.eventInfo,o.isGermline=!(0,we.cn)(e),o.isCustomDriver=e.driverFilter===Vr.U1,o}return{sampleId:n}}function uo(e){var t=[e.sampleId];if((0,ro.TM)(e)){switch(t.push(e.hugoGeneSymbol),lo[e.alteration]){case p.YK.MUTATION_EXTENDED:t.push(e.proteinChange||"mutation"),t.push(e.alteration.toUpperCase()+(e.isGermline?"_GERMLINE":"")+(e.isCustomDriver?"_DRIVER":""));break;case p.YK.COPY_NUMBER_ALTERATION:t.push(e.alteration.toUpperCase()),t.push("CNA");break;case p.YK.MRNA_EXPRESSION:t.push("mrnaHigh"===e.alteration?"HIGH":"LOW"),t.push("EXP");break;case p.YK.PROTEIN_LEVEL:t.push("protHigh"===e.alteration?"HIGH":"LOW"),t.push("PROT");break;case p.YK.STRUCTURAL_VARIANT:t.push(e.eventInfo||"structural_variant"),t.push("FUSION")}e.trackName&&t.push(e.trackName)}return t.map(co).join("  ")}function co(e){return e.replace(/\s+/g,"_")}function po(e){return e.replace(/[()]/g,"").replace(/\s+/g,"_")}function fo(e,t,n){var r=i().mapValues(i().keyBy(e,(function(e){return e.key})),(function(e){return i().keyBy(e.data,(function(e){return e[n]}))})),o=[];o.push(["Sample"].concat(e.map((function(e){return"".concat(po("".concat(e.label,"_").concat(e.molecularProfileName)),"(").concat(function(e,t){if(/zscores/i.test(e))return ao.UK.HEATMAP_ZSCORE;switch(t){case p.YK.METHYLATION:return ao.UK.HEATMAP_01;default:return ao.UK.HEATMAP}}(e.molecularProfileId,e.molecularAlterationType),")")}))));var a=!0,l=!1,s=void 0;try{for(var u,c=function(){var t=u.value;o.push([t].concat(e.map((function(e){var n=r[e.key][t];return!n||n.na||null===n.profile_data||isNaN(n.profile_data)?ao.Wp:n.profile_data}))))},d=t[Symbol.iterator]();!(a=(u=d.next()).done);a=!0)c()}catch(e){l=!0,s=e}finally{try{a||null==d.return||d.return()}finally{if(l)throw s}}return o.map((function(e){return e.join("  ")})).join("\n")}function mo(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ho(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yo(e){return(yo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function bo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function go(e,t){return(go=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vo(e){return(vo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var So,Co=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":vo(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Eo=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))};!function(e){e.CASE_ID="case_id",e.CASE_LIST="case_list",e.NONE=""}(So||(So={}));var wo="CLINICALTRACK_",To=function(e){function t(e){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=function(e,t){return!t||"object"!==vo(t)&&"function"!=typeof t?bo(e):t}(this,yo(t).call(this,e)),Object.defineProperty(bo(n),"distinguishGermlineMutations",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(bo(n),"distinguishMutationType",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(bo(n),"showUnalteredColumns",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(bo(n),"showWhitespaceBetweenColumns",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(bo(n),"showClinicalTrackLegends",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(bo(n),"_onlyShowClinicalLegendForAlteredCases",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(bo(n),"showOqlInLabels",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(bo(n),"showMinimap",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(bo(n),"selectedHeatmapProfileId",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(bo(n),"heatmapGeneInputValue",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(bo(n),"selectedGenericAssayProfileId",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(bo(n),"horzZoom",{enumerable:!0,configurable:!0,writable:!0,value:.5}),Object.defineProperty(bo(n),"mouseInsideBounds",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(bo(n),"renderingComplete",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(bo(n),"heatmapGeneInputValueUpdater",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(bo(n),"molecularProfileIdToTrackGroupIndex",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(bo(n),"expansionsByGeneticTrackKey",{enumerable:!0,configurable:!0,writable:!0,value:c.observable.map()}),Object.defineProperty(bo(n),"expansionsByGenesetHeatmapTrackKey",{enumerable:!0,configurable:!0,writable:!0,value:c.observable.map()}),Object.defineProperty(bo(n),"controlsHandlers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(bo(n),"controlsState",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(bo(n),"oncoprint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(bo(n),"urlParamsReaction",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(bo(n),"unalteredKeys",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[n.geneticTracks]},invoke:function(){return Eo(bo(n),void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,Fr.KD)(this.geneticTracks.result));case 1:case"end":return e.stop()}}),e,this)})))}})}),Object.defineProperty(bo(n),"alteredKeys",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[n.geneticTracks]},invoke:function(){return Eo(bo(n),void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,Fr.pM)(this.geneticTracks.result));case 1:case"end":return e.stop()}}),e,this)})))},default:[]})}),Object.defineProperty(bo(n),"sampleGeneticTracks",{enumerable:!0,configurable:!0,writable:!0,value:(0,Fr.dk)(bo(n),!0)}),Object.defineProperty(bo(n),"patientGeneticTracks",{enumerable:!0,configurable:!0,writable:!0,value:(0,Fr.dk)(bo(n),!1)}),Object.defineProperty(bo(n),"sampleClinicalTracks",{enumerable:!0,configurable:!0,writable:!0,value:(0,Fr.fE)(bo(n),!0)}),Object.defineProperty(bo(n),"patientClinicalTracks",{enumerable:!0,configurable:!0,writable:!0,value:(0,Fr.fE)(bo(n),!1)}),Object.defineProperty(bo(n),"sampleHeatmapTracks",{enumerable:!0,configurable:!0,writable:!0,value:(0,Fr.Qo)(bo(n),!0)}),Object.defineProperty(bo(n),"patientHeatmapTracks",{enumerable:!0,configurable:!0,writable:!0,value:(0,Fr.Qo)(bo(n),!1)}),Object.defineProperty(bo(n),"samplegGenericAssayHeatmapTracks",{enumerable:!0,configurable:!0,writable:!0,value:(0,Fr.oQ)(bo(n),!0)}),Object.defineProperty(bo(n),"patientGenericAssayHeatmapTracks",{enumerable:!0,configurable:!0,writable:!0,value:(0,Fr.oQ)(bo(n),!1)}),Object.defineProperty(bo(n),"sampleGenericAssayCategoricalTracks",{enumerable:!0,configurable:!0,writable:!0,value:(0,Fr.O9)(bo(n),!0)}),Object.defineProperty(bo(n),"patientGenericAssayCategoricalTracks",{enumerable:!0,configurable:!0,writable:!0,value:(0,Fr.O9)(bo(n),!1)}),Object.defineProperty(bo(n),"sampleGenesetHeatmapTracks",{enumerable:!0,configurable:!0,writable:!0,value:(0,Fr.gm)(bo(n),!0,(0,Fr.Gf)(bo(n),!0))}),Object.defineProperty(bo(n),"patientGenesetHeatmapTracks",{enumerable:!0,configurable:!0,writable:!0,value:(0,Fr.gm)(bo(n),!1,(0,Fr.Gf)(bo(n),!1))}),Object.defineProperty(bo(n),"additionalTrackGroupHeaders",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[n.props.store.molecularProfileIdToMolecularProfile]},invoke:function(){return Promise.resolve((0,no.zA)(n.props.store.molecularProfileIdToMolecularProfile.result,n.molecularProfileIdToAdditionalTracks,n.genesetHeatmapTrackGroupIndex,(function(){return n.clusteredHeatmapTrackGroupIndex}),n.clusterHeatmapByIndex,(function(){return n.sortByData()}),n.removeAdditionalTrackSection))},default:{}})}),Object.defineProperty(bo(n),"alterationTypesInQuery",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[n.props.store.selectedMolecularProfiles]},invoke:function(){return Promise.resolve(i().uniq(n.props.store.selectedMolecularProfiles.result.map((function(e){return e.molecularAlterationType}))))}})}),Object.defineProperty(bo(n),"loadingGeneticDataDuringCurrentLoad",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(bo(n),"loadingClinicalDataDuringCurrentLoad",{enumerable:!0,configurable:!0,writable:!0,value:!1}),(0,c.makeObservable)(bo(n)),n.showOqlInLabels=e.store.queryContainsOql,window.resultsViewOncoprint=bo(n);var r=bo(n);return n.onChangeSelectedClinicalTracks=n.onChangeSelectedClinicalTracks.bind(bo(n)),n.onDeleteClinicalTrack=n.onDeleteClinicalTrack.bind(bo(n)),n.onMinimapClose=n.onMinimapClose.bind(bo(n)),n.oncoprintRef=n.oncoprintRef.bind(bo(n)),n.toggleColumnMode=n.toggleColumnMode.bind(bo(n)),n.onTrackSortDirectionChange=n.onTrackSortDirectionChange.bind(bo(n)),n.onSuppressRendering=n.onSuppressRendering.bind(bo(n)),n.onReleaseRendering=n.onReleaseRendering.bind(bo(n)),(0,w.XE)(n.props.store.heatmapMolecularProfiles,(function(e){e.length&&(n.selectedHeatmapProfileId=e[0].molecularProfileId)})),n.heatmapGeneInputValueUpdater=(0,w.XE)(n.props.store.genes,(function(e){n.heatmapGeneInputValue=e.map((function(e){return e.hugoGeneSymbol})).join(" ")}),Number.POSITIVE_INFINITY),n.onMouseEnter=n.onMouseEnter.bind(bo(n)),n.onMouseLeave=n.onMouseLeave.bind(bo(n)),n.controlsHandlers=n.buildControlsHandlers(),n.controlsState=(0,c.observable)({get selectedClinicalAttributeIds(){return Array.from(r.selectedClinicalAttributeIds.keys())},get selectedColumnType(){return r.oncoprintAnalysisCaseType},get showUnalteredColumns(){return r.showUnalteredColumns},get showWhitespaceBetweenColumns(){return r.showWhitespaceBetweenColumns},get showClinicalTrackLegends(){return r.showClinicalTrackLegends},get onlyShowClinicalLegendForAlteredCases(){return r.onlyShowClinicalLegendForAlteredCases},get showOqlInLabels(){return r.showOqlInLabels},get showMinimap(){return r.showMinimap},get hideHeatmapMenu(){return r.props.store.studies.result.length>1},get sortByMutationType(){return r.sortByMutationType},get sortByCaseListDisabled(){return!r.caseListSortPossible},get distinguishMutationType(){return r.distinguishMutationType},get distinguishDrivers(){return r.distinguishDrivers},get distinguishGermlineMutations(){return r.distinguishGermlineMutations},get annotateDriversOncoKb(){return r.props.store.driverAnnotationSettings.oncoKb},get annotateDriversOncoKbDisabled(){return!(0,pn.Ib)().show_oncokb},get annotateDriversOncoKbError(){return r.props.store.didOncoKbFailInOncoprint},get annotateDriversHotspots(){return r.props.store.driverAnnotationSettings.hotspots},get annotateDriversHotspotsDisabled(){return!(0,pn.Ib)().show_hotspot},get annotateDriversHotspotsError(){return r.props.store.didHotspotFailInOncoprint},get annotateDriversCBioPortal(){return r.props.store.driverAnnotationSettings.cbioportalCount},get annotateDriversCOSMIC(){return r.props.store.driverAnnotationSettings.cosmicCount},get hidePutativePassengers(){return!r.props.store.driverAnnotationSettings.includeVUS},get hideGermlineMutations(){return!r.props.store.includeGermlineMutations},get annotateCBioPortalInputValue(){return r.props.store.driverAnnotationSettings.cbioportalCountThreshold+""},get annotateCOSMICInputValue(){return r.props.store.driverAnnotationSettings.cosmicCountThreshold+""},get sortMode(){return r.sortMode},get sortByDrivers(){return r.sortByDrivers},get heatmapProfilesPromise(){return r.props.store.heatmapMolecularProfiles},get genericAssayEntitiesGroupedByGenericAssayTypePromise(){return this.genericAssayPromises.genericAssayEntitiesGroupedByGenericAssayType},get selectedHeatmapProfileId(){return r.selectedHeatmapProfileId},get heatmapIsDynamicallyQueried(){return r.heatmapIsDynamicallyQueried},get ngchmButtonActive(){return!(!(0,pn.Ib)().show_mdacc_heatmap||!r.props.store.remoteNgchmUrl.result||""==r.props.store.remoteNgchmUrl.result)},get heatmapGeneInputValue(){return r.heatmapGeneInputValue},get customDriverAnnotationBinaryMenuLabel(){var e=(0,pn.Ib)().oncoprint_custom_driver_annotation_binary_menu_label,t=r.props.store.customDriverAnnotationReport.result;return e&&t&&t.hasBinary?e:void 0},get customDriverAnnotationTiersMenuLabel(){var e=(0,pn.Ib)().oncoprint_custom_driver_annotation_tiers_menu_label,t=r.props.store.customDriverAnnotationReport.result;return e&&t&&t.tiers.length?e:void 0},get customDriverAnnotationTiers(){var e=r.props.store.customDriverAnnotationReport.result;return e&&e.tiers.length?e.tiers:void 0},get annotateCustomDriverBinary(){return r.props.store.driverAnnotationSettings.customBinary},get selectedCustomDriverAnnotationTiers(){return r.props.store.driverAnnotationSettings.driverTiers},get columnMode(){return r.oncoprintAnalysisCaseType},get horzZoom(){return isNaN(r.horzZoom)?1:r.horzZoom}}),n}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&go(e,t)}(t,e),n=t,(o=[{key:"onMouseEnter",value:function(){this.mouseInsideBounds=!0}},{key:"onMouseLeave",value:function(){this.mouseInsideBounds=!1}},{key:"setAnnotateCBioPortalInputValue",value:function(e){this.controlsHandlers.onChangeAnnotateCBioPortalInputValue&&this.controlsHandlers.onChangeAnnotateCBioPortalInputValue(e)}},{key:"setAnnotateCOSMICInputValue",value:function(e){this.controlsHandlers.onChangeAnnotateCOSMICInputValue&&this.controlsHandlers.onChangeAnnotateCOSMICInputValue(e)}},{key:"buildControlsHandlers",value:function(){var e=this;return{onSelectColumnType:function(t){e.props.store.setOncoprintAnalysisCaseType(t)},onSelectShowUnalteredColumns:function(t){e.showUnalteredColumns=t},onSelectShowWhitespaceBetweenColumns:function(t){e.showWhitespaceBetweenColumns=t},onSelectShowClinicalTrackLegends:function(t){e.showClinicalTrackLegends=t},onSelectOnlyShowClinicalLegendForAlteredCases:function(t){e._onlyShowClinicalLegendForAlteredCases=t},onSelectShowOqlInLabels:function(t){e.showOqlInLabels=t},onSelectShowMinimap:function(t){e.showMinimap=t},onSelectDistinguishMutationType:function(t){e.distinguishMutationType=t},onSelectDistinguishDrivers:(0,c.action)((function(t){t?(e.controlsState.annotateDriversOncoKbDisabled||e.controlsState.annotateDriversOncoKbError||(e.props.store.driverAnnotationSettings.oncoKb=!0),e.controlsState.annotateDriversHotspotsDisabled||e.controlsState.annotateDriversHotspotsError||(e.props.store.driverAnnotationSettings.hotspots=!0),e.props.store.driverAnnotationSettings.cbioportalCount=!0,e.props.store.driverAnnotationSettings.cosmicCount=!0,e.props.store.driverAnnotationSettings.customBinary=!0,e.props.store.driverAnnotationSettings.driverTiers.forEach((function(t,n){e.props.store.driverAnnotationSettings.driverTiers.set(n,!0)}))):(e.props.store.driverAnnotationSettings.oncoKb=!1,e.props.store.driverAnnotationSettings.hotspots=!1,e.props.store.driverAnnotationSettings.cbioportalCount=!1,e.props.store.driverAnnotationSettings.cosmicCount=!1,e.props.store.driverAnnotationSettings.customBinary=!1,e.props.store.driverAnnotationSettings.driverTiers.forEach((function(t,n){e.props.store.driverAnnotationSettings.driverTiers.set(n,!1)})),e.props.store.driverAnnotationSettings.includeVUS=!0)})),onSelectDistinguishGermlineMutations:function(t){e.distinguishGermlineMutations=t},onSelectAnnotateOncoKb:(0,c.action)((function(t){e.props.store.driverAnnotationSettings.oncoKb=t})),onSelectAnnotateHotspots:(0,c.action)((function(t){e.props.store.driverAnnotationSettings.hotspots=t})),onSelectAnnotateCBioPortal:(0,c.action)((function(t){e.props.store.driverAnnotationSettings.cbioportalCount=t})),onSelectAnnotateCOSMIC:(0,c.action)((function(t){e.props.store.driverAnnotationSettings.cosmicCount=t})),onChangeAnnotateCBioPortalInputValue:(0,c.action)((function(t){e.props.store.driverAnnotationSettings.cbioportalCountThreshold=parseInt(t,10),e.controlsHandlers.onSelectAnnotateCBioPortal&&e.controlsHandlers.onSelectAnnotateCBioPortal(!0)})),onChangeAnnotateCOSMICInputValue:(0,c.action)((function(t){e.props.store.driverAnnotationSettings.cosmicCountThreshold=parseInt(t,10),e.controlsHandlers.onSelectAnnotateCOSMIC&&e.controlsHandlers.onSelectAnnotateCOSMIC(!0)})),onSelectCustomDriverAnnotationBinary:(0,c.action)((function(t){e.props.store.driverAnnotationSettings.customBinary=t})),onSelectCustomDriverAnnotationTier:(0,c.action)((function(t,n){e.props.store.driverAnnotationSettings.driverTiers.set(t,n)})),onSelectHideVUS:function(t){e.props.store.driverAnnotationSettings.includeVUS=!t},onSelectHideGermlineMutations:function(t){e.props.store.setExcludeGermlineMutations(t)},onSelectSortByMutationType:function(t){e.urlWrapper.updateURL({oncoprint_sort_by_mutation_type:t.toString()})},onClickSortAlphabetical:function(){e.urlWrapper.updateURL({oncoprint_sortby:"case_id",oncoprint_cluster_profile:""})},onClickSortCaseListOrder:function(){e.urlWrapper.updateURL({oncoprint_sortby:"case_list",oncoprint_cluster_profile:""})},onSelectSortByDrivers:function(t){e.urlWrapper.updateURL({oncoprint_sort_by_drivers:t.toString()})},onClickSortByData:function(){e.urlWrapper.updateURL({oncoprint_sortby:"",oncoprint_cluster_profile:""})},onChangeSelectedClinicalTracks:this.onChangeSelectedClinicalTracks,onChangeHeatmapGeneInputValue:(0,c.action)((function(t){e.heatmapGeneInputValue=t,e.heatmapGeneInputValueUpdater()})),onSelectHeatmapProfile:function(t){e.selectedHeatmapProfileId=t},onClickAddGenesToHeatmap:function(){var t=(0,Kn.O$)(e.heatmapGeneInputValue.toUpperCase().trim()).map((function(e){return e.gene}));e.setHeatmapTracks(e.selectedHeatmapProfileId,t)},onSelectGenericAssayProfile:function(t){e.selectedGenericAssayProfileId=t},onClickAddGenericAssays:function(t){e.setGenericAssayTracks(e.selectedGenericAssayProfileId,t.map((function(e){return e.genericAssayEntityId})))},onClickNGCHM:function(){window.open(e.props.store.remoteNgchmUrl.result,"_blank")},onClickDownload:function(t){switch(t){case"pdf":(0,w.N7)("oncoprint.pdf",e.oncoprint.toSVG(!1));break;case"png":e.oncoprint.toCanvas((function(e,t){e.toBlob((function(n){t&&alert("Oncoprint too large - PNG truncated to ".concat(e.getAttribute("width"),"x").concat(e.getAttribute("height"))),Tn()(n,"oncoprint.png")}))}),2);break;case"svg":Tn()((new XMLSerializer).serializeToString(e.oncoprint.toSVG(!1)),"oncoprint.svg");break;case"order":var n=(0,w.kC)(e.oncoprintAnalysisCaseType);(0,w.XE)([e.props.store.sampleKeyToSample,e.props.store.patientKeyToPatient],(function(t,r){var o="".concat(n," order in the Oncoprint is:\n"),i=(e.oncoprintAnalysisCaseType,Pn.zz.SAMPLE,e.oncoprint.getIdOrder().map(e.oncoprintAnalysisCaseType===Pn.zz.SAMPLE?function(e){return t[e].sampleId}:function(e){return r[e].patientId})),a=!0,l=!1,s=void 0;try{for(var u,c=i[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var p=u.value;o+="".concat(p,"\n")}}catch(e){l=!0,s=e}finally{try{a||null==c.return||c.return()}finally{if(l)throw s}}Tn()(o,"OncoPrint".concat(n,"s.txt"))}));break;case"tabular":(0,w.XE)([e.props.store.sampleKeyToSample,e.props.store.patientKeyToPatient],(function(t,n){eo(e.geneticTracks.result,e.clinicalTracks.result,e.heatmapTracks.result,e.genericAssayHeatmapTracks.result,e.genesetHeatmapTracks.result,e.oncoprint.getIdOrder(),e.oncoprintAnalysisCaseType===Pn.zz.SAMPLE?function(e){return t[e].sampleId}:function(e){return n[e].patientId},e.oncoprintAnalysisCaseType,e.distinguishDrivers)}));break;case"oncoprinter":(0,w.XE)([e.props.store.samples,e.props.store.patients,e.geneticTracks,e.clinicalTracks,e.heatmapTracks,e.genesetHeatmapTracks,e.props.store.clinicalAttributeIdToClinicalAttribute],(function(t,n,r,o,a,l,s){var u=e.oncoprintAnalysisCaseType===Pn.zz.SAMPLE?t.map((function(e){return e.sampleId})):n.map((function(e){return e.patientId})),c="";r.length>0&&(c=function(e,t,n){var r={};return i().flatMapDeep(e,(function(e){var t=function(e,t){var n=e;for(t[n]=t[n]||0,t[n]+=1;t[n]>1;)t[n="".concat(n,"_").concat(t[n])]=t[n]||0,t[n]+=1;return n}(e.label,r);return e.data.map((function(e){return e.data.map((function(r){return so(r,t,e[n])}))}))})).map(uo).concat(t).join("\n")}(r,u,e.oncoprintAnalysisCaseType));var p="";o.length>0&&(p=function(e,t,n,r,o){var a=i().groupBy(e,(function(e){return e[o]})),l=[];l.push(["Sample"].concat(n.map((function(e){var t=r[e],n=po(t.displayName),o=t.datatype.toLowerCase();return"MUTATION_COUNT"===t.clinicalAttributeId&&(o=ao.Cb.LOG_NUMBER),t.clinicalAttributeId===to.OY.MutationSpectrum&&(o=to.gh.join("/")),"".concat(n,"(").concat(o,")")}))));var s=!0,u=!1,c=void 0;try{for(var p,d=function(){var e=p.value;l.push([e].concat(n.map((function(t){var n=a[e]&&a[e].find((function(e){return e.attr_id===t}));return n&&!n.na&&n.attr_val?t===to.OY.MutationSpectrum?to.gh.map((function(e){return n.attr_val[e]})).join("/"):co(n.attr_val.toString()):ao.Wp}))))},f=t[Symbol.iterator]();!(s=(p=f.next()).done);s=!0)d()}catch(e){u=!0,c=e}finally{try{s||null==f.return||f.return()}finally{if(u)throw c}}return l.map((function(e){return e.join("  ")})).join("\n")}(i().flatMap(o,(function(e){return e.data})),u,o.map((function(e){return e.attributeId})),s,e.oncoprintAnalysisCaseType));var d="";a.length>0&&(d=fo(a,u,e.oncoprintAnalysisCaseType)),l.length>0&&alert("Oncoprinter does not support geneset heatmaps - all other tracks will still be exported."),window.open((0,se.gN)("/oncoprinter")).clientPostedData={genetic:c,clinical:p,heatmap:d}}))}},onSetHorzZoom:function(t){e.oncoprint.setHorzZoomCentered(t)},onClickZoomIn:function(){e.oncoprint.setHorzZoomCentered(e.oncoprint.getHorzZoom()/.7)},onClickZoomOut:function(){e.oncoprint.setHorzZoomCentered(.7*e.oncoprint.getHorzZoom())}}}},{key:"sortByData",value:function(){this.urlWrapper.updateURL({oncoprint_sortby:"",oncoprint_cluster_profile:""})}},{key:"setGenericAssayTracks",value:function(e,t){var n=this.urlWrapper.query.generic_assay_groups?this.urlWrapper.query.generic_assay_groups.split(";").map((function(e){return e.split(",")})):[],r=n.find((function(t){return t[0]===e}));r?(r.splice(1,r.length),r.push.apply(r,mo(t))):n.push([e].concat(mo(t)));var o=n.filter((function(e){return e.length>1})).map((function(e){return e.join(",")})).join(";");this.urlWrapper.updateURL({generic_assay_groups:o})}},{key:"setHeatmapTracks",value:function(e,t){return Eo(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,o,a,l,s;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=i().cloneDeep(this.molecularProfileIdToAdditionalTracks),o=i().chain(t).keyBy((function(e){return e})).mapValues((function(){return!0})).value(),delete r[e],a=this.props.store.molecularProfileIdToMolecularProfile.result[e].molecularAlterationType,t&&t.length?r[e]={entities:o,molecularAlterationType:a,molecularProfileId:e}:delete r[e],n.next=7,(0,w.Vi)(this.props.store.molecularProfileIdToMolecularProfile);case 7:l=n.sent,s=[],i().forEach(r,(function(e,t){var n=l[t],r=!0;n.molecularAlterationType===p.YK.GENERIC_ASSAY&&(r=(0,no.w5)(n)),r&&s.push("".concat(t,",").concat(i().keys(e.entities).join(",")))})),this.urlWrapper.updateURL({heatmap_track_groups:s.join(";")});case 11:case"end":return n.stop()}}),n,this)})))}},{key:"toggleColumnMode",value:function(){switch(this.oncoprintAnalysisCaseType){case Pn.zz.SAMPLE:this.controlsHandlers.onSelectColumnType&&this.controlsHandlers.onSelectColumnType(Pn.zz.PATIENT);break;case Pn.zz.PATIENT:this.controlsHandlers.onSelectColumnType&&this.controlsHandlers.onSelectColumnType(Pn.zz.SAMPLE)}}},{key:"oncoprintRef",value:function(e){var t=this;this.oncoprint=e,this.props.addOnBecomeVisibleListener&&this.props.addOnBecomeVisibleListener((function(){return t.oncoprint.triggerPendingResizeAndOrganize(t.onReleaseRendering)})),this.oncoprint.onHorzZoom((function(e){return t.horzZoom=e})),this.horzZoom=this.oncoprint.getHorzZoom(),(0,w.XE)(this.alteredKeys,(function(e){t.oncoprint.setHorzZoomToFit(e)}))}},{key:"setColumnMode",value:function(e){this.urlWrapper.updateURL({show_samples:e===Pn.zz.SAMPLE?"true":"false"})}},{key:"onMinimapClose",value:function(){this.showMinimap=!1}},{key:"onSuppressRendering",value:function(){this.renderingComplete=!1}},{key:"onReleaseRendering",value:function(){this.renderingComplete=!0}},{key:"clinicalTrackKeyToAttributeId",value:function(e){return e.substr(wo.length)}},{key:"clinicalAttributeIdToTrackKey",value:function(e){return"".concat(wo).concat(e)}},{key:"onChangeSelectedClinicalTracks",value:function(e){this.urlWrapper.updateURL(this.urlWrapper.getOncoprintClinicalTrackParams(e))}},{key:"onDeleteClinicalTrack",value:function(e){var t=this;if(!this.isHidden){var n=mo(this.selectedClinicalAttributeIds.keys()),r=i().filter(n,(function(n){return n!==t.clinicalTrackKeyToAttributeId(e)}));this.urlWrapper.updateURL(this.urlWrapper.getOncoprintClinicalTrackParams(r))}}},{key:"onTrackSortDirectionChange",value:function(e,t){1!==t&&-1!==t||this.sortByData()}},{key:"clearSortDirectionsAndSortByData",value:function(){this.oncoprint&&(this.oncoprint.resetSortableTracksSortDirection(),this.sortByData())}},{key:"clusterHeatmapByIndex",value:function(e){var t;if(this.oncoprint&&this.oncoprint.resetSortableTracksSortDirection(),e===this.genesetHeatmapTrackGroupIndex)t=this.props.store.genesetMolecularProfile.result&&this.props.store.genesetMolecularProfile.result.value&&this.props.store.genesetMolecularProfile.result.value.molecularProfileId;else{var n=i().values(this.molecularProfileIdToAdditionalTracks).find((function(t){return t.trackGroupIndex===e}));t=n?n.molecularProfileId:void 0}t&&this.urlWrapper.updateURL({oncoprint_sortby:"cluster",oncoprint_cluster_profile:t})}},{key:"removeAdditionalTrackSection",value:function(e){var t=i().values(this.molecularProfileIdToAdditionalTracks).find((function(t){return t.trackGroupIndex===e}));t&&((0,no.w5)(t.molecularProfile)||(0,no.hu)(t.molecularProfile)?this.removeGenericAssayTracksByMolecularProfileId(t.molecularProfileId):this.removeHeatmapTracksByMolecularProfileId(t.molecularProfileId))}},{key:"removeGenericAssayTracksByMolecularProfileId",value:function(e){delete this.molecularProfileIdToTrackGroupIndex[e],this.setGenericAssayTracks(e,[])}},{key:"removeHeatmapTracksByMolecularProfileId",value:function(e){delete this.molecularProfileIdToTrackGroupIndex[e],this.setHeatmapTracks(e,[])}},{key:"getControls",value:function(){return this.oncoprint&&!this.oncoprint.webgl_unavailable&&this.props.store.molecularProfileIdToMolecularProfile.result?r.createElement(w.i0,{showByDefault:!0,show:!0},r.createElement($r.Z,{handlers:this.controlsHandlers,state:this.controlsState,store:this.props.store,molecularProfileIdToMolecularProfile:this.props.store.molecularProfileIdToMolecularProfile.result,selectedGenericAssayEntitiesGroupedByGenericAssayTypeFromUrl:this.selectedGenericAssayEntitiesGroupedByGenericAssayTypeFromUrl})):r.createElement("span",null)}},{key:"getProgressItems",value:function(e){0===e&&(this.loadingGeneticDataDuringCurrentLoad=!1,this.loadingClinicalDataDuringCurrentLoad=!1);var t=i().some(mo(this.selectedClinicalAttributeIds.keys()),(function(e){return!(0,to.Ac)({clinicalAttributeId:e})}));this.geneticTracks.isPending&&(this.loadingGeneticDataDuringCurrentLoad=!0),t&&this.clinicalTracks.isPending&&(this.loadingClinicalDataDuringCurrentLoad=!0);var n,r=[];if(this.props.store.genes.isComplete&&this.props.store.filteredSamples.isComplete){var o=this.props.store.genes.result.length,a=this.props.store.filteredSamples.result.length;n="Querying ".concat(o," genes in ").concat(a," samples")}else n="Querying ... genes in ... samples";var l="";e>2&&(l=" - this can take several seconds"),r.push({label:"".concat(n).concat(l),promises:[],hideIcon:!0,style:{fontWeight:"bold"}});var s=[];this.loadingGeneticDataDuringCurrentLoad&&s.push("genetic"),this.loadingClinicalDataDuringCurrentLoad&&s.push("clinical"),r.push({label:"Loading ".concat(s.join(" and ")," data"),promises:[this.props.store.molecularData,this.props.store.mutations].concat(mo(t?[this.clinicalTracks]:[]))});var u=this.props.store.driverAnnotationSettings.oncoKb,c=this.props.store.driverAnnotationSettings.hotspots;return r.push({label:(0,no.Iq)(u,c),promises:[this.props.store.filteredAndAnnotatedMolecularData,this.props.store.filteredAndAnnotatedMutations,this.props.store.filteredAndAnnotatedStructuralVariants]}),r.push({label:"Rendering"}),r}},{key:"render",value:function(){return r.createElement("div",{style:{position:"relative"}},r.createElement(ee.Z,{isLoading:this.isHidden,size:"big",centerRelativeToContainer:!1,center:!0,className:"oncoprintLoadingIndicator",noFade:!0},r.createElement("div",null,r.createElement(Ar.Z,{getItems:this.getProgressItems,show:this.isHidden,sequential:!0}))),r.createElement("div",{className:"tabMessageContainer"},r.createElement(oe.Z,{className:"oncoprint-oql-status-banner",store:this.props.store,tabReflectsOql:!0}),r.createElement(ae.Z,{store:this.props.store}),r.createElement(ue.Z,{store:this.props.store,isPatientMode:this.oncoprintAnalysisCaseType===Pn.zz.PATIENT})),r.createElement("div",{className:b()("oncoprintContainer",{fadeIn:!this.isHidden}),onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},r.createElement(u.Observer,null,this.getControls),r.createElement("div",{style:{position:"relative",marginTop:15}},r.createElement("div",null,r.createElement(zr.ZP,{oncoprintRef:this.oncoprintRef,clinicalTracks:this.clinicalTracks.result,geneticTracks:this.geneticTracks.result,genesetHeatmapTracks:this.genesetHeatmapTracks.result,heatmapTracks:[].concat(this.genericAssayHeatmapTracks.result).concat(this.heatmapTracks.result),categoricalTracks:this.genericAssayCategoricalTracks.result,divId:this.props.divId,width:this.width,caseLinkOutInTooltips:!0,suppressRendering:this.isLoading,keepSorted:!this.isLoading,onSuppressRendering:this.onSuppressRendering,onReleaseRendering:this.onReleaseRendering,hiddenIds:this.showUnalteredColumns?void 0:this.unalteredKeys.result,molecularProfileIdToMolecularProfile:this.props.store.molecularProfileIdToMolecularProfile.result,alterationTypesInQuery:this.alterationTypesInQuery.result,showSublabels:this.showOqlInLabels,additionalTrackGroupHeaders:this.additionalTrackGroupHeaders.result,horzZoomToFitIds:this.alteredKeys.result,distinguishMutationType:this.distinguishMutationType,distinguishDrivers:this.distinguishDrivers,distinguishGermlineMutations:this.distinguishGermlineMutations,sortConfig:this.oncoprintLibrarySortConfig,showClinicalTrackLegends:this.showClinicalTrackLegends,showWhitespaceBetweenColumns:this.showWhitespaceBetweenColumns,showMinimap:this.showMinimap,onMinimapClose:this.onMinimapClose,onDeleteClinicalTrack:this.onDeleteClinicalTrack,onTrackSortDirectionChange:this.onTrackSortDirectionChange,initParams:{max_height:Number.POSITIVE_INFINITY}})))))}},{key:"columnMode",get:function(){return"true"===this.urlWrapper.query.show_samples?"sample":"patient"}},{key:"sortMode",get:function(){var e;switch(this.urlWrapper.query.oncoprint_sortby){case"case_id":e={type:"alphabetical"};break;case"case_list":e={type:"caseList"};break;case"cluster":e={type:"heatmap",clusteredHeatmapProfile:this.urlWrapper.query.oncoprint_cluster_profile};break;case"":default:e={type:"data"}}return e}},{key:"sortByMutationType",get:function(){return!this.urlWrapper.query.oncoprint_sort_by_mutation_type||"true"===this.urlWrapper.query.oncoprint_sort_by_mutation_type}},{key:"sortByDrivers",get:function(){return!this.urlWrapper.query.oncoprint_sort_by_drivers||"true"===this.urlWrapper.query.oncoprint_sort_by_drivers}},{key:"genericAssayPromises",get:function(){return 1===this.props.store.studyIds.result.length?this.props.store:{genericAssayEntitiesGroupedByGenericAssayType:(0,w.ri)({}),genericAssayEntitiesGroupedByGenericAssayTypeLinkMap:(0,w.ri)({})}}},{key:"selectedGenericAssayEntitiesGroupedByGenericAssayTypeFromUrl",get:function(){var e=this;return i().reduce(this.props.store.selectedGenericAssayEntitiesGroupByMolecularProfileId,(function(t,n,r){if(e.props.store.molecularProfileIdToMolecularProfile.result[r]){var o=e.props.store.molecularProfileIdToMolecularProfile.result[r].genericAssayType;t[o]=t[o]?i().union(n,t[o]):n}return t}),{})}},{key:"onlyShowClinicalLegendForAlteredCases",get:function(){return this.showClinicalTrackLegends&&this._onlyShowClinicalLegendForAlteredCases}},{key:"selectedClinicalAttributeIds",get:function(){var e=this.urlWrapper.oncoprintSelectedClinicalTracks.slice();return void 0===this.urlWrapper.query.clinicallist&&(this.props.store.studyIds.result&&this.props.store.studyIds.result.length>1&&e.push(to.OY.StudyOfOrigin),this.props.store.filteredSamples.result&&this.props.store.filteredPatients.result&&this.props.store.filteredSamples.result.length>this.props.store.filteredPatients.result.length&&e.push(to.OY.NumSamplesPerPatient),i().forEach(this.props.store.clinicalAttributes_profiledIn.result,(function(t){e.push(t.clinicalAttributeId)}))),e.reduce((function(e,t){return e.set(t,!0),e}),c.observable.map({},{deep:!1}))}},{key:"molecularProfileIdToAdditionalTracks",get:function(){var e=this,t=this.urlWrapper.query.heatmap_track_groups?this.urlWrapper.query.heatmap_track_groups.split(";").map((function(e){return e.split(",")})):[];this.urlWrapper.query.generic_assay_groups&&t.push.apply(t,mo(this.urlWrapper.query.generic_assay_groups.split(";").map((function(e){return e.split(",")}))));var n,r=t.reduce((function(e,t){return e[t[0]]=t.slice(1),e}),{}),o={};return n=i().isEmpty(this.molecularProfileIdToTrackGroupIndex)?2:Math.max.apply(Math,mo(i().values(this.molecularProfileIdToTrackGroupIndex)))+1,i().forEach(r,(function(t,r){var i=e.props.store.molecularProfileIdToMolecularProfile.result[r];if(i&&t&&t.length){i.molecularProfileId in e.molecularProfileIdToTrackGroupIndex||(e.molecularProfileIdToTrackGroupIndex[i.molecularProfileId]=n,n+=1);var a={trackGroupIndex:e.molecularProfileIdToTrackGroupIndex[i.molecularProfileId],molecularProfile:i,molecularProfileId:i.molecularProfileId,molecularAlterationType:i.molecularAlterationType,entities:{}};t.forEach((function(e){return a.entities[e]=!0})),o[r]=a}})),o}},{key:"urlWrapper",get:function(){return this.props.urlWrapper}},{key:"caseListSortPossible",get:function(){return!(!this.props.store.givenSampleOrder.isComplete||!this.props.store.givenSampleOrder.result.length)}},{key:"distinguishDrivers",get:function(){return this.props.store.driverAnnotationSettings.driversAnnotated}},{key:"heatmapIsDynamicallyQueried",get:function(){var e=this.props.store.molecularProfileIdToMolecularProfile.result;return e.hasOwnProperty(this.selectedHeatmapProfileId)&&e[this.selectedHeatmapProfileId].molecularAlterationType!==p.YK.GENESET_SCORE}},{key:"clinicalTracksUrlParam",get:function(){return mo(this.selectedClinicalAttributeIds.keys()).join(",")}},{key:"oncoprintAnalysisCaseType",get:function(){return"true"===this.urlWrapper.query.show_samples?Pn.zz.SAMPLE:Pn.zz.PATIENT}},{key:"sortOrder",get:function(){return"alphabetical"===this.sortMode.type?this.oncoprintAnalysisCaseType===Pn.zz.SAMPLE?this.alphabeticalSampleOrder:this.alphabeticalPatientOrder:"caseList"===this.sortMode.type?this.oncoprintAnalysisCaseType===Pn.zz.SAMPLE&&this.props.store.givenSampleOrder.isComplete?this.props.store.givenSampleOrder.result.map((function(e){return e.uniqueSampleKey})):this.oncoprintAnalysisCaseType===Pn.zz.PATIENT&&this.props.store.givenSampleOrder.isComplete?i().uniq(this.props.store.givenSampleOrder.result.map((function(e){return e.uniquePatientKey}))):void 0:void 0}},{key:"alphabeticalSampleOrder",get:function(){return this.props.store.filteredSamples.isComplete?i().sortBy(this.props.store.filteredSamples.result,(function(e){return e.sampleId})).map((function(e){return e.uniqueSampleKey})):void 0}},{key:"alphabeticalPatientOrder",get:function(){return this.props.store.filteredPatients.isComplete?i().sortBy(this.props.store.filteredPatients.result,(function(e){return e.patientId})).map((function(e){return e.uniquePatientKey})):void 0}},{key:"geneticTracks",get:function(){return this.oncoprintAnalysisCaseType===Pn.zz.SAMPLE?this.sampleGeneticTracks:this.patientGeneticTracks}},{key:"clinicalTracks",get:function(){return this.oncoprintAnalysisCaseType===Pn.zz.SAMPLE?this.sampleClinicalTracks:this.patientClinicalTracks}},{key:"heatmapTracks",get:function(){return this.oncoprintAnalysisCaseType===Pn.zz.SAMPLE?this.sampleHeatmapTracks:this.patientHeatmapTracks}},{key:"genericAssayHeatmapTracks",get:function(){return this.oncoprintAnalysisCaseType===Pn.zz.SAMPLE?this.samplegGenericAssayHeatmapTracks:this.patientGenericAssayHeatmapTracks}},{key:"genericAssayCategoricalTracks",get:function(){return this.oncoprintAnalysisCaseType===Pn.zz.SAMPLE?this.sampleGenericAssayCategoricalTracks:this.patientGenericAssayCategoricalTracks}},{key:"genesetHeatmapTrackGroupIndex",get:function(){return this.props.store.genesetIds.length>0?1+Math.max.apply(Math,[zr.Z9].concat(mo(this.heatmapTracks.result.map((function(e){return e.trackGroupIndex}))),mo(this.genericAssayHeatmapTracks.result.map((function(e){return e.trackGroupIndex}))),mo(this.genericAssayCategoricalTracks.result.map((function(e){return e.trackGroupIndex}))))):void 0}},{key:"genesetHeatmapTracks",get:function(){return this.oncoprintAnalysisCaseType===Pn.zz.SAMPLE?this.sampleGenesetHeatmapTracks:this.patientGenesetHeatmapTracks}},{key:"clusteredHeatmapTrackGroupIndex",get:function(){if("heatmap"===this.sortMode.type){var e=this.sortMode.clusteredHeatmapProfile;if(e===(this.props.store.genesetMolecularProfile.result&&this.props.store.genesetMolecularProfile.result.value&&this.props.store.genesetMolecularProfile.result.value.molecularProfileId))return this.genesetHeatmapTrackGroupIndex;var t=this.molecularProfileIdToAdditionalTracks[e];return t&&t.trackGroupIndex}}},{key:"oncoprintLibrarySortConfig",get:function(){return{sortByMutationType:this.sortByMutationType,sortByDrivers:this.sortByDrivers,order:this.sortOrder,clusterHeatmapTrackGroupIndex:this.clusteredHeatmapTrackGroupIndex}}},{key:"isLoading",get:function(){return"pending"===(0,ie.CX)(this.clinicalTracks,this.geneticTracks,this.genesetHeatmapTracks,this.genericAssayCategoricalTracks,this.genericAssayHeatmapTracks,this.heatmapTracks,this.props.store.molecularProfileIdToMolecularProfile,this.alterationTypesInQuery,this.alteredKeys,this.additionalTrackGroupHeaders)}},{key:"isHidden",get:function(){return this.isLoading||!this.renderingComplete}},{key:"loadingIndicatorHeight",get:function(){return 300}},{key:"loadingIndicatorMessage",get:function(){return this.isLoading?"Downloading Oncoprint data...":this.renderingComplete?"":"Data downloaded. Rendering Oncoprint.."}},{key:"width",get:function(){return E.Z.size.width-75}}])&&ho(n.prototype,o),a&&ho(n,a),t}(r.Component);Co([c.computed],To.prototype,"columnMode",null),Co([c.computed],To.prototype,"sortMode",null),Co([c.computed],To.prototype,"sortByMutationType",null),Co([c.computed],To.prototype,"sortByDrivers",null),Co([c.computed],To.prototype,"genericAssayPromises",null),Co([c.computed],To.prototype,"selectedGenericAssayEntitiesGroupedByGenericAssayTypeFromUrl",null),Co([c.observable],To.prototype,"distinguishGermlineMutations",void 0),Co([c.observable],To.prototype,"distinguishMutationType",void 0),Co([c.observable],To.prototype,"showUnalteredColumns",void 0),Co([c.observable],To.prototype,"showWhitespaceBetweenColumns",void 0),Co([c.observable],To.prototype,"showClinicalTrackLegends",void 0),Co([c.observable],To.prototype,"_onlyShowClinicalLegendForAlteredCases",void 0),Co([c.observable],To.prototype,"showOqlInLabels",void 0),Co([c.computed],To.prototype,"onlyShowClinicalLegendForAlteredCases",null),Co([c.observable],To.prototype,"showMinimap",void 0),Co([c.observable],To.prototype,"selectedHeatmapProfileId",void 0),Co([c.observable],To.prototype,"heatmapGeneInputValue",void 0),Co([c.observable],To.prototype,"selectedGenericAssayProfileId",void 0),Co([c.observable],To.prototype,"horzZoom",void 0),Co([c.observable],To.prototype,"mouseInsideBounds",void 0),Co([c.observable],To.prototype,"renderingComplete",void 0),Co([c.computed],To.prototype,"selectedClinicalAttributeIds",null),Co([c.computed],To.prototype,"molecularProfileIdToAdditionalTracks",null),Co([c.observable.ref],To.prototype,"oncoprint",void 0),Co([c.computed],To.prototype,"caseListSortPossible",null),Co([c.computed],To.prototype,"distinguishDrivers",null),Co([c.action],To.prototype,"setAnnotateCBioPortalInputValue",null),Co([c.action],To.prototype,"setAnnotateCOSMICInputValue",null),Co([c.computed],To.prototype,"heatmapIsDynamicallyQueried",null),Co([c.action],To.prototype,"sortByData",null),Co([c.computed],To.prototype,"clinicalTracksUrlParam",null),Co([c.action],To.prototype,"onMinimapClose",null),Co([c.action],To.prototype,"onSuppressRendering",null),Co([c.action],To.prototype,"onReleaseRendering",null),Co([c.action],To.prototype,"onChangeSelectedClinicalTracks",null),Co([c.action.bound],To.prototype,"clearSortDirectionsAndSortByData",null),Co([c.computed],To.prototype,"sortOrder",null),Co([c.computed],To.prototype,"alphabeticalSampleOrder",null),Co([c.computed],To.prototype,"alphabeticalPatientOrder",null),Co([c.computed],To.prototype,"geneticTracks",null),Co([c.computed],To.prototype,"clinicalTracks",null),Co([c.computed],To.prototype,"heatmapTracks",null),Co([c.computed],To.prototype,"genericAssayHeatmapTracks",null),Co([c.computed],To.prototype,"genericAssayCategoricalTracks",null),Co([c.computed],To.prototype,"genesetHeatmapTrackGroupIndex",null),Co([c.computed],To.prototype,"genesetHeatmapTracks",null),Co([c.computed],To.prototype,"clusteredHeatmapTrackGroupIndex",null),Co([c.computed],To.prototype,"oncoprintLibrarySortConfig",null),Co([c.action.bound],To.prototype,"clusterHeatmapByIndex",null),Co([c.action.bound],To.prototype,"removeAdditionalTrackSection",null),Co([c.action.bound],To.prototype,"removeGenericAssayTracksByMolecularProfileId",null),Co([c.action.bound],To.prototype,"removeHeatmapTracksByMolecularProfileId",null),Co([c.computed],To.prototype,"isLoading",null),Co([c.computed],To.prototype,"isHidden",null),Co([c.computed],To.prototype,"loadingIndicatorMessage",null),Co([S.default],To.prototype,"getControls",null),Co([S.default],To.prototype,"getProgressItems",null),Co([c.computed],To.prototype,"width",null);const Po=To=Co([u.observer],To);var Oo=n(39013),ko=n(69539),Ao=n.n(ko),Io=n(99549),_o=n(90848);function Do(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xo(e){return(xo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Mo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function No(e,t){return(No=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Lo(e){return(Lo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Ro=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":Lo(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},jo=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))},Go=(0,w.hZ)(),Vo=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=function(e,t){return!t||"object"!==Lo(t)&&"function"!=typeof t?Mo(e):t}(this,xo(t).call(this,e)),Object.defineProperty(Mo(n),"showBookmarkDialog",{enumerable:!0,configurable:!0,writable:!0,value:!1}),(0,c.makeObservable)(Mo(n)),n}var n,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&No(e,t)}(t,e),n=t,(o=[{key:"getUrls",value:function(){return jo(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Go.location.href,e.next=3,(0,_o.k)(t,this.props.bitlyAccessToken);case 3:return n=e.sent,e.abrupt("return",{bitlyUrl:n,fullUrl:t,sessionUrl:t});case 5:case"end":return e.stop()}}),e,this)})))}},{key:"toggleBookmarkDialog",value:function(){this.showBookmarkDialog=!this.showBookmarkDialog}},{key:"render",value:function(){return r.createElement("div",{className:Ao().shareModule},r.createElement(w.ZD,{placement:"topLeft",overlay:r.createElement("div",null,"Get bookmark link")},r.createElement("a",{onClick:this.toggleBookmarkDialog},r.createElement("span",{className:"fa-stack fa-4x"},r.createElement("i",{className:"fa fa-circle fa-stack-2x"}),r.createElement("i",{className:"fa fa-link fa-stack-1x"})))),this.showBookmarkDialog&&r.createElement(Io.S,{onHide:this.toggleBookmarkDialog,urlPromise:this.getUrls(),title:"Bookmark Query"}))}}])&&Do(n.prototype,o),i&&Do(n,i),t}(r.Component);Ro([c.observable],Vo.prototype,"showBookmarkDialog",void 0),Ro([c.action.bound],Vo.prototype,"toggleBookmarkDialog",null),Vo=Ro([u.observer],Vo);var Fo=n(35770),Bo=n(58997),qo=n(39887),Uo=n(85537),Ho=n(83224),Wo=n(43643),Yo=n(21382),Ko=n(6175),Qo=n.n(Ko);function Xo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Zo(e){return(Zo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $o(e,t){return($o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Jo(e){return(Jo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ei,ti=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":Jo(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};!function(e){e.hidePutativePassengers="0",e.showGermlineMutations="1",e.hideUnprofiledSamples="1.1",e.hideAnyUnprofiledSamples="1.2",e.hideTotallyUnprofiledSamples="1.3",e.dataTypeSample="2",e.dataTypePatient="3"}(ei||(ei={}));var ni=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=function(e,t){return!t||"object"!==Jo(t)&&"function"!=typeof t?zo(e):t}(this,Zo(t).call(this,e)),Object.defineProperty(zo(n),"driverSettingsState",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(zo(n),"driverSettingsHandlers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),(0,c.makeObservable)(zo(n),{driverSettingsState:c.observable,driverSettingsHandlers:c.observable}),n.driverSettingsState=(0,Ho.Pj)(e.store.driverAnnotationSettings,e.store.customDriverAnnotationReport.result,e.store.didOncoKbFailInOncoprint,e.store.didHotspotFailInOncoprint),n.driverSettingsHandlers=(0,Ho.Zl)(e.store.driverAnnotationSettings,n.driverSettingsState),n}var n,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$o(e,t)}(t,e),n=t,(o=[{key:"onInputClick",value:function(e){switch(e.target.value){case ei.hidePutativePassengers:this.props.store.driverAnnotationSettings.includeVUS=!this.props.store.driverAnnotationSettings.includeVUS;break;case ei.hideUnprofiledSamples:this.props.store.hideUnprofiledSamples?this.props.store.hideUnprofiledSamples=!1:this.props.store.hideUnprofiledSamples="any";break;case ei.hideAnyUnprofiledSamples:this.props.store.hideUnprofiledSamples="any";break;case ei.hideTotallyUnprofiledSamples:this.props.store.hideUnprofiledSamples="totally";break;case ei.showGermlineMutations:this.props.store.includeGermlineMutations=!this.props.store.includeGermlineMutations}}},{key:"render",value:function(){return this.props.disabled?r.createElement("div",{"data-test":"GlobalSettingsButtonHint"},r.createElement("div",null,"Filtering based on annotations is not available for this study."),r.createElement("div",null,"Load custom driver annotations for the selected study to enable filtering.")):r.createElement("div",{"data-test":"GlobalSettingsDropdown",className:b()("cbioportal-frontend",Qo().globalSettingsDropdown),style:{padding:5}},r.createElement("h5",{style:{marginTop:"auto",marginBottom:"auto"}},"Annotate Data"),r.createElement(Yo.Z,{divStyle:{display:"inline-block",marginLeft:6},style:{color:"rgb(54, 134, 194)"},tooltip:r.createElement("span",null,"Putative driver vs VUS setings apply to every tab except"," ",r.createElement(hr.CT,{words:["Co-expression","CN Segments"]}))}),r.createElement("div",{style:{marginLeft:10}},r.createElement(Wo.Z,{state:this.driverSettingsState,handlers:this.driverSettingsHandlers,resultsView:this.props.resultsView})),r.createElement("hr",null),r.createElement("h5",{style:{marginTop:"auto",marginBottom:"auto"}},"Filter Data"),r.createElement("div",{style:{marginLeft:10}},r.createElement("div",{className:"checkbox"},r.createElement("label",null,r.createElement("input",{"data-test":"HideVUS",type:"checkbox",value:ei.hidePutativePassengers,checked:!this.props.store.driverAnnotationSettings.includeVUS,onClick:this.onInputClick,disabled:!this.driverSettingsState.distinguishDrivers})," ","Exclude alterations (mutations, structural variants and copy number) of unknown significance")),r.createElement("div",{className:"checkbox"},r.createElement("label",null,r.createElement("input",{"data-test":"HideGermline",type:"checkbox",value:ei.showGermlineMutations,checked:!this.props.store.includeGermlineMutations,onClick:this.onInputClick})," ","Exclude germline mutations")),this.props.resultsView&&r.createElement("div",null,r.createElement("div",{className:"checkbox"},r.createElement("label",null,r.createElement("input",{"data-test":"HideUnprofiled",type:"checkbox",value:ei.hideUnprofiledSamples,checked:!1!==this.props.store.hideUnprofiledSamples,onClick:this.onInputClick})," ","Exclude unprofiled samples")),r.createElement("div",{style:{marginLeft:10}},r.createElement("div",{className:"radio"},r.createElement("label",null,r.createElement("input",{type:"radio",checked:"any"===this.props.store.hideUnprofiledSamples,value:ei.hideAnyUnprofiledSamples,onClick:this.onInputClick}),"Exclude samples that are unprofiled in any queried gene or profile"),r.createElement("label",null,r.createElement("input",{type:"radio",checked:"totally"===this.props.store.hideUnprofiledSamples,value:ei.hideTotallyUnprofiledSamples,onClick:this.onInputClick}),"Exclude samples that are unprofiled in every queried gene and profile."))))))}}])&&Xo(n.prototype,o),i&&Xo(n,i),t}(r.Component);ti([S.default],ni.prototype,"onInputClick",null);const ri=ni=ti([u.observer],ni);function oi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ii(e){return(ii=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ai(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function li(e,t){return(li=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function si(e){return(si="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ui=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":si(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},ci=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=function(e,t){return!t||"object"!==si(t)&&"function"!=typeof t?ai(e):t}(this,ii(t).call(this,e)),Object.defineProperty(ai(n),"visible",{enumerable:!0,configurable:!0,writable:!0,value:!1}),(0,c.makeObservable)(ai(n)),n}var n,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&li(e,t)}(t,e),n=t,(o=[{key:"setVisibilityState",value:function(e){void 0!==e&&(void 0!==this.props.store.isSettingsMenuVisible?this.props.store.isSettingsMenuVisible=!!e:this.visible=!!e)}},{key:"render",value:function(){var e=this;return r.createElement(w.ZD,{trigger:[this.trigger],placement:"bottomRight",overlay:this.overlay,visible:this.visibilityState,onVisibleChange:function(t){e.setVisibilityState(t)},onPopupAlign:function(e){return(0,w.pb)(e,"22px")}},r.createElement("button",{"data-test":"GlobalSettingsButton",style:{marginRight:0,marginLeft:5},className:"btn btn-primary"},r.createElement("i",{className:"fa fa-sliders fa-lg"})))}},{key:"visibilityState",get:function(){return void 0!==this.props.store.isSettingsMenuVisible?this.props.store.isSettingsMenuVisible:this.visible}},{key:"overlay",get:function(){return r.createElement(ri,{store:this.props.store,resultsView:this.props.resultsView,disabled:this.props.disabled})}},{key:"trigger",get:function(){return this.props.disabled?"hover":"click"}}])&&oi(n.prototype,o),i&&oi(n,i),t}(r.Component);ui([c.observable],ci.prototype,"visible",void 0),ui([c.computed],ci.prototype,"visibilityState",null),ui([c.action],ci.prototype,"setVisibilityState",null),ui([c.computed],ci.prototype,"overlay",null),ui([c.computed],ci.prototype,"trigger",null);const pi=ci=ui([u.observer],ci);var di=n(77906);function fi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function mi(e){return(mi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function hi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yi(e,t){return(yi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bi(e){return(bi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var gi=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":bi(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},vi=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=function(e,t){return!t||"object"!==bi(t)&&"function"!=typeof t?hi(e):t}(this,mi(t).call(this,e)),Object.defineProperty(hi(n),"singleStudyUI",{enumerable:!0,configurable:!0,writable:!0,value:(0,Fo.F)({await:function(){return[n.props.store.queriedStudies,n.props.store.sampleLists,n.props.store.filteredSamples,n.props.store.filteredPatients]},render:function(){var e=n.props.store.sampleLists.result.length>0?r.createElement("span",null,n.props.store.sampleLists.result[0].name):r.createElement("span",null,"User-defined Patient List");return r.createElement("div",null,r.createElement("h3",null,r.createElement("a",{href:(0,se.gN)("study",{id:n.props.store.queriedStudies.result.map((function(e){return e.studyId})).join(",")}),target:"_blank"},n.props.store.queriedStudies.result[0].name)),e,"Â (",n.studyPageFilteredCasesLink,") Â -Â ",(0,zt.sC)(n.props.store.hugoGeneSymbols),"Â ",r.createElement(w.ZD,{overlay:"Edit genes or OQL"},r.createElement("a",{"data-test":"oqlQuickEditButton",onClick:n.props.onToggleOQLEditUIVisibility},r.createElement("i",{className:"fa fa-pencil"}))))}})}),Object.defineProperty(hi(n),"multipleStudyUI",{enumerable:!0,configurable:!0,writable:!0,value:(0,Fo.F)({await:function(){return[n.props.store.filteredSamples,n.props.store.filteredPatients,n.props.store.queriedStudies,n.props.store.sampleLists]},render:function(){return r.createElement("div",null,r.createElement("h3",null,r.createElement("a",{href:(0,se.gN)("study",{id:n.props.store.queriedStudies.result.map((function(e){return e.studyId})).join(",")}),target:"_blank"},"Combined Study (",i().sumBy(n.props.store.queriedStudies.result,(function(e){return e.allSampleCount}))," ","samples)"),n.props.store.isMixedReferenceGenome&&(0,Uo.gM)()),r.createElement("span",null,"Querying ",n.studyPageFilteredCasesLink," in"," ",n.props.store.queriedStudies.result.length," ","studiesÂ ",r.createElement(w.ZD,{placement:"bottom",overlay:n.studyList,destroyTooltipOnHide:!0},r.createElement("i",{className:"fa fa-info-circle"})),"Â ",(0,zt.sC)(n.props.store.hugoGeneSymbols),"Â ",r.createElement(w.ZD,{overlay:"Edit genes or OQL"},r.createElement("a",{"data-test":"oqlQuickEditButton",onClick:n.props.onToggleOQLEditUIVisibility},r.createElement("i",{className:"fa fa-pencil"})))))}})}),Object.defineProperty(hi(n),"cohortAndGeneSummary",{enumerable:!0,configurable:!0,writable:!0,value:(0,Fo.F)({await:function(){return[n.singleStudyUI,n.multipleStudyUI,n.props.store.queriedStudies]},render:function(){return 1===n.props.store.queriedStudies.result.length?n.singleStudyUI.component:n.multipleStudyUI.component}})}),Object.defineProperty(hi(n),"alterationSummary",{enumerable:!0,configurable:!0,writable:!0,value:(0,Fo.F)({await:function(){return[n.props.store.filteredSamples,n.props.store.filteredPatients,n.props.store.filteredAlteredSampleKeys,n.props.store.filteredAlteredPatientKeys]},render:function(){return(0,zt.Rs)(n.props.store.filteredSamples.result.length,n.props.store.filteredPatients.result.length,n.props.store.filteredAlteredSampleKeys.result.length,n.props.store.filteredAlteredPatientKeys.result.length,n.props.store.hugoGeneSymbols.length)}})}),(0,c.makeObservable)(hi(n)),n}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yi(e,t)}(t,e),n=t,(o=[{key:"toggleQueryFormVisibility",value:function(){this.props.onToggleQueryFormVisibility(this.props.store.queryFormVisible),this.props.store.modifyQueryParams&&!0===this.props.store.queryFormVisible&&(this.props.store.modifyQueryParams=void 0),this.props.store.queryFormVisible=!this.props.store.queryFormVisible}},{key:"closeQueryForm",value:function(){!0===this.props.store.queryFormVisible&&(this.toggleQueryFormVisibility(),di(document).scrollTop(0))}},{key:"onSubmit",value:function(){this.closeQueryForm(),(0,Bo.cc)()("send","event","resultsView","query modified")}},{key:"render",value:function(){if(this.cohortAndGeneSummary.isError||this.alterationSummary.isError)return this.isQueryOrGeneInvalid?this.queryForm:null;var e=this.cohortAndGeneSummary.isComplete&&this.alterationSummary.isComplete;return r.createElement("div",null,r.createElement("div",{className:"query-summary"},r.createElement("div",{className:"query-summary__leftItems"},!this.isQueryOrGeneInvalid&&r.createElement("div",{style:{display:"flex"}},r.createElement("button",{id:"modifyQueryBtn",onClick:this.toggleQueryFormVisibility,className:b()("btn btn-primary",{disabled:!e})},this.queryFormVisible?"Cancel Modify Query":"Modify Query"),r.createElement(pi,{store:this.props.store,resultsView:!0})),r.createElement(ee.Z,{isLoading:!e,small:!0}),e&&this.cohortAndGeneSummary.component),r.createElement("div",{className:"query-summary__rightItems"},r.createElement("div",{className:"query-summary__alterationData"},e&&r.createElement("strong",null,this.alterationSummary.component)),r.createElement(Vo,{sessionEnabled:pn.v4.sessionServiceIsEnabled(),bitlyAccessToken:(0,pn.Ib)().bitly_access_token,urlWrapper:this.props.store.urlWrapper}))),this.queryFormVisible&&this.queryForm)}},{key:"queryFormVisible",get:function(){return this.props.store.queryFormVisible||this.isQueryOrGeneInvalid}},{key:"studyPageFilteredCasesLink",get:function(){var e=this;return r.createElement("a",{onClick:function(){(0,zt.Bu)(e.props.store.queriedStudies.result,e.props.store.filteredSamples.result,e.props.store.filteredSamples.result.length<e.props.store.samples.result.length,e.props.store.queriedVirtualStudies.result.length>0,e.props.store.sampleLists.result)}},(0,zt.Fq)(this.props.store.filteredSamples.result,this.props.store.filteredPatients.result))}},{key:"studyList",get:function(){return r.createElement("div",{className:"cbioportal-frontend"},r.createElement("ul",{className:"list-unstyled",style:{marginBottom:0}},this.props.store.queriedStudies.result.map((function(e){return r.createElement("li",null,r.createElement(Bn._,{studyId:e.studyId},e.name))}))))}},{key:"queryForm",get:function(){var e=this;return r.createElement("div",{style:{margin:"10px -20px 0 -20px"}},r.createElement(Oo.Z,{onSubmit:this.onSubmit,forkedMode:!1,showQuickSearchTab:!1,showDownloadTab:!1,showAlerts:!0,modifyQueryParams:this.props.store.modifyQueryParams,getQueryStore:function(){return(0,qo.S)(e.props.store.urlWrapper.query,e.props.store.urlWrapper,!1)}}))}},{key:"isQueryOrGeneInvalid",get:function(){return this.props.store.genesInvalid||this.props.store.queryExceedsLimit}}])&&fi(n.prototype,o),a&&fi(n,a),t}(r.Component);gi([c.action.bound],vi.prototype,"toggleQueryFormVisibility",null),gi([c.computed],vi.prototype,"queryFormVisible",null),gi([c.computed],vi.prototype,"studyPageFilteredCasesLink",null),gi([c.action.bound],vi.prototype,"closeQueryForm",null),gi([S.default],vi.prototype,"onSubmit",null),gi([c.computed],vi.prototype,"queryForm",null),gi([c.computed],vi.prototype,"isQueryOrGeneInvalid",null);const Si=vi=gi([u.observer],vi);var Ci=n(28913),Ei=n(14069),wi=n(92977),Ti=n(42352);function Pi(e){return e>0?"rgb(41, 87, 41)":"rgb(180, 4, 4)"}function Oi(e){return[Math.abs(e),e>0?1:0]}var ki=n(12004),Ai=n(30244),Ii=n(64318),_i=n(3563);function Di(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Mi(e,t){return!t||"object"!==ji(t)&&"function"!=typeof t?Li(e):t}function Ni(e){return(Ni=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Li(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ri(e,t){return(Ri=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ji(e){return(ji="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Gi=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":ji(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Vi="q-Value",Fi=[{name:"Correlated Gene",render:function(e){return r.createElement("span",{style:{fontWeight:"bold"}},e.geneticEntityName)},filter:function(e,t,n){return e.geneticEntityName.indexOf(n)>-1},download:function(e){return e.geneticEntityName},sortBy:function(e){return e.geneticEntityName},width:"30%"},{name:"Cytoband",render:function(e){return r.createElement("span",null,e.cytoband)},filter:Ii.x,download:function(e){return e.cytoband},sortBy:function(e){return e.cytoband},width:"30%"},Bi("Spearman's Correlation","spearmansCorrelation",!0,!1),Object.assign(Bi("p-Value","pValue",!1,!1),{tooltip:r.createElement("span",null,"Derived from 2-sided t-test.")}),Object.assign(Bi(Vi,"qValue",!1,!0),{sortBy:function(e){return[e.qValue,e.pValue]},tooltip:r.createElement("span",null,"Derived from Benjamini-Hochberg FDR correction procedure.")})];function Bi(e,t,n,o){return{name:e,render:function(e){return r.createElement("span",{style:{color:n?Pi(e[t]):"#000000",textAlign:"right",float:"right",whiteSpace:"nowrap"}},o?(0,ce.It)(e[t]):(0,_i.C)(e[t],3,.01))},download:function(e){return e[t].toString()+""},sortBy:function(e){return Oi(e[t])},align:"right"}}var qi=function(e){function t(){var e;return Di(this,t),e=Mi(this,Ni(t).apply(this,arguments)),Object.defineProperty(Li(e),"tableModeOptions",{enumerable:!0,configurable:!0,writable:!0,value:[{label:"Show Any Correlation",value:Ka.SHOW_ALL},{label:"Show Only Positively Correlated",value:Ka.SHOW_POSITIVE},{label:"Show Only Negatively Correlated",value:Ka.SHOW_NEGATIVE}]}),Object.defineProperty(Li(e),"paginationProps",{enumerable:!0,configurable:!0,writable:!0,value:{itemsPerPageOptions:[25]}}),e}var n,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ri(e,t)}(t,e),n=t,(o=[{key:"onRowClick",value:function(e){this.props.dataStore.setHighlighted(e)}},{key:"onSelectTableMode",value:function(e){this.props.onSelectTableMode(e.value)}},{key:"render",value:function(){return r.createElement("div",null,r.createElement("div",{style:{float:"left",display:"flex",flexDirection:"row"}},r.createElement("div",{style:{width:180}},r.createElement(wi.default,{value:this.props.tableMode,onChange:this.onSelectTableMode,options:this.tableModeOptions,searchable:!1,clearable:!1,className:"coexpression-select-table-mode"})),r.createElement(Yo.Z,{style:{marginLeft:21,marginTop:"0.7em"},tooltip:r.createElement("div",{style:{maxWidth:200}},ki.f7),tooltipPlacement:"left"})),r.createElement(An.ZP,{initialSortColumn:Vi,initialSortDirection:"asc",columns:Fi,showColumnVisibility:!1,dataStore:this.props.dataStore,onRowClick:this.onRowClick,filterPlaceholder:"Enter gene or cytoband..",paginationProps:this.paginationProps,initialItemsPerPage:25,copyDownloadProps:{showCopy:!1}}))}}])&&xi(n.prototype,o),i&&xi(n,i),t}(r.Component);Gi([Ai.ak],qi.prototype,"onRowClick",null),Gi([Ai.ak],qi.prototype,"onSelectTableMode",null);const Ui=qi=Gi([u.observer],qi);function Hi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Wi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Yi(e,t){return!t||"object"!==Zi(t)&&"function"!=typeof t?Qi(e):t}function Ki(e){return(Ki=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xi(e,t){return(Xi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Zi(e){return(Zi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var zi=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":Zi(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},$i="q-Value",Ji=[{name:"Correlated Gene Set",render:function(e){return r.createElement("span",{style:{fontWeight:"bold"}},e.geneticEntityName.length>28?e.geneticEntityName.substring(0,25)+"...":e.geneticEntityName)},filter:function(e,t,n){return e.geneticEntityName.indexOf(n)>-1},download:function(e){return e.geneticEntityName},sortBy:function(e){return e.geneticEntityName},width:"60%"},ea("Spearman's Correlation","spearmansCorrelation",!0,!1),ea("p-Value","pValue",!1,!1),Object.assign(ea($i,"qValue",!1,!0),{sortBy:function(e){return[e.qValue,e.pValue]}})];function ea(e,t,n,o){return{name:e,render:function(e){return r.createElement("span",{style:{color:n?Pi(e[t]):"#000000",textAlign:"right",float:"right",whiteSpace:"nowrap"}},o?(0,ce.It)(e[t]):(0,_i.C)(e[t],3,.01))},download:function(e){return e[t].toString()+""},sortBy:function(e){return Oi(e[t])},align:"right"}}var ta=function(e){function t(){var e;return Hi(this,t),e=Yi(this,Ki(t).apply(this,arguments)),Object.defineProperty(Qi(e),"tableModeOptions",{enumerable:!0,configurable:!0,writable:!0,value:[{label:"Show Any Correlation",value:Ka.SHOW_ALL},{label:"Show Only Positively Correlated",value:Ka.SHOW_POSITIVE},{label:"Show Only Negatively Correlated",value:Ka.SHOW_NEGATIVE}]}),Object.defineProperty(Qi(e),"paginationProps",{enumerable:!0,configurable:!0,writable:!0,value:{itemsPerPageOptions:[25]}}),e}var n,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xi(e,t)}(t,e),n=t,(o=[{key:"onRowClick",value:function(e){this.props.dataStore.setHighlighted(e)}},{key:"onSelectTableMode",value:function(e){this.props.onSelectTableMode(e.value)}},{key:"render",value:function(){return r.createElement("div",null,r.createElement("div",{style:{float:"left",display:"flex",flexDirection:"row"}},r.createElement("div",{style:{width:180}},r.createElement(wi.default,{value:this.props.tableMode,onChange:this.onSelectTableMode,options:this.tableModeOptions,searchable:!1,clearable:!1,className:"coexpression-select-table-mode"})),r.createElement(Yo.Z,{style:{marginLeft:21,marginTop:"0.7em"},tooltip:r.createElement("div",{style:{maxWidth:200}},ki.f7),tooltipPlacement:"left"})),r.createElement(An.ZP,{initialSortColumn:$i,initialSortDirection:"asc",columns:Ji,showColumnVisibility:!1,dataStore:this.props.dataStore,onRowClick:this.onRowClick,filterPlaceholder:"Enter gene set..",paginationProps:this.paginationProps,initialItemsPerPage:25,copyDownloadProps:{showCopy:!1}}))}}])&&Wi(n.prototype,o),i&&Wi(n,i),t}(r.Component);zi([Ai.ak],ta.prototype,"onRowClick",null),zi([Ai.ak],ta.prototype,"onSelectTableMode",null);const na=ta=zi([u.observer],ta);var ra=n(17502),oa=n(17163),ia=n(21341);function aa(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function la(e,t,n){return"".concat(n,": ").concat(e.geneticEntityName," ").concat(e.cytoband?"(".concat(e.cytoband,") "):"").concat(t?"(".concat(t.label,") "):"")}function sa(e){return!e.profiledX&&!e.profiledY}var ua=n(58839);function ca(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pa(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function da(e,t){return!t||"object"!==ba(t)&&"function"!=typeof t?fa(e):t}function fa(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ma(e){return(ma=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ha(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ya(e,t)}function ya(e,t){return(ya=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ba(e){return(ba="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ga=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":ba(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},va=function(e){function t(){return pa(this,t),da(this,ma(t).apply(this,arguments))}return ha(t,e),t}(ia.Z),Sa="#0174df",Ca="#58acfa",Ea="#886A08",wa="#DBA901",Ta="#F7819F",Pa="#F5A9F2",Oa="#B40404",ka="#FF0000",Aa="#d3d3d3",Ia="#ffffff";function _a(){}var Da="coexpression-plot-svg",xa=function(e){function t(e){var n;return pa(this,t),n=da(this,ma(t).call(this,e)),(0,c.makeObservable)(fa(n)),n}var n,o,a;return ha(t,e),n=t,(o=[{key:"getSvg",value:function(){return document.getElementById(Da)}},{key:"plot",value:function(){return this.data.length?r.createElement(va,{svgId:Da,title:this.title,data:this.data,size:ua.kl,chartWidth:this.props.width,chartHeight:this.props.height,stroke:this.stroke,fill:this.fill,strokeWidth:1.2,legendData:this.mutationLegendElements,showRegressionLine:this.props.showRegressionLine,logX:this.axisLogScaleFunction,logY:this.axisLogScaleFunction,useLogSpaceTicks:!0,axisLabelX:this.axisLabelX,axisLabelY:this.axisLabelY,tooltip:this.tooltip,fontFamily:"Arial,Helvetica"}):r.createElement("div",{className:"alert alert-info"},"No data to plot.")}},{key:"toolbar",value:function(){return r.createElement("div",{style:{textAlign:"center",position:"relative"}},r.createElement("div",{style:{display:"inline-block"}},this.props.showMutationControls&&r.createElement("div",{className:"checkbox coexpression-plot-toolbar-elt"},r.createElement("label",null,r.createElement("input",{type:"checkbox",checked:this.props.showMutations,onClick:this.props.handlers.onClickShowMutations||_a,"data-test":"ShowMutations"}),"Show Mutations")),this.props.showLogScaleControls&&r.createElement("div",{className:"coexpression-plot-toolbar-elt"},r.createElement("div",{className:"checkbox coexpression-plot-toolbar-elt"},r.createElement("label",null,r.createElement("input",{type:"checkbox",checked:this.props.logScale,onClick:this.props.handlers.onClickLogScale||_a,"data-test":"logScale"}),"Log Scale"))),r.createElement("div",{className:"checkbox coexpression-plot-toolbar-elt"},r.createElement("label",null,r.createElement("input",{type:"checkbox",checked:this.props.showRegressionLine,onClick:this.props.handlers.onClickShowRegressionLine,"data-test":"ShowRegressionLine"}),"Show Regression Line"))),r.createElement(w.t_,{getSvg:this.getSvg,getData:this.getDownloadData,buttons:["SVG","PNG","PDF","Data"],filename:"coexpression",dontFade:!0,type:"button",style:{position:"absolute",top:0,right:0}}))}},{key:"getDownloadData",value:function(){return e=this.props.data,t=this.props.xAxisGeneticEntity,n=this.props.yAxisGeneticEntity,r=this.props.molecularProfileX,o=this.props.molecularProfileY,i=!!this.props.showMutations,a=["Sample ID","".concat(t.geneticEntityName," (").concat(r.name,")"),"".concat(n.geneticEntityName," (").concat(o.name,")")],i&&a.push("".concat(t.geneticEntityName," Mutations"),"".concat(n.geneticEntityName," Mutations")),[a].concat(aa(e.map((function(e){var t=[e.sampleId,e.x,e.y];return i&&t.push(e.profiledX?e.mutationsX||"WT":"NS",e.profiledY?e.mutationsY||"WT":"NS"),t})))).map((function(e){return e.join("\t")})).join("\n");var e,t,n,r,o,i,a}},{key:"tooltip",value:function(e){return r.createElement("div",null,r.createElement("div",null,r.createElement("span",null,"Sample ID: "),r.createElement("a",{href:(0,se.Qk)(e.studyId,e.sampleId)},e.sampleId)),r.createElement("div",null,r.createElement("span",null,this.props.xAxisGeneticEntity.geneticEntityName,":Â ",r.createElement("b",null,e.x.toFixed(2)))),r.createElement("div",null,r.createElement("span",null,this.props.yAxisGeneticEntity.geneticEntityName,":Â ",r.createElement("b",null,e.y.toFixed(2)))),e.mutationsX&&r.createElement("div",null,r.createElement("span",null,this.props.xAxisGeneticEntity.geneticEntityName," ","Mutation:Â ",r.createElement("b",null,e.mutationsX))),e.mutationsY&&r.createElement("div",null,r.createElement("span",null,this.props.yAxisGeneticEntity.geneticEntityName," ","Mutation:Â ",r.createElement("b",null,e.mutationsY))))}},{key:"render",value:function(){return r.createElement("div",{className:"borderedChart inlineBlock","data-test":"CoExpressionPlot"},r.createElement(u.Observer,null,this.toolbar),r.createElement(u.Observer,null,this.plot))}},{key:"stroke",get:function(){return this.props.showMutations?function(e){return sa(e)?Aa:e.mutationsX&&e.mutationsY?Oa:e.mutationsX||e.mutationsY?e.mutationsX?Ea:Ta:Sa}:Sa}},{key:"fill",get:function(){return this.props.showMutations?function(e){return sa(e)?Ia:e.mutationsX&&e.mutationsY?ka:e.mutationsX||e.mutationsY?e.mutationsX?wa:Pa:Ca}:Ca}},{key:"mutationLegendElements",get:function(){if(!this.props.showMutations)return[];var e=!1,t=!1,n=!1,r=!1,o=!1,i=!0,a=!1,l=void 0;try{for(var s,u=this.data[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;sa(c)&&(o=!0),c.mutationsX&&c.mutationsY?e=!0:c.mutationsX||c.mutationsY?c.mutationsX?t=!0:n=!0:r=!0}}catch(e){a=!0,l=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw l}}var p=[];return t&&p.push({name:[this.props.xAxisGeneticEntity.geneticEntityName,"mutated"],symbol:{fill:wa,stroke:Ea}}),n&&p.push({name:[this.props.yAxisGeneticEntity.geneticEntityName,"mutated"],symbol:{fill:Pa,stroke:Ta}}),e&&p.push({name:"Both mutated",symbol:{fill:ka,stroke:Oa}}),r&&p.push({name:"Neither mutated",symbol:{fill:Ca,stroke:Sa}}),o&&p.push({name:"Not profiled for mutations",symbol:{fill:Ia,stroke:Aa}}),p}},{key:"data",get:function(){return i().sortBy(this.props.data,(function(e){return e.mutationsX&&e.mutationsY?3:e.mutationsX||e.mutationsY?2:sa(e)?0:1}))}},{key:"title",get:function(){return"".concat(this.props.xAxisGeneticEntity.geneticEntityName," vs. ").concat(this.props.yAxisGeneticEntity.geneticEntityName)}},{key:"axisLabelX",get:function(){return la({geneticEntityName:this.props.xAxisGeneticEntity.geneticEntityName,cytoband:this.props.xAxisGeneticEntity.cytoband},this.axisLogScaleFunction,this.props.molecularProfileX.name)}},{key:"axisLabelY",get:function(){return la({geneticEntityName:this.props.yAxisGeneticEntity.geneticEntityName},this.axisLogScaleFunction,this.props.molecularProfileY.name)}},{key:"axisLogScaleFunction",get:function(){if(this.props.logScale)return{label:"log2",fLogScale:function(e,t){return Math.log2(Math.max(e,.01))},fInvLogScale:function(e){return Math.pow(2,e)}}}}])&&ca(n.prototype,o),a&&ca(n,a),t}(r.Component);ga([Ai.ak],xa.prototype,"getSvg",null),ga([c.computed],xa.prototype,"stroke",null),ga([c.computed],xa.prototype,"fill",null),ga([c.computed],xa.prototype,"mutationLegendElements",null),ga([c.computed],xa.prototype,"data",null),ga([c.computed],xa.prototype,"axisLabelX",null),ga([c.computed],xa.prototype,"axisLabelY",null),ga([c.computed],xa.prototype,"axisLogScaleFunction",null),ga([Ai.ak],xa.prototype,"plot",null),ga([Ai.ak],xa.prototype,"toolbar",null),ga([S.default],xa.prototype,"getDownloadData",null),ga([Ai.ak],xa.prototype,"tooltip",null);const Ma=xa=ga([u.observer],xa);var Na="Â ";function La(e){return e.map((function(e){return"".concat(e.proteinChange).concat((0,we.cn)(e)?"":" [germline]")})).filter((function(e){return!!e})).join(", ")}function Ra(e,t,n,r,o){var i=o[t];return!!i&&(0,te.vs)(e,i.molecularProfileId,n,r)}var ja=n(55505);function Ga(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Va(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fa(e,t,n){return t&&Va(e.prototype,t),n&&Va(e,n),e}function Ba(e,t){return!t||"object"!==Ya(t)&&"function"!=typeof t?Ua(e):t}function qa(e){return(qa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ua(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ha(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wa(e,t)}function Wa(e,t){return(Wa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ya(e){return(Ya="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Ka,Qa=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":Ya(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};!function(e){e[e.SHOW_ALL=0]="SHOW_ALL",e[e.SHOW_POSITIVE=1]="SHOW_POSITIVE",e[e.SHOW_NEGATIVE=2]="SHOW_NEGATIVE"}(Ka||(Ka={}));var Xa=function(e){function t(e,n,r){var o;return Ga(this,t),o=Ba(this,qa(t).call(this,e)),Object.defineProperty(Ua(o),"setHighlighted",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(Ua(o),"tableMode",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Ua(o),"reactionDisposer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),(0,c.makeObservable)(Ua(o)),o.tableMode=Ka.SHOW_ALL,o.dataHighlighter=function(e){var t=n();return!(!t||e.geneticEntityId!==t.geneticEntityId)},o.dataSelector=function(e){var t;switch(o.tableMode){case Ka.SHOW_POSITIVE:t=e.spearmansCorrelation>=0;break;case Ka.SHOW_NEGATIVE:t=e.spearmansCorrelation<=0;break;default:t=!0}return t},o.reactionDisposer=(0,c.autorun)((function(){o.sortMetric&&o.sortedFilteredData.length>0&&!n()&&o.setHighlighted(o.sortedFilteredData[0])})),o}return Ha(t,e),Fa(t,[{key:"destroy",value:function(){this.reactionDisposer()}}]),t}(ra.Lq);Qa([c.observable],Xa.prototype,"tableMode",void 0);var Za=function(e){function t(e){var n;return Ga(this,t),n=Ba(this,qa(t).call(this,e)),Object.defineProperty(Ua(n),"highlightedCoExpression",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Ua(n),"allDataRequested",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(Ua(n),"lastCoExpressionData",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Ua(n),"coExpressionsWithQValues",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[n.coExpressionDataPromise]},invoke:function(){var e=n.coExpressionDataPromise.result,t=i().sortBy(e,(function(e){return e.pValue}));return(0,ja.f)(t.map((function(e){return e.pValue}))).forEach((function(e,n){t[n].qValue=e})),Promise.resolve(t)}})}),Object.defineProperty(Ua(n),"dataStore",{enumerable:!0,configurable:!0,writable:!0,value:new Xa((function(){return n.props.hidden?n.lastCoExpressionData||[]:n.coExpressionsWithQValues.isComplete?(n.lastCoExpressionData=n.coExpressionsWithQValues.result,n.coExpressionsWithQValues.result):[]}),(function(){return n.highlightedCoExpression}),(function(e){n.highlightedCoExpression=e}))}),Object.defineProperty(Ua(n),"plotData",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){if(n.props.hidden)return[];var e=n.getPlotDataPromises(n.highlightedCoExpression),t=[n.props.coverageInformation,n.props.studyToMutationMolecularProfile,e.molecularX];return e.mutationX&&t.push(e.mutationX),e.molecularY&&t.push(e.molecularY),e.mutationY&&t.push(e.mutationY),t},invoke:function(){if(n.props.hidden)return Promise.resolve([]);if(!n.highlightedCoExpression)return Promise.resolve([]);var e=n.getPlotDataPromises(n.highlightedCoExpression),t=[];e.molecularX&&e.molecularX.isComplete&&(t=t.concat(e.molecularX.result)),e.molecularY&&e.molecularY.isComplete&&(t=t.concat(e.molecularY.result));var r=[];return e.mutationX&&e.mutationX.isComplete&&(r=r.concat(e.mutationX.result)),e.mutationY&&e.mutationY.isComplete&&(r=r.concat(e.mutationY.result)),Promise.resolve(function(e,t,n,r,o,i,a,l){var s={},u={},c={},p={},d={},f=function(e){d[e.uniqueSampleKey]||(d[e.uniqueSampleKey]=e)};if("number"==typeof n){var m=!0,h=!1,y=void 0;try{for(var b,g=t[Symbol.iterator]();!(m=(b=g.next()).done);m=!0){var v=b.value;if(v.proteinChange){var S=v.entrezGeneId===n?c:p;S[v.uniqueSampleKey]=S[v.uniqueSampleKey]||[],S[v.uniqueSampleKey].push(v),f(v)}}}catch(e){h=!0,y=e}finally{try{m||null==g.return||g.return()}finally{if(h)throw y}}}if(e[0]&&void 0!==e[0].entrezGeneId){var C=!0,E=!1,w=void 0;try{for(var T,P=e[Symbol.iterator]();!(C=(T=P.next()).done);C=!0){var O=T.value;(O.entrezGeneId===n?s:u)[O.uniqueSampleKey]=O,f(O)}}catch(e){E=!0,w=e}finally{try{C||null==P.return||P.return()}finally{if(E)throw w}}}else{var k=!0,A=!1,I=void 0;try{for(var _,D=e[Symbol.iterator]();!(k=(_=D.next()).done);k=!0){var x=_.value;(x.genesetId===n.toString()?s:u)[x.uniqueSampleKey]=x,f(x)}}catch(e){A=!0,I=e}finally{try{k||null==D.return||D.return()}finally{if(A)throw I}}}for(var M=[],N=0,L=Object.keys(s);N<L.length;N++){var R=L[N],j=d[R].studyId,G=s[R],V=u[R];if(G&&V){var F=Number(G.value),B=Number(V.value);isNaN(F)||isNaN(B)||M.push({x:F,y:B,mutationsX:La(c[R]||[]),mutationsY:La(p[R]||[]),profiledX:"number"==typeof n&&Ra(R,j,o,a,l),profiledY:"number"==typeof r&&Ra(R,j,i,a,l),studyId:j,sampleId:d[R].sampleId})}}return M}(t,r,n.props.geneticEntity.geneticEntityId,isNaN(Number(n.highlightedCoExpression.geneticEntityId))?n.highlightedCoExpression.geneticEntityId:Number(n.highlightedCoExpression.geneticEntityId),n.props.geneticEntity.geneticEntityName,n.highlightedCoExpression.geneticEntityName,n.props.coverageInformation.result,n.props.studyToMutationMolecularProfile.result))}})}),(0,c.makeObservable)(Ua(n)),n}return Ha(t,e),Fa(t,[{key:"onSelectTableMode",value:function(e){this.dataStore.tableMode=e}},{key:"requestAllData",value:function(){this.allDataRequested=!0}},{key:"getPlotDataPromises",value:function(e){var t={molecularX:this.props.profileX.molecularAlterationType===p.YK.GENESET_SCORE?this.props.numericGenesetMolecularDataCache.get({genesetId:this.props.geneticEntity.geneticEntityId.toString(),molecularProfileId:this.props.profileX.molecularProfileId}):this.props.numericGeneMolecularDataCache.get({entrezGeneId:parseInt(String(this.props.geneticEntity.geneticEntityId),10),molecularProfileId:this.props.profileX.molecularProfileId}),mutationX:void 0,molecularY:void 0,mutationY:void 0};return e&&(t.molecularY=this.props.profileY.molecularAlterationType===p.YK.GENESET_SCORE?this.props.numericGenesetMolecularDataCache.get({genesetId:e.geneticEntityId,molecularProfileId:this.props.profileY.molecularProfileId}):this.props.numericGeneMolecularDataCache.get({entrezGeneId:parseInt(e.geneticEntityId,10),molecularProfileId:this.props.profileY.molecularProfileId})),this.props.mutationCache&&(t.mutationX=this.props.mutationCache.get({entrezGeneId:parseInt(String(this.props.geneticEntity.geneticEntityId),10)}),e&&(t.mutationY=this.props.mutationCache.get({entrezGeneId:parseInt(e.geneticEntityId,10)}))),t}},{key:"table",value:function(){return this.props.profileY.molecularAlterationType!==p.YK.GENESET_SCORE?r.createElement("div",null,r.createElement(Ui,{referenceGeneticEntity:this.props.geneticEntity.geneticEntityData,dataStore:this.dataStore,tableMode:this.dataStore.tableMode,onSelectTableMode:this.onSelectTableMode}),this.requestAllDataButton):r.createElement("div",null,r.createElement(na,{referenceGeneticEntity:this.props.geneticEntity.geneticEntityData,dataStore:this.dataStore,tableMode:this.dataStore.tableMode,onSelectTableMode:this.onSelectTableMode}),this.requestAllDataButton)}},{key:"plot",value:function(){if(this.props.hidden)return r.createElement("span",null);if(this.plotData.isError)return r.createElement("span",null,"Error fetching data. Please refresh the page and try again.");var e;if(this.highlightedCoExpression){e={geneticEntityName:this.highlightedCoExpression.geneticEntityName,geneticEntityType:this.highlightedCoExpression.geneticEntityType,geneticEntityId:this.highlightedCoExpression.geneticEntityId,cytoband:this.highlightedCoExpression.cytoband,geneticEntityData:{geneticEntityId:0,entrezGeneId:0,hugoGeneSymbol:"",type:""}}}return r.createElement("div",{style:{position:"relative"}},r.createElement(ee.Z,{isLoading:this.dataStore.allData.length>0&&(this.plotData.isPending||!this.highlightedCoExpression),center:!0,size:"big"}),this.plotData.isComplete&&this.highlightedCoExpression&&r.createElement("div",{style:{marginLeft:10}},r.createElement(Ma,{xAxisGeneticEntity:this.props.geneticEntity,yAxisGeneticEntity:e,data:this.plotData.result,showLogScaleControls:this.showLogScaleControls,showMutationControls:this.showMutationControls,showMutations:this.plotShowMutations,showRegressionLine:this.props.plotState.plotShowRegressionLine,logScale:this.plotLogScale,handlers:this.props.plotHandlers,molecularProfileY:this.props.profileY,molecularProfileX:this.props.profileX,height:530,width:530})))}},{key:"componentWillUnmount",value:function(){this.dataStore.destroy()}},{key:"render",value:function(){var e=r.createElement("div",{style:{display:!this.props.hidden&&this.coExpressionsWithQValues.isComplete?"inherit":"none"},"data-test":"CoExpressionGeneTabContent"},r.createElement("div",{className:"clearfix"},this.dataStore.allData.length>0?[r.createElement("div",{style:{width:"40%",float:"left",marginTop:6}},r.createElement(u.Observer,null,this.table)),r.createElement("div",{style:{width:"60%",float:"right",marginTop:6}},r.createElement(u.Observer,null,this.plot))]:r.createElement("div",{style:{position:"absolute",top:200,left:"50%",transform:"translate(-50%, 0)"}},"There is no expression data for"," ",r.createElement("strong",null,this.props.geneticEntity.geneticEntityName)," ","with the selected samples in"," ",r.createElement("strong",null,this.props.profileX.name),".")));return r.createElement("div",{style:{display:this.props.hidden?"none":"inherit",minHeight:826,position:"relative"}},e,r.createElement(ee.Z,{isLoading:!this.props.hidden&&this.coExpressionsWithQValues.isPending,center:!0,size:"big"}))}},{key:"coExpressionDataPromise",get:function(){return this.props.coExpressionCache.get({geneticEntityId:this.props.geneticEntity.geneticEntityId.toString(),geneticEntityType:this.props.geneticEntity.geneticEntityType,profileX:this.props.profileX,profileY:this.props.profileY,allData:this.allDataRequested})}},{key:"plotShowMutations",get:function(){return this.props.plotState.plotShowMutations&&this.showMutationControls}},{key:"plotLogScale",get:function(){return this.props.plotState.plotLogScale&&this.showLogScaleControls}},{key:"showMutationControls",get:function(){return!!this.props.mutationCache}},{key:"showLogScaleControls",get:function(){var e=this.props.profileX.molecularProfileId.toLowerCase(),t=this.props.profileY.molecularProfileId.toLowerCase();return(0,oa.fj)(e)||(0,oa.fj)(t)}},{key:"requestAllDataButton",get:function(){return!this.plotData.isComplete||this.dataStore.allData.length||this.allDataRequested?null:r.createElement("div",null,r.createElement("span",{style:{marginRight:5}},(e=this.props.geneticEntity.geneticEntityName,"There are no genes with a Pearson or Spearman correlation with ".concat(e," of").concat(Na,">").concat(Na,"0.3").concat(Na,"or").concat(Na,"<").concat(Na,"-0.3."))),r.createElement(f.Button,{onClick:this.requestAllData},"Load data for all genes."));var e}}]),t}(r.Component);Qa([c.observable.ref],Za.prototype,"highlightedCoExpression",void 0),Qa([c.observable],Za.prototype,"allDataRequested",void 0),Qa([c.action.bound],Za.prototype,"onSelectTableMode",null),Qa([c.action.bound],Za.prototype,"requestAllData",null),Qa([c.computed],Za.prototype,"plotShowMutations",null),Qa([c.computed],Za.prototype,"plotLogScale",null),Qa([c.computed],Za.prototype,"showMutationControls",null),Qa([c.computed],Za.prototype,"showLogScaleControls",null),Qa([Ai.ak],Za.prototype,"table",null),Qa([Ai.ak],Za.prototype,"plot",null);const za=Za=Qa([u.observer],Za);var $a=n(77791);function Ja(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function el(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tl(e,t){return!t||"object"!==al(t)&&"function"!=typeof t?nl(e):t}function nl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rl(e){return(rl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ol(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&il(e,t)}function il(e,t){return(il=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function al(e){return(al="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ll=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":al(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},sl=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))},ul=function(e){function t(){return el(this,t),tl(this,rl(t).apply(this,arguments))}return ol(t,e),t}($a.Z),cl=function(e){function t(e){var n;return el(this,t),n=tl(this,rl(t).call(this,e)),Object.defineProperty(nl(n),"_selectedProfileX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(nl(n),"_selectedProfileY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(nl(n),"_selectedGeneticEntity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(nl(n),"selectedProfileX",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[n.xProfileOptions]},invoke:function(){return!n._selectedProfileX&&n.xProfileOptions.result.length>0?Promise.resolve(n.xProfileOptions.result[0].value):Promise.resolve(n._selectedProfileX)}})}),Object.defineProperty(nl(n),"selectedProfileY",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[n.yProfileOptions]},invoke:function(){return!n._selectedProfileY&&n.yProfileOptions.result.length>0?Promise.resolve(n.yProfileOptions.result[0].value):Promise.resolve(n._selectedProfileY)}})}),Object.defineProperty(nl(n),"selectedGeneticEntity",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[n.props.store.geneticEntities]},invoke:function(){return n._selectedGeneticEntity?Promise.resolve(n._selectedGeneticEntity):Promise.resolve(n.props.store.geneticEntities.result[0])}})}),Object.defineProperty(nl(n),"isSelectedGeneticEntityAGeneSet",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[n.props.store.geneticEntities]},invoke:function(){if(n._selectedGeneticEntity){var e=!0,t=!1,r=void 0;try{for(var o,i=n.props.store.geneticEntities.result[Symbol.iterator]();!(e=(o=i.next()).done);e=!0){var a=o.value;if(a.geneticEntityType===p.Mz.GENESET&&a.geneticEntityId===n._selectedGeneticEntity.geneticEntityId)return Promise.resolve(!0)}}catch(e){t=!0,r=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw r}}}return Promise.resolve(!1)}})}),Object.defineProperty(nl(n),"plotState",{enumerable:!0,configurable:!0,writable:!0,value:{plotLogScale:!1,plotShowMutations:!0,plotShowRegressionLine:!1}}),Object.defineProperty(nl(n),"plotHandlers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(nl(n),"xProfileOptions",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[n.props.store.coexpressionTabMolecularProfiles,n.isSelectedGeneticEntityAGeneSet,n.props.store.molecularProfileIdToProfiledFilteredSamples]},invoke:function(){var e=[];return e=n.isSelectedGeneticEntityAGeneSet.result?(0,ki.Vv)(n.props.store.coexpressionTabMolecularProfiles.result):(0,ki.aL)(n.props.store.coexpressionTabMolecularProfiles.result),Promise.resolve((0,ki.mY)(e,n.props.store.molecularProfileIdToProfiledFilteredSamples.result))}})}),Object.defineProperty(nl(n),"yProfileOptions",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[n.props.store.coexpressionTabMolecularProfiles,n.props.store.molecularProfileIdToProfiledFilteredSamples]},invoke:function(){return Promise.resolve((0,ki.mY)(n.props.store.coexpressionTabMolecularProfiles.result,n.props.store.molecularProfileIdToProfiledFilteredSamples.result))}})}),Object.defineProperty(nl(n),"coExpressionCache",{enumerable:!0,configurable:!0,writable:!0,value:new ul((function(e){return{await:function(){return[n.props.store.entrezGeneIdToGeneAll,n.props.store.entrezGeneIdToReferenceGene,n.props.store.molecularProfileIdToProfiledFilteredSamples]},invoke:function(){return sl(nl(n),void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,o,a,l,s,u,c,d,f,m,h;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=.3,e.allData&&(n=0),r=this.props.store.molecularProfileIdToProfiledFilteredSamples.result[e.profileX.molecularProfileId],o=this.props.store.molecularProfileIdToProfiledFilteredSamples.result[e.profileY.molecularProfileId],a={},e.profileX.molecularProfileId===e.profileY.molecularProfileId?a=this.props.store.studyToDataQueryFilter.result[e.profileX.studyId]:(l=i().intersectionWith(r,o,(function(e,t){return e.uniqueSampleKey===t.uniqueSampleKey})),a.sampleIds=l.map((function(e){return e.sampleId}))),!i().isEmpty(a.sampleIds)||!i().isEmpty(a.sampleListId)){t.next=8;break}return t.abrupt("return",Promise.resolve([]));case 8:if(null==(s=this.createDataQueryFilterForCoExpression(a,e.geneticEntityId,e.geneticEntityType))){t.next=26;break}return void 0,t.next=13,Ti.Z.fetchCoExpressionsUsingPOST({molecularProfileIdA:e.profileX.molecularProfileId,molecularProfileIdB:e.profileY.molecularProfileId,coExpressionFilter:s,threshold:n,$domain:undefined});case 13:if(u=t.sent,c={},e.profileY.molecularAlterationType!==p.YK.GENESET_SCORE){t.next=21;break}return d=i().chain(u).map((function(e){return e.geneticEntityId})).uniq().value(),t.next=19,Ti.Z.fetchGenesetsUsingPOST({genesetIds:d});case 19:f=t.sent,c=i().keyBy(f,(function(e){return e.genesetId}));case 21:return m=this.props.store.entrezGeneIdToReferenceGene.result||{},h=this.props.store.entrezGeneIdToGeneAll.result||{},t.abrupt("return",Promise.resolve(i().reduce(u,(function(t,n){var r=void 0,o="-";return e.profileY.molecularAlterationType===p.YK.GENESET_SCORE?r=c[n.geneticEntityId].name:void 0!==m[n.geneticEntityId]?(r=m[n.geneticEntityId].hugoGeneSymbol,o=m[n.geneticEntityId].cytoband):void 0!==h[n.geneticEntityId]&&(r=h[n.geneticEntityId].hugoGeneSymbol,o=""),void 0!==r&&t.push(Object.assign(Object.assign({},n),{geneticEntityName:r,cytoband:o})),t}),[])));case 26:return t.abrupt("return",Promise.resolve([]));case 27:case"end":return t.stop()}}),t,this)})))}}}),(function(e){return"".concat(e.geneticEntityId,",").concat(e.profileX.molecularProfileId,",").concat(e.profileY.molecularProfileId)}))}),(0,c.makeObservable)(nl(n)),window.resultsViewCoExpressionTab=nl(n),n.plotHandlers={onClickLogScale:(0,c.action)((function(){n.plotState.plotLogScale=!n.plotState.plotLogScale})),onClickShowMutations:(0,c.action)((function(){n.plotState.plotShowMutations=!n.plotState.plotShowMutations})),onClickShowRegressionLine:(0,c.action)((function(){n.plotState.plotShowRegressionLine=!n.plotState.plotShowRegressionLine}))},n}var n,o,a;return ol(t,e),n=t,(o=[{key:"onSelectProfileX",value:function(e){this._selectedProfileX=e.value}},{key:"onSelectProfileY",value:function(e){this._selectedProfileY=e.value}},{key:"onSelectGeneticEntity",value:function(e){if(!this.props.store.geneticEntities.isComplete)throw new Error("Invalid Genetic Entity");var t=!0,n=!1,r=void 0;try{for(var o,i=this.props.store.geneticEntities.result[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;a.geneticEntityId.toString()===e&&(this._selectedGeneticEntity=a)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}},{key:"createDataQueryFilterForCoExpression",value:function(e,t,n){var r=void 0;return n===p.Mz.GENE?r=Object.assign(Object.assign({},e),{entrezGeneId:parseFloat(t)}):n===p.Mz.GENESET&&(r=Object.assign(Object.assign({},e),{genesetId:t})),r}},{key:"header",value:function(){return r.createElement("div",{style:{marginBottom:20}},this.profilesSelector)}},{key:"geneTabs",value:function(){if(this.selectedGeneticEntity.isComplete&&this.selectedProfileX.isComplete&&this.selectedProfileY.isComplete&&this.props.store.geneticEntities.isComplete&&this.props.store.coexpressionTabMolecularProfiles.isComplete){var e=[],t=!0,n=!1,o=void 0;try{for(var i,a=this.props.store.geneticEntities.result[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var l=i.value,s=!0,c=!1,f=void 0;try{for(var m,h=(l.geneticEntityType===p.Mz.GENE?(0,ki.aL)(this.props.store.coexpressionTabMolecularProfiles.result):(0,ki.Vv)(this.props.store.coexpressionTabMolecularProfiles.result))[Symbol.iterator]();!(s=(m=h.next()).done);s=!0){var y=m.value,b=!0,g=!1,v=void 0;try{for(var S,C=this.props.store.coexpressionTabMolecularProfiles.result[Symbol.iterator]();!(b=(S=C.next()).done);b=!0){var E=S.value;e.push(r.createElement(za,{key:"".concat(l.geneticEntityId,",").concat(y.molecularProfileId,",").concat(E.molecularProfileId),coExpressionCache:this.coExpressionCache,geneticEntity:l,profileX:y,profileY:E,numericGeneMolecularDataCache:this.props.store.numericGeneMolecularDataCache,numericGenesetMolecularDataCache:this.props.store.numericGenesetMolecularDataCache,mutationCache:this.hasMutationData?this.props.store.mutationCache:void 0,hidden:y.molecularProfileId!==this.selectedProfileX.result||E.molecularProfileId!==this.selectedProfileY.result||l.geneticEntityId!==this.selectedGeneticEntity.result.geneticEntityId,plotState:this.plotState,plotHandlers:this.plotHandlers,coverageInformation:this.props.store.coverageInformation,studyToMutationMolecularProfile:this.props.store.studyToMutationMolecularProfile}))}}catch(e){g=!0,v=e}finally{try{b||null==C.return||C.return()}finally{if(g)throw v}}}}catch(e){c=!0,f=e}finally{try{s||null==h.return||h.return()}finally{if(c)throw f}}}}catch(e){n=!0,o=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw o}}return r.createElement("div",null,r.createElement(d.Kh,{id:"coexpressionTabGeneTabs",activeTabId:this.selectedGeneticEntity.result.geneticEntityId.toString(),onTabClick:this.onSelectGeneticEntity,className:"coexpressionTabGeneTabs pillTabs",unmountOnHide:!0,tabButtonStyle:"pills",arrowStyle:{"line-height":.8}},this.props.store.geneticEntities.result.map((function(e,t){return r.createElement(d.l6,{key:t,id:e.geneticEntityId.toString(),linkText:e.geneticEntityName})}))),r.createElement(u.Observer,null,this.header),e)}return r.createElement(ee.Z,{isLoading:!0,center:!0,size:"big"})}},{key:"render",value:function(){var e=null;e=this.props.store.coexpressionTabMolecularProfiles.isComplete&&this.props.store.coexpressionTabMolecularProfiles.result.length>0?r.createElement("div",null,r.createElement(u.Observer,null,this.geneTabs)):r.createElement("div",{className:"alert alert-info"},"There are no available profiles in the queried studies.");var t=(0,ie.CX)(this.props.store.genes,this.props.store.molecularProfileIdToProfiledFilteredSamples,this.props.store.coexpressionTabMolecularProfiles);return r.createElement("div",{"data-test":"coExpressionTabDiv"},r.createElement("div",{className:"tabMessageContainer"},r.createElement(oe.Z,{className:"coexp-oql-status-banner",store:this.props.store,tabReflectsOql:!1}),r.createElement(ae.Z,{store:this.props.store,isUnaffected:!0}),r.createElement(ue.Z,{store:this.props.store})),"complete"===t&&e,r.createElement(ee.Z,{center:!0,size:"big",isLoading:"pending"===t}))}},{key:"hasMutationData",get:function(){return i().some(this.props.store.molecularProfilesWithData.result,(function(e){return e.molecularAlterationType===p.YK.MUTATION_EXTENDED}))}},{key:"profilesSelector",get:function(){return this.selectedGeneticEntity.isComplete&&this.selectedProfileX.isComplete&&this.selectedProfileY.isComplete&&this.xProfileOptions.isComplete&&this.yProfileOptions.isComplete&&this.props.store.coexpressionTabMolecularProfiles.isComplete&&this.isSelectedGeneticEntityAGeneSet.isComplete?r.createElement("div",null,r.createElement("div",{style:{float:"left",width:"100%",display:"flex",alignItems:"center"}},r.createElement("span",null,"Find"," ",(0,ki.Vv)(this.props.store.coexpressionTabMolecularProfiles.result).length>0?"genes/genesets":"genes"," ","in"," "),r.createElement("div",{style:{display:"inline-block",width:376,marginLeft:4,marginRight:4,zIndex:10}},r.createElement(wi.default,{name:"query-profile-select",value:this.selectedProfileY.result,onChange:this.onSelectProfileY,options:this.yProfileOptions.result,searchable:!1,clearable:!1,className:"coexpression-select-query-profile"})),r.createElement("span",null," ","that are correlated with"," ",this.selectedGeneticEntity.result.geneticEntityName," ","in"," "),r.createElement("div",{style:{display:"inline-block",width:376,marginLeft:4,marginRight:4,zIndex:15}},r.createElement(wi.default,{name:"subject-profile-select",value:this.selectedProfileX.result,onChange:this.onSelectProfileX,options:this.xProfileOptions.result,searchable:!1,clearable:!1,disabled:this.isSelectedGeneticEntityAGeneSet.result,className:"coexpression-select-subject-profile"})))):r.createElement(ee.Z,{isLoading:!0,center:!0,size:"big"})}}])&&Ja(n.prototype,o),a&&Ja(n,a),t}(r.Component);ll([c.observable.ref],cl.prototype,"_selectedProfileX",void 0),ll([c.observable.ref],cl.prototype,"_selectedProfileY",void 0),ll([c.observable],cl.prototype,"_selectedGeneticEntity",void 0),ll([c.observable],cl.prototype,"plotState",void 0),ll([Ai.ak],cl.prototype,"onSelectProfileX",null),ll([Ai.ak],cl.prototype,"onSelectProfileY",null),ll([Ai.ak],cl.prototype,"onSelectGeneticEntity",null),ll([c.computed],cl.prototype,"hasMutationData",null),ll([Ai.ak],cl.prototype,"header",null),ll([Ai.ak],cl.prototype,"geneTabs",null);const pl=cl=ll([u.observer],cl);var dl=n(23368),fl=n(94916),ml=n(66798),hl=n(2648),yl=n(16168),bl=n(11037),gl=n(94745),vl=n(35595),Sl=n(38659),Cl=n(18474),El=n(25565),wl=n(30177);function Tl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Pl(e){return(Pl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ol(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kl(e,t){return(kl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Al(e){return(Al="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Il=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":Al(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},_l=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))},Dl=function(e){function t(e,n,r){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=function(e,t){return!t||"object"!==Al(t)&&"function"!=typeof t?Ol(e):t}(this,Pl(t).call(this,e,n,r)),Object.defineProperty(Ol(o),"urlWrapper",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(Ol(o),"resultsViewStore",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(Ol(o),"_originalGroups",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[o.resultsViewStore.comparisonTabGroups]},invoke:function(){var e=o.resultsViewStore.comparisonTabGroups.result;if(o.groupOrder){var t=(0,w.ky)(o.groupOrder);return Promise.resolve(i().sortBy(e,(function(e){return(0,Jr.Z)(t[e.name],Number.POSITIVE_INFINITY)})))}return Promise.resolve(e)}})}),Object.defineProperty(Ol(o),"nameToUserCreatedGroup",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[o._session]},invoke:function(){return Promise.resolve(i().keyBy(o._session.result.groups,(function(e){return e.name})))}})}),(0,c.makeObservable)(Ol(o)),o}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kl(e,t)}(t,e),n=t,(r=[{key:"updateOverlapStrategy",value:function(e){this.urlWrapper.updateURL({comparison_overlapStrategy:e})}},{key:"setUsePatientLevelEnrichments",value:function(e){this.resultsViewStore.setUsePatientLevelEnrichments(e)}},{key:"isGroupDeletable",value:function(e){return!!this.nameToUserCreatedGroup.isComplete&&e.name in this.nameToUserCreatedGroup.result}},{key:"updateSelectedGroups",value:function(e){this.urlWrapper.updateURL({comparison_selectedGroups:JSON.stringify(e)})}},{key:"isGroupSelected",value:function(e){return this.selectedGroups.includes(e)}},{key:"toggleGroupSelected",value:function(e){var t=this.selectedGroups.slice();t.includes(e)?t.splice(t.indexOf(e),1):t.push(e),this.updateSelectedGroups(t)}},{key:"selectAllGroups",value:function(){var e=this._originalGroups.result;this.updateSelectedGroups(e.map((function(e){return e.name})))}},{key:"deselectAllGroups",value:function(){this.updateSelectedGroups([])}},{key:"updateGroupOrder",value:function(e,t){var n=this.groupOrder;n||(n=this._originalGroups.result.map((function(e){return e.name})));var r=(n=n.slice()).splice(e,1)[0];n.splice(t,0,r),this.urlWrapper.updateURL({comparison_groupOrder:JSON.stringify(n)})}},{key:"saveAndGoToSession",value:function(e){return _l(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,wl.Z.addComparisonSession(e);case 2:n=t.sent,r=n.id,this.urlWrapper.updateURL({comparison_createdGroupsSessionId:r}),this.newSessionPending=!1;case 6:case"end":return t.stop()}}),t,this)})))}},{key:"overlapStrategy",get:function(){return this.urlWrapper.query.comparison_overlapStrategy||Cl.T.EXCLUDE}},{key:"usePatientLevelEnrichments",get:function(){return this.resultsViewStore.usePatientLevelEnrichments}},{key:"_session",get:function(){return this.resultsViewStore.comparisonTabComparisonSession}},{key:"selectedGroups",get:function(){var e=this.urlWrapper.query.comparison_selectedGroups;return e?JSON.parse(e):[El.vj,El.iA]}},{key:"groupOrder",get:function(){var e=this.urlWrapper.query.comparison_groupOrder;return e?JSON.parse(e):void 0}},{key:"samples",get:function(){return this.resultsViewStore.samples}},{key:"studies",get:function(){return this.resultsViewStore.studies}}])&&Tl(n.prototype,r),o&&Tl(n,o),t}(Cl.Z);Il([c.action],Dl.prototype,"updateOverlapStrategy",null),Il([c.computed],Dl.prototype,"overlapStrategy",null),Il([c.computed],Dl.prototype,"usePatientLevelEnrichments",null),Il([c.action.bound],Dl.prototype,"setUsePatientLevelEnrichments",null),Il([c.computed],Dl.prototype,"_session",null),Il([S.default],Dl.prototype,"isGroupDeletable",null),Il([c.computed],Dl.prototype,"selectedGroups",null),Il([c.action],Dl.prototype,"updateSelectedGroups",null),Il([S.default],Dl.prototype,"isGroupSelected",null),Il([c.action.bound],Dl.prototype,"toggleGroupSelected",null),Il([c.action.bound],Dl.prototype,"selectAllGroups",null),Il([c.action.bound],Dl.prototype,"deselectAllGroups",null),Il([c.computed],Dl.prototype,"groupOrder",null),Il([c.action],Dl.prototype,"updateGroupOrder",null),Il([c.action],Dl.prototype,"saveAndGoToSession",null);var xl=n(62046),Ml=n(37672),Nl=n(6790),Ll=n.n(Nl),Rl=n(42764),jl=n(4538),Gl=n(24952),Vl=n(15127),Fl=n(98638),Bl=n(7515),ql=n.n(Bl),Ul=n(57761);function Hl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wl(e){return(Wl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Yl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kl(e,t){return(Kl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ql(e){return(Ql="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Xl=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":Ql(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Zl=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=function(e,t){return!t||"object"!==Ql(t)&&"function"!=typeof t?Yl(e):t}(this,Wl(t).call(this,e)),Object.defineProperty(Yl(n),"store",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Yl(n),"overlapStrategySelector",{enumerable:!0,configurable:!0,writable:!0,value:(0,Fo.F)({await:function(){return[n.store.overlapComputations]},render:function(){if(n.store.overlapComputations.result.totalSampleOverlap||n.store.overlapComputations.result.totalPatientOverlap){var e="Include overlapping samples and patients",t="Exclude overlapping samples and patients";return r.createElement("div",{style:{minWidth:355,width:355,zIndex:20}},r.createElement(Sl.default,{name:"select overlap strategy",onChange:function(e){e&&n.onOverlapStrategySelect(e)},options:[{label:e,value:Cl.T.INCLUDE},{label:t,value:Cl.T.EXCLUDE}],clearable:!1,searchable:!1,value:{label:n.store.overlapStrategy===Cl.T.EXCLUDE?t:e,value:n.store.overlapStrategy}}))}return null}})}),Object.defineProperty(Yl(n),"tabs",{enumerable:!0,configurable:!0,writable:!0,value:(0,Fo.F)({await:function(){return[n.store._activeGroupsNotOverlapRemoved,n.store.activeGroups,n.store.mutationEnrichmentProfiles,n.store.structuralVariantEnrichmentProfiles,n.store.copyNumberEnrichmentProfiles,n.store.mRNAEnrichmentProfiles,n.store.proteinEnrichmentProfiles,n.store.methylationEnrichmentProfiles,n.store.survivalClinicalDataExists,n.store.genericAssayEnrichmentProfilesGroupedByGenericAssayType]},render:function(){return r.createElement(d.Kh,{unmountOnHide:!1,activeTabId:n.props.urlWrapper.comparisonSubTabId,onTabClick:n.props.urlWrapper.setComparisonSubTabId,className:"secondaryNavigation comparisonTabSubTabs"},r.createElement(d.l6,{id:xl.ig.OVERLAP,linkText:"Overlap"},r.createElement(yl.Z,{store:n.store})),n.store.showSurvivalTab&&r.createElement(d.l6,{id:xl.ig.SURVIVAL,linkText:"Survival",anchorClassName:n.store.survivalTabUnavailable?"greyedOut":""},r.createElement(Ml.Z,{store:n.store})),r.createElement(d.l6,{id:xl.ig.CLINICAL,linkText:"Clinical",anchorClassName:n.store.clinicalTabUnavailable?"greyedOut":""},r.createElement(bl.ZP,{store:n.store})),n.store.showAlterationsTab&&r.createElement(d.l6,{id:hr.YP.ALTERATIONS,linkText:n.alterationEnrichmentTabName,anchorClassName:n.store.alterationsTabUnavailable?"greyedOut":""},n.store.activeGroups.isComplete&&n.store.activeGroups.result.length>1&&(0,pn.Ib)().skin_show_settings_menu&&r.createElement(Ul.AI,{store:n.store,updateSelectedEnrichmentEventTypes:n.store.updateSelectedEnrichmentEventTypes})||r.createElement(Vl.Z,{classNames:ql().inlineAlterationTypeSelectorMenu,store:n.store,updateSelectedEnrichmentEventTypes:n.store.updateSelectedEnrichmentEventTypes,showMutations:n.store.hasMutationEnrichmentData,showCnas:n.store.hasCnaEnrichmentData,showStructuralVariants:n.store.hasStructuralVariantData}),r.createElement(Gl.Z,{store:n.store,resultsViewStore:n.props.store})),n.store.showMRNATab&&r.createElement(d.l6,{id:xl.ig.MRNA,linkText:"mRNA",anchorClassName:n.store.mRNATabUnavailable?"greyedOut":""},r.createElement(gl.Z,{store:n.store,resultsViewMode:!0})),n.store.showProteinTab&&r.createElement(d.l6,{id:xl.ig.PROTEIN,linkText:"Protein",anchorClassName:n.store.proteinTabUnavailable?"greyedOut":""},r.createElement(vl.Z,{store:n.store,resultsViewMode:!0})),n.store.showMethylationTab&&r.createElement(d.l6,{id:xl.ig.DNAMETHYLATION,linkText:"DNA Methylation",anchorClassName:n.store.methylationTabUnavailable?"greyedOut":""},r.createElement(jl.Z,{store:n.store,resultsViewMode:!0})),n.store.showGenericAssayTab&&i().keys(n.store.genericAssayEnrichmentProfilesGroupedByGenericAssayType.result).map((function(e){return r.createElement(d.l6,{id:"".concat(hr.YP.GENERIC_ASSAY_PREFIX,"_").concat(e.toLowerCase()),linkText:(0,oa._y)(e),anchorClassName:n.store.genericAssayTabUnavailable?"greyedOut":""},r.createElement(Fl.Z,{store:n.store,genericAssayType:e,resultsViewMode:!0}))})))},renderPending:function(){return r.createElement(ee.Z,{center:!0,isLoading:!0,size:"big"})},renderError:function(){return r.createElement(pr.Z,null)}})}),(0,c.makeObservable)(Yl(n)),window.comparisonTab=Yl(n),n.store=new Dl(n.props.appStore,n.props.urlWrapper,n.props.store),n}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Kl(e,t)}(t,e),n=t,(o=[{key:"componentWillUnmount",value:function(){this.store&&this.store.destroy()}},{key:"onOverlapStrategySelect",value:function(e){(0,Bo.L9)({category:"resultsView",action:"setComparisonTabOverlapStrategy",label:e.value}),this.store.updateOverlapStrategy(e.value)}},{key:"render",value:function(){return this.store?r.createElement("div",{"data-test":"ComparisonTabDiv"},r.createElement(ee.Z,{center:!0,isLoading:this.store.newSessionPending,size:"big"}),r.createElement("div",{className:"tabMessageContainer",style:{marginBottom:10}},r.createElement(oe.Z,{className:"comparison-oql-status-banner",store:this.props.store,tabReflectsOql:!0}),r.createElement(ae.Z,{store:this.props.store}),r.createElement(ue.Z,{store:this.props.store})),r.createElement("div",{style:{display:"flex",justifyContent:"space-between",paddingBottom:25}},r.createElement("div",{className:Ll().headerControls},r.createElement(Rl.Z,{store:this.store,groupCollapseThreshold:40,isGroupDeletable:this.store.isGroupDeletable})),r.createElement("div",null,this.overlapStrategySelector.component)),this.tabs.component):null}},{key:"alterationEnrichmentTabName",get:function(){return xl.hN}}])&&Hl(n.prototype,o),a&&Hl(n,a),t}(r.Component);Xl([c.observable.ref],Zl.prototype,"store",void 0),Xl([c.computed],Zl.prototype,"alterationEnrichmentTabName",null),Xl([c.action.bound],Zl.prototype,"onOverlapStrategySelect",null);const zl=Zl=Xl([u.observer],Zl);var $l=n(17790),Jl=n(5206),es=n.n(Jl),ts=n(96840),ns=n(37687),rs=n(25120);function os(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function is(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function as(e){return(as=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ls(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ss(e,t){return(ss=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function us(e){return(us="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var cs=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":us(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};function ps(e,t){var n=new p.oh(e,t);return(0,ml.Z)("resultsViewPageStore",n),(0,c.autorun)((function(){n.studyIds.isComplete&&n.oqlText&&(0,Bo.Ci)(n.studyIds.result,n.oqlText,n.hugoGeneSymbols,n.queriedVirtualStudies.result.length>0)})),n}function ds(e){l()("#oncoprint-result-tab").click(e)}var fs=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=function(e,t){return!t||"object"!==us(t)&&"function"!=typeof t?ls(e):t}(this,as(t).call(this,e)),Object.defineProperty(ls(n),"resultsViewPageStore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(ls(n),"urlWrapper",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(ls(n),"quickOQLQueryStore",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(ls(n),"showTabs",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(ls(n),"userMessages",{enumerable:!0,configurable:!0,writable:!0,value:(0,w.$w)({await:function(){return[n.resultsViewPageStore.expressionProfiles,n.resultsViewPageStore.studies]},invoke:function(){return Promise.resolve([])}})}),(0,c.makeObservable)(ls(n)),n.urlWrapper=new le.Z(e.routing),(0,hl.gM)(n.urlWrapper),(0,hl.$O)(n.urlWrapper),(0,ml.Z)("urlWrapper",n.urlWrapper),n.urlWrapper.hasSessionId?(0,w.XE)(n.urlWrapper.remoteSessionData,(function(){n.resultsViewPageStore=ps(e.appStore,n.urlWrapper)})):n.resultsViewPageStore=ps(e.appStore,n.urlWrapper),n}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ss(e,t)}(t,e),n=t,(o=[{key:"componentWillUnmount",value:function(){this.resultsViewPageStore.destroy(),this.urlWrapper.destroy()}},{key:"evaluateTabInclusion",value:function(e){var t=(0,pn.Ib)().disabled_tabs||"",n=(0,hr.t8)(t).includes(e.id),r=this.resultsViewPageStore.tabId===e.id,o=!!e.hide&&e.hide();return r||!n&&!o}},{key:"handleQuickOQLSubmission",value:function(){this.quickOQLQueryStore.submit(),this.showOQLEditor=!1}},{key:"toggleOQLEditor",value:function(){this.showOQLEditor=!this.showOQLEditor}},{key:"getTabHref",value:function(e){return s.format({pathname:(0,se.gN)("./results/".concat(e)),query:this.props.routing.query,hash:this.props.routing.location.hash})}},{key:"render",value:function(){var e=this;return this.urlWrapper.isTemporarySessionPendingSave||this.urlWrapper.isLoadingSession||!this.resultsViewPageStore.studies.isComplete?r.createElement(ee.Z,{isLoading:!0,center:!0,noFade:!0,size:"big"}):this.resultsViewPageStore.studies.isComplete&&!this.resultsViewPageStore.tabId?(setTimeout((function(){e.resultsViewPageStore.handleTabChange(e.resultsViewPageStore.tabId,!0)})),null):r.createElement(Ei.X,{noMargin:!0,hideFooter:!0,className:"subhead-dark"},this.pageContent)}},{key:"tabs",get:function(){var e=this,t=this.resultsViewPageStore,n=[{id:hr.PC.ONCOPRINT,getTab:function(){return r.createElement(d.l6,{key:0,id:hr.PC.ONCOPRINT,linkText:"OncoPrint"},r.createElement(Po,{divId:"oncoprintDiv",store:t,urlWrapper:t.urlWrapper,key:t.hugoGeneSymbols.join(","),addOnBecomeVisibleListener:ds}))}},{id:hr.PC.CANCER_TYPES_SUMMARY,getTab:function(){return r.createElement(d.l6,{key:1,id:hr.PC.CANCER_TYPES_SUMMARY,linkText:"Cancer Types Summary"},r.createElement(Ce,{store:t}))}},{id:hr.PC.MUTUAL_EXCLUSIVITY,getTab:function(){return r.createElement(d.l6,{key:5,id:hr.PC.MUTUAL_EXCLUSIVITY,linkText:"Mutual Exclusivity"},r.createElement(En.Z,{store:t,isSampleAlteredMap:t.isSampleAlteredMap}))},hide:function(){return!e.resultsViewPageStore.isSampleAlteredMap.isComplete||i().size(e.resultsViewPageStore.isSampleAlteredMap.result)<2}},{id:hr.PC.PLOTS,getTab:function(){return r.createElement(d.l6,{key:12,id:hr.PC.PLOTS,linkText:"Plots"},r.createElement(Ci.ZP,{store:t,urlWrapper:e.urlWrapper}))}},{id:hr.PC.MUTATIONS,getTab:function(){return r.createElement(d.l6,{key:3,id:hr.PC.MUTATIONS,linkText:"Mutations"},r.createElement(Cn,{store:t,appStore:e.props.appStore,urlWrapper:e.urlWrapper}))}},{id:hr.PC.COEXPRESSION,hide:function(){if(e.resultsViewPageStore.isThereDataForCoExpressionTab.isComplete&&e.resultsViewPageStore.studies.isComplete){var t=e.resultsViewPageStore.studies.result.length>1,n=!e.resultsViewPageStore.isThereDataForCoExpressionTab.result;return t||n}return!0},getTab:function(){return r.createElement(d.l6,{key:7,id:hr.PC.COEXPRESSION,linkText:"Co-expression"},r.createElement(pl,{store:t}))}},{id:hr.PC.COMPARISON,hide:function(){return e.resultsViewPageStore.survivalClinicalDataExists.isPending},getTab:function(){var t=e.resultsViewPageStore.survivalClinicalDataExists.result?"Comparison/Survival":"Comparison";return r.createElement(d.l6,{key:10,id:hr.PC.COMPARISON,linkText:t},r.createElement(zl,{urlWrapper:e.urlWrapper,appStore:e.props.appStore,store:e.resultsViewPageStore}))}},{id:hr.PC.CN_SEGMENTS,hide:function(){return!(e.resultsViewPageStore.studies.isComplete&&e.resultsViewPageStore.genes.isComplete&&e.resultsViewPageStore.referenceGenes.isComplete&&(0,Pn.$b)(e.resultsViewPageStore.samples.result))},getTab:function(){return r.createElement(d.l6,{key:6,id:hr.PC.CN_SEGMENTS,linkText:"CN Segments",className:"cnSegmentsMSKTab"},r.createElement(Rr,{store:t}))}},{id:hr.PC.NETWORK,hide:function(){return!0},getTab:function(){return r.createElement(d.l6,{key:9,id:hr.PC.NETWORK,linkText:"Network"},r.createElement("div",{className:"alert alert-info"},"The Network tab has been retired. For similar functionality, please visit"," ",r.createElement("a",{href:"http://www.pathwaycommons.org/pcviz/",target:"_blank"},"http://www.pathwaycommons.org/pcviz/")))}},{id:hr.PC.PATHWAY_MAPPER,hide:function(){return"Internet Explorer"===es().name||!(0,pn.Ib)().show_pathway_mapper||!e.resultsViewPageStore.studies.isComplete},getTab:function(){var n=t.filteredSequencedSampleKeysByGene.isComplete&&t.oqlFilteredCaseAggregatedDataByOQLLine.isComplete&&t.genes.isComplete&&t.samples.isComplete&&t.patients.isComplete&&t.coverageInformation.isComplete&&t.filteredSequencedSampleKeysByGene.isComplete&&t.filteredSequencedPatientKeysByGene.isComplete&&t.selectedMolecularProfiles.isComplete&&t.oqlFilteredCaseAggregatedDataByUnflattenedOQLLine.isComplete;return r.createElement(d.l6,{key:13,id:hr.PC.PATHWAY_MAPPER,linkText:"Pathways"},n?r.createElement(Zr,{store:t,appStore:e.props.appStore,urlWrapper:e.urlWrapper}):r.createElement(ee.Z,{isLoading:!0,size:"big",center:!0}))}},{id:hr.PC.DOWNLOAD,getTab:function(){return r.createElement(d.l6,{key:11,id:hr.PC.DOWNLOAD,linkText:"Download"},r.createElement(Tr,{store:t}))}}].filter(this.evaluateTabInclusion).map((function(e){return e.getTab()}));return n.push.apply(n,os((0,rs.m)(this.customTabs))),n}},{key:"customTabs",get:function(){return(0,rs.E)((0,pn.Ib)().custom_tabs,"RESULTS_PAGE")}},{key:"quickOQLSubmitButton",get:function(){if(this.quickOQLQueryStore)return r.createElement(r.Fragment,null,r.createElement("button",{className:"btn btn-primary btn-sm","data-test":"oqlQuickEditSubmitButton",style:{marginLeft:10},onClick:this.handleQuickOQLSubmission,disabled:!this.quickOQLQueryStore.submitEnabled},"Submit Query"),"Â ",r.createElement("button",{className:"btn btn-link btn-sm",onClick:this.toggleOQLEditor},"Cancel"))}},{key:"showOQLEditor",get:function(){return!!this.quickOQLQueryStore},set:function(e){this.quickOQLQueryStore=e?(0,qo.S)(this.urlWrapper.query,this.urlWrapper,!1):null}},{key:"pageContent",get:function(){var e=this;if(0===this.resultsViewPageStore.hugoGeneSymbols.length||this.resultsViewPageStore.invalidStudyIds.result.length>0)return r.createElement("div",null,r.createElement("div",{className:"headBlock"}),r.createElement(Oo.Z,{forkedMode:!1,showQuickSearchTab:!1,showDownloadTab:!1,showAlerts:!0,getQueryStore:function(){return(0,qo.S)(e.urlWrapper.query,e.urlWrapper)}}));var t=this.showTabs&&!this.resultsViewPageStore.genesInvalid&&!this.resultsViewPageStore.queryExceedsLimit&&this.resultsViewPageStore.customDriverAnnotationReport.isComplete;return r.createElement(r.Fragment,null,this.resultsViewPageStore.queryExceedsLimit&&r.createElement("div",{className:"alert alert-danger queryInvalid",style:{marginBottom:"40px"},role:"alert"},r.createElement(fl.Z,{sampleCount:this.resultsViewPageStore.samples.result.length,queryProductLimit:(0,pn.Ib)().query_product_limit,email:(0,pn.Ib)().skin_email_contact})),this.userMessages.isComplete&&this.userMessages.result.length>0&&r.createElement(ts.Z,{messages:this.userMessages.result}),(this.resultsViewPageStore.studies.isPending||!t&&!this.resultsViewPageStore.queryFormVisible)&&r.createElement(ee.Z,{isLoading:!0,center:!0,noFade:!0,size:"big"}),this.resultsViewPageStore.studies.isComplete&&r.createElement(r.Fragment,null,r.createElement(dl.Z,null,r.createElement("title",null,(0,Pn.zF)(this.resultsViewPageStore.hugoGeneSymbols,this.resultsViewPageStore.studies.result))),r.createElement("div",null,r.createElement("div",{className:"headBlock"},r.createElement(Si,{routingStore:this.props.routing,store:this.resultsViewPageStore,onToggleQueryFormVisibility:function(t){(0,c.runInAction)((function(){e.showTabs=t,e.showOQLEditor=!1}))},onToggleOQLEditUIVisibility:this.toggleOQLEditor}),this.showOQLEditor&&r.createElement("div",{className:"quick_oql_edit"},r.createElement($l.Z,{validateInputGeneQuery:!0,inputGeneQuery:this.quickOQLQueryStore.geneQuery,callback:function(){e.quickOQLQueryStore.geneQuery=arguments.length<=2?void 0:arguments[2]},location:$l.e.DEFAULT,submitButton:this.quickOQLSubmitButton,error:this.quickOQLQueryStore.submitError,messages:this.quickOQLQueryStore.oqlMessages}))),t&&r.createElement(d.Kh,{key:this.urlWrapper.hash,activeTabId:this.resultsViewPageStore.tabId,unmountOnHide:!1,onTabClick:function(t){return e.resultsViewPageStore.handleTabChange(t)},className:"mainTabs",hrefRoot:(0,se.gN)("results"),contentWindowExtra:r.createElement(ns.v,{path:this.props.routing.location.pathname})},this.tabs))))}}])&&is(n.prototype,o),a&&is(n,a),t}(r.Component);cs([c.observable.ref],fs.prototype,"quickOQLQueryStore",void 0),cs([c.observable],fs.prototype,"showTabs",void 0),cs([c.computed],fs.prototype,"tabs",null),cs([c.computed],fs.prototype,"customTabs",null),cs([S.default],fs.prototype,"evaluateTabInclusion",null),cs([c.computed],fs.prototype,"quickOQLSubmitButton",null),cs([c.computed],fs.prototype,"showOQLEditor",null),cs([c.action.bound],fs.prototype,"handleQuickOQLSubmission",null),cs([c.action.bound],fs.prototype,"toggleOQLEditor",null),cs([S.default],fs.prototype,"getTabHref",null),cs([c.computed],fs.prototype,"pageContent",null);const ms=fs=cs([(0,u.inject)("appStore","routing"),u.observer],fs)},66798:(e,t,n)=>{"use strict";function r(e,t){window&&(window[e]=t)}n.d(t,{Z:()=>r})},7515:e=>{e.exports={portalWidth:"styles-module__portalWidth__3C3M_",framedImage:"styles-module__framedImage__7sZho",inlineAlterationTypeSelectorMenu:"styles-module__inlineAlterationTypeSelectorMenu__2qY8I",buttonAlterationTypeSelectorMenu:"styles-module__buttonAlterationTypeSelectorMenu__1ECLU"}},24433:e=>{e.exports={portalWidth:"styles-module__portalWidth__1Fjw6",framedImage:"styles-module__framedImage__3hqyk","tables-container":"styles-module__tables-container__1wDsF",downloadCopyTable:"styles-module__downloadCopyTable__1jMBv",noAlterationSpan:"styles-module__noAlterationSpan__1jy3D",notProfiledSpan:"styles-module__notProfiledSpan__2eZFJ",alterationSpan:"styles-module__alterationSpan__1oylB",tooltip:"styles-module__tooltip__2f1I5",infoIcon:"styles-module__infoIcon__2ZQ2T"}},69539:e=>{e.exports={portalWidth:"shareUI-module__portalWidth__23kqI",framedImage:"shareUI-module__framedImage__2dQ1S",shareModule:"shareUI-module__shareModule__3FK_r"}}}]);