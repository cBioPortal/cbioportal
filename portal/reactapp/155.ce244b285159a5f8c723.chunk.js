(self.webpackChunkcbioportal_frontend=self.webpackChunkcbioportal_frontend||[]).push([[155],{82580:(e,t,r)=>{"use strict";r.r(t),r.d(t,{StudyResultsSummary:()=>Su,default:()=>Tu});var n=r(88034),i=r(57930),o=r.n(i),a=r(27808),s=r(21015),l=r(78566),u=r(42352),c=r(67145),p=r(79718),d=r(4098),h=r(86384),f=r(72564),m=r(5933),y=r(13047),b=r(8974),g=r(28676),v=r(64577),S=r(24775),C=r.n(S),T=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))};function E(e){return T(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,n,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=[],t.prev=1,t.next=4,C().get(e);case 4:n=t.sent,i=JSON.parse(n.text),r=JSON.parse(i.fileContent),t.next=12;break;case 9:return t.prev=9,t.t0=t.catch(1),t.abrupt("return",[]);case 12:if(void 0!==r){t.next=16;break}return t.abrupt("return",[]);case 16:return t.abrupt("return",r);case 17:case"end":return t.stop()}}),t,null,[[1,9]])})))}var w,A=r(63623),P=r(62524),_=r(65587),I=r(58997),O=r(30177),k=r(57761),D=r(31595),N=r(89551),R=r(80320),G=r(77791),M=r(58235),F=r(99355),L=r(84232),x=r(63443),B=r(39594),j=r.n(B);function V(e){return(V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function U(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function q(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function K(e,t,r){return t&&q(e.prototype,t),r&&q(e,r),e}function W(e,t){return!t||"object"!==V(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Y(e){return(Y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function z(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&H(e,t)}function H(e,t){return(H=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Z(e,t){if(void 0===e.time||t)return e.treatment;var r=e;return"".concat(r.time,"-").concat(r.treatment)}function X(e,t){if(void 0===e.time||t)return e.treatment;var r=e;return r.treatment+"::"+r.time}!function(e){e.SAMPLE="SAMPLE_TREATMENTS",e.PATIENT="PATIENT_TREATMENTS"}(w||(w={}));var Q=function(e){function t(){return U(this,t),W(this,Y(t).apply(this,arguments))}return z(t,e),K(t,[{key:"render",value:function(){return n.createElement("div",{style:{marginLeft:this.props.margin},className:j().displayFlex},this.props.headerName)}}]),t}(n.Component),$=function(e){function t(){return U(this,t),W(this,Y(t).apply(this,arguments))}return z(t,e),K(t,[{key:"render",value:function(){return n.createElement("div",null,this.props.row.treatment)}}]),t}(n.Component);function J(e,t){return e.treatment.toUpperCase().includes(t.toUpperCase())}function ee(e){return e.toLocaleLowerCase().split("").map((function(e){return Math.min(e.charCodeAt(0),127)})).filter((function(e){return NaN!==e})).reduce((function(e,t,r){return e+t/Math.pow(128,r+1)}),0)}var te=r(85537),re=r(90661);function ne(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ie(e){return(ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var oe=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":ie(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},ae=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"_promise",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"_status",{enumerable:!0,configurable:!0,writable:!0,value:"pending"}),Object.defineProperty(this,"_result",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_error",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),(0,l.makeObservable)(this),(0,l.runInAction)((function(){r._status="pending",t.then((0,l.action)((function(e){r._status="complete",r._result=e})),(0,l.action)((function(e){r._status="error",r._error=e})))}))}var t,r,n;return t=e,(r=[{key:"status",get:function(){return this._status}},{key:"result",get:function(){return this._result}},{key:"error",get:function(){return this._error}},{key:"promise",get:function(){return this._promise}}])&&ne(t.prototype,r),n&&ne(t,n),e}();oe([l.observable.ref],ae.prototype,"_status",void 0),oe([l.observable.ref],ae.prototype,"_result",void 0),oe([l.observable.ref],ae.prototype,"_error",void 0),oe([l.computed],ae.prototype,"status",null),oe([l.computed],ae.prototype,"result",null),oe([l.computed],ae.prototype,"error",null),oe([l.computed],ae.prototype,"promise",null);var se=r(20232),le=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))};function ue(e){return e.uniqueKey!==f.h_.CANCER_STUDIES}function ce(e,t,r,n){return le(this,void 0,void 0,regeneratorRuntime.mark((function i(){var a,s,l;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return a=o().map(r,(function(e,r){var n=o().uniqBy(e,(function(e){return"".concat(e.sampleId,"_").concat(e.studyId)})).map((function(e){return{studyId:e.studyId,sampleId:e.sampleId}}));return(0,F.$q)(r,n,t)})),n(D.J.CREATING_SESSION),i.next=4,O.Z.addComparisonSession({groups:a,origin:t,clinicalAttributeName:e.displayName});case 4:return s=i.sent,l=s.id,i.abrupt("return",l);case 7:case"end":return i.stop()}}),i)})))}function pe(e,t){var r=o().keyBy(t,(function(e){return e.studyId}));return e.reduce((function(e,t){return t.studyId in r&&e.push({sampleId:t.sampleId,molecularProfileId:r[t.studyId].molecularProfileId}),e}),[])}function de(e,t,r){return le(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,o,a;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=pe(e,t),n.next=3,c.Z.fetchGenesUsingPOST({geneIdType:"HUGO_GENE_SYMBOL",geneIds:r});case 3:return o=n.sent,a={entrezGeneIds:o.map((function(e){return e.entrezGeneId})),sampleMolecularIdentifiers:i},n.abrupt("return",c.Z.fetchMutationsInMultipleMolecularProfilesUsingPOST({projection:"DETAILED",mutationMultipleStudyFilter:a}));case 6:case"end":return n.stop()}}),n)})))}function he(e,t,r){return le(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=pe(e,t),n.next=3,c.Z.fetchGenesUsingPOST({geneIdType:"HUGO_GENE_SYMBOL",geneIds:r});case 3:return o=n.sent,n.abrupt("return",c.Z.fetchMolecularDataInMultipleMolecularProfilesUsingPOST({projection:"DETAILED",molecularDataMultipleStudyFilter:{entrezGeneIds:o.map((function(e){return e.entrezGeneId})),sampleMolecularIdentifiers:i}}));case 5:case"end":return n.stop()}}),n)})))}function fe(e,t,r){return le(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=pe(e,t),n.next=3,c.Z.fetchGenesUsingPOST({geneIdType:"HUGO_GENE_SYMBOL",geneIds:r});case 3:return o=n.sent,n.abrupt("return",c.Z.fetchStructuralVariantsUsingPOST({structuralVariantFilter:{entrezGeneIds:o.map((function(e){return e.entrezGeneId})),sampleMolecularIdentifiers:i}}));case 5:case"end":return n.stop()}}),n)})))}function me(e,t){var r={},n=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){r[a.value]=[]}}catch(e){i=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}var l=!0,u=!1,c=void 0;try{for(var p,d=e[Symbol.iterator]();!(l=(p=d.next()).done);l=!0){var h=p.value;h.site1HugoSymbol in r&&r[h.site1HugoSymbol].push(h),h.site2HugoSymbol in r&&r[h.site2HugoSymbol].push(h)}}catch(e){u=!0,c=e}finally{try{l||null==d.return||d.return()}finally{if(u)throw c}}return r}function ye(e,t){switch(t){case A.oV.MUTATED_GENES_TABLE:case A.oV.CNA_GENES_TABLE:case A.oV.STRUCTURAL_VARIANT_GENES_TABLE:return{hugoGeneSymbols:function(e,t){switch(e){case A.oV.CNA_GENES_TABLE:return o().uniq(t.map(M.E2));default:return t}}(t,e.slice())};case A.oV.SAMPLE_TREATMENTS_TABLE:case A.oV.SAMPLE_TREATMENT_GROUPS_TABLE:case A.oV.SAMPLE_TREATMENT_TARGET_TABLE:case A.oV.PATIENT_TREATMENTS_TABLE:case A.oV.PATIENT_TREATMENT_GROUPS_TABLE:case A.oV.PATIENT_TREATMENT_TARGET_TABLE:return{treatmentUniqueKeys:e.slice()};default:return{}}}var be=r(78631),ge=r(79666),ve=r(83224),Se=r(34207),Ce=r(26942);function Te(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ee(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function we(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Ae(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Pe(e){return(Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var _e,Ie=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":Pe(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},Oe=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))},ke=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r};!function(e){e.SUMMARY="Summary",e.CLINICAL_DATA="Clinical Data",e.HEATMAPS="Heatmaps",e.CN_SEGMENTS="CN Segments"}(_e||(_e={}));var De="Selected",Ne="STATIC",Re=function(){function e(t,r,n){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"appStore",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"sessionServiceIsEnabled",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"urlWrapper",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"reactionDisposers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"chartItemToColor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"chartToUsedColors",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"studyViewQueryFilter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"driverAnnotationSettings",{enumerable:!0,configurable:!0,writable:!0,value:(0,ve.QB)((function(){return!1}))}),Object.defineProperty(this,"includeGermlineMutations",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeSomaticMutations",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeUnknownStatusMutations",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"isSettingsMenuVisible",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"showComparisonGroupUI",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"showCustomDataSelectionUI",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"numberOfVisibleColorChooserModals",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"userGroupColors",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"toggleNAValue",{enumerable:!0,configurable:!0,writable:!0,value:function(e){var t=i.getDataBinFilterSet(e),r=o().clone(t.get(e));r.showNA=!i.isShowNAChecked(e),t.set(e,r)}}),Object.defineProperty(this,"isShowNAChecked",{enumerable:!0,configurable:!0,writable:!0,value:function(e){var t=i.getDataBinFilterSet(e).get(e),r=t?t.showNA:void 0;return void 0===r||r}}),Object.defineProperty(this,"hideRestoreSettingsMsg",{enumerable:!0,configurable:!0,writable:!0,value:this.isLoggedIn}),Object.defineProperty(this,"_loadUserSettingsInitially",{enumerable:!0,configurable:!0,writable:!0,value:this.isLoggedIn}),Object.defineProperty(this,"openResourceTabMap",{enumerable:!0,configurable:!0,writable:!0,value:l.observable.map()}),Object.defineProperty(this,"_comparisonConfirmationModal",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_selectedComparisonGroups",{enumerable:!0,configurable:!0,writable:!0,value:l.observable.map({},{deep:!1})}),Object.defineProperty(this,"createdGroups",{enumerable:!0,configurable:!0,writable:!0,value:l.observable.map({},{deep:!1})}),Object.defineProperty(this,"_selectedComparisonGroupsWarningSigns",{enumerable:!0,configurable:!0,writable:!0,value:l.observable.map({},{deep:!1})}),Object.defineProperty(this,"_comparisonGroupsMarkedForDeletion",{enumerable:!0,configurable:!0,writable:!0,value:l.observable.map({},{deep:!1})}),Object.defineProperty(this,"_customChartsMarkedForDeletion",{enumerable:!0,configurable:!0,writable:!0,value:l.observable.map({},{deep:!1})}),Object.defineProperty(this,"_pendingChanges",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"pendingDecision",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._pendingChanges=this._pendingChanges.filter((function(e){return"pending"!==e.status})),e.next=3,Promise.all(this._pendingChanges.map((function(e){return e.promise})));case 3:return e.abrupt("return",!1);case 4:case"end":return e.stop()}}),e,this)})))},default:!0})}),Object.defineProperty(this,"userGroupsFromRemote",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.sampleSet,i.pendingDecision]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._comparisonGroupsChangeCount,!(this.studyIds.length>0)||!this.isLoggedIn&&"noauthsessionservice"!==(0,Ce.Ib)().authenticationMethod||this.pendingDecision.result){e.next=6;break}return e.next=4,O.Z.getGroupsForStudies(this.studyIds.slice());case 4:return t=e.sent,e.abrupt("return",t.map((function(e){return Object.assign(e.data,{uid:e.id,isSharedGroup:!1,color:void 0},(0,k.uQ)(e.data,r.sampleSet.result))})));case 6:return e.abrupt("return",[]);case 7:case"end":return e.stop()}}),e,this)})))},default:[]})}),Object.defineProperty(this,"sharedGroups",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.sampleSet,i.queriedPhysicalStudyIds,i.userSettings]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r,n,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],Object.keys(this.sharedGroupSet).forEach((function(e){t.push(O.Z.getGroup(e))})),r=(0,_.cD)(this.queriedPhysicalStudyIds.result),e.next=5,Promise.all(t);case 5:return n=e.sent,e.abrupt("return",n.filter((function(e){return!o().some(e.data.studies,(function(e){return void 0===r[e.id]}))})).map((function(e){return Object.assign(e.data,{uid:e.id,isSharedGroup:!0,color:(0,f.ns)(i.userGroupColors,e.id)},(0,k.uQ)(e.data,i.sampleSet.result))})));case 7:case"end":return e.stop()}}),e,this)})))},default:[]})}),Object.defineProperty(this,"comparisonGroups",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.userGroupsFromRemote,i.sharedGroups]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r,n,i,a,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=o().cloneDeep(this.userGroupsFromRemote.result),r=(0,_.cD)(t.map((function(e){return e.uid}))),this.sharedGroups.result.length>0&&this.sharedGroups.result.forEach((function(e){void 0===r[e.uid]&&(t.push(e),r[e.uid]=!0)})),!((n=Array.from(this.createdGroups.keys()).filter((function(e){return void 0===r[e]}))).length>0)){e.next=11;break}return i=n.map((function(e){return O.Z.getGroup(e)})),a=(0,_.cD)(this.queriedPhysicalStudyIds.result),e.next=9,Promise.all(i);case 9:e.sent.forEach((function(e){o().every(e.data.studies,(function(e){return e.id in a}))&&t.push(Object.assign(e.data,{uid:e.id},{color:void 0},(0,k.uQ)(e.data,s.sampleSet.result)))}));case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}}),e,this)})))},default:[],onResult:function(e){i.saveGroupsToUserProfile(e)}})}),Object.defineProperty(this,"userSavedCustomData",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.studyIds.length>0&&this.isLoggedIn)){e.next=5;break}return e.next=3,g.Z.getCustomDataForStudies(this.studyIds.slice());case 3:return t=e.sent,e.abrupt("return",t.map((function(e){return{uniqueKey:e.id,displayName:e.data.displayName,description:e.data.description,priority:e.data.priority,dataType:f.E4.CUSTOM_DATA,patientAttribute:e.data.patientAttribute,renderWhenDataChange:!1,data:e.data.data,isSharedChart:!1,clinicalAttribute:{clinicalAttributeId:e.id,datatype:e.data.datatype,displayName:e.data.displayName,description:e.data.description,patientAttribute:e.data.patientAttribute,priority:e.data.priority}}})));case 5:return e.abrupt("return",[]);case 6:case"end":return e.stop()}}),e,this)})))},default:[],onResult:function(e){i._loadUserSettingsInitially&&i.updateCustomDataList(e,!0)}})}),Object.defineProperty(this,"sharedCustomData",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.queriedPhysicalStudyIds]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],Object.keys(this.sharedCustomChartSet).forEach((function(e){t.push(g.Z.getCustomData(e))})),r=(0,_.cD)(this.queriedPhysicalStudyIds.result),e.next=5,Promise.all(t);case 5:return n=e.sent,e.abrupt("return",n.filter((function(e){return!o().some(e.data.origin,(function(e){return void 0===r[e]}))})).map((function(e){return{uniqueKey:e.id,displayName:e.data.displayName,description:e.data.description,priority:e.data.priority,dataType:f.E4.CUSTOM_DATA,patientAttribute:e.data.patientAttribute,renderWhenDataChange:!1,data:e.data.data,isSharedChart:!0,clinicalAttribute:{clinicalAttributeId:e.id,datatype:e.data.datatype,displayName:e.data.displayName,description:e.data.description,patientAttribute:e.data.patientAttribute,priority:e.data.priority}}})));case 7:case"end":return e.stop()}}),e,this)})))},default:[],onResult:function(e){i.updateCustomDataList(e,!1,!0),i.saveSharedCustomDataToUserProfile(e)}})}),Object.defineProperty(this,"_comparisonGroupsChangeCount",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"initialFiltersQuery",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"studyIds",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_clinicalDataFilterSet",{enumerable:!0,configurable:!0,writable:!0,value:l.observable.map({},{deep:!1})}),Object.defineProperty(this,"_customDataFilterSet",{enumerable:!0,configurable:!0,writable:!0,value:l.observable.map({},{deep:!1})}),Object.defineProperty(this,"_genomicProfilesFilter",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_caseListsFilter",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_customBinsFromScatterPlotSelectionSet",{enumerable:!0,configurable:!0,writable:!0,value:l.observable.map({},{deep:!1})}),Object.defineProperty(this,"_genomicDataIntervalFilterSet",{enumerable:!0,configurable:!0,writable:!0,value:l.observable.map({},{deep:!1})}),Object.defineProperty(this,"_genericAssayDataFilterSet",{enumerable:!0,configurable:!0,writable:!0,value:l.observable.map({},{deep:!1})}),Object.defineProperty(this,"_clinicalDataBinFilterSet",{enumerable:!0,configurable:!0,writable:!0,value:l.observable.map()}),Object.defineProperty(this,"_genomicDataBinFilterSet",{enumerable:!0,configurable:!0,writable:!0,value:l.observable.map()}),Object.defineProperty(this,"_genericAssayDataBinFilterSet",{enumerable:!0,configurable:!0,writable:!0,value:l.observable.map()}),Object.defineProperty(this,"_geneFilterSet",{enumerable:!0,configurable:!0,writable:!0,value:l.observable.map()}),Object.defineProperty(this,"_chartVisibility",{enumerable:!0,configurable:!0,writable:!0,value:l.observable.map()}),Object.defineProperty(this,"geneQueryStr",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"geneQueries",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"chartsDimension",{enumerable:!0,configurable:!0,writable:!0,value:l.observable.map()}),Object.defineProperty(this,"chartsType",{enumerable:!0,configurable:!0,writable:!0,value:l.observable.map()}),Object.defineProperty(this,"newlyAddedCharts",{enumerable:!0,configurable:!0,writable:!0,value:l.observable.array()}),Object.defineProperty(this,"sharedGroupSet",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"sharedCustomChartSet",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"unfilteredClinicalDataCountCache",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"unfilteredClinicalDataBinCountCache",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"pageStatusMessages",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"useCurrentGridLayout",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"currentGridLayout",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"previousSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"currentFocusedChartByUser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"currentFocusedChartByUserDimension",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clinicalDataBinPromises",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"clinicalDataCountPromises",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"customDataCountPromises",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"genomicChartPromises",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"genericAssayChartPromises",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"genericAssayDataCountPromises",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_chartSampleIdentifiersFilterSet",{enumerable:!0,configurable:!0,writable:!0,value:l.observable.map()}),Object.defineProperty(this,"preDefinedCustomChartFilterSet",{enumerable:!0,configurable:!0,writable:!0,value:l.observable.map()}),Object.defineProperty(this,"numberOfSelectedSamplesInCustomSelection",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_filterComparisonGroups",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_filterMutatedGenesTableByCancerGenes",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_filterSVGenesTableByCancerGenes",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_filterCNAGenesTableByCancerGenes",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_customCharts",{enumerable:!0,configurable:!0,writable:!0,value:l.observable.map({},{deep:!1})}),Object.defineProperty(this,"_geneSpecificChartMap",{enumerable:!0,configurable:!0,writable:!0,value:l.observable.map({},{deep:!1})}),Object.defineProperty(this,"_geneSpecificCharts",{enumerable:!0,configurable:!0,writable:!0,value:l.observable.map({},{deep:!1})}),Object.defineProperty(this,"_genericAssayChartMap",{enumerable:!0,configurable:!0,writable:!0,value:l.observable.map({},{deep:!1})}),Object.defineProperty(this,"_genericAssayCharts",{enumerable:!0,configurable:!0,writable:!0,value:l.observable.map({},{deep:!1})}),Object.defineProperty(this,"_XvsYViolinChartMap",{enumerable:!0,configurable:!0,writable:!0,value:l.observable.map({},{deep:!0})}),Object.defineProperty(this,"_XvsYScatterChartMap",{enumerable:!0,configurable:!0,writable:!0,value:l.observable.map({},{deep:!0})}),Object.defineProperty(this,"_XvsYCharts",{enumerable:!0,configurable:!0,writable:!0,value:l.observable.map({},{deep:!0})}),Object.defineProperty(this,"_XvsYChartSettings",{enumerable:!0,configurable:!0,writable:!0,value:l.observable.map({},{deep:!0})}),Object.defineProperty(this,"_customChartsSelectedCases",{enumerable:!0,configurable:!0,writable:!0,value:l.observable.map({},{deep:!1})}),Object.defineProperty(this,"customChartSet",{enumerable:!0,configurable:!0,writable:!0,value:l.observable.map({},{deep:!1})}),Object.defineProperty(this,"_newlyCreatedCustomChartSet",{enumerable:!0,configurable:!0,writable:!0,value:l.observable.map({},{deep:!1})}),Object.defineProperty(this,"sampleToAnalysisGroup",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.samples,i.selectedSamples]},invoke:function(){var e=o().keyBy(i.selectedSamples.result,(function(e){return e.uniqueSampleKey}));return Promise.resolve(o().reduce(i.samples.result,(function(t,r){var n=r.uniqueSampleKey;return t[n]=n in e?De:"Unselected",t}),{}))}})}),Object.defineProperty(this,"patientToAnalysisGroup",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.samples,i.selectedPatientKeys]},invoke:function(){var e=o().keyBy(i.selectedPatientKeys.result);return Promise.resolve(o().reduce(i.samples.result,(function(t,r){var n=r.uniquePatientKey;return n in e&&(t[n]=De),t}),{}))}})}),Object.defineProperty(this,"hasRawDataForDownload",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(1!==this.studyIds.length){e.next=7;break}return e.next=3,C()((0,P.Aj)());case 3:return t=e.sent,e.abrupt("return",t.body.includes(this.studyIds[0]));case 7:return e.abrupt("return",!1);case 8:case"end":return e.stop()}}),e,this)})))},onError:function(){return!1},default:!1})}),Object.defineProperty(this,"unfilteredClinicalDataCount",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({invoke:function(){return o().isEmpty(i.unfilteredAttrsForNonNumerical)?Promise.resolve([]):u.Z.fetchClinicalDataCountsUsingPOST({clinicalDataCountFilter:{attributes:i.unfilteredAttrsForNonNumerical,studyViewFilter:i.filters}})},onError:function(){},onResult:function(e){e.forEach((function(e){var t=e.attributeId;i.isNewlyAdded(t)&&(i.showAsPieChart(t,e.counts.length),i.newlyAddedCharts.remove(t))}))},default:[]})}),Object.defineProperty(this,"unfilteredCustomDataCount",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.selectedSamples]},invoke:function(){return i.hasFilteredSamples?u.Z.fetchCustomDataCountsUsingPOST({clinicalDataCountFilter:{attributes:i.unfilteredCustomAttrsForNonNumerical,studyViewFilter:i.filters}}):Promise.resolve([])},onError:function(){},onResult:function(e){e.forEach((function(e){var t=e.attributeId;i.isNewlyAdded(t)&&(i.showAsPieChart(t,e.counts.length),i.newlyAddedCharts.remove(t))}))},default:[]})}),Object.defineProperty(this,"newlyAddedUnfilteredClinicalDataCount",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({invoke:function(){return o().isEmpty(i.newlyAddedUnfilteredAttrsForNonNumerical)?Promise.resolve([]):u.Z.fetchClinicalDataCountsUsingPOST({clinicalDataCountFilter:{attributes:i.newlyAddedUnfilteredAttrsForNonNumerical,studyViewFilter:i.filters}})},default:[],onError:function(){},onResult:function(e){e.forEach((function(e){var t=e.attributeId;i.unfilteredClinicalDataCountCache[t]=e,i.showAsPieChart(t,e.counts.length),i.newlyAddedCharts.remove(t)}))}})}),Object.defineProperty(this,"newlyAddedUnfilteredClinicalDataBinCount",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.hasSampleIdentifiersInFilter&&this.newlyAddedUnfilteredAttrsForNumerical.length>0)){e.next=5;break}return e.next=3,u.Z.fetchClinicalDataBinCountsUsingPOST({dataBinMethod:"STATIC",clinicalDataBinCountFilter:{attributes:this.newlyAddedUnfilteredAttrsForNumerical,studyViewFilter:this.filters}});case 3:return t=e.sent,e.abrupt("return",Promise.resolve((0,f.Ls)(t)));case 5:return e.abrupt("return",Promise.resolve([]));case 6:case"end":return e.stop()}}),e,this)})))},default:[],onError:function(){},onResult:function(e){o().each(o().groupBy(e,(function(e){return e.id})),(function(e,t){i.unfilteredClinicalDataBinCountCache[t]=e,i.newlyAddedCharts.remove(t)}))}})}),Object.defineProperty(this,"unfilteredClinicalDataBinCount",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.hasSampleIdentifiersInFilter&&this.unfilteredAttrsForNumerical.length>0)){e.next=5;break}return e.next=3,u.Z.fetchClinicalDataBinCountsUsingPOST({dataBinMethod:"STATIC",clinicalDataBinCountFilter:{attributes:this.unfilteredAttrsForNumerical,studyViewFilter:this.filters}});case 3:return t=e.sent,e.abrupt("return",Promise.resolve((0,f.Ls)(t)));case 5:return e.abrupt("return",Promise.resolve([]));case 6:case"end":return e.stop()}}),e,this)})))},onError:function(){},default:[]})}),Object.defineProperty(this,"molecularProfiles",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.queriedPhysicalStudyIds]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.queriedPhysicalStudyIds.result.length>0)){e.next=4;break}return e.next=3,c.Z.fetchMolecularProfilesUsingPOST({molecularProfileFilter:{studyIds:this.queriedPhysicalStudyIds.result}});case 3:return e.abrupt("return",e.sent);case 4:return e.abrupt("return",[]);case 5:case"end":return e.stop()}}),e,this)})))},onError:function(){},default:[]})}),Object.defineProperty(this,"allStudies",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.Z.getAllStudiesUsingGET({projection:"SUMMARY"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}},[])}),Object.defineProperty(this,"everyStudyIdToStudy",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.allStudies]},invoke:function(){return Promise.resolve(o().keyBy(i.allStudies.result,(function(e){return e.studyId})))}})}),Object.defineProperty(this,"filteredPhysicalStudies",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.everyStudyIdToStudy]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.everyStudyIdToStudy.result,e.abrupt("return",o().reduce(this.studyIds,(function(e,r){return t[r]&&(0,f.ZF)(t[r])&&e.push(t[r]),e}),[]));case 2:case"end":return e.stop()}}),e,this)})))},default:[]})}),Object.defineProperty(this,"filteredVirtualStudies",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.filteredPhysicalStudies]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.filteredPhysicalStudies.result.length!==this.studyIds.length){e.next=2;break}return e.abrupt("return",[]);case 2:return t=[],r=this.filteredPhysicalStudies.result.map((function(e){return e.studyId})),n=o().filter(this.studyIds,(function(e){return!o().includes(r,e)})),e.next=7,Promise.all(n.map((function(e){return g.Z.getVirtualStudy(e).then((function(e){t.push(e)})).catch((function(){}))})));case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e,this)})))},default:[]})}),Object.defineProperty(this,"queriedPhysicalStudies",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.filteredPhysicalStudies,i.filteredVirtualStudies]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.everyStudyIdToStudy.result,r=o().reduce(this.filteredPhysicalStudies.result,(function(e,r){return e[r.studyId]=t[r.studyId],e}),{}),this.filteredVirtualStudies.result.forEach((function(e){e.data.studies.forEach((function(e){!r[e.id]&&t[e.id]&&(r[e.id]=t[e.id])}))})),e.abrupt("return",o().values(r));case 4:case"end":return e.stop()}}),e,this)})))},default:[]})}),Object.defineProperty(this,"queriedPhysicalStudyIds",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.queriedPhysicalStudies]},invoke:function(){return Promise.resolve(o().map(i.queriedPhysicalStudies.result,(function(e){return e.studyId})))},default:[]})}),Object.defineProperty(this,"queriedSampleIdentifiers",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.filteredPhysicalStudies,i.filteredVirtualStudies]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=o().reduce(this.filteredVirtualStudies.result,(function(e,t){return t.data.studies.forEach((function(t){var r=t.samples;e[t.id]&&(r=o().union(e[t.id],r)),e[t.id]=r})),e}),{}),o().isEmpty(t)){e.next=6;break}return t=o().reduce(this.filteredPhysicalStudies.result,(function(e,t){return e[t.studyId]=[],e}),t),r=o().reduce(t,(function(e,t,r){return 0===t.length&&e.push(r),e}),[]),e.next=6,Promise.all(o().map(r,(function(e){return c.Z.getAllSamplesInStudyUsingGET({studyId:e}).then((function(r){t[e]=r.map((function(e){return e.sampleId}))}))})));case 6:return e.abrupt("return",o().flatten(o().map(t,(function(e,t){return e.map((function(e){return{sampleId:e,studyId:t}}))}))));case 7:case"end":return e.stop()}}),e,this)})))},default:[]})}),Object.defineProperty(this,"displayedStudies",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.filteredVirtualStudies,i.filteredPhysicalStudies,i.queriedPhysicalStudies]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.filteredPhysicalStudies.result.length||1!==this.filteredVirtualStudies.result.length){e.next=5;break}return t=this.filteredVirtualStudies.result[0],e.abrupt("return",[{name:t.data.name,description:t.data.description,studyId:t.id}]);case 5:return e.abrupt("return",this.queriedPhysicalStudies.result);case 6:case"end":return e.stop()}}),e,this)})))},default:[]})}),Object.defineProperty(this,"originStudies",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.filteredPhysicalStudies,i.filteredVirtualStudies,i.everyStudyIdToStudy]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r,n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[],!this.showOriginStudiesInSummaryDescription){e.next=8;break}return r=this.filteredVirtualStudies.result[0].data.origin,n=[],i=this.everyStudyIdToStudy.result,o().each(r,(function(e){i[e]?t.push(i[e]):n.push(e)})),e.next=8,Promise.all(n.map((function(e){return g.Z.getVirtualStudy(e).then((function(e){t.push({name:e.data.name,description:e.data.description,studyId:e.id})})).catch((function(){}))})));case 8:return e.abrupt("return",t);case 9:case"end":return e.stop()}}),e,this)})))},default:[]})}),Object.defineProperty(this,"unknownQueriedIds",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.filteredPhysicalStudies,i.filteredVirtualStudies]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],o().each(this.filteredPhysicalStudies.result,(function(e){return t.push(e.studyId)})),o().each(this.filteredVirtualStudies.result,(function(e){return t.push(e.id)})),e.abrupt("return",o().filter(this.studyIds,(function(e){return!o().includes(t,e)})));case 4:case"end":return e.stop()}}),e,this)})))},onError:function(){},onResult:function(e){e.length>0&&(i.pageStatusMessages.unknownIds={status:"danger",message:"Unknown/Unauthorized ".concat(e.length>1?"studies:":"study:"," ").concat(e.join(", "))})},default:[]})}),Object.defineProperty(this,"studyIdToMolecularProfiles",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.molecularProfiles]},invoke:function(){return Promise.resolve(o().groupBy(i.molecularProfiles.result,(function(e){return e.studyId})))},onError:function(e){},default:{}})}),Object.defineProperty(this,"mutationProfiles",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.studyIdToMolecularProfiles]},invoke:function(){return Promise.resolve((0,f.fe)(i.studyIdToMolecularProfiles.result,L.YK.MUTATION_EXTENDED))},onError:function(){},default:[]})}),Object.defineProperty(this,"structuralVariantProfiles",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.studyIdToMolecularProfiles]},invoke:function(){return Promise.resolve((0,f.fe)(i.studyIdToMolecularProfiles.result,L.YK.STRUCTURAL_VARIANT,[L.QH.FUSION,L.QH.SV]))},onError:function(){},default:[]})}),Object.defineProperty(this,"cnaProfiles",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.studyIdToMolecularProfiles]},invoke:function(){return Promise.resolve((0,f.fe)(i.studyIdToMolecularProfiles.result,L.YK.COPY_NUMBER_ALTERATION,[L.QH.DISCRETE]))},onError:function(){},default:[]})}),Object.defineProperty(this,"resourceDefinitions",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.queriedPhysicalStudies]},invoke:function(){return u.Z.fetchResourceDefinitionsUsingPOST({studyIds:i.queriedPhysicalStudies.result.map((function(e){return e.studyId}))})},onResult:function(e){if(e){var t=!0,r=!1,n=void 0;try{for(var o,a=e[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var s=o.value;s.openByDefault&&i.setResourceTabOpen(s.resourceId,!0)}}catch(e){r=!0,n=e}finally{try{t||null==a.return||a.return()}finally{if(r)throw n}}}}})}),Object.defineProperty(this,"studyResourceData",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.resourceDefinitions]},invoke:function(){var e=[],t=i.resourceDefinitions.result.filter((function(e){return"STUDY"===e.resourceType})),r=[],n=!0,o=!1,a=void 0;try{for(var s,l=t[Symbol.iterator]();!(n=(s=l.next()).done);n=!0){var c=s.value;r.push(u.Z.getAllStudyResourceDataInStudyUsingGET({studyId:c.studyId,resourceId:c.resourceId,projection:"DETAILED"}).then((function(t){return e.push.apply(e,we(t))})))}}catch(e){o=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(o)throw a}}return Promise.all(r).then((function(){return e}))}})}),Object.defineProperty(this,"resourceIdToResourceData",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.studyResourceData]},invoke:function(){return Promise.resolve(o().groupBy(i.studyResourceData.result,(function(e){return e.resourceId})))}})}),Object.defineProperty(this,"chartClinicalAttributes",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.clinicalAttributes,i.survivalClinicalAttributesPrefix]},invoke:function(){var e=(0,x.Nj)(i.survivalClinicalAttributesPrefix.result);return e=o().omit(e,["OS_STATUS"]),Promise.resolve(o().filter(i.clinicalAttributes.result,(function(t){return!(t.clinicalAttributeId in e)})))},default:[]})}),Object.defineProperty(this,"clinicalAttributes",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.queriedPhysicalStudyIds]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.queriedPhysicalStudyIds.result.length>0)){e.next=7;break}return e.t0=o(),e.next=4,c.Z.fetchClinicalAttributesUsingPOST({studyIds:this.queriedPhysicalStudyIds.result});case 4:return e.t1=e.sent,e.t2=function(e){return"".concat(e.patientAttribute,"-").concat(e.clinicalAttributeId)},e.abrupt("return",e.t0.uniqBy.call(e.t0,e.t1,e.t2));case 7:return e.abrupt("return",[]);case 8:case"end":return e.stop()}}),e,this)})))},default:[],onError:function(){},onResult:function(e){e.forEach((function(e){if(e.datatype===f.g.NUMBER){var t=(0,f.PG)(e),r=i.getDefaultClinicalDataBinFilter(e);A.$u.initialBins[t]&&(r.customBins=A.$u.initialBins[t]),i._clinicalDataBinFilterSet.set(t,r)}}))}})}),Object.defineProperty(this,"clinicalAttributeIdToClinicalAttribute",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.clinicalAttributes]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",o().keyBy(this.clinicalAttributes.result,"clinicalAttributeId"));case 1:case"end":return e.stop()}}),e,this)})))}})}),Object.defineProperty(this,"clinicalAttributeIdToDataType",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.clinicalAttributes]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={},o().map(Array.from(this._customCharts.values()),(function(e){t[e.uniqueKey]=e.clinicalAttribute?e.clinicalAttribute.datatype:f.g.STRING})),this.clinicalAttributes.result.forEach((function(e){t[e.clinicalAttributeId]=e.datatype})),e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)})))}})}),Object.defineProperty(this,"MDACCHeatmapStudyMeta",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.queriedPhysicalStudyIds]},onError:function(){},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,Ce.Ib)().show_mdacc_heatmap){e.next=6;break}if(!(1===this.queriedPhysicalStudyIds.result.length)){e.next=6;break}return e.next=5,E((0,P.FE)(this.queriedPhysicalStudyIds.result[0]));case 5:return e.abrupt("return",e.sent);case 6:return e.abrupt("return",[]);case 7:case"end":return e.stop()}}),e,this)})))}},[])}),Object.defineProperty(this,"oncokbCancerGenes",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",p.Z.utilsCancerGeneListGetUsingGET_1({}));case 1:case"end":return e.stop()}}),e)})))},onError:function(){},default:[]})}),Object.defineProperty(this,"oncokbGenes",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.oncokbCancerGenes]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.oncokbCancerGenes.result.filter((function(e){return e.oncokbAnnotated})));case 1:case"end":return e.stop()}}),e,this)})))},onError:function(){},default:[]})}),Object.defineProperty(this,"oncokbCancerGeneEntrezGeneIds",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.oncokbCancerGenes]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.oncokbCancerGenes.result.map((function(e){return e.entrezGeneId})));case 1:case"end":return e.stop()}}),e,this)})))},default:[]})}),Object.defineProperty(this,"oncokbAnnotatedGeneEntrezGeneIds",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.oncokbCancerGenes]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.oncokbCancerGenes.result.filter((function(e){return e.oncokbAnnotated})).map((function(e){return e.entrezGeneId})));case 1:case"end":return e.stop()}}),e,this)})))},default:[]})}),Object.defineProperty(this,"oncokbOncogeneEntrezGeneIds",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.oncokbGenes]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.oncokbGenes.result.filter((function(e){return e.oncogene})).map((function(e){return e.entrezGeneId})));case 1:case"end":return e.stop()}}),e,this)})))},default:[]})}),Object.defineProperty(this,"oncokbTumorSuppressorGeneEntrezGeneIds",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.oncokbGenes]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.oncokbGenes.result.filter((function(e){return e.tsg})).map((function(e){return e.entrezGeneId})));case 1:case"end":return e.stop()}}),e,this)})))},default:[]})}),Object.defineProperty(this,"genericAssayEntitiesGroupedByGenericAssayType",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.genericAssayProfiles]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,ge.XK)(this.genericAssayProfiles.result);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})))}})}),Object.defineProperty(this,"genericAssayEntitiesGroupedByProfileId",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.genericAssayProfiles]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,ge.ru)(this.genericAssayProfiles.result);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})))}})}),Object.defineProperty(this,"genericAssayStableIdToMeta",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.genericAssayEntitiesGroupedByGenericAssayType]},invoke:function(){return Promise.resolve(o().chain(i.genericAssayEntitiesGroupedByGenericAssayType.result).values().flatten().uniqBy((function(e){return e.stableId})).keyBy((function(e){return e.stableId})).value())}})}),Object.defineProperty(this,"genericAssayProfiles",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.molecularProfiles]},invoke:function(){return Promise.resolve(i.molecularProfiles.result.filter((function(e){return e.molecularAlterationType===L.YK.GENERIC_ASSAY})))},default:[]})}),Object.defineProperty(this,"genericAssayProfileOptionsByType",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.genericAssayProfiles,i.molecularProfileSampleCountSet]},invoke:function(){return Promise.resolve(o().chain(i.genericAssayProfiles.result).filter((function(e){return e.molecularAlterationType===L.YK.GENERIC_ASSAY})).groupBy((function(e){return e.genericAssayType})).mapValues((function(e){return o().chain(e).groupBy((function(e){return(0,se.o)(e)})).map((function(e,t){return{value:t,count:i.molecularProfileSampleCountSet.result[t]||0,label:e[0].name,description:e[0].description,dataType:e[0].datatype,patientLevel:e[0].patientLevel,profileIds:e.map((function(e){return e.molecularProfileId}))}})).value()})).value())},default:{}})}),Object.defineProperty(this,"isInitiallLoad",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"updateUserSettingsDebounce",{enumerable:!0,configurable:!0,writable:!0,value:o().debounce((function(){!o().isEqual(i.previousSettings,i.currentChartSettingsMap)&&(i.previousSettings=i.currentChartSettingsMap,o().isEmpty(i.currentChartSettingsMap)||g.Z.updateUserSettings({origin:(0,l.toJS)(i.studyIds),chartSettings:o().values(i.currentChartSettingsMap),groupColors:(0,l.toJS)(i.userGroupColors)}))}),3e3)}),Object.defineProperty(this,"userSettings",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.isSavingUserPreferencePossible&&this.studyIds.length>0)){e.next=2;break}return e.abrupt("return",g.Z.fetchUserSettings((0,l.toJS)(this.studyIds)));case 2:return e.abrupt("return",void 0);case 3:case"end":return e.stop()}}),e,this)})))},default:void 0,onError:function(){},onResult:function(){var e=i.userSettings.isComplete&&i.userSettings.result?i.userSettings.result.groupColors:{};o().forIn(e,(function(e,t){return i.userGroupColors[t]=e}))}})}),Object.defineProperty(this,"_defaultChartsDimension",{enumerable:!0,configurable:!0,writable:!0,value:l.observable.map()}),Object.defineProperty(this,"_defaultChartsType",{enumerable:!0,configurable:!0,writable:!0,value:l.observable.map()}),Object.defineProperty(this,"_defaultVisibleChartIds",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_defaultClinicalDataBinFilterSet",{enumerable:!0,configurable:!0,writable:!0,value:l.observable.map()}),Object.defineProperty(this,"defaultVisibleAttributes",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.clinicalAttributes]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r,n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.clinicalAttributes.result.map((function(e){return e.priority=(0,f.NE)(e).toString(),e})),r=t.sort(f.tt).slice(0,20),n=[],void 0!==this.initialFilters.clinicalDataFilters&&(n=n.concat(this.initialFilters.clinicalDataFilters.map((function(e){return e.attributeId})))),n.length>0&&(i=o().filter(this.clinicalAttributes.result,(function(e){return n.includes(e.clinicalAttributeId)})),void 0!==r&&(r=r.concat(i))),e.abrupt("return",o().uniq(r));case 6:case"end":return e.stop()}}),e,this)})))},onError:function(){},default:[]})}),Object.defineProperty(this,"initialVisibleAttributesClinicalDataCountData",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.defaultVisibleAttributes]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o().uniqBy(o().filter(this.defaultVisibleAttributes.result,(function(e){return e.datatype===f.g.STRING})).map((function(e){return{attributeId:e.clinicalAttributeId}})),(function(e){return e.attributeId})),e.abrupt("return",u.Z.fetchClinicalDataCountsUsingPOST({clinicalDataCountFilter:{attributes:t,studyViewFilter:this.initialFilters}}));case 2:case"end":return e.stop()}}),e,this)})))},onError:function(){},default:[]})}),Object.defineProperty(this,"initialVisibleAttributesClinicalDataBinAttributes",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.defaultVisibleAttributes]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",o().chain(this.defaultVisibleAttributes.result).filter((function(e){return e.datatype===f.g.NUMBER})).map(this.getDefaultClinicalDataBinFilter).uniqBy((function(e){return e.attributeId})).value());case 1:case"end":return e.stop()}}),e,this)})))},onError:function(){},default:[]})}),Object.defineProperty(this,"initialVisibleAttributesClinicalDataBinCountData",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.initialVisibleAttributesClinicalDataBinAttributes]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.Z.fetchClinicalDataBinCountsUsingPOST({dataBinMethod:"STATIC",clinicalDataBinCountFilter:{attributes:this.initialVisibleAttributesClinicalDataBinAttributes.result,studyViewFilter:this.initialFilters}});case 2:return t=e.sent,e.abrupt("return",Promise.resolve((0,f.Ls)(t)));case 4:case"end":return e.stop()}}),e,this)})))},onError:function(){},default:[]})}),Object.defineProperty(this,"samples",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.clinicalAttributes,i.queriedSampleIdentifiers,i.queriedPhysicalStudyIds]},invoke:function(){var e={};return i.queriedSampleIdentifiers.result.length>0?e.sampleIdentifiers=i.queriedSampleIdentifiers.result:e.studyIds=i.queriedPhysicalStudyIds.result,o().isEmpty(e.sampleIdentifiers)&&o().isEmpty(e.studyIds)?Promise.resolve([]):u.Z.fetchFilteredSamplesUsingPOST({studyViewFilter:e})},onError:function(){},default:[]})}),Object.defineProperty(this,"sampleSet",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.samples]},invoke:function(){var e=new R.Z,t=!0,r=!1,n=void 0;try{for(var o,a=i.samples.result[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var s=o.value;e.set({studyId:s.studyId,sampleId:s.sampleId},s)}}catch(e){r=!0,n=e}finally{try{t||null==a.return||a.return()}finally{if(r)throw n}}return Promise.resolve(e)}})}),Object.defineProperty(this,"selectedSampleSet",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.selectedSamples]},invoke:function(){return Promise.resolve(R.Z.from(i.selectedSamples.result,(function(e){return{studyId:e.studyId,sampleId:e.sampleId}})))}})}),Object.defineProperty(this,"sampleSetByKey",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.samples]},invoke:function(){return Promise.resolve(o().keyBy(i.samples.result,(function(e){return e.uniqueSampleKey})))}})}),Object.defineProperty(this,"invalidSampleIds",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.queriedSampleIdentifiers,i.samples]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.queriedSampleIdentifiers.result.length>0&&this.samples.result.length!==this.queriedSampleIdentifiers.result.length)){e.next=3;break}return t=o().reduce(this.samples.result,(function(e,t){return e[t.studyId+"_"+t.sampleId]=!0,e}),{}),e.abrupt("return",o().filter(this.queriedSampleIdentifiers.result,(function(e){return!t[e.studyId+"_"+e.sampleId]})));case 3:return e.abrupt("return",[]);case 4:case"end":return e.stop()}}),e,this)})))},onError:function(){},default:[]})}),Object.defineProperty(this,"studyWithSamples",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.selectedSamples,i.filteredPhysicalStudies,i.filteredVirtualStudies]},invoke:function(){return Promise.resolve((0,f.YQ)(i.selectedSamples.result,i.filteredPhysicalStudies.result,i.filteredVirtualStudies.result))},onError:function(){},default:[]})}),Object.defineProperty(this,"blockLoading",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"selectedSamples",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.samples]},invoke:function(){return i.chartsAreFiltered?i.hasSampleIdentifiersInFilter?u.Z.fetchFilteredSamplesUsingPOST({studyViewFilter:i.filters}):Promise.resolve([]):Promise.resolve(i.samples.result)},onError:function(){},default:[],onResult:function(e){0===e.length?i.blockLoading=!0:i.blockLoading=!1}})}),Object.defineProperty(this,"selectedPatientKeys",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.selectedSamples]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",o().uniq(this.selectedSamples.result.map((function(e){return e.uniquePatientKey}))));case 1:case"end":return e.stop()}}),e,this)})))},onError:function(){},default:[]})}),Object.defineProperty(this,"unSelectedPatientKeys",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.samples,i.selectedPatientKeys]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o().reduce(this.selectedPatientKeys.result,(function(e,t){return e[t]=!0,e}),{}),r=o().reduce(this.samples.result,(function(e,r){return void 0===t[r.uniquePatientKey]&&(e[r.uniquePatientKey]=!0),e}),{}),e.abrupt("return",Object.keys(r));case 3:case"end":return e.stop()}}),e,this)})))},onError:function(){},default:[]})}),Object.defineProperty(this,"clinicalViolinDataCache",{enumerable:!0,configurable:!0,writable:!0,value:new G.Z((function(e){return{invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.Z.fetchClinicalDataViolinPlotsUsingPOST({categoricalAttributeId:e.chartInfo.categoricalAttr.clinicalAttributeId,numericalAttributeId:e.chartInfo.numericalAttr.clinicalAttributeId,logScale:e.violinLogScale,sigmaMultiplier:4,studyViewFilter:(0,f._Y)(this.filters,[e.chartInfo.categoricalAttr.clinicalAttributeId,e.chartInfo.numericalAttr.clinicalAttributeId])});case 2:return t.t0=t.sent,t.t1=e.violinLogScale,t.abrupt("return",{data:t.t0,violinLogScale:t.t1});case 5:case"end":return t.stop()}}),t,this)})))},default:{data:{axisStart:-1,axisEnd:-1,rows:[]},violinLogScale:!1}}}),(function(e){return"Category:".concat(e.chartInfo.categoricalAttr.clinicalAttributeId,"/")+"Numerical:".concat(e.chartInfo.numericalAttr.clinicalAttributeId,"/")+"violinDomain:".concat(JSON.stringify(e.chartInfo.violinDomain),"/")+"violinLog:".concat(e.violinLogScale,"/")+"Filters:".concat(JSON.stringify((0,f._Y)(i.filters,[e.chartInfo.categoricalAttr.clinicalAttributeId,e.chartInfo.numericalAttr.clinicalAttributeId])))}))}),Object.defineProperty(this,"clinicalDataDensityCache",{enumerable:!0,configurable:!0,writable:!0,value:new G.Z((function(e){return{invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function t(){var r,n,i,o,a,s,l,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return 263.282,223.372,r=Math.ceil(263.282/6),n=Math.ceil(223.372/6),i={xAxisAttributeId:e.chartInfo.xAttr.clinicalAttributeId,yAxisAttributeId:e.chartInfo.yAttr.clinicalAttributeId,xAxisLogScale:e.xAxisLogScale,yAxisLogScale:e.yAxisLogScale,xAxisBinCount:r,yAxisBinCount:n,studyViewFilter:this.filters},e.chartInfo.xAttr.clinicalAttributeId===f.h_.FRACTION_GENOME_ALTERED?(i.xAxisStart=0,i.xAxisEnd=1):e.chartInfo.xAttr.clinicalAttributeId===f.h_.MUTATION_COUNT&&(i.xAxisStart=0),e.chartInfo.yAttr.clinicalAttributeId===f.h_.FRACTION_GENOME_ALTERED?(i.yAxisStart=0,i.yAxisEnd=1):e.chartInfo.yAttr.clinicalAttributeId===f.h_.MUTATION_COUNT&&(i.yAxisStart=0),t.next=9,u.Z.fetchClinicalDataDensityPlotUsingPOST(i);case 9:return o=t.sent,a=o.bins.filter((function(e){return e.count>0})),s=(0,f.LA)(a),l=(s.x.max-s.x.min)/r,c=(s.y.max-s.y.min)/n,t.abrupt("return",{bins:a,pearsonCorr:o.pearsonCorr,spearmanCorr:o.spearmanCorr,xBinSize:l,yBinSize:c});case 15:case"end":return t.stop()}}),t,this)})))},default:{bins:[],pearsonCorr:0,spearmanCorr:0,xBinSize:-1,yBinSize:-1}}}),(function(e){return"Attr1:".concat(e.chartInfo.xAttr.clinicalAttributeId,"/")+"Attr2:".concat(e.chartInfo.yAttr.clinicalAttributeId,"/")+"plotDomain:".concat(JSON.stringify(e.chartInfo.plotDomain),"/")+"xLog:".concat(e.xAxisLogScale,"/")+"yLog:".concat(e.yAxisLogScale)}))}),Object.defineProperty(this,"genePanelCache",{enumerable:!0,configurable:!0,writable:!0,value:new G.Z((function(e){return{invoke:function(){return c.Z.getGenePanelUsingGET(e)}}}))}),Object.defineProperty(this,"mutatedGeneTableRowData",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return i.oncokbCancerGeneFilterEnabled?[i.mutationProfiles,i.oncokbAnnotatedGeneEntrezGeneIds,i.oncokbOncogeneEntrezGeneIds,i.oncokbTumorSuppressorGeneEntrezGeneIds,i.oncokbCancerGeneEntrezGeneIds]:[i.mutationProfiles]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o().isEmpty(this.mutationProfiles.result)){e.next=7;break}return e.next=3,u.Z.fetchMutatedGenesUsingPOST({studyViewFilter:this.filters});case 3:return t=e.sent,e.abrupt("return",t.map((function(e){return Object.assign(Object.assign({},e),{label:e.hugoGeneSymbol,uniqueKey:e.hugoGeneSymbol,oncokbAnnotated:!!r.oncokbCancerGeneFilterEnabled&&r.oncokbAnnotatedGeneEntrezGeneIds.result.includes(e.entrezGeneId),isOncokbOncogene:!!r.oncokbCancerGeneFilterEnabled&&r.oncokbOncogeneEntrezGeneIds.result.includes(e.entrezGeneId),isOncokbTumorSuppressorGene:!!r.oncokbCancerGeneFilterEnabled&&r.oncokbTumorSuppressorGeneEntrezGeneIds.result.includes(e.entrezGeneId),isCancerGene:!!r.oncokbCancerGeneFilterEnabled&&r.oncokbCancerGeneEntrezGeneIds.result.includes(e.entrezGeneId)})})));case 7:return e.abrupt("return",[]);case 8:case"end":return e.stop()}}),e,this)})))},onError:function(){},default:[]})}),Object.defineProperty(this,"structuralVariantGeneTableRowData",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return i.oncokbCancerGeneFilterEnabled?[i.structuralVariantProfiles,i.oncokbAnnotatedGeneEntrezGeneIds,i.oncokbOncogeneEntrezGeneIds,i.oncokbTumorSuppressorGeneEntrezGeneIds,i.oncokbCancerGeneEntrezGeneIds]:[i.structuralVariantProfiles]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o().isEmpty(this.structuralVariantProfiles.result)){e.next=7;break}return e.next=3,u.Z.fetchStructuralVariantGenesUsingPOST({studyViewFilter:this.filters});case 3:return t=e.sent,e.abrupt("return",t.map((function(e){return Object.assign(Object.assign({},e),{label:e.hugoGeneSymbol,uniqueKey:e.hugoGeneSymbol,oncokbAnnotated:!!r.oncokbCancerGeneFilterEnabled&&r.oncokbAnnotatedGeneEntrezGeneIds.result.includes(e.entrezGeneId),isOncokbOncogene:!!r.oncokbCancerGeneFilterEnabled&&r.oncokbOncogeneEntrezGeneIds.result.includes(e.entrezGeneId),isOncokbTumorSuppressorGene:!!r.oncokbCancerGeneFilterEnabled&&r.oncokbTumorSuppressorGeneEntrezGeneIds.result.includes(e.entrezGeneId),isCancerGene:!!r.oncokbCancerGeneFilterEnabled&&r.oncokbCancerGeneEntrezGeneIds.result.includes(e.entrezGeneId)})})));case 7:return e.abrupt("return",[]);case 8:case"end":return e.stop()}}),e,this)})))},onError:function(){},default:[]})}),Object.defineProperty(this,"cnaGeneTableRowData",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return i.oncokbCancerGeneFilterEnabled?[i.cnaProfiles,i.oncokbAnnotatedGeneEntrezGeneIds,i.oncokbOncogeneEntrezGeneIds,i.oncokbTumorSuppressorGeneEntrezGeneIds,i.oncokbCancerGeneEntrezGeneIds]:[i.cnaProfiles]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o().isEmpty(this.cnaProfiles.result)){e.next=7;break}return e.next=3,u.Z.fetchCNAGenesUsingPOST({studyViewFilter:this.filters});case 3:return t=e.sent,e.abrupt("return",t.map((function(e){return Object.assign(Object.assign({},e),{label:e.hugoGeneSymbol,uniqueKey:(0,M.z)(e.hugoGeneSymbol,e.alteration),oncokbAnnotated:!!r.oncokbCancerGeneFilterEnabled&&r.oncokbAnnotatedGeneEntrezGeneIds.result.includes(e.entrezGeneId),isOncokbOncogene:!!r.oncokbCancerGeneFilterEnabled&&r.oncokbOncogeneEntrezGeneIds.result.includes(e.entrezGeneId),isOncokbTumorSuppressorGene:!!r.oncokbCancerGeneFilterEnabled&&r.oncokbTumorSuppressorGeneEntrezGeneIds.result.includes(e.entrezGeneId),isCancerGene:!!r.oncokbCancerGeneFilterEnabled&&r.oncokbCancerGeneEntrezGeneIds.result.includes(e.entrezGeneId)})})));case 7:return e.abrupt("return",[]);case 8:case"end":return e.stop()}}),e,this)})))},onError:function(){},default:[]})}),Object.defineProperty(this,"cnSegments",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.selectedSamples]},invoke:function(){return(0,d.f8)(i.selectedSamples.result)}},[])}),Object.defineProperty(this,"hasCNSegmentData",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.samples]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",c.Z.fetchCopyNumberSegmentsUsingPOSTWithHttpInfo({sampleIdentifiers:this.samples.result.map((function(e){return{sampleId:e.sampleId,studyId:e.studyId}})),projection:"META"}).then((function(e){return parseInt(e.header["total-count"],10)>0})));case 1:case"end":return e.stop()}}),e,this)})))}})}),Object.defineProperty(this,"selectedDriverTiers",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.customDriverAnnotationReport]},invoke:function(){return Promise.resolve(i.customDriverAnnotationReport.result.tiers.filter((function(e){return i.driverAnnotationSettings.driverTiers.get(e)})))}})}),Object.defineProperty(this,"selectedDriverTiersMap",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.customDriverAnnotationReport,i.selectedDriverTiers]},invoke:function(){return Promise.resolve((0,f.$Y)(i.selectedDriverTiers.result,i.customDriverAnnotationReport.result.tiers))}})}),Object.defineProperty(this,"customDriverAnnotationReport",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.molecularProfiles]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.molecularProfiles.result.map((function(e){return e.molecularProfileId})),e.next=3,u.Z.fetchAlterationDriverAnnotationReportUsingPOST({molecularProfileIds:t});case 3:return r=e.sent,e.abrupt("return",Object.assign(Object.assign({},r),{hasCustomDriverAnnotations:r.hasBinary||r.tiers.length>0}));case 5:case"end":return e.stop()}}),e,this)})))},onResult:function(e){(0,ve._c)(e,i.driverAnnotationSettings,i.driverAnnotationSettings.customTiersDefault)}})}),Object.defineProperty(this,"survivalPlots",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.survivalClinicalAttributesPrefix,i.clinicalAttributeIdToClinicalAttribute,i.survivalDescriptions]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.survivalClinicalAttributesPrefix.result.map((function(e){var t="KM Plot: ";t+=r.survivalDescriptions.result&&r.survivalDescriptions.result[e]?(0,x.dw)(r.survivalDescriptions.result[e][0].displayName):"".concat(e," Survival"),t+=" (months)";var n=r.clinicalAttributeIdToClinicalAttribute.result["".concat(e,"_STATUS")];return{id:"".concat(e,"_SURVIVAL"),title:t,survivalStatusAttribute:n,associatedAttrs:["".concat(e,"_STATUS"),"".concat(e,"_MONTHS")],filter:function(t){return(0,x.Fy)(t,e)},survivalData:[]}})),e.abrupt("return",t);case 2:case"end":return e.stop()}}),e,this)})))},default:[]})}),Object.defineProperty(this,"survivalPlotData",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.survivalData,i.selectedPatientKeys,i.survivalPlots]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.survivalPlots.result.map((function(e){return e.survivalData=(0,h.y)(t.survivalData.result,t.selectedPatientKeys.result,e.associatedAttrs[0],e.associatedAttrs[1],e.filter),e})));case 1:case"end":return e.stop()}}),e,this)})))},onError:function(){},default:[]})}),Object.defineProperty(this,"survivalData",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.clinicalAttributes,i.samples,i.survivalPlots]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=o().flatten(this.survivalPlots.result.map((function(e){return e.associatedAttrs}))),o().isEmpty(t)){e.next=7;break}return r={attributeIds:t,identifiers:o().map(this.samples.result,(function(e){return{entityId:e.patientId,studyId:e.studyId}}))},e.next=5,c.Z.fetchClinicalDataUsingPOST({clinicalDataType:f.EU.PATIENT,clinicalDataMultiStudyFilter:r});case 5:return n=e.sent,e.abrupt("return",o().groupBy(n,"uniquePatientKey"));case 7:return e.abrupt("return",{});case 8:case"end":return e.stop()}}),e,this)})))},onError:function(){},default:{}})}),Object.defineProperty(this,"sampleMutationCountAndFractionGenomeAlteredData",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.clinicalAttributes,i.selectedSamples]},invoke:function(){if(0===i.selectedSamples.result.length)return Promise.resolve([]);var e={attributeIds:[f.h_.MUTATION_COUNT,f.h_.FRACTION_GENOME_ALTERED],identifiers:o().map(i.selectedSamples.result,(function(e){return{entityId:e.sampleId,studyId:e.studyId}}))};return c.Z.fetchClinicalDataUsingPOST({clinicalDataType:f.EU.SAMPLE,clinicalDataMultiStudyFilter:e})},onError:function(){},default:[]})}),Object.defineProperty(this,"mutationCountVsFGAData",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.sampleMutationCountAndFractionGenomeAlteredData]},onError:function(){},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",o().reduce(o().groupBy(this.sampleMutationCountAndFractionGenomeAlteredData.result,(function(e){return e.uniqueSampleKey})),(function(e,t){if(2==t.length){var r={studyId:t[0].studyId,sampleId:t[0].sampleId,patientId:t[0].patientId,uniqueSampleKey:t[0].uniqueSampleKey,x:0,y:0};o().forEach(t,(function(e){e.clinicalAttributeId===f.h_.MUTATION_COUNT?r.y=Number(e.value):e.clinicalAttributeId===f.h_.FRACTION_GENOME_ALTERED&&(r.x=Number(e.value))})),e.push(r)}return e}),[]));case 1:case"end":return e.stop()}}),e,this)})))}})}),Object.defineProperty(this,"mutationCountVsFractionGenomeAlteredDataSet",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.mutationCountVsFGAData]},invoke:function(){return Promise.resolve(o().keyBy(i.mutationCountVsFGAData.result,(function(e){return e.uniqueSampleKey})))},default:{}})}),Object.defineProperty(this,"getDataForClinicalDataTab",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.clinicalAttributes,i.selectedSamples]},onError:function(){},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.selectedSamples.result.length){e.next=2;break}return e.abrupt("return",Promise.resolve([]));case 2:return e.next=4,(0,f.vc)(this.selectedSamples.result);case 4:return t=e.sent,e.abrupt("return",o().reduce(this.selectedSamples.result,(function(e,r){var n=Object.assign({studyId:r.studyId,patientId:r.patientId,sampleId:r.sampleId},t[r.uniqueSampleKey]||{});return e.push(n),e}),[]));case 6:case"end":return e.stop()}}),e,this)})))},default:[]})}),Object.defineProperty(this,"molecularProfileForGeneCharts",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.molecularProfiles,i.molecularProfileSampleCounts]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.molecularProfiles.result.filter((function(e){return[L.YK.MRNA_EXPRESSION,L.YK.PROTEIN_LEVEL,L.YK.METHYLATION].includes(e.molecularAlterationType)||e.molecularAlterationType===L.YK.COPY_NUMBER_ALTERATION&&e.datatype===L.QH.CONTINUOUS})));case 1:case"end":return e.stop()}}),e,this)})))},default:[]})}),Object.defineProperty(this,"molecularProfileOptions",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.molecularProfileForGeneCharts,i.molecularProfileSampleCounts]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.molecularProfileForGeneCharts.result.map((function(e){return(0,se.o)(e)})),e.abrupt("return",this.molecularProfileSampleCounts.result.filter((function(e){return t.includes(e.uniqueKey)})).map((function(e){return{value:e.uniqueKey,count:e.numberOfAlteredCases,label:e.label,description:e.label,dataType:"STRING"}})));case 2:case"end":return e.stop()}}),e,this)})))},default:[]})}),Object.defineProperty(this,"molecularProfileSampleCounts",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.molecularProfiles]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r,n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([u.Z.fetchMolecularProfileSampleCountsUsingPOST({studyViewFilter:this.filters}),(0,_.Vi)(this.selectedSamples)]);case 2:return t=e.sent,r=Ee(t,2),n=r[0],i=r[1],e.abrupt("return",n.map((function(e){return{uniqueKey:e.value,label:e.label,numberOfAlteredCases:e.count,numberOfProfiledCases:i.length}})));case 7:case"end":return e.stop()}}),e,this)})))},default:[]})}),Object.defineProperty(this,"caseListSampleCounts",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r,n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([u.Z.fetchCaseListCountsUsingPOST({studyViewFilter:this.filters}),(0,_.Vi)(this.selectedSamples)]);case 2:return t=e.sent,r=Ee(t,2),n=r[0],i=r[1],e.abrupt("return",n.map((function(e){return{uniqueKey:e.value,label:e.label,numberOfAlteredCases:e.count,numberOfProfiledCases:i.length}})));case 7:case"end":return e.stop()}}),e,this)})))}})}),Object.defineProperty(this,"molecularProfileSampleCountSet",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.molecularProfileSampleCounts]},onError:function(){},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",o().chain(this.molecularProfileSampleCounts.result||[]).keyBy((function(e){return e.uniqueKey})).mapValues((function(e){return e.numberOfAlteredCases})).value());case 1:case"end":return e.stop()}}),e,this)})))},default:{}})}),Object.defineProperty(this,"initialMolecularProfileSampleCounts",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",u.Z.fetchMolecularProfileSampleCountsUsingPOST({studyViewFilter:this.initialFilters}));case 1:case"end":return e.stop()}}),e,this)})))},default:[]})}),Object.defineProperty(this,"initialMolecularProfileSampleCountSet",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.initialMolecularProfileSampleCounts]},onError:function(){},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",o().chain(this.initialMolecularProfileSampleCounts.result||[]).keyBy((function(e){return e.value})).mapValues((function(e){return e.count})).value());case 1:case"end":return e.stop()}}),e,this)})))}})}),Object.defineProperty(this,"molecularProfileNameSet",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.initialMolecularProfileSampleCounts]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",o().chain(this.initialMolecularProfileSampleCounts.result).keyBy((function(e){return e.value})).mapValues((function(e){return e.label})).value());case 1:case"end":return e.stop()}}),e,this)})))}})}),Object.defineProperty(this,"caseListNameSet",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.caseListSampleCounts]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",o().chain(this.caseListSampleCounts.result).keyBy((function(e){return e.uniqueKey})).mapValues((function(e){return e.label})).value());case 1:case"end":return e.stop()}}),e,this)})))}})}),Object.defineProperty(this,"clinicalAttributesCounts",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.selectedSamples]},onError:function(){},invoke:function(){if(0===i.selectedSamples.result.length)return Promise.resolve([]);var e={sampleIdentifiers:i.selectedSamples.result.map((function(e){return{sampleId:e.sampleId,studyId:e.studyId}}))};return u.Z.getClinicalAttributeCountsUsingPOST({clinicalAttributeCountFilter:e})}})}),Object.defineProperty(this,"dataWithCount",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.molecularProfileSampleCountSet,i.clinicalAttributeIdToClinicalAttribute,i.clinicalAttributesCounts,i.mutationCountVsFractionGenomeAlteredDataSet,i.sampleTreatments,i.patientTreatments,i.sampleTreatmentGroups,i.patientTreatmentGroups,i.sampleTreatmentTarget,i.patientTreatmentTarget]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r,n,i,a,s,l,u,c,p,d,h,m=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o().isEmpty(this.chartMetaSet)){e.next=22;break}return t=this.clinicalAttributeIdToClinicalAttribute.result,r=o().reduce(this.clinicalAttributesCounts.result||[],(function(e,r){var n=t[r.clinicalAttributeId];if(n){var i=(0,f.PG)(n);e[i]=e[i]||0,e[i]+=r.count}return e}),{}),o().each(this.survivalPlotData.result,(function(e){e.id in m.chartMetaSet&&(r[e.id]=e.survivalData.length)})),f.h_.CANCER_STUDIES in this.chartMetaSet&&(r[f.h_.CANCER_STUDIES]=o().sumBy(this.cancerStudiesData.result,(function(e){return e.count}))),n=this.molecularProfileSampleCountSet.result,o().isEmpty(this.mutationProfiles.result)||(i=(0,f.wl)(this.mutationProfiles.result.map((function(e){return e.molecularProfileId}))),r[i]=o().sumBy(this.mutationProfiles.result,(function(e){return n[(0,se.o)(e)]||0}))),a=function(e){return e?e.map((function(e){return e.samples})).reduce((function(e,t){return t.forEach((function(t){return e.add(t.sampleId+"::"+t.studyId)})),e}),new Set).size:0},o().isEmpty(this.sampleTreatments.result)||(r.SAMPLE_TREATMENTS=a(this.sampleTreatments.result)),o().isEmpty(this.patientTreatments.result)||(r.PATIENT_TREATMENTS=a(this.patientTreatments.result)),o().isEmpty(this.sampleTreatmentGroups.result)||(r.SAMPLE_TREATMENT_GROUPS=a(this.sampleTreatmentGroups.result)),o().isEmpty(this.patientTreatmentGroups.result)||(r.PATIENT_TREATMENT_GROUPS=a(this.patientTreatmentGroups.result)),o().isEmpty(this.sampleTreatmentTarget.result)||(r.SAMPLE_TREATMENT_TARGET=a(this.sampleTreatmentTarget.result)),o().isEmpty(this.patientTreatmentTarget.result)||(r.PATIENT_TREATMENT_TARGET=a(this.patientTreatmentTarget.result)),o().isEmpty(this.structuralVariantProfiles.result)||(s=(0,f.wl)(this.structuralVariantProfiles.result.map((function(e){return e.molecularProfileId}))),0===(l=o().sumBy(this.structuralVariantProfiles.result,(function(e){return n[(0,se.o)(e)]||0})))&&(u=(0,f.wl)(this.mutationProfiles.result.map((function(e){return e.molecularProfileId}))),l=r[u]),r[s]=l),o().isEmpty(this.cnaProfiles.result)||(c=(0,f.wl)(this.cnaProfiles.result.map((function(e){return e.molecularProfileId}))),r[c]=o().sumBy(this.cnaProfiles.result,(function(e){return n[(0,se.o)(e)]||0}))),f.g1 in this.chartMetaSet&&(p=this.mutationCountVsFractionGenomeAlteredDataSet.result,d=o().keyBy(this.selectedSamples.result,(function(e){return e.uniqueSampleKey})),h=o().reduce(d,(function(e,t){return p[t.uniqueSampleKey]&&e.push(p[t.uniqueSampleKey]),e}),[]),r[f.g1]=h.length),f.h_.GENOMIC_PROFILES_SAMPLE_COUNT in this.chartMetaSet&&(r[f.h_.GENOMIC_PROFILES_SAMPLE_COUNT]=this.selectedSamples.result.length),o().reduce(Array.from(this._customCharts.keys()),(function(e,t){return e[t]=m.selectedSamples.result.length,e}),r),this._geneSpecificChartMap.size>0&&o().reduce(Array.from(this._geneSpecificChartMap.keys()),(function(e,t){var r=m._geneSpecificChartMap.get(t);return e[t]=n[r.profileType]||0,e}),r),this._genericAssayChartMap.size>0&&o().reduce(Array.from(this._genericAssayChartMap.keys()),(function(e,t){var r=m._genericAssayChartMap.get(t);return e[t]=n[r.profileType]||0,e}),r),e.abrupt("return",o().reduce(this.chartMetaSet,(function(e,t,n){return e[n]=r[n]||0,e}),{}));case 22:return e.abrupt("return",{});case 23:case"end":return e.stop()}}),e,this)})))},onError:function(){},default:{}})}),Object.defineProperty(this,"cancerStudiesData",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.selectedSamples]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.hasFilteredSamples){e.next=2;break}return e.abrupt("return",[]);case 2:if(t=[],!this._chartSampleIdentifiersFilterSet.has(f.h_.CANCER_STUDIES)){e.next=9;break}return e.next=6,(0,f.ak)(f.h_.CANCER_STUDIES,this.filters,o().fromPairs(this._chartSampleIdentifiersFilterSet.toJSON()),this.queriedSampleIdentifiers.result,this.queriedPhysicalStudyIds.result);case 6:t=e.sent,e.next=10;break;case 9:t=this.selectedSamples.result;case 10:return r=o().values(o().reduce(t,(function(e,t){var r=t.studyId;return e[r]?e[r].count=e[r].count+1:e[r]={value:"".concat(r),count:1},e}),{})),e.abrupt("return",this.addColorToCategories(r,f.h_.CANCER_STUDIES));case 12:case"end":return e.stop()}}),e,this)})))},onError:function(){},default:[]})}),Object.defineProperty(this,"cancerStudyAsClinicalData",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.samples]},invoke:function(){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve(this.samples.result.map((function(e){return{clinicalAttributeId:f.h_.CANCER_STUDIES,patientId:e.patientId,sampleId:e.sampleId,studyId:e.studyId,uniquePatientKey:e.uniquePatientKey,uniqueSampleKey:e.uniqueSampleKey,value:e.studyId}}))));case 1:case"end":return e.stop()}}),e,this)})))},onError:function(){return Promise.resolve([])},default:[]})}),Object.defineProperty(this,"survivalClinicalAttributesPrefix",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.clinicalAttributes]},invoke:function(){return Promise.resolve((0,d.Ps)(i.clinicalAttributes.result))},default:[]})}),Object.defineProperty(this,"survivalDescriptions",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.clinicalAttributes,i.survivalClinicalAttributesPrefix]},invoke:function(){var e=o().reduce(i.survivalClinicalAttributesPrefix.result,(function(e,t){var r="".concat(t,"_STATUS"),n=o().groupBy(i.clinicalAttributes.result,"clinicalAttributeId");return n&&n[r]&&n[r].length>0&&n[r].map((function(r){e[t]||(e[t]=[]),e[t].push({studyName:r.studyId,description:r.description,displayName:r.displayName})})),e}),{});return Promise.resolve(e)}})}),Object.defineProperty(this,"_patientTreatmentsFilter",{enumerable:!0,configurable:!0,writable:!0,value:{filters:[]}}),Object.defineProperty(this,"_sampleTreatmentsFilters",{enumerable:!0,configurable:!0,writable:!0,value:{filters:[]}}),Object.defineProperty(this,"_patientTreatmentGroupsFilter",{enumerable:!0,configurable:!0,writable:!0,value:{filters:[]}}),Object.defineProperty(this,"_sampleTreatmentGroupsFilters",{enumerable:!0,configurable:!0,writable:!0,value:{filters:[]}}),Object.defineProperty(this,"_patientTreatmentTargetFilter",{enumerable:!0,configurable:!0,writable:!0,value:{filters:[]}}),Object.defineProperty(this,"_sampleTreatmentTargetFilters",{enumerable:!0,configurable:!0,writable:!0,value:{filters:[]}}),Object.defineProperty(this,"sampleTreatments",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.shouldDisplaySampleTreatments]},invoke:function(){return i.shouldDisplaySampleTreatments.result?c.Z.getAllSampleTreatmentsUsingPOST({studyViewFilter:i.filters}):Promise.resolve([])}})}),Object.defineProperty(this,"shouldDisplayPatientTreatments",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.queriedPhysicalStudyIds]},invoke:function(){return c.Z.getContainsTreatmentDataUsingPOST({studyIds:(0,l.toJS)(i.queriedPhysicalStudyIds.result)})}})}),Object.defineProperty(this,"shouldDisplaySampleTreatments",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.queriedPhysicalStudyIds]},invoke:function(){return c.Z.getContainsSampleTreatmentDataUsingPOST({studyIds:(0,l.toJS)(i.queriedPhysicalStudyIds.result)})}})}),Object.defineProperty(this,"patientTreatments",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.shouldDisplayPatientTreatments]},invoke:function(){return i.shouldDisplayPatientTreatments.result?c.Z.getAllPatientTreatmentsUsingPOST({studyViewFilter:i.filters}):Promise.resolve([])}})}),Object.defineProperty(this,"sampleTreatmentGroups",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.shouldDisplaySampleTreatmentGroups]},invoke:function(){return i.shouldDisplaySampleTreatmentGroups.result?c.Z.getAllSampleTreatmentsUsingPOST({studyViewFilter:i.filters,tier:"AgentClass"}):Promise.resolve([])}})}),Object.defineProperty(this,"shouldDisplayPatientTreatmentGroups",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.queriedPhysicalStudyIds]},invoke:function(){return(0,Ce.Ib)().enable_treatment_groups?c.Z.getContainsTreatmentDataUsingPOST({studyIds:(0,l.toJS)(i.queriedPhysicalStudyIds.result),tier:"AgentClass"}):Promise.resolve(!1)}})}),Object.defineProperty(this,"shouldDisplaySampleTreatmentGroups",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.queriedPhysicalStudyIds]},invoke:function(){return(0,Ce.Ib)().enable_treatment_groups?c.Z.getContainsSampleTreatmentDataUsingPOST({studyIds:(0,l.toJS)(i.queriedPhysicalStudyIds.result),tier:"AgentClass"}):Promise.resolve(!1)}})}),Object.defineProperty(this,"patientTreatmentGroups",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.shouldDisplayPatientTreatmentGroups]},invoke:function(){return i.shouldDisplayPatientTreatmentGroups.result?c.Z.getAllPatientTreatmentsUsingPOST({studyViewFilter:i.filters,tier:"AgentClass"}):Promise.resolve([])}})}),Object.defineProperty(this,"sampleTreatmentTarget",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.shouldDisplaySampleTreatmentTarget]},invoke:function(){return i.shouldDisplaySampleTreatmentTarget.result?c.Z.getAllSampleTreatmentsUsingPOST({studyViewFilter:i.filters,tier:"AgentTarget"}):Promise.resolve([])}})}),Object.defineProperty(this,"shouldDisplayPatientTreatmentTarget",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.queriedPhysicalStudyIds]},invoke:function(){return(0,Ce.Ib)().enable_treatment_groups?c.Z.getContainsTreatmentDataUsingPOST({studyIds:(0,l.toJS)(i.queriedPhysicalStudyIds.result),tier:"AgentTarget"}):Promise.resolve(!1)}})}),Object.defineProperty(this,"shouldDisplaySampleTreatmentTarget",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.queriedPhysicalStudyIds]},invoke:function(){return(0,Ce.Ib)().enable_treatment_groups?c.Z.getContainsSampleTreatmentDataUsingPOST({studyIds:(0,l.toJS)(i.queriedPhysicalStudyIds.result),tier:"AgentTarget"}):Promise.resolve(!1)}})}),Object.defineProperty(this,"patientTreatmentTarget",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.shouldDisplayPatientTreatmentTarget]},invoke:function(){return i.shouldDisplayPatientTreatmentTarget.result?c.Z.getAllPatientTreatmentsUsingPOST({studyViewFilter:i.filters,tier:"AgentTarget"}):Promise.resolve([])}})}),(0,l.makeObservable)(this),this.chartItemToColor=new Map,this.chartToUsedColors=new Map,this.reactionDisposers.push((0,l.reaction)((function(){return i.loadingInitialDataForSummaryTab}),(function(){i.loadingInitialDataForSummaryTab||(i.updateChartStats(),i.loadUserChartSettings())}))),this.reactionDisposers.push((0,l.reaction)((function(){return[i.visibleAttributes,i.columns,o().fromPairs(i.chartsDimension.toJSON()),o().fromPairs(i.chartsType.toJSON())]}),(function(){i.updateLayout()}))),this.reactionDisposers.push((0,l.reaction)((function(){return[(0,l.toJS)(i.currentChartSettingsMap),(0,l.toJS)(i.userGroupColors)]}),(function(){if(i.isSavingUserSettingsPossible){i.hideRestoreSettingsMsg||(i.hideRestoreSettingsMsg=!0);var e=void 0===i.userSettings.result&&Object.keys(i.userGroupColors).length>0;i.userSettings.result&&(!i.userSettings.result.groupColors||!o().isEqual((0,l.toJS)(i.userGroupColors),i.userSettings.result.groupColors))||e?i.updateUserSettings():i.updateUserSettingsDebounce()}}))),this.reactionDisposers.push((0,l.reaction)((function(){return i.userSettings.isComplete}),(function(e){e&&i.isSavingUserPreferencePossible&&!i._loadUserSettingsInitially&&(i.previousSettings=i.currentChartSettingsMap,i.loadUserChartSettings())}))),this.reactionDisposers.push((0,l.reaction)((function(){return i.userSavedCustomData.isComplete}),(function(e){e&&i.isSavingUserPreferencePossible&&!i._loadUserSettingsInitially&&(i.updateCustomDataList(i.userSavedCustomData.result,!0),i.saveSharedCustomDataToUserProfile(Array.from(i.customChartSet.values())))}))),f.qD.forEach((function(e){var t=e.uniqueKey;i.chartsType.has(t)||i.chartsType.set(t,e.chartType),void 0!==i.chartsType.get(t)&&(i._customCharts.set(t,{displayName:e.displayName,uniqueKey:t,dataType:(0,f.C3)(t),patientAttribute:e.patientAttribute,description:e.description,renderWhenDataChange:!1,priority:A.$u.priority[t]||e.priority}),i.chartsType.set(t,e.chartType),i.chartsDimension.set(t,e.dimension))}))}var t,r,n;return t=e,(r=[{key:"getDataBinFilterSet",value:function(e){return this.isGenericAssayChart(e)?this._genericAssayDataBinFilterSet:this.isGeneSpecificChart(e)?this._genomicDataBinFilterSet:this._clinicalDataBinFilterSet}},{key:"isShowNAToggleVisible",value:function(e){return 0!==e.length&&e.some((function(e){return"NA"===e.specialValue}))}},{key:"destroy",value:function(){var e=!0,t=!1,r=void 0;try{for(var n,i=this.reactionDisposers[Symbol.iterator]();!(e=(n=i.next()).done);e=!0)(0,n.value)()}catch(e){t=!0,r=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw r}}}},{key:"isResourceTabOpen",value:function(e){return!!this.openResourceTabMap.get(e)}},{key:"setResourceTabOpen",value:function(e,t){this.openResourceTabMap.set(e,t)}},{key:"setComparisonConfirmationModal",value:function(e){var t=this;this._comparisonConfirmationModal=e((function(){t._comparisonConfirmationModal=null}))}},{key:"trackNewlyCreatedGroup",value:function(e){this.createdGroups.set(e,!0)}},{key:"setComparisonGroupSelected",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._selectedComparisonGroups.set(e,t)}},{key:"toggleComparisonGroupSelected",value:function(e){this.isComparisonGroupSelected(e)&&this.showComparisonGroupWarningSign(e,!1),this.setComparisonGroupSelected(e,!this.isComparisonGroupSelected(e))}},{key:"toggleComparisonGroupMarkedForDeletion",value:function(e){this._comparisonGroupsMarkedForDeletion.set(e,!this.isComparisonGroupMarkedForDeletion(e))}},{key:"toggleCustomChartMarkedForDeletion",value:function(e){this._customChartsMarkedForDeletion.set(e,!this.isCustomChartGroupMarkedForDeletion(e))}},{key:"showComparisonGroupWarningSign",value:function(e,t){this._selectedComparisonGroupsWarningSigns.set(e,t)}},{key:"isComparisonGroupSelected",value:function(e){return!this.isComparisonGroupMarkedForDeletion(e)&&!!this._selectedComparisonGroups.has(e)&&this._selectedComparisonGroups.get(e)}},{key:"isComparisonGroupMarkedForDeletion",value:function(e){return!!this._comparisonGroupsMarkedForDeletion.has(e)&&this._comparisonGroupsMarkedForDeletion.get(e)}},{key:"isCustomChartGroupMarkedForDeletion",value:function(e){return this._customChartsMarkedForDeletion.get(e)||!1}},{key:"isComparisonGroupMarkedWithWarningSign",value:function(e){return!(!this._selectedComparisonGroups.has(e)||!this._selectedComparisonGroupsWarningSigns.get(e))}},{key:"deleteMarkedComparisonGroups",value:function(){return Oe(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r,n,i,o,a,s,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=[],r=!0,n=!1,i=void 0,e.prev=4,o=this._comparisonGroupsMarkedForDeletion.keys()[Symbol.iterator]();!(r=(a=o.next()).done);r=!0)s=a.value,this.isComparisonGroupMarkedForDeletion(s)&&(this.isLoggedIn&&(l=O.Z.deleteGroup(s),t.push(l),this._pendingChanges.push(new ae(l))),delete this.sharedGroupSet[s],this.createdGroups.delete(s),this._selectedComparisonGroups.delete(s));e.next=12;break;case 8:e.prev=8,e.t0=e.catch(4),n=!0,i=e.t0;case 12:e.prev=12,e.prev=13,r||null==o.return||o.return();case 15:if(e.prev=15,!n){e.next=18;break}throw i;case 18:return e.finish(15);case 19:return e.finish(12);case 20:return e.next=22,Promise.all(t);case 22:this._comparisonGroupsMarkedForDeletion.clear(),this.notifyComparisonGroupsChange();case 24:case"end":return e.stop()}}),e,this,[[4,8,12,20],[13,,15,19]])})))}},{key:"deleteMarkedCustomData",value:function(){return Oe(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r,n,i,o,a,s,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(Array.from(this._customChartsMarkedForDeletion.keys()).length>0)){e.next=24;break}for(t=[],r=!0,n=!1,i=void 0,e.prev=5,o=this._customChartsMarkedForDeletion.keys()[Symbol.iterator]();!(r=(a=o.next()).done);r=!0)s=a.value,this.isCustomChartGroupMarkedForDeletion(s)&&(this.isLoggedIn&&(l=g.Z.deleteCustomData(s),t.push(l)),delete this.sharedCustomChartSet[s],this.customChartSet.delete(s),this._customCharts.delete(s));e.next=13;break;case 9:e.prev=9,e.t0=e.catch(5),n=!0,i=e.t0;case 13:e.prev=13,e.prev=14,r||null==o.return||o.return();case 16:if(e.prev=16,!n){e.next=19;break}throw i;case 19:return e.finish(16);case 20:return e.finish(13);case 21:return e.next=23,Promise.all(t);case 23:this._customChartsMarkedForDeletion.clear();case 24:case"end":return e.stop()}}),e,this,[[5,9,13,21],[14,,16,20]])})))}},{key:"flagDuplicateColorsForSelectedGroups",value:function(e,t){var r=this,n={},i=(0,F.Zd)(this.comparisonGroups.result,this);i.sort((function(e,t){return e.name.localeCompare(t.name)})),i.forEach((function(i,o){var a=i.uid===e?t:r.userGroupColors[i.uid];null!=a&&(a=a.toLowerCase()),null==a||null==n[a]?(null!=a&&(n[a]=1),r.showComparisonGroupWarningSign(i.uid,!1)):(n[a]=n[a]+1,r.showComparisonGroupWarningSign(i.uid,!0))}))}},{key:"saveGroupsToUserProfile",value:function(e){return Oe(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isLoggedIn){t.next=5;break}return r=[],e.forEach((function(e){if(e.isSharedGroup||void 0===e.isSharedGroup){var t=O.Z.addGroupToUser(e.uid);r.push(t)}})),t.next=5,Promise.all(r);case 5:case"end":return t.stop()}}),t,this)})))}},{key:"saveSharedCustomDataToUserProfile",value:function(e){if(this.isLoggedIn){var t=[];e.forEach((function(e){if(e.isSharedChart||void 0===e.isSharedChart){var r=g.Z.addCustomDataToUser(e.uniqueKey);t.push(r)}})),Promise.all(t)}}},{key:"notifyComparisonGroupsChange",value:function(){this._comparisonGroupsChangeCount+=1}},{key:"onGroupColorChange",value:function(e,t){null==t&&this.userGroupColors[e]?delete this.userGroupColors[e]:this.userGroupColors[e]=t}},{key:"createNumberAttributeComparisonSession",value:function(e,t,r){return Oe(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,o=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r(D.J.DOWNLOADING_GROUPS),i=[this.selectedSamples],this.isGeneSpecificChart(e.uniqueKey)?i.push(this.genomicChartPromises[e.uniqueKey]):this.isGenericAssayChart(e.uniqueKey)?i.push(this.genericAssayChartPromises[e.uniqueKey]):i.push(this.clinicalDataBinPromises[e.uniqueKey]),n.abrupt("return",new Promise((function(n){(0,_.XE)(i,(function(i,a){return Oe(o,void 0,void 0,regeneratorRuntime.mark((function o(){var s,l,u,p,d,h,m,y,b;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(s=[],!this.isGeneSpecificChart(e.uniqueKey)){o.next=8;break}return l=this._geneSpecificChartMap.get(e.uniqueKey),o.next=5,(0,f.bq)(l,this.molecularProfileMapByType,i);case 5:s=o.sent,o.next=25;break;case 8:if(!this.isGenericAssayChart(e.uniqueKey)){o.next=15;break}return u=this._genericAssayChartMap.get(e.uniqueKey),o.next=12,(0,f.v5)(u,this.molecularProfileMapByType,i);case 12:s=o.sent,o.next=25;break;case 15:if(!(p=e.clinicalAttribute)){o.next=25;break}if(d=p.patientAttribute?"patientId":"sampleId",0!==i.length){o.next=22;break}s=[],o.next=25;break;case 22:return o.next=24,c.Z.fetchClinicalDataUsingPOST({clinicalDataType:p.patientAttribute?f.EU.PATIENT:f.EU.SAMPLE,clinicalDataMultiStudyFilter:{attributeIds:[p.clinicalAttributeId],identifiers:i.map((function(e){return{studyId:e.studyId,entityId:e[d]}}))}});case 24:s=o.sent;case 25:h=[],o.t0=t,o.next=o.t0===f.BX.BINS?29:o.t0===f.BX.MEDIAN?32:(o.t0,f.BX.QUARTILES,35);break;case 29:return h=(0,f.VC)(i,e.patientAttribute,s,a,this.studyIds),m="Bins of ".concat(e.displayName),o.abrupt("break",37);case 32:return h=(0,f.I1)(i,e.patientAttribute,(0,k.n1)(s,2),this.studyIds),m="Median of ".concat(e.displayName),o.abrupt("break",37);case 35:h=(0,f.I1)(i,e.patientAttribute,(0,k.n1)(s,4),this.studyIds),m="Quartiles of ".concat(e.displayName);case 37:return r(D.J.CREATING_SESSION),o.next=40,O.Z.addComparisonSession({groups:h,clinicalAttributeName:m,origin:this.studyIds,groupNameOrder:h.map((function(e){return e.name}))});case 40:return y=o.sent,b=y.id,o.abrupt("return",n(b));case 43:case"end":return o.stop()}}),o,this)})))}))})));case 4:case"end":return n.stop()}}),n,this)})))}},{key:"createTreatmentsComparisonSession",value:function(e,t,r,n){var i=this;n(D.J.DOWNLOADING_GROUPS);var a=t===A.oV.PATIENT_TREATMENTS_TABLE||t===A.oV.PATIENT_TREATMENT_GROUPS_TABLE||t===A.oV.PATIENT_TREATMENT_TARGET_TABLE,s=[this.selectedSampleSet,this.sampleTreatments];return new Promise((function(t){(0,_.XE)(s,(function(s,l){return Oe(i,void 0,void 0,regeneratorRuntime.mark((function i(){var u,c,p,d,h,f,m=this;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return u=o().keyBy(r),c=l.filter((function(e){return X(e,a)in u})),p=o().groupBy(c,(function(e){return X(e,a)})),d=o().map(p,(function(e){var t=o().flatMap(e,(function(e){return e.samples.filter((function(e){return s.has(e,["sampleId","studyId"])}))})).map((function(e){return{studyId:e.studyId,sampleId:e.sampleId}}));return(0,F.$q)(Z(e[0],a),t,m.studyIds)})),n(D.J.CREATING_SESSION),i.next=7,O.Z.addComparisonSession({groups:d,origin:this.studyIds,clinicalAttributeName:e.displayName});case 7:return h=i.sent,f=h.id,i.abrupt("return",t(f));case 10:case"end":return i.stop()}}),i,this)})))}))}))}},{key:"createSvGeneComparisonSession",value:function(e,t,r){var n=this;r(D.J.DOWNLOADING_GROUPS);var i=[this.selectedSamples,this.structuralVariantProfiles];return new Promise((function(o){(0,_.XE)(i,(function(i,a){return Oe(n,void 0,void 0,regeneratorRuntime.mark((function n(){var s,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fe(i,a,t);case 2:return s=n.sent,l=me(s,t),n.t0=o,n.next=7,ce(e,this.studyIds,l,r);case 7:return n.t1=n.sent,n.abrupt("return",(0,n.t0)(n.t1));case 9:case"end":return n.stop()}}),n,this)})))}))}))}},{key:"createCnaGeneComparisonSession",value:function(e,t,r){var n=this;r(D.J.DOWNLOADING_GROUPS);var i=[this.selectedSamples,this.cnaProfiles];return new Promise((function(a){(0,_.XE)(i,(function(i,s){return Oe(n,void 0,void 0,regeneratorRuntime.mark((function n(){var l,u;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,he(i,s,t);case 2:return l=n.sent,u=o().groupBy(l.filter((function(e){return e.value===be.XS||e.value===be.SD})),(function(e){return"".concat(e.gene.hugoGeneSymbol,":").concat((0,f.$9)(e.value))})),n.t0=a,n.next=7,ce(e,this.studyIds,u,r);case 7:return n.t1=n.sent,n.abrupt("return",(0,n.t0)(n.t1));case 9:case"end":return n.stop()}}),n,this)})))}))}))}},{key:"createMutatedGeneComparisonSession",value:function(e,t,r){var n=this;r(D.J.DOWNLOADING_GROUPS);var i=[this.selectedSamples,this.mutationProfiles];return new Promise((function(a){(0,_.XE)(i,(function(i,s){return Oe(n,void 0,void 0,regeneratorRuntime.mark((function n(){var l,u;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,de(i,s,t);case 2:return l=n.sent,u=o().groupBy(l,(function(e){return e.gene.hugoGeneSymbol})),n.t0=a,n.next=7,ce(e,this.studyIds,u,r);case 7:return n.t1=n.sent,n.abrupt("return",(0,n.t0)(n.t1));case 9:case"end":return n.stop()}}),n,this)})))}))}))}},{key:"createCategoricalAttributeComparisonSession",value:function(e,t,r){var n=this;r(D.J.DOWNLOADING_GROUPS);var i=[this.selectedSamples];return e.uniqueKey===f.h_.CANCER_STUDIES?i.push(this.cancerStudyAsClinicalData):this.isGenericAssayChart(e.uniqueKey)&&i.push(this.genericAssayProfiles),new Promise((function(a){(0,_.XE)(i,(function(i,s){return Oe(n,void 0,void 0,regeneratorRuntime.mark((function n(){var l,u,p,d,h,f,m,y,b,g,v,S,C,T,E,w,A,P=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(l=[],!this.isUserDefinedCustomDataChart(e.uniqueKey)){n.next=5;break}void 0===s?(u=o().keyBy(this._customChartsSelectedCases.get(e.uniqueKey),(function(e){return e.studyId+e.sampleId})),l=i.map((function(e){var t=u[e.studyId+e.sampleId];return{sampleId:e.sampleId,studyId:e.studyId,value:t?t.value:re.y.NA}}))):(p=o().keyBy(i,(function(e){return e.uniqueSampleKey})),l=o().filter(s,(function(e){return void 0!==p[e.uniqueSampleKey]}))),n.next=24;break;case 5:if(!this.isGenericAssayChart(e.uniqueKey)){n.next=18;break}return d=e.patientAttribute,h=this._genericAssayChartMap.get(e.uniqueKey),f=o().chain(this.genericAssayProfiles.result).filter((function(e){return e.genericAssayType===h.genericAssayType})).groupBy((function(e){return(0,se.o)(e)})).value(),m=o().flatMap(f[h.profileType].map((function(e){return e.molecularProfileId})),(function(e){return o().map(P.samples.result,(function(t){return{molecularProfileId:e,sampleId:t.sampleId}}))})),n.next=12,c.Z.fetchGenericAssayDataInMultipleMolecularProfilesUsingPOST({genericAssayDataMultipleStudyFilter:{genericAssayStableIds:[h.genericAssayEntityId],sampleMolecularIdentifiers:m}});case 12:l=n.sent,y=d?o().keyBy(l,(function(e){return e.uniquePatientKey})):o().keyBy(l,(function(e){return e.uniqueSampleKey})),b=function(e){return d?e.uniquePatientKey:e.uniqueSampleKey},l=i.map((function(e){var t=y[b(e)];return{sampleId:e.sampleId,studyId:e.studyId,value:t?t.value:re.y.NA}})),n.next=24;break;case 18:return g=e.clinicalAttribute&&e.clinicalAttribute.patientAttribute||!1,v=g?"patientId":"sampleId",n.next=22,c.Z.fetchClinicalDataUsingPOST({clinicalDataType:g?"PATIENT":"SAMPLE",clinicalDataMultiStudyFilter:{attributeIds:[e.clinicalAttribute.clinicalAttributeId],identifiers:i.map((function(e){return{studyId:e.studyId,entityId:e[v]}}))}});case 22:l=n.sent,g&&(S=o().keyBy(l,(function(e){return e.uniquePatientKey})),l=i.map((function(e){var t=S[e.uniquePatientKey];return{sampleId:e.sampleId,studyId:e.studyId,value:t?t.value:re.y.NA}})));case 24:return C=o().groupBy(l,(function(e){return e.value.toLowerCase()})),T=o().keyBy(t,(function(e){return e.value.toLowerCase()})),E=o().chain(t).filter((function(e){var t=e.value.toLowerCase(),r=C[t];return r&&r.length>0})).sortBy((function(e){return-e.count})).slice(0,ue(e)?k.EC:void 0).map((function(e){var t=e.value.toLowerCase(),r=C[t];return(0,F.$q)(e.value,r,P.studyIds,T[t].color)})).value(),r(D.J.CREATING_SESSION),n.next=30,O.Z.addComparisonSession({groups:E,clinicalAttributeName:e.displayName,origin:this.studyIds});case 30:return w=n.sent,A=w.id,n.abrupt("return",a(A));case 33:case"end":return n.stop()}}),n,this)})))}))}))}},{key:"openComparisonPage",value:function(e,t){return Oe(this,void 0,void 0,regeneratorRuntime.mark((function r(){var n,i,o,a,s;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=window.open((0,P.ds)({phase:D.J.DOWNLOADING_GROUPS,clinicalAttributeName:e.displayName,origin:this.studyIds.join(",")}),"_blank"),r.next=3,(0,N.C)((function(){return n.closed||n.globalStores&&n.globalStores.appStore.appReady}));case 3:if(!n.closed){r.next=5;break}return r.abrupt("return");case 5:i=setInterval((function(){try{n.closed||n.ping()}catch(e){clearInterval(i)}}),500),a=function(e){n.closed||n.routingStore.updateRoute({phase:e},void 0,!1)},s=this.chartsType.get(e.uniqueKey),r.t0=s,r.next=r.t0===A.oV.PIE_CHART||r.t0===A.oV.TABLE?11:r.t0===A.oV.MUTATED_GENES_TABLE?15:r.t0===A.oV.CNA_GENES_TABLE?19:r.t0===A.oV.STRUCTURAL_VARIANT_GENES_TABLE?23:r.t0===A.oV.SAMPLE_TREATMENTS_TABLE||r.t0===A.oV.SAMPLE_TREATMENT_GROUPS_TABLE||r.t0===A.oV.SAMPLE_TREATMENT_TARGET_TABLE||r.t0===A.oV.PATIENT_TREATMENTS_TABLE||r.t0===A.oV.PATIENT_TREATMENT_GROUPS_TABLE||r.t0===A.oV.PATIENT_TREATMENT_TARGET_TABLE?27:31;break;case 11:return r.next=13,this.createCategoricalAttributeComparisonSession(e,t.clinicalAttributeValues,a);case 13:return o=r.sent,r.abrupt("break",35);case 15:return r.next=17,this.createMutatedGeneComparisonSession(e,t.hugoGeneSymbols,a);case 17:return o=r.sent,r.abrupt("break",35);case 19:return r.next=21,this.createCnaGeneComparisonSession(e,t.hugoGeneSymbols,a);case 21:return o=r.sent,r.abrupt("break",35);case 23:return r.next=25,this.createSvGeneComparisonSession(e,t.hugoGeneSymbols,a);case 25:return o=r.sent,r.abrupt("break",35);case 27:return r.next=29,this.createTreatmentsComparisonSession(e,s,t.treatmentUniqueKeys,a);case 29:return o=r.sent,r.abrupt("break",35);case 31:return r.next=33,this.createNumberAttributeComparisonSession(e,t.categorizationType||f.BX.QUARTILES,a);case 33:return o=r.sent,r.abrupt("break",35);case 35:clearInterval(i),n.closed||(0,P.bf)(n,{comparisonId:o});case 37:case"end":return r.stop()}}),r,this)})))}},{key:"setGenomicProfilesFilter",value:function(e){this._genomicProfilesFilter=e}},{key:"setCaseListsFilter",value:function(e){this._caseListsFilter=e}},{key:"isNewlyAdded",value:function(e){return this.newlyAddedCharts.includes(e)}},{key:"updateStoreByFilters",value:function(e){var t=this;(0,f.LZ)(e),o().isEmpty(e.clinicalDataFilters)||o().each(e.clinicalDataFilters,(function(e){t._clinicalDataFilterSet.set(e.attributeId,{attributeId:e.attributeId,values:o().reduce(e.values,(function(e,t){return e.push({end:t.end,start:t.start,value:t.value}),e}),[])})})),o().isArray(e.customDataFilters)&&e.customDataFilters.length>0&&o().each(e.customDataFilters,(function(e){t.sharedCustomChartSet[e.attributeId]=!0,t._customDataFilterSet.set(e.attributeId,{attributeId:e.attributeId,values:o().reduce(e.values,(function(e,t){return e.push({end:t.end,start:t.start,value:t.value}),e}),[])})})),o().isEmpty(e.geneFilters)||e.geneFilters.forEach((function(e){var r=(0,f.wl)(e.molecularProfileIds);t._geneFilterSet.set(r,o().clone(e.geneQueries))})),o().isEmpty(e.sampleIdentifiers)||(this.numberOfSelectedSamplesInCustomSelection=e.sampleIdentifiers.length,this.updateChartSampleIdentifierFilter(f.h_.CUSTOM_SELECT,e.sampleIdentifiers,!1)),void 0!==e.genomicProfiles&&this.setGenomicProfilesFilter(e.genomicProfiles),this.setTreatmentFilters(e),void 0!==e.caseLists&&this.setCaseListsFilter(e.caseLists),o().isEmpty(e.genomicDataFilters)||e.genomicDataFilters.forEach((function(e){var r=(0,f.Xq)(e.hugoGeneSymbol,e.profileType);t._genomicDataIntervalFilterSet.set(r,o().clone(e))})),o().isEmpty(e.genericAssayDataFilters)||e.genericAssayDataFilters.forEach((function(e){var r=(0,f.XP)(e.stableId,e.profileType);t._genericAssayDataFilterSet.set(r,o().clone(e))})),o().isEqual((0,l.toJS)(this.initialFiltersQuery),e)||(this.initialFiltersQuery=e)}},{key:"updateStoreFromURL",value:function(e){return Oe(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,n,i,a,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r="",n=[],e.studyId&&(r=e.studyId),e.cancer_study_id&&(r=e.cancer_study_id),e.id&&(r=e.id),r&&(n=r.trim().split(","),o().isEqual(n,(0,l.toJS)(this.studyIds))||(this.studyIds=n)),e.sharedGroups&&(this.sharedGroupSet=(0,_.cD)(e.sharedGroups.trim().split(",")),this.showComparisonGroupUI=!0),e.sharedCustomData&&(this.sharedCustomChartSet=(0,_.cD)(e.sharedCustomData.trim().split(",")),this.showCustomDataSelectionUI=!0),i={},!e.filterJson){t.next=13;break}try{i=JSON.parse(decodeURIComponent(e.filterJson)),this.updateStoreByFilters(i)}catch(e){}t.next=22;break;case 13:if(!e.filterAttributeId||!e.filterValues){t.next=22;break}return t.t0=o(),t.next=17,c.Z.fetchClinicalAttributesUsingPOST({studyIds:n});case 17:t.t1=t.sent,t.t2=function(e){return"".concat(e.patientAttribute,"-").concat(e.clinicalAttributeId)},a=t.t0.uniqBy.call(t.t0,t.t1,t.t2),void 0!==(s=o().find(a,(function(t){return t.clinicalAttributeId.toUpperCase()===e.filterAttributeId.toUpperCase()})))?(s.datatype==f.g.NUMBER?i.clinicalDataFilters=[{attributeId:s.clinicalAttributeId,values:e.filterValues.split(",").map((function(e){var t=e.split("-");return{start:Number(t[0]),end:Number(t[1])}}))}]:i.clinicalDataFilters=[{attributeId:s.clinicalAttributeId,values:(0,f.tM)(e.filterValues).map((function(e){return{value:e}}))}],this.updateStoreByFilters(i)):this.pageStatusMessages.unknownClinicalAttribute={message:"The clinical attribute ".concat(e.filterAttributeId," is not available for this study"),status:"danger"};case 22:case"end":return t.stop()}}),t,this)})))}},{key:"updateLayout",value:function(){this.currentGridLayout=(0,f.JS)(this.visibleAttributes,this.columns,o().fromPairs(this.chartsDimension.toJSON()),this.useCurrentGridLayout?this.currentGridLayout:[],this.currentFocusedChartByUser,this.currentFocusedChartByUserDimension),this.useCurrentGridLayout&&(this.useCurrentGridLayout=!1)}},{key:"updateCurrentGridLayout",value:function(e){this.currentGridLayout=e}},{key:"updateMutatedGenesTableByCancerGenesFilter",value:function(e){this._filterMutatedGenesTableByCancerGenes=e}},{key:"updateSVGenesTableByCancerGenesFilter",value:function(e){this._filterSVGenesTableByCancerGenes=e}},{key:"updateCNAGenesTableByCancerGenesFilter",value:function(e){this._filterCNAGenesTableByCancerGenes=e}},{key:"updateComparisonGroupsFilter",value:function(){var e=this;(0,_.XE)(this.comparisonGroups,(function(t){e._filterComparisonGroups=(0,F.Zd)(t,e),e.updateChartSampleIdentifierFilter(f.h_.SELECTED_COMPARISON_GROUPS,(0,k.b)(e._filterComparisonGroups))}))}},{key:"getXvsYViolinChartInfo",value:function(e){return this._XvsYViolinChartMap.get(e)}},{key:"getXvsYScatterChartInfo",value:function(e){return this._XvsYScatterChartMap.get(e)}},{key:"getXvsYChartSettings",value:function(e){return this._XvsYChartSettings.get(e)}},{key:"getXvsYChartMeta",value:function(e){return this._XvsYCharts.get(e)}},{key:"swapXvsYChartAxes",value:function(e){var t=this.getXvsYScatterChartInfo(e),r=this.getXvsYChartSettings(e),n=this.getXvsYChartMeta(e),i=t.xAttr;t.xAttr=t.yAttr,t.yAttr=i;var o=r.xLogScale;r.xLogScale=r.yLogScale,r.yLogScale=o,n.displayName=(0,f.OT)(t.xAttr,t.yAttr),this.changeChartVisibility(e,!1),this.changeChartVisibility(e,!0)}},{key:"isXvsYChartVisible",value:function(e,t){var r=this._XvsYScatterChartMap.entries(),n=null,i=!0,o=!1,a=void 0;try{for(var s,l=r[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=Ee(s.value,2),c=u[0],p=u[1],d=[p.xAttr.clinicalAttributeId,p.yAttr.clinicalAttributeId];if(d.includes(e)&&d.includes(t)){n=c;break}}}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}return null!==n&&!!this._chartVisibility.get(n)}},{key:"onCheckGene",value:function(e){this.geneQueries=(0,f.W$)(this.geneQueries,e),this.geneQueryStr=this.geneQueries.map((function(e){return(0,b.rY)(e)})).join(" ")}},{key:"isSharedCustomData",value:function(e){var t;return this.customChartSet.has(e)&&(null===(t=this.customChartSet.get(e))||void 0===t?void 0:t.isSharedChart)||!1}},{key:"updateSelectedGenes",value:function(e,t){this.geneQueries=e,this.geneQueryStr=t}},{key:"clearAllFilters",value:function(){this._clinicalDataFilterSet.clear(),this._customDataFilterSet.clear(),this._geneFilterSet.clear(),this._genomicDataIntervalFilterSet.clear(),this._genericAssayDataFilterSet.clear(),this._chartSampleIdentifiersFilterSet.clear(),this.preDefinedCustomChartFilterSet.clear(),this.numberOfSelectedSamplesInCustomSelection=0,this.removeComparisonGroupSelectionFilter(),this._customBinsFromScatterPlotSelectionSet.clear(),this.setGenomicProfilesFilter([]),this.setCaseListsFilter([]),this.clearPatientTreatmentFilters(),this.clearPatientTreatmentGroupFilters(),this.clearPatientTreatmentTargetFilters(),this.clearSampleTreatmentFilters(),this.clearSampleTreatmentGroupFilters(),this.clearSampleTreatmentTargetFilters()}},{key:"updateClinicalDataIntervalFilters",value:function(e,t){e===f.h_.FRACTION_GENOME_ALTERED&&this._customBinsFromScatterPlotSelectionSet.delete(f.h_.FRACTION_GENOME_ALTERED),e===f.h_.MUTATION_COUNT&&this._customBinsFromScatterPlotSelectionSet.delete(f.h_.MUTATION_COUNT),(0,I.om)("clinicalDataInterval",this);var r=(0,f._S)(t);this.updateClinicalDataFilterByValues(e,r)}},{key:"updateClinicalDataFilterByValues",value:function(e,t){if(this.chartMetaSet[e]){var r=this.chartMetaSet[e];(0,I.om)("clinicalDataFilters",this),this.updateClinicalAttributeFilterByValues(r.clinicalAttribute.clinicalAttributeId,t)}}},{key:"updateClinicalAttributeFilterByValues",value:function(e,t){if(t.length>0){var r={attributeId:e,values:t};this._clinicalDataFilterSet.set(e,r)}else this._clinicalDataFilterSet.delete(e)}},{key:"updateClinicalDataCustomIntervalFilter",value:function(e,t){return Oe(this,void 0,void 0,regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,f.oM)(t,{uniqueKey:e,clinicalAttribute:{clinicalAttributeId:e}},this.getClinicalDataBin,this.getClinicalDataFiltersByUniqueKey,this.updateCustomBins,this.updateClinicalDataIntervalFilters);case 2:case"end":return r.stop()}}),r,this)})))}},{key:"setCustomChartFilters",value:function(e,t){if(this.chartMetaSet[e])if(t.length>0){var r={attributeId:e,values:t.map((function(e){return{value:e}}))};if(e===f.h_.CANCER_STUDIES){var n=(0,f.NH)(this.samples.result.filter((function(e){return t.includes(e.studyId)})));this._chartSampleIdentifiersFilterSet.set(e,n),this.preDefinedCustomChartFilterSet.set(e,r)}else this._customDataFilterSet.set(e,r)}else e===f.h_.CANCER_STUDIES?(this._chartSampleIdentifiersFilterSet.delete(e),this.preDefinedCustomChartFilterSet.delete(e)):this._customDataFilterSet.delete(e)}},{key:"updateGenomicDataIntervalFilters",value:function(e,t){(0,I.om)("genomicDataInterval",this);var r=(0,f._S)(t);this.updateGenomicDataIntervalFiltersByValues(e,r)}},{key:"updateGenericAssayDataFilters",value:function(e,t){(0,I.om)("genericAssayDataInterval",this);var r=(0,f._S)(t);this.updateGenericAssayDataFiltersByValues(e,r)}},{key:"updateCategoricalGenericAssayDataFilters",value:function(e,t){(0,I.om)("genericAssayCategoricalData",this);var r=(0,f.Tl)(t);this.updateGenericAssayDataFiltersByValues(e,r)}},{key:"updateScatterPlotFilterByValues",value:function(e,t){var r=this.getXvsYScatterChartInfo(e);if(void 0===t)this._clinicalDataFilterSet.delete(r.xAttr.clinicalAttributeId),this._clinicalDataFilterSet.delete(r.yAttr.clinicalAttributeId),this._customBinsFromScatterPlotSelectionSet.delete(r.xAttr.clinicalAttributeId),this._customBinsFromScatterPlotSelectionSet.delete(r.yAttr.clinicalAttributeId);else{var n=this.getXvsYChartSettings(e),i={start:t.yStart,end:t.yEnd};n.yLogScale&&(i.start=Math.exp(i.start)-1,i.end=Math.exp(i.end)-1);var o={attributeId:r.yAttr.clinicalAttributeId,values:[i]};this._customBinsFromScatterPlotSelectionSet.set(r.yAttr.clinicalAttributeId,[i.start,i.end]),this._clinicalDataFilterSet.set(r.yAttr.clinicalAttributeId,o);var a={start:t.xStart,end:t.xEnd};n.xLogScale&&(a.start=Math.exp(a.start)-1,a.end=Math.exp(a.end)-1);var s={attributeId:r.xAttr.clinicalAttributeId,values:[a]};this._customBinsFromScatterPlotSelectionSet.set(r.xAttr.clinicalAttributeId,[a.start,a.end]),this._clinicalDataFilterSet.set(r.xAttr.clinicalAttributeId,s)}}},{key:"addGeneFilters",value:function(e,t){var r=this;(0,I.om)("geneFilter",this);var n=(0,l.toJS)(this._geneFilterSet.get(e.uniqueKey))||[],i=o().map(t,(function(e){return o().map(e,(function(e){return(0,f.$3)(e,r.driverAnnotationSettings.includeDriver,r.driverAnnotationSettings.includeVUS,r.driverAnnotationSettings.includeUnknownOncogenicity,r.selectedDriverTiersMap.isComplete?r.selectedDriverTiersMap.result:{},r.driverAnnotationSettings.includeUnknownTier,r.includeGermlineMutations,r.includeSomaticMutations,r.includeUnknownStatusMutations)}))}));n=n.concat(i),this._geneFilterSet.set(e.uniqueKey,n)}},{key:"updateGenomicDataIntervalFiltersByValues",value:function(e,t){if(t.length>0){var r=this._geneSpecificChartMap.get(e),n={hugoGeneSymbol:r.hugoGeneSymbol,profileType:r.profileType,values:t};this._genomicDataIntervalFilterSet.set(e,n)}else this._genomicDataIntervalFilterSet.delete(e)}},{key:"updateGenericAssayDataFiltersByValues",value:function(e,t){if(t.length>0){var r=this._genericAssayChartMap.get(e),n={stableId:r.genericAssayEntityId,profileType:r.profileType,values:t};this._genericAssayDataFilterSet.set(e,n)}else this._genericAssayDataFilterSet.delete(e)}},{key:"addGenomicProfilesFilter",value:function(e,t){var r=(0,l.toJS)(this.genomicProfilesFilter)||[];this.setGenomicProfilesFilter(r.concat(t))}},{key:"addCaseListsFilter",value:function(e,t){var r=(0,l.toJS)(this.caseListsFilter)||[];this.setCaseListsFilter(r.concat(t))}},{key:"removeGeneFilter",value:function(e,t){var r=(0,l.toJS)(this._geneFilterSet.get(e))||[];0===(r=o().reduce(r,(function(e,r){var n=Ee(t.split(":"),2),i=n[0],a=n[1],s=r.filter((function(e){return e.hugoGeneSymbol!==i&&!o().includes(e.alterations,a)}));return s.length>0&&e.push(s),e}),[])).length?this._geneFilterSet.delete(e):this._geneFilterSet.set(e,r)}},{key:"resetGeneFilter",value:function(e){this._geneFilterSet.delete(e)}},{key:"removeGenomicProfileFilter",value:function(e){var t=(0,l.toJS)(this.genomicProfilesFilter)||[];t=o().reduce(t,(function(t,r){var n=r.filter((function(t){return t!==e}));return n.length>0&&t.push(n),t}),[]),this.setGenomicProfilesFilter(t)}},{key:"removeCaseListsFilter",value:function(e){var t=(0,l.toJS)(this.caseListsFilter)||[];t=o().reduce(t,(function(t,r){var n=r.filter((function(t){return t!==e}));return n.length>0&&t.push(n),t}),[]),this.setGenomicProfilesFilter(t)}},{key:"updateChartSampleIdentifierFilter",value:function(e,t,r){var n=t,i=o().keyBy(n,(function(e){return"".concat(e.studyId,":").concat(e.sampleId)}));r&&(n=o().reduce(this._chartSampleIdentifiersFilterSet.get(e)||[],(function(e,t){return"".concat(t.studyId,":").concat(t.sampleId)in i||e.push(t),e}),n)),o().isEmpty(n)?this._chartSampleIdentifiersFilterSet.delete(e):this._chartSampleIdentifiersFilterSet.set(e,n)}},{key:"getChartSampleIdentifiersFilter",value:function(e){return this._chartSampleIdentifiersFilterSet.get(e)||[]}},{key:"isPreDefinedCustomChart",value:function(e){return e in f.h_}},{key:"newCustomChartUniqueKey",value:function(){return"CUSTOM_FILTERS_".concat(this._customCharts.size)}},{key:"getUserDefinedCustomChartFilters",value:function(e){return this._customDataFilterSet.get(e)||[]}},{key:"isUserDefinedCustomDataChart",value:function(e){return this._customCharts.has(e)}},{key:"isGeneSpecificChart",value:function(e){return this._geneSpecificChartMap.has(e)}},{key:"isGenericAssayChart",value:function(e){return this._genericAssayChartMap.has(e)}},{key:"changeChartVisibility",value:function(e,t){t?this._chartVisibility.set(e,!0):this._chartVisibility.delete(e)}},{key:"resetFilterAndChangeChartVisibility",value:function(e,t){if(!t)switch(this.chartsType.get(e)){case A.oV.PIE_CHART:case A.oV.TABLE:this.isUserDefinedCustomDataChart(e)?this.setCustomChartFilters(e,[]):this.isGenericAssayChart(e)?this.updateGenericAssayDataFilters(e,[]):this.updateClinicalDataFilterByValues(e,[]);break;case A.oV.BAR_CHART:this.isGeneSpecificChart(e)?this.updateGenomicDataIntervalFilters(e,[]):this.isGenericAssayChart(e)?this.updateGenericAssayDataFilters(e,[]):this.updateClinicalDataIntervalFilters(e,[]);break;case A.oV.SCATTER:this.updateScatterPlotFilterByValues(e);break;case A.oV.MUTATED_GENES_TABLE:case A.oV.STRUCTURAL_VARIANT_GENES_TABLE:case A.oV.CNA_GENES_TABLE:this.resetGeneFilter(e);break;case A.oV.GENOMIC_PROFILES_TABLE:this.setGenomicProfilesFilter([]);break;case A.oV.CASE_LIST_TABLE:this.setCaseListsFilter([]);break;case A.oV.SURVIVAL:break;case A.oV.SAMPLE_TREATMENT_TARGET_TABLE:this.setSampleTreatmentTargetFilters({filters:[]});break;case A.oV.PATIENT_TREATMENT_TARGET_TABLE:this.setPatientTreatmentTargetFilters({filters:[]});break;case A.oV.SAMPLE_TREATMENT_GROUPS_TABLE:this.setSampleTreatmentGroupFilters({filters:[]});break;case A.oV.PATIENT_TREATMENT_GROUPS_TABLE:this.setPatientTreatmentGroupFilters({filters:[]});break;case A.oV.SAMPLE_TREATMENTS_TABLE:this.setSampleTreatmentFilters({filters:[]});break;case A.oV.PATIENT_TREATMENTS_TABLE:this.setPatientTreatmentFilters({filters:[]});break;default:this._clinicalDataFilterSet.delete(e),this._chartSampleIdentifiersFilterSet.delete(e),this.preDefinedCustomChartFilterSet.delete(e),this._genomicDataIntervalFilterSet.delete(e),this._genericAssayDataFilterSet.delete(e)}this.changeChartVisibility(e,t)}},{key:"isChartFiltered",value:function(e){switch(this.chartsType.get(e)){case A.oV.PIE_CHART:case A.oV.TABLE:return this.isUserDefinedCustomDataChart(e)?this._customDataFilterSet.has(e)||this.preDefinedCustomChartFilterSet.has(e):this.isGenericAssayChart(e)?this._genericAssayDataFilterSet.has(e):this._clinicalDataFilterSet.has(e);case A.oV.BAR_CHART:return this.isGeneSpecificChart(e)&&this._genomicDataIntervalFilterSet.has(e),this._clinicalDataFilterSet.has(e);case A.oV.SCATTER:var t=this._XvsYScatterChartMap.get(e);return this._customBinsFromScatterPlotSelectionSet.has(t.xAttr.clinicalAttributeId)&&this._customBinsFromScatterPlotSelectionSet.has(t.yAttr.clinicalAttributeId);case A.oV.MUTATED_GENES_TABLE:case A.oV.STRUCTURAL_VARIANT_GENES_TABLE:case A.oV.CNA_GENES_TABLE:return this._geneFilterSet.has(e);case A.oV.GENOMIC_PROFILES_TABLE:return!o().isEmpty(this._genomicProfilesFilter);case A.oV.CASE_LIST_TABLE:return!o().isEmpty(this._caseListsFilter);case A.oV.SURVIVAL:return!1;case A.oV.SAMPLE_TREATMENT_TARGET_TABLE:return!o().isEmpty(this._sampleTreatmentTargetFilters.filters);case A.oV.PATIENT_TREATMENT_TARGET_TABLE:return!o().isEmpty(this._patientTreatmentTargetFilter.filters);case A.oV.SAMPLE_TREATMENT_GROUPS_TABLE:return!o().isEmpty(this._sampleTreatmentGroupsFilters.filters);case A.oV.PATIENT_TREATMENT_GROUPS_TABLE:return!o().isEmpty(this._patientTreatmentGroupsFilter.filters);case A.oV.SAMPLE_TREATMENTS_TABLE:return!o().isEmpty(this._sampleTreatmentsFilters.filters);case A.oV.PATIENT_TREATMENTS_TABLE:return!o().isEmpty(this._patientTreatmentsFilter.filters);default:return!1}}},{key:"removeComparisonGroupSelectionFilter",value:function(){this._chartSampleIdentifiersFilterSet.delete(f.h_.SELECTED_COMPARISON_GROUPS),this._filterComparisonGroups=[]}},{key:"removeCustomSelectFilter",value:function(){this._chartSampleIdentifiersFilterSet.delete(f.h_.CUSTOM_SELECT),this.numberOfSelectedSamplesInCustomSelection=0}},{key:"toggleLogScale",value:function(e){if(this.isGeneSpecificChart(e)){this.updateGenomicDataIntervalFilters(e,[]);var t=this._genomicDataBinFilterSet.get(e);t.disableLogScale=!t.disableLogScale}else if(this.isGenericAssayChart(e)){this.updateGenericAssayDataFilters(e,[]);var r=this._genericAssayDataBinFilterSet.get(e);r.disableLogScale=!r.disableLogScale}else{this.updateClinicalDataIntervalFilters(e,[]);var n=this._clinicalDataBinFilterSet.get(e);n.disableLogScale=!n.disableLogScale}}},{key:"isLogScaleToggleVisible",value:function(e,t){return this.isGeneSpecificChart(e)?void 0!==this._genomicDataBinFilterSet.get(e)&&this._genomicDataBinFilterSet.get(e).disableLogScale||(0,f.c1)(t):this.isGenericAssayChart(e)?void 0!==this._genericAssayDataBinFilterSet.get(e)&&this._genericAssayDataBinFilterSet.get(e).disableLogScale||(0,f.c1)(t):void 0!==this._clinicalDataBinFilterSet.get(e)&&this._clinicalDataBinFilterSet.get(e).disableLogScale||(0,f.c1)(t)}},{key:"isLogScaleChecked",value:function(e){return this.isGeneSpecificChart(e)?void 0!==this._genomicDataBinFilterSet.get(e)&&!this._genomicDataBinFilterSet.get(e).disableLogScale:this.isGenericAssayChart(e)?void 0!==this._genericAssayDataBinFilterSet.get(e)&&!this._genericAssayDataBinFilterSet.get(e).disableLogScale:void 0!==this._clinicalDataBinFilterSet.get(e)&&!this._clinicalDataBinFilterSet.get(e).disableLogScale}},{key:"updateCustomBins",value:function(e,t){if(this.isGeneSpecificChart(e)){var r=o().clone(this._genomicDataBinFilterSet.get(e));r.customBins=t,this._genomicDataBinFilterSet.set(e,r)}else if(this.isGenericAssayChart(e)){var n=o().clone(this._genericAssayDataBinFilterSet.get(e));n.customBins=t,this._genericAssayDataBinFilterSet.set(e,n)}else{var i=o().clone(this._clinicalDataBinFilterSet.get(e));t.length>0?i.customBins=t:delete i.customBins,this._clinicalDataBinFilterSet.set(e,i)}}},{key:"getCurrentBins",value:function(e){return this.isGeneSpecificChart(e.uniqueKey)?(0,f.ii)(this.getGenomicChartDataBin(e).result):this.isGenericAssayChart(e.uniqueKey)?(0,f.ii)(this.getGenericAssayChartDataBin(e).result):(0,f.ii)(this.getClinicalDataBin(e).result)}},{key:"addCharts",value:function(e){var t=this;e.forEach((function(e){t._chartVisibility.has(e)||t.newlyAddedCharts.push(e)})),this.updateChartsVisibility(e)}},{key:"updateChartsVisibility",value:function(e){var t=!0,r=!1,n=void 0;try{for(var i,a=this._chartVisibility.keys()[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value;o().includes(e,s)&&this._chartVisibility.get(s)||this.changeChartVisibility(s,!1)}}catch(e){r=!0,n=e}finally{try{t||null==a.return||a.return()}finally{if(r)throw n}}var l=!0,u=!1,c=void 0;try{for(var p,d=e[Symbol.iterator]();!(l=(p=d.next()).done);l=!0){var h=p.value;void 0===this._chartVisibility.get(h)&&this.changeChartVisibility(h,!0)}}catch(e){u=!0,c=e}finally{try{l||null==d.return||d.return()}finally{if(u)throw c}}}},{key:"getGeneFiltersByUniqueKey",value:function(e){var t=o().map(this._geneFilterSet.get(e),(function(e){return o().map(e,f.zU)}));return(0,l.toJS)(t)}},{key:"getClinicalDataFiltersByUniqueKey",value:function(e){var t=this._clinicalDataFilterSet.get(e);return t?t.values:[]}},{key:"getCustomDataFiltersByUniqueKey",value:function(e){var t=void 0;return(t=e===f.h_.CANCER_STUDIES?this.preDefinedCustomChartFilterSet.get(e):this._customDataFilterSet.get(e))?t.values:[]}},{key:"getScatterPlotFiltersByUniqueKey",value:function(e){var t=this.getXvsYScatterChartInfo(e),r=this._clinicalDataFilterSet.get(t.xAttr.clinicalAttributeId),n=this._clinicalDataFilterSet.get(t.yAttr.clinicalAttributeId),i={};if(r){var o=(0,f.Uy)(r.values);i.xStart=o.start,i.xEnd=o.end}if(n){var a=(0,f.Uy)(n.values);i.yStart=a.start,i.yEnd=a.end}return r||n?[i]:[]}},{key:"getGenomicDataIntervalFiltersByUniqueKey",value:function(e){return this._genomicDataIntervalFilterSet.has(e)?this._genomicDataIntervalFilterSet.get(e).values:[]}},{key:"getGenericAssayDataFiltersByUniqueKey",value:function(e){return this._genericAssayDataFilterSet.has(e)?this._genericAssayDataFilterSet.get(e).values:[]}},{key:"hideChart",value:function(e){this.changeChartVisibility(e,!1)}},{key:"getClinicalDataCount",value:function(e){var t=this,r=(0,f.PG)(e.clinicalAttribute);if(!this.clinicalDataCountPromises.hasOwnProperty(r)){var n=void 0!==o().find(this.defaultVisibleAttributes.result,(function(e){return(0,f.PG)(e)===r}));this.clinicalDataCountPromises[r]=(0,_.$w)({await:function(){return we((0,f.ih)(n,t.isInitialFilterState,t.chartsAreFiltered,t._clinicalDataFilterSet.has(r),t.unfilteredClinicalDataCount,t.newlyAddedUnfilteredClinicalDataCount,t.initialVisibleAttributesClinicalDataCountData))},invoke:function(){return Oe(t,void 0,void 0,regeneratorRuntime.mark((function t(){var i,a,s,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=[],!this.isInitialFilterState||!n||this._clinicalDataFilterSet.has(r)){t.next=5;break}i=this.initialVisibleAttributesClinicalDataCountData.result,t.next=12;break;case 5:if(!this._clinicalDataFilterSet.has(r)&&!this.isInitialFilterState){t.next=11;break}return t.next=8,u.Z.fetchClinicalDataCountsUsingPOST({clinicalDataCountFilter:{attributes:[{attributeId:e.clinicalAttribute.clinicalAttributeId}],studyViewFilter:this.filters}});case 8:i=t.sent,t.next=12;break;case 11:i=n||this.chartsAreFiltered?this.unfilteredClinicalDataCount.result:[this.unfilteredClinicalDataCountCache[r]];case 12:return a=o().find(i,{attributeId:e.clinicalAttribute.clinicalAttributeId}),s=[],l="",void 0!==a&&(s=a.counts,l=a.attributeId,this.chartToUsedColors.has(l)||this.chartToUsedColors.set(l,new Set)),t.abrupt("return",this.addColorToCategories(s,l));case 17:case"end":return t.stop()}}),t,this)})))},onError:function(){},default:[]})}return this.clinicalDataCountPromises[r]}},{key:"addColorToCategories",value:function(e,t){var r=this;return(0,f.VD)(e).map((function(e){var n,i,o,a=r.generateColorMapKey(t,e.value);if(r.chartItemToColor.has(a))return Object.assign(Object.assign({},e),{color:r.chartItemToColor.get(a)});if(null===(n=r.chartToUsedColors.get(t))||void 0===n?void 0:n.has(e.color)){var s={value:e.value,count:e.count},l=(0,f.n8)(s,r.chartToUsedColors.get(t)||new Set);r.chartItemToColor.set(a,l),null===(o=r.chartToUsedColors.get(t))||void 0===o||o.add(l),e.color=l}else r.chartItemToColor.set(a,e.color),null===(i=r.chartToUsedColors.get(t))||void 0===i||i.add(e.color);return e}))}},{key:"getCustomDataCount",value:function(e){var t=this,r=e.uniqueKey;return r===f.h_.CANCER_STUDIES?this.cancerStudiesData:(this.customDataCountPromises.hasOwnProperty(r)||(this.customDataCountPromises[r]=(0,_.$w)({await:function(){return t._customDataFilterSet.has(r)?[t.selectedSamples]:[t.selectedSamples,t.unfilteredCustomDataCount]},invoke:function(){return Oe(t,void 0,void 0,regeneratorRuntime.mark((function t(){var n,i,a,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=[],!this.isInitialFilterState||this._customDataFilterSet.has(r)){t.next=5;break}n=this.unfilteredCustomDataCount.result,t.next=14;break;case 5:if(!this._customDataFilterSet.has(r)&&!this.isInitialFilterState){t.next=13;break}if(this.hasFilteredSamples){t.next=8;break}return t.abrupt("return",[]);case 8:return t.next=10,u.Z.fetchCustomDataCountsUsingPOST({clinicalDataCountFilter:{attributes:[{attributeId:e.uniqueKey}],studyViewFilter:this.filters}});case 10:n=t.sent,t.next=14;break;case 13:n=this.unfilteredCustomDataCount.result;case 14:return i=o().find(n,{attributeId:e.uniqueKey}),a=[],s="",void 0!==i&&(a=i.counts,s=i.attributeId,this.chartToUsedColors.has(s)||this.chartToUsedColors.set(s,new Set)),t.abrupt("return",this.addColorToCategories(a,s));case 19:case"end":return t.stop()}}),t,this)})))},onError:function(){},default:[]})),this.customDataCountPromises[r])}},{key:"getGenericAssayChartDataCount",value:function(e){var t=this;return this.genericAssayDataCountPromises.hasOwnProperty(e.uniqueKey)||(this.genericAssayDataCountPromises[e.uniqueKey]=(0,_.$w)({await:function(){return[]},invoke:function(){return Oe(t,void 0,void 0,regeneratorRuntime.mark((function t(){var r,n,i,o,a,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=[],!(n=this._genericAssayChartMap.get(e.uniqueKey))){t.next=12;break}return i=[],t.next=6,u.Z.fetchGenericAssayDataCountsUsingPOST({genericAssayDataCountFilter:{genericAssayDataFilters:[{stableId:n.genericAssayEntityId,profileType:n.profileType}],studyViewFilter:this.filters}});case 6:return i=t.sent,o=i.find((function(e){return e.stableId===n.genericAssayEntityId})),a=[],s="",void 0!==o&&(a=o.counts.map((function(e){return{count:e.count,value:e.value}})),s=o.stableId,this.chartToUsedColors.has(s)||this.chartToUsedColors.set(s,new Set)),t.abrupt("return",this.addColorToCategories(a,s));case 12:return t.abrupt("return",r);case 13:case"end":return t.stop()}}),t,this)})))},default:[]})),this.genericAssayDataCountPromises[e.uniqueKey]}},{key:"generateColorMapKey",value:function(e,t){return"".concat(e,".").concat(t)}},{key:"getClinicalDataBin",value:function(e){var t=this,r=(0,f.PG)(e.clinicalAttribute);if(!this.clinicalDataBinPromises.hasOwnProperty(r)){var n=void 0!==o().find(this.defaultVisibleAttributes.result,(function(e){return(0,f.PG)(e)===r}));this.clinicalDataBinPromises[r]=(0,_.$w)({await:function(){return(0,f.ih)(n,t.isInitialFilterState,t.chartsAreFiltered,t._clinicalDataFilterSet.has(r),t.unfilteredClinicalDataBinCount,t.newlyAddedUnfilteredClinicalDataBinCount,t.initialVisibleAttributesClinicalDataBinCountData)},invoke:function(){return Oe(t,void 0,void 0,regeneratorRuntime.mark((function t(){var i,a,s,c,p,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=Ne,a=[],s=o().find(this.initialVisibleAttributesClinicalDataBinAttributes.result,(function(t){return t.attributeId===(0,f.PG)(e.clinicalAttribute)})),c=o().clone(this._clinicalDataBinFilterSet.get((0,f.PG)(e.clinicalAttribute))),this._customBinsFromScatterPlotSelectionSet.has(e.uniqueKey)&&(p=this._customBinsFromScatterPlotSelectionSet.get(e.uniqueKey)||[],c.customBins=o().sortBy([].concat(we(c.customBins||[]),we(p)))),d=n&&!o().isEqual(o().omit((0,l.toJS)(c),["showNA"]),o().omit(s,["showNA"])),!this.isInitialFilterState||!n||this._clinicalDataFilterSet.has(r)||d){t.next=10;break}a=this.initialVisibleAttributesClinicalDataBinCountData.result,t.next=20;break;case 10:if(!this._clinicalDataFilterSet.has(r)&&!this.isInitialFilterState){t.next=19;break}if(this.hasSampleIdentifiersInFilter){t.next=13;break}return t.abrupt("return",[]);case 13:return t.next=15,u.Z.fetchClinicalDataBinCountsUsingPOST({dataBinMethod:i,clinicalDataBinCountFilter:{attributes:[c],studyViewFilter:this.filters}});case 15:a=t.sent,a=(0,f.Ls)(a),t.next=20;break;case 19:a=n||this.chartsAreFiltered?this.unfilteredClinicalDataBinCount.result:this.unfilteredClinicalDataBinCountCache[r];case 20:return t.abrupt("return",o().filter(a,(function(t){return t.id===e.clinicalAttribute.clinicalAttributeId}))||[]);case 21:case"end":return t.stop()}}),t,this)})))},onError:function(){},default:[]})}return this.clinicalDataBinPromises[r]}},{key:"getGenomicChartDataBin",value:function(e){var t=this;return this.genomicChartPromises.hasOwnProperty(e.uniqueKey)||(this.genomicChartPromises[e.uniqueKey]=(0,_.$w)({await:function(){return[t.selectedSamples]},invoke:function(){return Oe(t,void 0,void 0,regeneratorRuntime.mark((function t(){var r,n,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this._geneSpecificChartMap.get(e.uniqueKey),n=this._genomicDataBinFilterSet.get(e.uniqueKey),!r||!this.hasFilteredSamples){t.next=7;break}return t.next=5,u.Z.fetchGenomicDataBinCountsUsingPOST({dataBinMethod:Ne,genomicDataBinCountFilter:{genomicDataBinFilters:[{hugoGeneSymbol:r.hugoGeneSymbol,profileType:r.profileType,customBins:n.customBins,disableLogScale:n.disableLogScale}],studyViewFilter:this.filters}});case 5:return i=t.sent,t.abrupt("return",(0,f._C)(i));case 7:return t.abrupt("return",[]);case 8:case"end":return t.stop()}}),t,this)})))},default:[]})),this.genomicChartPromises[e.uniqueKey]}},{key:"getGenericAssayChartDataBin",value:function(e){var t=this;return this.genericAssayChartPromises.hasOwnProperty(e.uniqueKey)||(this.genericAssayChartPromises[e.uniqueKey]=(0,_.$w)({await:function(){return[]},invoke:function(){return Oe(t,void 0,void 0,regeneratorRuntime.mark((function t(){var r,n,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this._genericAssayChartMap.get(e.uniqueKey),n=this._genericAssayDataBinFilterSet.get(e.uniqueKey),!r){t.next=7;break}return t.next=5,u.Z.fetchGenericAssayDataBinCountsUsingPOST({dataBinMethod:Ne,genericAssayDataBinCountFilter:{genericAssayDataBinFilters:[{stableId:r.genericAssayEntityId,profileType:r.profileType,customBins:n.customBins,disableLogScale:n.disableLogScale}],studyViewFilter:this.filters}});case 5:return i=t.sent,t.abrupt("return",(0,f.Bk)(i));case 7:return t.abrupt("return",[]);case 8:case"end":return t.stop()}}),t,this)})))},default:[]})),this.genericAssayChartPromises[e.uniqueKey]}},{key:"getDefaultClinicalDataBinFilter",value:function(e){return{attributeId:e.clinicalAttributeId,disableLogScale:!1,showNA:!0}}},{key:"isChartNameValid",value:function(e){return void 0===o().find(this.chartMetaSet,(function(t){return t.displayName.toUpperCase()===e.toUpperCase()}))}},{key:"getDefaultCustomChartName",value:function(){return"".concat("Custom Data"," ").concat(this._customCharts.size-f.qD.length+1)}},{key:"addCustomChart",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Oe(this,void 0,void 0,regeneratorRuntime.mark((function r(){var n,i,a,s,u,c,p;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.displayName?e.displayName:this.getDefaultCustomChartName(),i=e.data,r.next=4,g.Z.saveCustomData({origin:(0,l.toJS)(this.studyIds),displayName:n,description:n,datatype:"STRING",patientAttribute:!1,priority:0,data:i});case 4:a=r.sent,s=a.id,u={clinicalAttributeId:s,datatype:"STRING",description:n,displayName:n,patientAttribute:!1,priority:0},c={uniqueKey:s,displayName:n,description:n,dataType:f.E4.CUSTOM_DATA,patientAttribute:!1,renderWhenDataChange:!1,priority:0,clinicalAttribute:u},this.customChartSet.set(s,Object.assign(Object.assign({},c),{data:i})),this._newlyCreatedCustomChartSet.set(s,Object.assign(Object.assign({},c),{data:i})),e.patientAttribute&&(c.patientAttribute=!0),this._customCharts.set(s,c),this._customChartsSelectedCases.set(s,i),this.chartsType.set(s,A.oV.PIE_CHART),this.chartsDimension.set(s,{w:1,h:1}),this.changeChartVisibility(s,!0),t||(p=o().chain(i).map((function(e){return e.value})).uniq().value(),this.setCustomChartFilters(c.uniqueKey,p),this.newlyAddedCharts.clear(),this.newlyAddedCharts.push(s));case 17:case"end":return r.stop()}}),r,this)})))}},{key:"addXvsYScatterChart",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t||this.newlyAddedCharts.clear();var n=this.clinicalAttributes.result.find((function(t){return t.clinicalAttributeId===e.xAttrId})),i=this.clinicalAttributes.result.find((function(t){return t.clinicalAttributeId===e.yAttrId})),o={xAttr:n,yAttr:i,plotDomain:{}};n.clinicalAttributeId===f.h_.MUTATION_COUNT?o.plotDomain.x=f.hI:n.clinicalAttributeId===f.h_.FRACTION_GENOME_ALTERED&&(o.plotDomain.x=f.rP),i.clinicalAttributeId===f.h_.MUTATION_COUNT?o.plotDomain.y=f.hI:i.clinicalAttributeId===f.h_.FRACTION_GENOME_ALTERED&&(o.plotDomain.y=f.rP);var a=(0,f.s9)(o.xAttr.clinicalAttributeId,o.yAttr.clinicalAttributeId);if(this._XvsYScatterChartMap.has(a))this.changeChartVisibility(a,!0);else{var s={uniqueKey:a,displayName:(0,f.OT)(o.xAttr,o.yAttr),description:"",dataType:f.E4.X_VS_Y_SCATTER,patientAttribute:!1,renderWhenDataChange:!1,priority:0};a===f.g1&&(s.priority=(0,f.eY)(f.g1)),this._XvsYCharts.set(a,s),this._XvsYScatterChartMap.set(a,o),this._XvsYChartSettings.set(a,{xLogScale:!1,yLogScale:!1}),this.changeChartVisibility(a,!0),this.chartsType.set(a,A.oV.SCATTER),this.chartsDimension.set(a,A.$u.layout.dimensions[A.oV.SCATTER])}t||r||this.newlyAddedCharts.push(a)}},{key:"addXvsYViolinChart",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t||this.newlyAddedCharts.clear();var n=this.clinicalAttributes.result.find((function(t){return t.clinicalAttributeId===e.categoricalAttrId})),i=this.clinicalAttributes.result.find((function(t){return t.clinicalAttributeId===e.numericalAttrId})),o={categoricalAttr:n,numericalAttr:i,violinDomain:{}};switch(i.clinicalAttributeId){case f.h_.MUTATION_COUNT:o.violinDomain=f.hI;break;case f.h_.FRACTION_GENOME_ALTERED:o.violinDomain=f.rP}var a=(0,f.s9)(o.categoricalAttr.clinicalAttributeId,o.numericalAttr.clinicalAttributeId);if(this._XvsYViolinChartMap.has(a))this.changeChartVisibility(a,!0);else{var s={uniqueKey:a,displayName:"",description:"",dataType:f.E4.X_VS_Y_VIOLIN,patientAttribute:!1,renderWhenDataChange:!1,priority:0};this._XvsYCharts.set(a,s),this._XvsYViolinChartMap.set(a,o),this._XvsYChartSettings.set(a,{violinLogScale:!1,showBox:!0,showViolin:!0}),this.changeChartVisibility(a,!0),this.chartsType.set(a,A.oV.VIOLIN_PLOT_TABLE),this.chartsDimension.set(a,A.$u.layout.dimensions[A.oV.VIOLIN_PLOT_TABLE])}t||r||this.newlyAddedCharts.push(a)}},{key:"addGeneSpecificCharts",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];r||this.newlyAddedCharts.clear(),e.forEach((function(e){var n=(0,f.Xq)(e.hugoGeneSymbol,e.profileType);if(t._geneSpecificChartMap.has(n))t.changeChartVisibility(n,!0);else{var i=e.name?e.name:t.getDefaultCustomChartName(),o={uniqueKey:n,displayName:i,description:e.description||i,dataType:f.E4.GENE_SPECIFIC,patientAttribute:!1,renderWhenDataChange:!1,priority:0};t._geneSpecificCharts.set(n,o),t._geneSpecificChartMap.set(n,e),t.changeChartVisibility(n,!0),t.chartsType.set(n,A.oV.BAR_CHART),t.chartsDimension.set(n,{w:2,h:1}),t._genomicDataBinFilterSet.set(n,{clinicalDataType:"SAMPLE",disableLogScale:!1,hugoGeneSymbol:e.hugoGeneSymbol,profileType:e.profileType})}r||t.newlyAddedCharts.push(n)}))}},{key:"addGenericAssayContinuousCharts",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];r||this.newlyAddedCharts.clear(),e.forEach((function(e){var n=(0,f.XP)(e.genericAssayEntityId,e.profileType);if(t._genericAssayChartMap.has(n))t.changeChartVisibility(n,!0);else{var i=e.name?e.name:t.getDefaultCustomChartName(),o={uniqueKey:n,displayName:i,description:e.description||i,dataType:f.E4.GENERIC_ASSAY,patientAttribute:e.patientLevel||!1,renderWhenDataChange:!1,priority:0,genericAssayType:e.genericAssayType};t._genericAssayCharts.set(n,o),t._genericAssayChartMap.set(n,e),t.changeChartVisibility(n,!0),t.chartsType.set(n,A.oV.BAR_CHART),t.chartsDimension.set(n,{w:2,h:1}),t._genericAssayDataBinFilterSet.set(n,{clinicalDataType:"SAMPLE",disableLogScale:!1,stableId:e.genericAssayEntityId,profileType:e.profileType})}r||t.newlyAddedCharts.push(n)}))}},{key:"addGenericAssayBinaryOrCategoricalCharts",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];r||this.newlyAddedCharts.clear(),e.forEach((function(e){var n=(0,f.XP)(e.genericAssayEntityId,e.profileType);if(t._genericAssayChartMap.has(n))t.changeChartVisibility(n,!0);else{var i=e.name?e.name:t.getDefaultCustomChartName(),o={uniqueKey:n,displayName:i,description:e.description||i,dataType:f.E4.GENERIC_ASSAY,patientAttribute:e.patientLevel||!1,renderWhenDataChange:!1,priority:0,genericAssayType:e.genericAssayType};t._genericAssayCharts.set(n,o),t._genericAssayChartMap.set(n,e),t.changeChartVisibility(n,!0),t.chartsType.set(n,A.oV.PIE_CHART),t.chartsDimension.set(n,A.$u.layout.dimensions[A.oV.PIE_CHART])}r||t.newlyAddedCharts.push(n)}))}},{key:"updateCustomSelect",value:function(e){this.clearAllFilters();var t=e.data.map((function(e){return{studyId:e.studyId,sampleId:e.sampleId}}));this.numberOfSelectedSamplesInCustomSelection=t.length,this.updateChartSampleIdentifierFilter(f.h_.CUSTOM_SELECT,t,!1)}},{key:"updateUserSettings",value:function(){g.Z.updateUserSettings({origin:(0,l.toJS)(this.studyIds),chartSettings:o().values(this.currentChartSettingsMap),groupColors:(0,l.toJS)(this.userGroupColors)})}},{key:"clearPageChartSettings",value:function(){var e=this;o().forEach(o().fromPairs(this._chartVisibility.toJSON()),(function(t,r){t&&!e.isChartFiltered(r)&&e._chartVisibility.delete(r)})),this.currentGridLayout=[],this.currentFocusedChartByUser=void 0,this.currentFocusedChartByUserDimension=void 0,this._filterMutatedGenesTableByCancerGenes=!0,this._filterSVGenesTableByCancerGenes=!0,this._filterCNAGenesTableByCancerGenes=!0,this._clinicalDataBinFilterSet=l.observable.map((0,l.toJS)(this._defaultClinicalDataBinFilterSet))}},{key:"loadUserChartSettings",value:function(){this.isSavingUserPreferencePossible&&this.userSettings.isComplete&&this.userSettings.result&&!o().isEmpty(this.userSettings.result.chartSettings)&&(this.loadChartSettings(this.userSettings.result.chartSettings),this._loadUserSettingsInitially&&(this.previousSettings=o().keyBy(this.userSettings.result.chartSettings,(function(e){return e.id}))))}},{key:"updateCustomDataList",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e.forEach((function(e){var i=e.uniqueKey;if(!t.customChartSet.has(i)){var o=e.data,a=(e.isSharedChart,ke(e,["data","isSharedChart"]));t._customCharts.set(i,a),t._customChartsSelectedCases.set(i,o),t.chartsType.set(i,A.oV.PIE_CHART),t.chartsDimension.set(i,{w:1,h:1}),t.customChartSet.set(i,e),n&&t.changeChartVisibility(i,!0)}r&&t.customChartSet.set(i,e)}))}},{key:"undoUserChartSettings",value:function(){this.loadChartSettings(o().values(this.previousSettings)),this.previousSettings={}}},{key:"resetToDefaultChartSettings",value:function(){this.clearPageChartSettings(),this.loadChartSettings(o().values(this.defaultChartSettingsMap))}},{key:"loadChartSettings",value:function(e){var t=this;this.clearPageChartSettings();var r=Object.values(A.oV).map((function(e){return e.toString()}));o().map(e,(function(e){if(e.name&&e.groups){var n=e.groups,i=o().flatMap(n,(function(e){return e.sampleIdentifiers.map((function(t){return Object.assign(Object.assign({},t),{value:e.name})}))})),a={origin:t.studyIds,displayName:e.name,description:e.name,datatype:"STRING",patientAttribute:e.patientAttribute,priority:0,data:i};t.addCustomChart(a,!0)}switch(e.hugoGeneSymbol&&e.profileType&&t.addGeneSpecificCharts([{name:e.name,description:e.description,profileType:e.profileType,hugoGeneSymbol:e.hugoGeneSymbol}],!0),e.genericAssayEntityId&&e.profileType&&t.addGenericAssayContinuousCharts([{name:e.name,description:e.description,profileType:e.profileType,genericAssayType:e.genericAssayType,genericAssayEntityId:e.genericAssayEntityId,dataType:e.dataType,patientLevel:e.patientLevelProfile}],!0),e.chartType===A.oV.SCATTER&&t.addXvsYScatterChart({xAttrId:e.xAttrId,yAttrId:e.yAttrId},!0),e.chartType===A.oV.VIOLIN_PLOT_TABLE&&t.addXvsYViolinChart({categoricalAttrId:e.categoricalAttrId,numericalAttrId:e.numericalAttrId},!0),e.layout&&(t.currentGridLayout.push(Object.assign({i:e.id,isResizable:!0,moved:!1,static:!1},e.layout)),t.chartsDimension.set(e.id,{w:e.layout.w,h:e.layout.h})),e.chartType){case A.oV.MUTATED_GENES_TABLE:t._filterMutatedGenesTableByCancerGenes=void 0===e.filterByCancerGenes||e.filterByCancerGenes;break;case A.oV.STRUCTURAL_VARIANT_GENES_TABLE:t._filterSVGenesTableByCancerGenes=void 0===e.filterByCancerGenes||e.filterByCancerGenes;break;case A.oV.CNA_GENES_TABLE:t._filterCNAGenesTableByCancerGenes=void 0===e.filterByCancerGenes||e.filterByCancerGenes;break;case A.oV.BAR_CHART:var s=t._clinicalDataBinFilterSet.get(e.id);s&&(e.customBins&&(s.customBins=e.customBins),e.disableLogScale&&(s.disableLogScale=e.disableLogScale),s.showNA=e.showNA)}var l=e.chartType;l&&("FUSION_GENES_TABLE"===l.toString()&&(l=A.oV.STRUCTURAL_VARIANT_GENES_TABLE),r.includes(l)&&(t.changeChartVisibility(e.id,!0),t.chartsType.set(e.id,l)))})),this.useCurrentGridLayout=!0}},{key:"updateChartStats",value:function(){if(this.initializeChartStatsByClinicalAttributes(),!o().isEmpty(this.molecularProfiles.result)){var e=o().find(this.chartMetaSet,(function(e){return e.uniqueKey===f.h_.GENOMIC_PROFILES_SAMPLE_COUNT}));this.chartsType.set(f.h_.GENOMIC_PROFILES_SAMPLE_COUNT,A.oV.GENOMIC_PROFILES_TABLE),this.chartsDimension.set(f.h_.GENOMIC_PROFILES_SAMPLE_COUNT,A.$u.layout.dimensions[A.oV.GENOMIC_PROFILES_TABLE]),e&&0!==e.priority&&this.changeChartVisibility(e.uniqueKey,!0)}if(this.shouldDisplayPatientTreatments.result&&(this.changeChartVisibility(f.h_.SAMPLE_TREATMENTS,!0),this.changeChartVisibility(f.h_.PATIENT_TREATMENTS,!0),this.chartsType.set(f.h_.PATIENT_TREATMENTS,A.oV.PATIENT_TREATMENTS_TABLE),this.chartsType.set(f.h_.SAMPLE_TREATMENTS,A.oV.SAMPLE_TREATMENTS_TABLE)),this.shouldDisplaySampleTreatmentGroups.result&&(this.changeChartVisibility(f.h_.SAMPLE_TREATMENT_GROUPS,!0),this.changeChartVisibility(f.h_.PATIENT_TREATMENT_GROUPS,!0),this.chartsType.set(f.h_.PATIENT_TREATMENT_GROUPS,A.oV.PATIENT_TREATMENT_GROUPS_TABLE),this.chartsType.set(f.h_.SAMPLE_TREATMENT_GROUPS,A.oV.SAMPLE_TREATMENT_GROUPS_TABLE)),this.shouldDisplaySampleTreatmentTarget.result&&(this.changeChartVisibility(f.h_.SAMPLE_TREATMENT_TARGET,!0),this.changeChartVisibility(f.h_.PATIENT_TREATMENT_TARGET,!0),this.chartsType.set(f.h_.PATIENT_TREATMENT_TARGET,A.oV.PATIENT_TREATMENT_TARGET_TABLE),this.chartsType.set(f.h_.SAMPLE_TREATMENT_TARGET,A.oV.SAMPLE_TREATMENT_TARGET_TABLE)),!o().isEmpty(this.mutationProfiles.result)){var t=(0,f.wl)(this.mutationProfiles.result.map((function(e){return e.molecularProfileId}))),r=o().find(this.chartMetaSet,(function(e){return e.uniqueKey===t}));this.chartsType.set(t,A.oV.MUTATED_GENES_TABLE),this.chartsDimension.set(t,A.$u.layout.dimensions[A.oV.MUTATED_GENES_TABLE]),r&&0!==r.priority&&this.changeChartVisibility(r.uniqueKey,!0)}if(!o().isEmpty(this.structuralVariantProfiles.result)){var n=(0,f.wl)(this.structuralVariantProfiles.result.map((function(e){return e.molecularProfileId}))),i=o().find(this.chartMetaSet,(function(e){return e.uniqueKey===n}));i&&0!==i.priority&&this.changeChartVisibility(i.uniqueKey,!0),this.chartsType.set(n,A.oV.STRUCTURAL_VARIANT_GENES_TABLE),this.chartsDimension.set(n,A.$u.layout.dimensions[A.oV.STRUCTURAL_VARIANT_GENES_TABLE])}if(!o().isEmpty(this.cnaProfiles.result)){var a=(0,f.wl)(this.cnaProfiles.result.map((function(e){return e.molecularProfileId}))),s=o().find(this.chartMetaSet,(function(e){return e.uniqueKey===a}));this.chartsType.set(a,A.oV.CNA_GENES_TABLE),this.chartsDimension.set(a,A.$u.layout.dimensions[A.oV.CNA_GENES_TABLE]),s&&0!==s.priority&&this.changeChartVisibility(s.uniqueKey,!0)}o().isEmpty(this.initialFilters.caseLists)||this.changeChartVisibility(f.h_.CASE_LISTS_SAMPLE_COUNT,!0),this.initializeClinicalDataCountCharts(),this.initializeClinicalDataBinCountCharts(),this.initializeGeneSpecificCharts(),this.initializeGenericAssayCharts(),this._defaultChartsDimension=l.observable.map(o().fromPairs(this.chartsDimension.toJSON())),this._defaultChartsType=l.observable.map(o().fromPairs(this.chartsType.toJSON())),this._defaultVisibleChartIds=this.visibleAttributes.map((function(e){return e.uniqueKey})),this._defaultClinicalDataBinFilterSet=l.observable.map(o().fromPairs(this._clinicalDataBinFilterSet.toJSON()))}},{key:"initializeChartStatsByClinicalAttributes",value:function(){var e=this,t=null,r=null;this.clinicalAttributes.result.forEach((function(n){var i=(0,f.PG)(n);"0"!==n.priority&&(f.h_.MUTATION_COUNT===n.clinicalAttributeId?t=n:f.h_.FRACTION_GENOME_ALTERED===n.clinicalAttributeId&&(r=n)),n.datatype===f.g.NUMBER?(e.chartsType.set(i,A.oV.BAR_CHART),e.chartsDimension.set(i,A.$u.layout.dimensions[A.oV.BAR_CHART])):(e.chartsType.set(i,A.oV.PIE_CHART),e.chartsDimension.set(i,A.$u.layout.dimensions[A.oV.PIE_CHART]))})),this.survivalPlotKeys.forEach((function(t){e.chartsType.set(t,A.oV.SURVIVAL),e.chartsDimension.set(t,A.$u.layout.dimensions[A.oV.SURVIVAL]),t in e.chartMetaSet&&0!==e.chartMetaSet[t].priority&&e.changeChartVisibility(t,!0)})),t&&r&&0!==(0,f.eY)(f.g1)&&this.addXvsYScatterChart({xAttrId:f.h_.FRACTION_GENOME_ALTERED,yAttrId:f.h_.MUTATION_COUNT},!1,!0),this.chartsDimension.set(f.h_.SAMPLE_TREATMENTS,A.$u.layout.dimensions[A.oV.SAMPLE_TREATMENTS_TABLE]),this.chartsDimension.set(f.h_.PATIENT_TREATMENTS,A.$u.layout.dimensions[A.oV.PATIENT_TREATMENTS_TABLE]),this.chartsDimension.set(f.h_.SAMPLE_TREATMENT_GROUPS,A.$u.layout.dimensions[A.oV.SAMPLE_TREATMENT_GROUPS_TABLE]),this.chartsDimension.set(f.h_.PATIENT_TREATMENT_GROUPS,A.$u.layout.dimensions[A.oV.PATIENT_TREATMENT_GROUPS_TABLE]),this.chartsDimension.set(f.h_.SAMPLE_TREATMENT_TARGET,A.$u.layout.dimensions[A.oV.SAMPLE_TREATMENT_TARGET_TABLE]),this.chartsDimension.set(f.h_.PATIENT_TREATMENT_TARGET,A.$u.layout.dimensions[A.oV.PATIENT_TREATMENT_TARGET_TABLE]),this.queriedPhysicalStudyIds.result.length>1&&this.showAsPieChart(f.h_.CANCER_STUDIES,this.queriedPhysicalStudyIds.result.length)}},{key:"getTableDimensionByNumberOfRecords",value:function(e){return e<=A.$u.thresholds.rowsInTableForOneGrid?{w:2,h:1,minW:2}:{w:2,h:2,minW:2}}},{key:"changeChartType",value:function(e,t){var r;t===A.oV.TABLE?(void 0!==(r=e.uniqueKey===f.h_.CANCER_STUDIES?this.cancerStudiesData:this.isUserDefinedCustomDataChart(e.uniqueKey)?this.getCustomDataCount(e):this.isGenericAssayChart(e.uniqueKey)?this.getGenericAssayChartDataCount(e):this.getClinicalDataCount(e))&&this.chartsDimension.set(e.uniqueKey,this.getTableDimensionByNumberOfRecords(r.result.length)),this.chartsType.set(e.uniqueKey,A.oV.TABLE)):(this.chartsDimension.set(e.uniqueKey,A.$u.layout.dimensions[t]),this.chartsType.set(e.uniqueKey,t)),this.currentFocusedChartByUser=o().clone(e),this.currentFocusedChartByUserDimension=this.chartsDimension.get(e.uniqueKey),this.useCurrentGridLayout=!0}},{key:"initializeClinicalDataCountCharts",value:function(){var e=this;o().each(this.initialVisibleAttributesClinicalDataCountData.result,(function(t){e.showAsPieChart(t.attributeId,t.counts.length)}))}},{key:"initializeGeneSpecificCharts",value:function(){var e=this;if(!o().isEmpty(this.initialFilters.genomicDataFilters)){var t=o().keyBy(this.molecularProfileSampleCounts.result,(function(e){return e.uniqueKey}));o().each(this.initialFilters.genomicDataFilters,(function(r){if(void 0!==t[r.profileType]){var n=t[r.profileType];e.addGeneSpecificCharts([{name:"".concat(r.hugoGeneSymbol,": ").concat(n.label),description:n.label,profileType:r.profileType,hugoGeneSymbol:r.hugoGeneSymbol}],!0)}}))}}},{key:"initializeGenericAssayCharts",value:function(){var e=this;o().isEmpty(this.initialFilters.genericAssayDataFilters)||o().map(this.genericAssayProfileOptionsByType.result,(function(t,r){var n=o().keyBy(t,(function(e){return e.value}));o().each(e.initialFilters.genericAssayDataFilters,(function(t){if(void 0!==n[t.profileType]){var i=n[t.profileType];i.dataType===L.QH.LIMITVALUE?e.addGenericAssayContinuousCharts([{name:"".concat(t.stableId,": ").concat(i.label),description:i.description,profileType:t.profileType,genericAssayType:r,genericAssayEntityId:t.stableId,dataType:i.dataType,patientLevel:i.patientLevel}],!0):i.dataType===(L.QH.BINARY||L.QH.CATEGORICAL)&&e.addGenericAssayBinaryOrCategoricalCharts([{name:"".concat(t.stableId,": ").concat(i.label),description:i.description,profileType:t.profileType,genericAssayType:r,genericAssayEntityId:t.stableId,dataType:i.dataType}],!0)}}))}))}},{key:"initializeClinicalDataBinCountCharts",value:function(){var e=this;o().each(o().groupBy(this.initialVisibleAttributesClinicalDataBinCountData.result,(function(e){return e.id})),(function(t,r){(0,f.Gm)(e.initialFilters,t.length,e.samples.result.length)&&e.changeChartVisibility(r,!0),e.chartsType.set(r,A.oV.BAR_CHART),e.chartsDimension.set(r,A.$u.layout.dimensions[A.oV.BAR_CHART])}))}},{key:"getPieChartDataDownload",value:function(e,t){return Oe(this,void 0,void 0,regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=this.isUserDefinedCustomDataChart(e.uniqueKey),!t||"summary"!==t){r.next=13;break}if(!n){r.next=6;break}return r.abrupt("return",this.getClinicalDataCountSummary(e,this.getCustomDataCount(e).result));case 6:if(!this.isGenericAssayChart(e.uniqueKey)){r.next=10;break}return r.abrupt("return",this.getClinicalDataCountSummary(e,this.getGenericAssayChartDataCount(e).result));case 10:return r.abrupt("return",this.getClinicalDataCountSummary(e,this.getClinicalDataCount(e).result));case 11:r.next=18;break;case 13:if(!n){r.next=17;break}return r.abrupt("return",this.getCustomChartDownloadData(e));case 17:return r.abrupt("return",this.getChartDownloadableData(e));case 18:case"end":return r.stop()}}),r,this)})))}},{key:"getClinicalDataCountSummary",value:function(e,t){var r=e.patientAttribute?"patients":"samples",n=[["Category","Number of ".concat(r),"Percentage of ".concat(r)].join("\t")];return(n=n.concat(t.map((function(e){return[e.value,e.count,e.freq].join("\t")})))).join("\n")}},{key:"getChartDownloadableData",value:function(e){return Oe(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,n,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=[],!this.isGeneSpecificChart(e.uniqueKey)){t.next=7;break}return t.next=4,(0,f.bq)(this._geneSpecificChartMap.get(e.uniqueKey),this.molecularProfileMapByType,this.selectedSamples.result);case 4:r=t.sent,t.next=17;break;case 7:if(!this.isGenericAssayChart(e.uniqueKey)){t.next=13;break}return t.next=10,(0,f.v5)(this._genericAssayChartMap.get(e.uniqueKey),this.molecularProfileMapByType,this.selectedSamples.result);case 10:r=t.sent,t.next=17;break;case 13:if(!e.clinicalAttribute||!this.samples.result){t.next=17;break}return t.next=16,c.Z.fetchClinicalDataUsingPOST({clinicalDataType:e.clinicalAttribute.patientAttribute?f.EU.PATIENT:f.EU.SAMPLE,clinicalDataMultiStudyFilter:{attributeIds:[e.clinicalAttribute.clinicalAttributeId],identifiers:this.selectedSamples.result.map((function(t){return{entityId:e.clinicalAttribute.patientAttribute?t.patientId:t.sampleId,studyId:t.studyId}}))}});case 16:r=t.sent;case 17:return n=["Study ID","Patient ID"],e.patientAttribute||n.push("Sample ID"),n.push(e.displayName),i=(i=[n.join("\t")]).concat(r.map((function(t){var r=[t.studyId||re.y.NA,t.patientId||re.y.NA];return e.patientAttribute||r.push(t.sampleId||re.y.NA),r.push(t.value||re.y.NA),r.join("\t")}))),t.abrupt("return",i.join("\n"));case 23:case"end":return t.stop()}}),t,this)})))}},{key:"getCustomChartDownloadData",value:function(e){var t=this;return new Promise((function(r){if(e&&e.uniqueKey){var n=e.patientAttribute,i=["Study ID","Patient ID"];n||i.push("Sample ID"),i.push(e.displayName);var a=[i.join("\t")];e.uniqueKey===f.h_.CANCER_STUDIES?a=a.concat(t.selectedSamples.result.map((function(e){return[e.studyId||re.y.NA,e.patientId||re.y.NA,e.sampleId||re.y.NA,e.studyId].join("\t")}))):t._customChartsSelectedCases.has(e.uniqueKey)&&(a=n?a.concat(t.selectedPatients.map((function(r){var n=o().find(t._customChartsSelectedCases.get(e.uniqueKey),(function(e){return e.studyId===r.studyId&&r.patientId===e.patientId}));return[r.studyId||re.y.NA,r.patientId||re.y.NA,void 0===n?"NA":n.value].join("\t")}))):a.concat(t.selectedSamples.result.map((function(r){var n=o().find(t._customChartsSelectedCases.get(e.uniqueKey),(function(e){return e.studyId===r.studyId&&r.sampleId===e.sampleId}));return[r.studyId||re.y.NA,r.patientId||re.y.NA,r.sampleId||re.y.NA,void 0===n?"NA":n.value].join("\t")})))),r(a.join("\n"))}else r("")}))}},{key:"getScatterDownloadData",value:function(e){return Oe(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,n,i,o,a,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.getXvsYScatterChartInfo(e),t.next=3,(0,_.Vi)(this.selectedSamples);case 3:return n=t.sent,t.next=6,Promise.all([(0,f.sS)(n,r.xAttr),(0,f.sS)(n,r.yAttr)]);case 6:return i=t.sent,o=Ee(i,2),a=o[0],s=o[1],t.abrupt("return",(0,f.xe)(r.xAttr,r.yAttr,n,a,s));case 11:case"end":return t.stop()}}),t,this)})))}},{key:"getSurvivalDownloadData",value:function(e){var t=this,r=o().find(this.survivalPlots.result,(function(t){return t.id===e.uniqueKey}));if(r&&this.survivalData.result){var n=[],i=r.associatedAttrs;n.push(["Study ID","Patient ID"].concat(we(i)).join("\t"));var a=o().reduce(this.selectedPatients,(function(e,t){return e[t.uniquePatientKey]=t,e}),{});return this.selectedPatientKeys.result.forEach((function(e){var r=t.survivalData.result[e],s=[];if(r&&r.length>0){s.push(r[0].studyId||re.y.NA),s.push(r[0].patientId||re.y.NA);var l=o().keyBy(r,"clinicalAttributeId");o().each(i,(function(e){s.push(l[e]&&l[e].value||re.y.NA)}))}else{var u=a[e];u&&(s.push(u.studyId||re.y.NA),s.push(u.patientId||re.y.NA),o().each(i,(function(){s.push(re.y.NA)})))}n.push(s.join("\t"))})),n.join("\n")}return""}},{key:"getMutatedGenesDownloadData",value:function(){return Oe(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.mutatedGeneTableRowData.result){e.next=8;break}return t=["Gene","MutSig(Q-value)","# Mut","#","Profiled Samples","Freq"],this.oncokbCancerGeneFilterEnabled&&t.push("Is Cancer Gene (source: OncoKB)"),r=[t.join("\t")],o().each(this.mutatedGeneTableRowData.result,(function(e){var t=[e.label,void 0===e.qValue?"":(0,f.sQ)(e.qValue),e.totalCount,e.numberOfAlteredCases,e.numberOfProfiledCases,(0,f.jJ)(e.numberOfAlteredCases/e.numberOfProfiledCases*100)];n.oncokbCancerGeneFilterEnabled&&t.push(n.oncokbCancerGeneFilterEnabled?e.isCancerGene?"Yes":"No":"NA"),r.push(t.join("\t"))})),e.abrupt("return",r.join("\n"));case 8:return e.abrupt("return","");case 9:case"end":return e.stop()}}),e,this)})))}},{key:"getStructuralVariantGenesDownloadData",value:function(){var e=this;if(this.structuralVariantGeneTableRowData.result){var t=["Gene","# Structural Variant","#","Profiled Samples","Freq"];this.oncokbCancerGeneFilterEnabled&&t.push("Is Cancer Gene (source: OncoKB)");var r=[t.join("\t")];return o().each(this.structuralVariantGeneTableRowData.result,(function(t){var n=[t.label,t.totalCount,t.numberOfAlteredCases,t.numberOfProfiledCases,(0,f.jJ)(t.numberOfAlteredCases/t.numberOfProfiledCases*100)];e.oncokbCancerGeneFilterEnabled&&n.push(e.oncokbCancerGeneFilterEnabled?t.isCancerGene?"Yes":"No":"NA"),r.push(n.join("\t"))})),r.join("\n")}return""}},{key:"getGenesCNADownloadData",value:function(){return Oe(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.cnaGeneTableRowData.result){e.next=8;break}return t=["Gene","Gistic(Q-value)","Cytoband","CNA","Profiled Samples","#","Freq"],this.oncokbCancerGeneFilterEnabled&&t.push("Is Cancer Gene (source: OncoKB)"),r=[t.join("\t")],o().each(this.cnaGeneTableRowData.result,(function(e){var t=[e.label,void 0===e.qValue?"":(0,f.sQ)(e.qValue),e.cytoband,(0,f.$9)(e.alteration),e.numberOfAlteredCases,e.numberOfProfiledCases,(0,f.jJ)(e.numberOfAlteredCases/e.numberOfProfiledCases*100)];n.oncokbCancerGeneFilterEnabled&&t.push(n.oncokbCancerGeneFilterEnabled?e.isCancerGene?"Yes":"No":"NA"),r.push(t.join("\t"))})),e.abrupt("return",r.join("\n"));case 8:return e.abrupt("return","");case 9:case"end":return e.stop()}}),e,this)})))}},{key:"getDownloadDataPromise",value:function(){return Oe(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,f.vc)(this.selectedSamples.result);case 2:return t=e.sent,r=o().reduce(this.clinicalAttributes.result,(function(e,t){return e[(0,f.PG)(t)]=t.displayName,e}),{studyId:"Study ID",patientId:"Patient ID",sampleId:"Sample ID"}),n=o().reduce(this.selectedSamples.result,(function(e,n){var i=Object.assign({studyId:n.studyId,patientId:n.patientId,sampleId:n.sampleId},t[n.uniqueSampleKey]||{});return e.push(o().map(Object.keys(r),(function(e){return i[e]||re.y.NA}))),e}),[o().values(r)]),e.abrupt("return",n.map((function(e){return e.join("\t")})).join("\n"));case 6:case"end":return e.stop()}}),e,this)})))}},{key:"onSubmitQuery",value:function(){var e=(0,_.cD)(this.unknownQueriedIds.result),t={cancer_study_list:this.studyIds.filter((function(t){return!e[t]})).join(","),tab_index:"tab_visualize"},r=[];0===this.filteredVirtualStudies.result.length&&1===this.studyIds.length?(this.alterationTypesInOQL.haveMutInQuery&&this.defaultMutationProfile&&r.push((0,se.o)(this.defaultMutationProfile)),this.alterationTypesInOQL.haveStructuralVariantInQuery&&this.defaultStructuralVariantProfile&&r.push((0,se.o)(this.defaultStructuralVariantProfile)),this.alterationTypesInOQL.haveCnaInQuery&&this.defaultCnaProfile&&r.push((0,se.o)(this.defaultCnaProfile)),this.alterationTypesInOQL.haveMrnaInQuery&&this.defaultMrnaProfile&&r.push((0,se.o)(this.defaultMrnaProfile)),this.alterationTypesInOQL.haveProtInQuery&&this.defaultProtProfile&&r.push((0,se.o)(this.defaultProtProfile))):r=o().chain([].concat(we(this.mutationProfiles.result),we(this.cnaProfiles.result),we(this.structuralVariantProfiles.result))).map((function(e){return(0,se.o)(e)})).uniq().value(),r.length>0&&(t.profileFilter=r.join(",")),this.chartsAreFiltered?(t.case_set_id="-1",t.case_ids=o().map(this.selectedSamples.result,(function(e){return e.studyId+":"+e.sampleId})).join("+")):0===this.filteredVirtualStudies.result.length&&1===this.studyIds.length?t.case_set_id=this.studyIds[0]+"_all":t.case_set_id="all";var n="/";o().isEmpty(this.geneQueries)||(t.Action="Submit",t.gene_list=this.geneQueries.map((function(e){return(0,b.rY)(e)})).join("\n"),n="/results"),(0,f.Ep)(n,t,"_blank")}},{key:"showAsPieChart",value:function(e,t){(0,f.Gm)(this.initialFilters,t,this.samples.result.length)&&(this.changeChartVisibility(e,!0),t>A.$u.thresholds.pieToTable||o().includes(A.$u.tableAttrs,e)?(this.chartsType.set(e,A.oV.TABLE),this.chartsDimension.set(e,this.getTableDimensionByNumberOfRecords(t))):(this.chartsType.set(e,A.oV.PIE_CHART),this.chartsDimension.set(e,A.$u.layout.dimensions[A.oV.PIE_CHART])))}},{key:"getChartTitle",value:function(e,t){var r=0;if(void 0!==this.molecularProfileSampleCountSet.result){switch(e){case A.oV.MUTATED_GENES_TABLE:r=this.molecularProfileSampleCountSet.result[d.qV.MUTATION_EXTENDED]?this.molecularProfileSampleCountSet.result[d.qV.MUTATION_EXTENDED]:0;break;case A.oV.STRUCTURAL_VARIANT_GENES_TABLE:r=(0,f.k5)(this.molecularProfileSampleCountSet.result);break;case A.oV.CNA_GENES_TABLE:r=(0,f.fo)(this.molecularProfileSampleCountSet.result)}if(r>0)return"".concat(t," (").concat(r," profiled ").concat((0,_._6)("sample",r),")")}return t}},{key:"clearPatientTreatmentFilters",value:function(){this._patientTreatmentsFilter={filters:[]}}},{key:"setPatientTreatmentFilters",value:function(e){this._patientTreatmentsFilter=e}},{key:"addPatientTreatmentFilters",value:function(e){this._patientTreatmentsFilter.filters=this._patientTreatmentsFilter.filters.concat(e)}},{key:"clearSampleTreatmentFilters",value:function(){this._sampleTreatmentsFilters={filters:[]}}},{key:"setSampleTreatmentFilters",value:function(e){this._sampleTreatmentsFilters=e}},{key:"addSampleTreatmentFilters",value:function(e){this._sampleTreatmentsFilters.filters=this._sampleTreatmentsFilters.filters.concat(e)}},{key:"setTreatmentFilters",value:function(e){e.patientTreatmentFilters&&o().isArray(e.patientTreatmentFilters.filters)&&this.setPatientTreatmentFilters(e.patientTreatmentFilters),e.sampleTreatmentFilters&&o().isArray(e.sampleTreatmentFilters.filters)&&this.setSampleTreatmentFilters(e.sampleTreatmentFilters),e.patientTreatmentGroupFilters&&o().isArray(e.patientTreatmentGroupFilters.filters)&&this.setPatientTreatmentFilters(e.patientTreatmentGroupFilters),e.sampleTreatmentGroupFilters&&o().isArray(e.sampleTreatmentGroupFilters.filters)&&this.setSampleTreatmentFilters(e.sampleTreatmentGroupFilters),e.patientTreatmentTargetFilters&&o().isArray(e.patientTreatmentTargetFilters.filters)&&this.setPatientTreatmentFilters(e.patientTreatmentTargetFilters),e.sampleTreatmentTargetFilters&&o().isArray(e.sampleTreatmentTargetFilters.filters)&&this.setSampleTreatmentFilters(e.sampleTreatmentTargetFilters)}},{key:"clearPatientTreatmentTargetFilters",value:function(){this._patientTreatmentTargetFilter={filters:[]}}},{key:"setPatientTreatmentTargetFilters",value:function(e){this._patientTreatmentTargetFilter=e}},{key:"addPatientTreatmentTargetFilters",value:function(e){this._patientTreatmentTargetFilter.filters=this._patientTreatmentTargetFilter.filters.concat(e)}},{key:"clearSampleTreatmentTargetFilters",value:function(){this._sampleTreatmentTargetFilters={filters:[]}}},{key:"setSampleTreatmentTargetFilters",value:function(e){this._sampleTreatmentTargetFilters=e}},{key:"addSampleTreatmentTargetFilters",value:function(e){this._sampleTreatmentTargetFilters.filters=this._sampleTreatmentTargetFilters.filters.concat(e)}},{key:"clearPatientTreatmentGroupFilters",value:function(){this._patientTreatmentGroupsFilter={filters:[]}}},{key:"setPatientTreatmentGroupFilters",value:function(e){this._patientTreatmentGroupsFilter=e}},{key:"addPatientTreatmentGroupFilters",value:function(e){this._patientTreatmentGroupsFilter.filters=this._patientTreatmentGroupsFilter.filters.concat(e)}},{key:"clearSampleTreatmentGroupFilters",value:function(){this._sampleTreatmentGroupsFilters={filters:[]}}},{key:"setSampleTreatmentGroupFilters",value:function(e){this._sampleTreatmentGroupsFilters=e}},{key:"addSampleTreatmentGroupFilters",value:function(e){this._sampleTreatmentGroupsFilters.filters=this._sampleTreatmentGroupsFilters.filters.concat(e)}},{key:"onTreatmentSelection",value:function(e,t){var r=t.map((function(t){return{filters:t.map((function(t){return function(e,t){return t.uniqueKey.startsWith("SAMPLE")?function(e){var t=e.split("::");return{treatment:t[0],time:t[1]}}(e):function(e){return{treatment:e.split("::")[0]}}(e)}(t,e)}))}}));switch(e.uniqueKey){case"SAMPLE_TREATMENT_TARGET":return this.addSampleTreatmentTargetFilters(r);case"PATIENT_TREATMENT_TARGET":return this.addPatientTreatmentTargetFilters(r);case"SAMPLE_TREATMENT_GROUPS":return this.addSampleTreatmentGroupFilters(r);case"PATIENT_TREATMENT_GROUPS":return this.addPatientTreatmentGroupFilters(r);case"SAMPLE_TREATMENTS":return this.addSampleTreatmentFilters(r);case"PATIENT_TREATMENTS":return this.addPatientTreatmentFilters(r)}}},{key:"removeTreatmentsFilter",value:function(e,t,r){var n=this.sampleTreatmentFilters.filters.map((function(r,n){return{filters:r.filters.filter((function(r,i){return!(e===n&&t===i)}))}})).filter((function(e){return e.filters.length>0}));switch(r){case"SAMPLE_TREATMENT_TARGET":return this.setSampleTreatmentTargetFilters({filters:n});case"PATIENT_TREATMENT_TARGET":return this.setPatientTreatmentTargetFilters({filters:n});case"SAMPLE_TREATMENT_GROUPS":return this.setSampleTreatmentGroupFilters({filters:n});case"PATIENT_TREATMENT_GROUPS":return this.setPatientTreatmentGroupFilters({filters:n});case"SAMPLE_TREATMENTS":return this.setSampleTreatmentFilters({filters:n});case"PATIENT_TREATMENTS":return this.setPatientTreatmentFilters({filters:n})}}},{key:"isLoggedIn",get:function(){return this.appStore.isLoggedIn}},{key:"isSavingUserPreferencePossible",get:function(){return this.isLoggedIn&&this.sessionServiceIsEnabled}},{key:"comparisonConfirmationModal",get:function(){return this._comparisonConfirmationModal}},{key:"customChartGroupMarkedForDeletion",get:function(){var e=[];return this._customChartsMarkedForDeletion.forEach((function(t,r){t&&e.push(r)})),e}},{key:"genomicProfilesFilter",get:function(){return this._genomicProfilesFilter}},{key:"caseListsFilter",get:function(){return this._caseListsFilter}},{key:"currentTab",get:function(){return this.urlWrapper.tabId}},{key:"initialFilters",get:function(){var e={};o().isEmpty(this.queriedSampleIdentifiers.result)?e.studyIds=this.queriedPhysicalStudyIds.result:e.sampleIdentifiers=this.queriedSampleIdentifiers.result;var t=Object.assign({},(0,l.toJS)(this.initialFiltersQuery),e);if(this.customDriverAnnotationReport.isComplete){var r,n=(0,ve.QB)((function(){return!1}));(0,ve._c)(this.customDriverAnnotationReport.result,n,n.customTiersDefault),t.alterationFilter={copyNumberAlterationEventTypes:(r={},Te(r,Se.TC.AMP,!0),Te(r,Se.TC.HOMDEL,!0),r),mutationEventTypes:Te({},Se.AG.any,!0),structuralVariants:null,includeDriver:n.includeDriver,includeVUS:n.includeVUS,includeUnknownOncogenicity:n.includeUnknownOncogenicity,includeUnknownTier:n.includeUnknownTier,includeGermline:!0,includeSomatic:!0,includeUnknownStatus:!0,tiersBooleanMap:this.selectedDriverTiersMap.isComplete?this.selectedDriverTiersMap.result:{}}}return o().isEmpty(t.sampleIdentifiers)||delete t.studyIds,t}},{key:"isInitialFilterState",get:function(){return o().isEqual((0,l.toJS)(this.initialFilters),(0,l.toJS)(this.filters))}},{key:"containerWidth",get:function(){return this.columns*A.$u.layout.grid.w+(this.columns+1)*A.$u.layout.gridMargin.x}},{key:"columns",get:function(){return Math.floor((v.Z.size.width-40)/(A.$u.layout.grid.w+A.$u.layout.gridMargin.x))}},{key:"studyViewPageLayoutProps",get:function(){return{cols:this.columns,grid:A.$u.layout.grid,gridMargin:A.$u.layout.gridMargin,layout:this.currentGridLayout,dimensions:A.$u.layout.dimensions}}},{key:"filterMutatedGenesTableByCancerGenes",get:function(){return this.oncokbCancerGeneFilterEnabled&&this._filterMutatedGenesTableByCancerGenes}},{key:"filterSVGenesTableByCancerGenes",get:function(){return this.oncokbCancerGeneFilterEnabled&&this._filterSVGenesTableByCancerGenes}},{key:"filterCNAGenesTableByCancerGenes",get:function(){return this.oncokbCancerGeneFilterEnabled&&this._filterCNAGenesTableByCancerGenes}},{key:"filterComparisonGroups",get:function(){return this._filterComparisonGroups}},{key:"selectedGenes",get:function(){return this.geneQueries.map((function(e){return e.gene}))}},{key:"alterationTypesInOQL",get:function(){return(0,d.xz)(this.geneQueries)}},{key:"defaultProfilesForOql",get:function(){if(this.molecularProfiles.isComplete)return(0,d.a9)(this.molecularProfiles.result)}},{key:"defaultMutationProfile",get:function(){return this.defaultProfilesForOql&&this.defaultProfilesForOql[L.YK.MUTATION_EXTENDED]}},{key:"defaultStructuralVariantProfile",get:function(){return this.defaultProfilesForOql&&this.defaultProfilesForOql[L.YK.STRUCTURAL_VARIANT]}},{key:"defaultCnaProfile",get:function(){return this.defaultProfilesForOql&&this.defaultProfilesForOql[L.YK.COPY_NUMBER_ALTERATION]}},{key:"defaultMrnaProfile",get:function(){return this.defaultProfilesForOql&&this.defaultProfilesForOql[L.YK.MRNA_EXPRESSION]}},{key:"defaultProtProfile",get:function(){return this.defaultProfilesForOql&&this.defaultProfilesForOql[L.YK.PROTEIN_LEVEL]}},{key:"analysisGroupsSettings",get:function(){return{groups:[{value:De,color:A.$u.colors.theme.unselectedGroup,name:this.chartsAreFiltered?"Selected patients":"All patients"}]}}},{key:"clinicalDataFilters",get:function(){return Array.from(this._clinicalDataFilterSet.values())}},{key:"customDataFilters",get:function(){return Array.from(this._customDataFilterSet.values())}},{key:"geneFilters",get:function(){return o().map(this._geneFilterSet.toJSON(),(function(e){var t=Ee(e,2),r=t[0],n=t[1];return{molecularProfileIds:(0,f.S4)(r),geneQueries:n}}))}},{key:"genomicDataIntervalFilters",get:function(){return Array.from(this._genomicDataIntervalFilterSet.values())}},{key:"genericAssayDataFilters",get:function(){return Array.from(this._genericAssayDataFilterSet.values())}},{key:"filters",get:function(){var e,t={},r=this.clinicalDataFilters,n=this.genomicDataIntervalFilters;n.length>0&&(t.genomicDataFilters=n);var i=this.genericAssayDataFilters;i.length>0&&(t.genericAssayDataFilters=i),r.length>0&&(t.clinicalDataFilters=r),this.customDataFilters.length>0&&(t.customDataFilters=this.customDataFilters),this.geneFilters.length>0&&(t.geneFilters=this.geneFilters),this.genomicProfilesFilter.length>0&&(t.genomicProfiles=(0,l.toJS)(this.genomicProfilesFilter)),this.caseListsFilter.length>0&&(t.caseLists=(0,l.toJS)(this.caseListsFilter)),this.sampleTreatmentFilters&&this.sampleTreatmentFilters.filters.length>0&&(t.sampleTreatmentFilters=this.sampleTreatmentFilters),this.patientTreatmentFilters&&this.patientTreatmentFilters.filters.length>0&&(t.patientTreatmentFilters=this.patientTreatmentFilters),this.sampleTreatmentGroupFilters&&this.sampleTreatmentGroupFilters.filters.length>0&&(t.sampleTreatmentGroupFilters=this.sampleTreatmentGroupFilters),this.patientTreatmentGroupFilters&&this.patientTreatmentGroupFilters.filters.length>0&&(t.patientTreatmentGroupFilters=this.patientTreatmentGroupFilters),this.sampleTreatmentTargetFilters&&this.sampleTreatmentTargetFilters.filters.length>0&&(t.sampleTreatmentTargetFilters=this.sampleTreatmentTargetFilters),this.patientTreatmentTargetFilters&&this.patientTreatmentTargetFilters.filters.length>0&&(t.patientTreatmentTargetFilters=this.patientTreatmentTargetFilters);var a=Array.from(this._chartSampleIdentifiersFilterSet.values()),s=o().intersectionWith.apply(o(),we(a).concat([function(e,t){return e.sampleId===t.sampleId&&e.studyId===t.studyId}]));return o().isEmpty(a)?o().isEmpty(this.queriedSampleIdentifiers.result)?t.studyIds=this.queriedPhysicalStudyIds.result:t.sampleIdentifiers=this.queriedSampleIdentifiers.result:t.sampleIdentifiers=s,t.alterationFilter={copyNumberAlterationEventTypes:(e={},Te(e,Se.TC.AMP,!0),Te(e,Se.TC.HOMDEL,!0),e),mutationEventTypes:Te({},Se.AG.any,!0),structuralVariants:null,includeDriver:this.driverAnnotationSettings.includeDriver,includeVUS:this.driverAnnotationSettings.includeVUS,includeUnknownOncogenicity:this.driverAnnotationSettings.includeUnknownOncogenicity,includeUnknownTier:this.driverAnnotationSettings.includeUnknownTier,includeGermline:this.includeGermlineMutations,includeSomatic:this.includeSomaticMutations,includeUnknownStatus:this.includeUnknownStatusMutations,tiersBooleanMap:this.selectedDriverTiersMap.isComplete?this.selectedDriverTiersMap.result:{}},t}},{key:"userSelections",get:function(){return Object.assign(Object.assign({},this.filters),{sampleIdentifiersSet:o().fromPairs(this._chartSampleIdentifiersFilterSet.toJSON())})}},{key:"unfilteredAttrsForNonNumerical",get:function(){var e=this;return this.visibleAttributes.filter((function(t){if(!e.isUserDefinedCustomDataChart(t.uniqueKey)&&void 0!==t.clinicalAttribute&&t.clinicalAttribute.datatype!==f.g.NUMBER){var r=(0,f.PG)(t.clinicalAttribute);return!e._clinicalDataFilterSet.has(r)}return!1})).map((function(e){return{attributeId:e.clinicalAttribute.clinicalAttributeId}}))}},{key:"unfilteredCustomAttrsForNonNumerical",get:function(){var e=this;return this.visibleAttributes.filter((function(t){return!(!e.isUserDefinedCustomDataChart(t.uniqueKey)||void 0===t.clinicalAttribute||t.clinicalAttribute.datatype===f.g.NUMBER||e._customDataFilterSet.has(t.uniqueKey))})).map((function(e){return{attributeId:e.clinicalAttribute.clinicalAttributeId}}))}},{key:"newlyAddedUnfilteredAttrsForNonNumerical",get:function(){var e=this;return this.clinicalAttributes.result.filter((function(t){if(t.datatype!==f.g.NUMBER){var r=(0,f.PG)(t);return!!e.newlyAddedCharts.includes(r)}return!1})).map((function(e){return{attributeId:e.clinicalAttributeId}}))}},{key:"newlyAddedUnfilteredAttrsForNumerical",get:function(){var e=this;return this.clinicalAttributes.result.filter((function(t){if(t.datatype===f.g.NUMBER){var r=(0,f.PG)(t);return!!e.newlyAddedCharts.includes(r)}return!1})).map((function(t){return e._clinicalDataBinFilterSet.get((0,f.PG)(t))}))}},{key:"unfilteredAttrsForNumerical",get:function(){var e=this;return this.visibleAttributes.filter((function(t){if(void 0!==t.clinicalAttribute&&t.clinicalAttribute.datatype===f.g.NUMBER){var r=(0,f.PG)(t.clinicalAttribute);return!e._clinicalDataFilterSet.has(r)}return!1})).map((function(t){return e._clinicalDataBinFilterSet.get((0,f.PG)(t.clinicalAttribute))}))}},{key:"isSingleNonVirtualStudyQueried",get:function(){return this.filteredPhysicalStudies.isComplete&&this.filteredVirtualStudies.isComplete&&1===this.filteredPhysicalStudies.result.length&&0===this.filteredVirtualStudies.result.length}},{key:"showOriginStudiesInSummaryDescription",get:function(){return(0,f.zj)(this.filteredPhysicalStudies.result,this.filteredVirtualStudies.result)}},{key:"hasCnaProfileData",get:function(){return this.cnaProfiles.isComplete&&!o().isEmpty(this.cnaProfiles.result)}},{key:"oncokbCancerGeneFilterEnabled",get:function(){return!!(0,Ce.Ib)().show_oncokb&&!this.oncokbCancerGenes.isError&&!this.oncokbGenes.isError}},{key:"isSingleVirtualStudyPageWithoutFilter",get:function(){return this.filteredPhysicalStudies.result.length+this.filteredVirtualStudies.result.length===1&&this.filteredVirtualStudies.result.length>0&&!this.chartsAreFiltered}},{key:"analysisGroupsPossible",get:function(){var e=this.survivalPlotKeys,t=!1,r=!0,n=!1,i=void 0;try{for(var o,a=this.visibleAttributes[Symbol.iterator]();!(r=(o=a.next()).done);r=!0){var s=o.value;if(e.includes(s.uniqueKey)){t=!0;break}}}catch(e){n=!0,i=e}finally{try{r||null==a.return||a.return()}finally{if(n)throw i}}return t}},{key:"survivalPlotKeys",get:function(){return this.survivalClinicalAttributesPrefix.result?this.survivalClinicalAttributesPrefix.result.map((function(e){return"".concat(e,"_SURVIVAL")})):[]}},{key:"chartMetaSet",get:function(){var e=o().fromPairs(this._customCharts.toJSON());if(o().isEmpty(this.molecularProfiles.result)&&delete e[f.h_.GENOMIC_PROFILES_SAMPLE_COUNT],e=o().merge(e,o().fromPairs(this._geneSpecificCharts.toJSON()),o().fromPairs(this._genericAssayCharts.toJSON()),o().fromPairs(this._XvsYCharts.toJSON())),o().reduce(this.chartClinicalAttributes.result,(function(e,t){var r=(0,f.PG)(t);return e[r]={displayName:t.displayName,uniqueKey:r,dataType:(0,f.C3)(r),patientAttribute:t.patientAttribute,description:t.description,priority:(0,f.NE)(t),renderWhenDataChange:!1,clinicalAttribute:t},e}),e),o().reduce(this.survivalPlots.result,(function(e,t){return e[t.id]={uniqueKey:t.id,dataType:(0,f.C3)(t.id),patientAttribute:!0,displayName:t.title,priority:A.$u.priority[t.id]||(0,f.NE)(t.survivalStatusAttribute),renderWhenDataChange:!1,description:""},e}),e),this.shouldDisplaySampleTreatments.result&&(e.SAMPLE_TREATMENTS={uniqueKey:"SAMPLE_TREATMENTS",dataType:f.E4.CLINICAL,patientAttribute:!0,displayName:"Treatment by Sample (pre/post)",priority:(0,f.eY)(A.oV.SAMPLE_TREATMENTS_TABLE),renderWhenDataChange:!0,description:"List of treatments and the corresponding number of samples acquired before treatment or after/on treatment"}),this.shouldDisplayPatientTreatments.result&&(e.PATIENT_TREATMENTS={uniqueKey:"PATIENT_TREATMENTS",dataType:f.E4.CLINICAL,patientAttribute:!0,displayName:"Treatment by Patient",priority:(0,f.eY)(A.oV.PATIENT_TREATMENTS_TABLE),renderWhenDataChange:!0,description:"List of treatments and the corresponding number of patients treated"}),this.shouldDisplaySampleTreatmentGroups.result&&(e.SAMPLE_TREATMENT_GROUPS={uniqueKey:"SAMPLE_TREATMENT_GROUPS",dataType:f.E4.CLINICAL,patientAttribute:!0,displayName:"Treatment Category by Sample (pre/post)",priority:(0,f.eY)(A.oV.SAMPLE_TREATMENT_GROUPS_TABLE),renderWhenDataChange:!0,description:"List of treatments groups and the corresponding number of samples acquired before treatment or after/on treatment"}),this.shouldDisplayPatientTreatmentGroups.result&&(e.PATIENT_TREATMENT_GROUPS={uniqueKey:"PATIENT_TREATMENT_GROUPS",dataType:f.E4.CLINICAL,patientAttribute:!0,displayName:"Treatment Category by Patient",priority:(0,f.eY)(A.oV.PATIENT_TREATMENT_GROUPS_TABLE),renderWhenDataChange:!0,description:"List of treatment groups and the corresponding number of patients treated"}),this.shouldDisplaySampleTreatmentTarget.result&&(e.SAMPLE_TREATMENT_TARGET={uniqueKey:"SAMPLE_TREATMENT_TARGET",dataType:f.E4.CLINICAL,patientAttribute:!0,displayName:"Treatment Target by Sample (pre/post)",priority:(0,f.eY)(A.oV.SAMPLE_TREATMENT_TARGET_TABLE),renderWhenDataChange:!0,description:"List of treatments targets and the corresponding number of samples acquired before treatment or after/on treatment"}),this.shouldDisplayPatientTreatmentTarget.result&&(e.PATIENT_TREATMENT_TARGET={uniqueKey:"PATIENT_TREATMENT_TARGET",dataType:f.E4.CLINICAL,patientAttribute:!0,displayName:"Treatment Target by Patient",priority:(0,f.eY)(A.oV.PATIENT_TREATMENT_TARGET_TABLE),renderWhenDataChange:!0,description:"List of treatment targets and the corresponding number of patients treated"}),!o().isEmpty(this.mutationProfiles.result)){var t=(0,f.wl)(this.mutationProfiles.result.map((function(e){return e.molecularProfileId})));e[t]={uniqueKey:t,dataType:f.E4.GENOMIC,patientAttribute:!1,displayName:"Mutated Genes",priority:(0,f.eY)(A.oV.MUTATED_GENES_TABLE),renderWhenDataChange:!1,description:""}}if(!o().isEmpty(this.structuralVariantProfiles.result)){var r=(0,f.wl)(this.structuralVariantProfiles.result.map((function(e){return e.molecularProfileId})));e[r]={uniqueKey:r,dataType:f.E4.GENOMIC,patientAttribute:!1,displayName:"Structural Variant Genes",priority:(0,f.eY)(A.oV.STRUCTURAL_VARIANT_GENES_TABLE),renderWhenDataChange:!0,description:""}}if(!o().isEmpty(this.cnaProfiles.result)){var n=(0,f.wl)(this.cnaProfiles.result.map((function(e){return e.molecularProfileId})));e[n]={uniqueKey:n,dataType:f.E4.GENOMIC,patientAttribute:!1,displayName:"CNA Genes",renderWhenDataChange:!1,priority:(0,f.eY)(A.oV.CNA_GENES_TABLE),description:""}}return e}},{key:"chartMetaSetWithChartType",get:function(){var e=this;return o().reduce(this.chartMetaSet,(function(t,r){return t[r.uniqueKey]=Object.assign(Object.assign({},r),{chartType:e.chartsType.get(r.uniqueKey)}),t}),{})}},{key:"visibleAttributes",get:function(){var e=this;return o().reduce(Array.from(this._chartVisibility.entries()),(function(t,r){var n=Ee(r,2),i=n[0];if(n[1]&&e.chartMetaSet[i]){var o=e.chartMetaSet[i];t.push(o)}return t}),[])}},{key:"showSettingRestoreMsg",get:function(){return!(!this.isSavingUserPreferencePossible||this.hideRestoreSettingsMsg||!this.userSettings.isComplete||!this.userSettings.result||o().isEqual(this.previousSettings,o().keyBy(this.userSettings.result.chartSettings,(function(e){return e.id}))))}},{key:"isSavingUserSettingsPossible",get:function(){return this.isSavingUserPreferencePossible&&this.userSettings.isComplete&&(!this.showSettingRestoreMsg||!this.userSettings.result||!o().isEqual(this.currentChartSettingsMap,o().keyBy(this.userSettings.result.chartSettings,(function(e){return e.id})))||!o().isEqual((0,l.toJS)(this.userGroupColors),this.userSettings.result.groupColors))}},{key:"loadingInitialDataForSummaryTab",get:function(){if(!this.queriedPhysicalStudyIds.isComplete||0===this.queriedPhysicalStudyIds.result.length)return!1;var e=this.defaultVisibleAttributes.isPending||this.chartClinicalAttributes.isPending||this.clinicalAttributes.isPending||this.mutationProfiles.isPending||this.cnaProfiles.isPending||this.structuralVariantProfiles.isPending||this.survivalPlots.isPending||this.shouldDisplayPatientTreatments.isPending||this.sharedCustomData.isPending;return this.clinicalAttributes.isComplete&&!o().isEmpty(this.clinicalAttributes.result)&&(e=e||this.initialVisibleAttributesClinicalDataBinCountData.isPending||this.initialVisibleAttributesClinicalDataCountData.isPending),this._loadUserSettingsInitially&&(e=(e=e||this.userSettings.isPending)||this.userSavedCustomData.isPending),o().isEmpty(this.initialFilters.genomicDataFilters)||(e=e||this.molecularProfileSampleCounts.isPending),o().isEmpty(this.initialFilters.genericAssayDataFilters)||(e=e||this.genericAssayProfileOptionsByType.isPending),o().isEmpty(this.initialFilters.caseLists)||(e=e||this.caseListSampleCounts.isPending),!e&&this.isInitiallLoad&&(e=e||0===this.selectedSamples.result.length),!e&&this.isInitiallLoad&&(this.isInitiallLoad=!1),e}},{key:"currentChartSettingsMap",get:function(){var e={};return this.isSavingUserPreferencePossible&&(e=(0,f.vO)(this.visibleAttributes,this.columns,o().fromPairs(this.chartsDimension.toJSON()),o().fromPairs(this.chartsType.toJSON()),o().fromPairs(this._geneSpecificChartMap.toJSON()),o().fromPairs(this._genericAssayChartMap.toJSON()),o().fromPairs(this._XvsYScatterChartMap.toJSON()),o().fromPairs(this._XvsYViolinChartMap.toJSON()),o().fromPairs(this._clinicalDataBinFilterSet.toJSON()),this._filterMutatedGenesTableByCancerGenes,this._filterSVGenesTableByCancerGenes,this._filterCNAGenesTableByCancerGenes,this.currentGridLayout)),e}},{key:"_defaultXvsYChartMap",get:function(){var e,t,r={};return this.clinicalAttributes.result.forEach((function(r){"0"!==r.priority&&(f.h_.MUTATION_COUNT===r.clinicalAttributeId?e=r:f.h_.FRACTION_GENOME_ALTERED===r.clinicalAttributeId&&(t=r))})),e&&t&&0!==(0,f.eY)(f.g1)&&(r[f.g1]={xAttr:t,yAttr:e,plotDomain:{x:f.rP,y:f.hI}}),r}},{key:"showResetToDefaultButton",get:function(){return!o().isEqual(this.currentChartSettingsMap,this.defaultChartSettingsMap)}},{key:"defaultChartSettingsMap",get:function(){var e=this,t=o().reduce(this._defaultVisibleChartIds,(function(t,r){return e.chartMetaSet[r]&&t.push(e.chartMetaSet[r]),t}),[]);return(0,f.vO)(t,this.columns,o().fromPairs(this._defaultChartsDimension.toJSON()),o().fromPairs(this._defaultChartsType.toJSON()),{},{},this._defaultXvsYChartMap,{},o().fromPairs(this._defaultClinicalDataBinFilterSet.toJSON()))}},{key:"chartsAreFiltered",get:function(){return(0,f.wA)(this.userSelections)}},{key:"hasFilteredSamples",get:function(){return this.selectedSamples.isComplete&&this.selectedSamples.result.length>0}},{key:"hasSampleIdentifiersInFilter",get:function(){return!(o().isEmpty(this.filters.studyIds)&&o().isEmpty(this.filters.sampleIdentifiers))}},{key:"selectedSamplesMap",get:function(){return o().keyBy(this.selectedSamples.result,(function(e){return e.uniqueSampleKey}))}},{key:"selectedPatients",get:function(){return o().values(o().reduce(this.selectedSamples.result,(function(e,t){return e[t.uniquePatientKey]={cancerStudy:{},patientId:t.patientId,uniquePatientKey:t.uniquePatientKey,studyId:t.studyId,uniqueSampleKey:t.uniqueSampleKey},e}),{}))}},{key:"molecularProfileMapByType",get:function(){return o().groupBy(this.molecularProfiles.result,(function(e){return(0,se.o)(e)}))}},{key:"clinicalDataDownloadFilename",get:function(){return"".concat(this.downloadFilenamePrefix,"clinical_data.tsv")}},{key:"downloadFilenamePrefix",get:function(){return(0,y.N)(this.displayedStudies.result)}},{key:"isMixedReferenceGenome",get:function(){if(this.queriedPhysicalStudies.result)return(0,te.LD)(this.queriedPhysicalStudies.result)}},{key:"patientTreatmentTargetFilters",get:function(){return this._patientTreatmentTargetFilter}},{key:"sampleTreatmentTargetFilters",get:function(){return this._sampleTreatmentTargetFilters}},{key:"patientTreatmentGroupFilters",get:function(){return this._patientTreatmentGroupsFilter}},{key:"sampleTreatmentGroupFilters",get:function(){return this._sampleTreatmentGroupsFilters}},{key:"patientTreatmentFilters",get:function(){return this._patientTreatmentsFilter}},{key:"sampleTreatmentFilters",get:function(){return this._sampleTreatmentsFilters}},{key:"sampleTreatmentFiltersAsStrings",get:function(){return this.sampleTreatmentFilters.filters.map((function(e){return e.filters.map((function(e){return X(e)}))}))}},{key:"patientTreatmentFiltersAsStrings",get:function(){return this.patientTreatmentFilters.filters.map((function(e){return e.filters.map((function(e){return X(e)}))}))}},{key:"sampleTreatmentGroupFiltersAsStrings",get:function(){return this.sampleTreatmentGroupFilters.filters.map((function(e){return e.filters.map((function(e){return X(e)}))}))}},{key:"patientTreatmentGroupFiltersAsStrings",get:function(){return this.patientTreatmentGroupFilters.filters.map((function(e){return e.filters.map((function(e){return X(e)}))}))}},{key:"sampleTreatmentTargetFiltersAsStrings",get:function(){return this.sampleTreatmentTargetFilters.filters.map((function(e){return e.filters.map((function(e){return X(e)}))}))}},{key:"patientTreatmentTargetFiltersAsStrings",get:function(){return this.patientTreatmentTargetFilters.filters.map((function(e){return e.filters.map((function(e){return X(e)}))}))}},{key:"isGlobalMutationFilterActive",get:function(){return this.isGlobalAlterationFilterActive||this.isStatusFilterActive}},{key:"isGlobalAlterationFilterActive",get:function(){return this.isTiersFilterActive||this.isAnnotationsFilterActive}},{key:"isTiersFilterActive",get:function(){return(0,f.Ek)(o().fromPairs(this.driverAnnotationSettings.driverTiers.toJSON()),this.driverAnnotationSettings.includeUnknownTier)}},{key:"isAnnotationsFilterActive",get:function(){return(0,f.bp)(this.driverAnnotationSettings.includeDriver,this.driverAnnotationSettings.includeVUS,this.driverAnnotationSettings.includeUnknownOncogenicity)}},{key:"isStatusFilterActive",get:function(){return(0,f.df)(this.includeGermlineMutations,this.includeSomaticMutations,this.includeUnknownStatusMutations)}},{key:"doShowDriverAnnotationSectionInGlobalMenu",get:function(){return!!(this.customDriverAnnotationReport.isComplete&&this.customDriverAnnotationReport.result.hasBinary&&(0,Ce.Ib)().oncoprint_custom_driver_annotation_binary_menu_label&&(0,Ce.Ib)().oncoprint_custom_driver_annotation_tiers_menu_label)}},{key:"doShowTierAnnotationSectionInGlobalMenu",get:function(){return!!(this.customDriverAnnotationReport.isComplete&&this.customDriverAnnotationReport.result.tiers.length>0&&(0,Ce.Ib)().oncoprint_custom_driver_annotation_binary_menu_label&&(0,Ce.Ib)().oncoprint_custom_driver_annotation_tiers_menu_label)}}])&&Ae(t.prototype,r),n&&Ae(t,n),e}();Ie([l.observable],Re.prototype,"driverAnnotationSettings",void 0),Ie([l.observable],Re.prototype,"includeGermlineMutations",void 0),Ie([l.observable],Re.prototype,"includeSomaticMutations",void 0),Ie([l.observable],Re.prototype,"includeUnknownStatusMutations",void 0),Ie([l.observable],Re.prototype,"isSettingsMenuVisible",void 0),Ie([l.observable],Re.prototype,"showComparisonGroupUI",void 0),Ie([l.observable],Re.prototype,"showCustomDataSelectionUI",void 0),Ie([l.observable],Re.prototype,"numberOfVisibleColorChooserModals",void 0),Ie([l.observable],Re.prototype,"userGroupColors",void 0),Ie([l.action],Re.prototype,"toggleNAValue",void 0),Ie([l.computed],Re.prototype,"isLoggedIn",null),Ie([l.computed],Re.prototype,"isSavingUserPreferencePossible",null),Ie([l.observable],Re.prototype,"hideRestoreSettingsMsg",void 0),Ie([m.default],Re.prototype,"isResourceTabOpen",null),Ie([l.action.bound],Re.prototype,"setResourceTabOpen",null),Ie([l.observable.ref],Re.prototype,"_comparisonConfirmationModal",void 0),Ie([l.action.bound],Re.prototype,"setComparisonConfirmationModal",null),Ie([l.action],Re.prototype,"trackNewlyCreatedGroup",null),Ie([l.action],Re.prototype,"setComparisonGroupSelected",null),Ie([l.action],Re.prototype,"toggleComparisonGroupSelected",null),Ie([l.action],Re.prototype,"toggleComparisonGroupMarkedForDeletion",null),Ie([l.action],Re.prototype,"toggleCustomChartMarkedForDeletion",null),Ie([l.action],Re.prototype,"showComparisonGroupWarningSign",null),Ie([l.computed],Re.prototype,"customChartGroupMarkedForDeletion",null),Ie([l.action],Re.prototype,"deleteMarkedComparisonGroups",null),Ie([l.action],Re.prototype,"deleteMarkedCustomData",null),Ie([l.observable],Re.prototype,"_pendingChanges",void 0),Ie([l.observable],Re.prototype,"_comparisonGroupsChangeCount",void 0),Ie([l.action],Re.prototype,"notifyComparisonGroupsChange",null),Ie([l.action.bound],Re.prototype,"onGroupColorChange",null),Ie([m.default],Re.prototype,"openComparisonPage",null),Ie([l.observable],Re.prototype,"initialFiltersQuery",void 0),Ie([l.observable],Re.prototype,"studyIds",void 0),Ie([l.observable],Re.prototype,"_genomicProfilesFilter",void 0),Ie([l.observable],Re.prototype,"_caseListsFilter",void 0),Ie([l.computed.struct],Re.prototype,"genomicProfilesFilter",null),Ie([l.computed.struct],Re.prototype,"caseListsFilter",null),Ie([l.action],Re.prototype,"setGenomicProfilesFilter",null),Ie([l.action],Re.prototype,"setCaseListsFilter",null),Ie([l.observable],Re.prototype,"_clinicalDataBinFilterSet",void 0),Ie([l.observable],Re.prototype,"_genomicDataBinFilterSet",void 0),Ie([l.observable],Re.prototype,"_genericAssayDataBinFilterSet",void 0),Ie([l.observable.ref],Re.prototype,"_geneFilterSet",void 0),Ie([l.observable],Re.prototype,"_chartVisibility",void 0),Ie([l.observable.ref],Re.prototype,"geneQueryStr",void 0),Ie([l.observable],Re.prototype,"geneQueries",void 0),Ie([l.observable],Re.prototype,"chartsDimension",void 0),Ie([l.observable],Re.prototype,"chartsType",void 0),Ie([l.observable],Re.prototype,"sharedGroupSet",void 0),Ie([l.observable],Re.prototype,"sharedCustomChartSet",void 0),Ie([l.computed],Re.prototype,"currentTab",null),Ie([l.observable],Re.prototype,"pageStatusMessages",void 0),Ie([l.action],Re.prototype,"updateStoreByFilters",null),Ie([l.action],Re.prototype,"updateStoreFromURL",null),Ie([l.computed],Re.prototype,"initialFilters",null),Ie([l.computed],Re.prototype,"isInitialFilterState",null),Ie([l.computed],Re.prototype,"containerWidth",null),Ie([l.computed],Re.prototype,"columns",null),Ie([l.action.bound],Re.prototype,"updateLayout",null),Ie([l.computed],Re.prototype,"studyViewPageLayoutProps",null),Ie([l.action.bound],Re.prototype,"updateCurrentGridLayout",null),Ie([l.observable.ref],Re.prototype,"currentGridLayout",void 0),Ie([l.observable],Re.prototype,"previousSettings",void 0),Ie([l.observable],Re.prototype,"numberOfSelectedSamplesInCustomSelection",void 0),Ie([l.observable],Re.prototype,"_filterComparisonGroups",void 0),Ie([l.observable],Re.prototype,"_filterMutatedGenesTableByCancerGenes",void 0),Ie([l.observable],Re.prototype,"_filterSVGenesTableByCancerGenes",void 0),Ie([l.observable],Re.prototype,"_filterCNAGenesTableByCancerGenes",void 0),Ie([l.action.bound],Re.prototype,"updateMutatedGenesTableByCancerGenesFilter",null),Ie([l.action.bound],Re.prototype,"updateSVGenesTableByCancerGenesFilter",null),Ie([l.action.bound],Re.prototype,"updateCNAGenesTableByCancerGenesFilter",null),Ie([l.computed],Re.prototype,"filterMutatedGenesTableByCancerGenes",null),Ie([l.computed],Re.prototype,"filterSVGenesTableByCancerGenes",null),Ie([l.computed],Re.prototype,"filterCNAGenesTableByCancerGenes",null),Ie([l.action],Re.prototype,"updateComparisonGroupsFilter",null),Ie([l.observable],Re.prototype,"_customCharts",void 0),Ie([l.observable],Re.prototype,"_geneSpecificChartMap",void 0),Ie([l.observable],Re.prototype,"_geneSpecificCharts",void 0),Ie([l.observable],Re.prototype,"_genericAssayChartMap",void 0),Ie([l.observable],Re.prototype,"_genericAssayCharts",void 0),Ie([l.observable],Re.prototype,"_customChartsSelectedCases",void 0),Ie([l.observable],Re.prototype,"customChartSet",void 0),Ie([l.observable],Re.prototype,"_newlyCreatedCustomChartSet",void 0),Ie([l.action.bound],Re.prototype,"swapXvsYChartAxes",null),Ie([l.action.bound],Re.prototype,"onCheckGene",null),Ie([l.action.bound],Re.prototype,"isSharedCustomData",null),Ie([l.computed],Re.prototype,"selectedGenes",null),Ie([l.action.bound],Re.prototype,"updateSelectedGenes",null),Ie([l.computed],Re.prototype,"alterationTypesInOQL",null),Ie([l.computed],Re.prototype,"defaultProfilesForOql",null),Ie([l.computed],Re.prototype,"defaultMutationProfile",null),Ie([l.computed],Re.prototype,"defaultStructuralVariantProfile",null),Ie([l.computed],Re.prototype,"defaultCnaProfile",null),Ie([l.computed],Re.prototype,"defaultMrnaProfile",null),Ie([l.computed],Re.prototype,"defaultProtProfile",null),Ie([l.action.bound],Re.prototype,"clearAllFilters",null),Ie([l.computed],Re.prototype,"analysisGroupsSettings",null),Ie([l.action.bound],Re.prototype,"updateClinicalDataIntervalFilters",null),Ie([l.action.bound],Re.prototype,"updateClinicalDataFilterByValues",null),Ie([l.action.bound],Re.prototype,"updateClinicalAttributeFilterByValues",null),Ie([l.action.bound],Re.prototype,"updateClinicalDataCustomIntervalFilter",null),Ie([l.action.bound],Re.prototype,"setCustomChartFilters",null),Ie([l.action.bound],Re.prototype,"updateGenomicDataIntervalFilters",null),Ie([l.action.bound],Re.prototype,"updateGenericAssayDataFilters",null),Ie([l.action.bound],Re.prototype,"updateCategoricalGenericAssayDataFilters",null),Ie([l.action.bound],Re.prototype,"updateScatterPlotFilterByValues",null),Ie([l.action.bound],Re.prototype,"addGeneFilters",null),Ie([l.action.bound],Re.prototype,"updateGenomicDataIntervalFiltersByValues",null),Ie([l.action.bound],Re.prototype,"updateGenericAssayDataFiltersByValues",null),Ie([l.action.bound],Re.prototype,"addGenomicProfilesFilter",null),Ie([l.action.bound],Re.prototype,"addCaseListsFilter",null),Ie([l.action.bound],Re.prototype,"removeGeneFilter",null),Ie([l.action.bound],Re.prototype,"resetGeneFilter",null),Ie([l.action.bound],Re.prototype,"removeGenomicProfileFilter",null),Ie([l.action.bound],Re.prototype,"removeCaseListsFilter",null),Ie([l.action.bound],Re.prototype,"updateChartSampleIdentifierFilter",null),Ie([l.action],Re.prototype,"changeChartVisibility",null),Ie([l.action],Re.prototype,"resetFilterAndChangeChartVisibility",null),Ie([l.action.bound],Re.prototype,"removeComparisonGroupSelectionFilter",null),Ie([l.action.bound],Re.prototype,"removeCustomSelectFilter",null),Ie([l.action],Re.prototype,"toggleLogScale",null),Ie([l.action.bound],Re.prototype,"updateCustomBins",null),Ie([l.action],Re.prototype,"addCharts",null),Ie([l.action],Re.prototype,"updateChartsVisibility",null),Ie([l.computed],Re.prototype,"clinicalDataFilters",null),Ie([l.computed],Re.prototype,"customDataFilters",null),Ie([l.computed],Re.prototype,"geneFilters",null),Ie([l.computed],Re.prototype,"genomicDataIntervalFilters",null),Ie([l.computed],Re.prototype,"genericAssayDataFilters",null),Ie([l.computed],Re.prototype,"filters",null),Ie([l.computed],Re.prototype,"userSelections",null),Ie([m.default],Re.prototype,"getClinicalDataFiltersByUniqueKey",null),Ie([m.default],Re.prototype,"getGenomicDataIntervalFiltersByUniqueKey",null),Ie([m.default],Re.prototype,"getGenericAssayDataFiltersByUniqueKey",null),Ie([l.computed],Re.prototype,"unfilteredAttrsForNonNumerical",null),Ie([l.computed],Re.prototype,"unfilteredCustomAttrsForNonNumerical",null),Ie([l.computed],Re.prototype,"newlyAddedUnfilteredAttrsForNonNumerical",null),Ie([l.computed],Re.prototype,"newlyAddedUnfilteredAttrsForNumerical",null),Ie([l.computed],Re.prototype,"unfilteredAttrsForNumerical",null),Ie([l.action.bound],Re.prototype,"hideChart",null),Ie([m.default],Re.prototype,"getClinicalDataBin",null),Ie([m.default],Re.prototype,"getGenomicChartDataBin",null),Ie([m.default],Re.prototype,"getGenericAssayChartDataBin",null),Ie([l.computed],Re.prototype,"isSingleNonVirtualStudyQueried",null),Ie([l.computed],Re.prototype,"showOriginStudiesInSummaryDescription",null),Ie([l.computed],Re.prototype,"hasCnaProfileData",null),Ie([(0,l.computed)({keepAlive:!0})],Re.prototype,"oncokbCancerGeneFilterEnabled",null),Ie([l.computed],Re.prototype,"isSingleVirtualStudyPageWithoutFilter",null),Ie([l.computed],Re.prototype,"analysisGroupsPossible",null),Ie([l.computed],Re.prototype,"survivalPlotKeys",null),Ie([m.default],Re.prototype,"isChartNameValid",null),Ie([m.default],Re.prototype,"getDefaultCustomChartName",null),Ie([l.action.bound],Re.prototype,"addCustomChart",null),Ie([l.action.bound],Re.prototype,"addXvsYScatterChart",null),Ie([l.action.bound],Re.prototype,"addXvsYViolinChart",null),Ie([l.action.bound],Re.prototype,"addGeneSpecificCharts",null),Ie([l.action.bound],Re.prototype,"addGenericAssayContinuousCharts",null),Ie([l.action.bound],Re.prototype,"addGenericAssayBinaryOrCategoricalCharts",null),Ie([l.action.bound],Re.prototype,"updateCustomSelect",null),Ie([l.computed],Re.prototype,"chartMetaSet",null),Ie([l.computed],Re.prototype,"chartMetaSetWithChartType",null),Ie([l.computed],Re.prototype,"visibleAttributes",null),Ie([l.computed],Re.prototype,"showSettingRestoreMsg",null),Ie([l.computed],Re.prototype,"isSavingUserSettingsPossible",null),Ie([l.computed],Re.prototype,"loadingInitialDataForSummaryTab",null),Ie([l.computed],Re.prototype,"currentChartSettingsMap",null),Ie([l.action.bound],Re.prototype,"clearPageChartSettings",null),Ie([l.action.bound],Re.prototype,"loadUserChartSettings",null),Ie([l.action.bound],Re.prototype,"updateCustomDataList",null),Ie([l.action.bound],Re.prototype,"undoUserChartSettings",null),Ie([l.observable],Re.prototype,"_defaultChartsDimension",void 0),Ie([l.observable],Re.prototype,"_defaultChartsType",void 0),Ie([l.observable],Re.prototype,"_defaultVisibleChartIds",void 0),Ie([l.observable],Re.prototype,"_defaultClinicalDataBinFilterSet",void 0),Ie([l.computed],Re.prototype,"_defaultXvsYChartMap",null),Ie([l.action.bound],Re.prototype,"resetToDefaultChartSettings",null),Ie([l.computed],Re.prototype,"showResetToDefaultButton",null),Ie([l.computed],Re.prototype,"defaultChartSettingsMap",null),Ie([l.action.bound],Re.prototype,"loadChartSettings",null),Ie([l.action.bound],Re.prototype,"updateChartStats",null),Ie([l.action],Re.prototype,"initializeChartStatsByClinicalAttributes",null),Ie([l.action.bound],Re.prototype,"changeChartType",null),Ie([l.action],Re.prototype,"initializeClinicalDataCountCharts",null),Ie([l.action],Re.prototype,"initializeGeneSpecificCharts",null),Ie([l.action],Re.prototype,"initializeGenericAssayCharts",null),Ie([l.action],Re.prototype,"initializeClinicalDataBinCountCharts",null),Ie([l.computed],Re.prototype,"chartsAreFiltered",null),Ie([l.observable],Re.prototype,"blockLoading",void 0),Ie([l.computed],Re.prototype,"hasFilteredSamples",null),Ie([l.computed],Re.prototype,"hasSampleIdentifiersInFilter",null),Ie([l.computed],Re.prototype,"selectedSamplesMap",null),Ie([l.computed],Re.prototype,"selectedPatients",null),Ie([l.computed],Re.prototype,"molecularProfileMapByType",null),Ie([l.computed],Re.prototype,"clinicalDataDownloadFilename",null),Ie([l.computed],Re.prototype,"downloadFilenamePrefix",null),Ie([m.default],Re.prototype,"getDownloadDataPromise",null),Ie([m.default],Re.prototype,"onSubmitQuery",null),Ie([l.action],Re.prototype,"showAsPieChart",null),Ie([l.computed],Re.prototype,"isMixedReferenceGenome",null),Ie([l.observable],Re.prototype,"_patientTreatmentsFilter",void 0),Ie([l.observable],Re.prototype,"_sampleTreatmentsFilters",void 0),Ie([l.observable],Re.prototype,"_patientTreatmentGroupsFilter",void 0),Ie([l.observable],Re.prototype,"_sampleTreatmentGroupsFilters",void 0),Ie([l.observable],Re.prototype,"_patientTreatmentTargetFilter",void 0),Ie([l.observable],Re.prototype,"_sampleTreatmentTargetFilters",void 0),Ie([l.computed],Re.prototype,"patientTreatmentTargetFilters",null),Ie([l.computed],Re.prototype,"sampleTreatmentTargetFilters",null),Ie([l.computed],Re.prototype,"patientTreatmentGroupFilters",null),Ie([l.computed],Re.prototype,"sampleTreatmentGroupFilters",null),Ie([l.computed],Re.prototype,"patientTreatmentFilters",null),Ie([l.computed],Re.prototype,"sampleTreatmentFilters",null),Ie([l.computed],Re.prototype,"sampleTreatmentFiltersAsStrings",null),Ie([l.computed],Re.prototype,"patientTreatmentFiltersAsStrings",null),Ie([l.computed],Re.prototype,"sampleTreatmentGroupFiltersAsStrings",null),Ie([l.computed],Re.prototype,"patientTreatmentGroupFiltersAsStrings",null),Ie([l.computed],Re.prototype,"sampleTreatmentTargetFiltersAsStrings",null),Ie([l.computed],Re.prototype,"patientTreatmentTargetFiltersAsStrings",null),Ie([l.action],Re.prototype,"clearPatientTreatmentFilters",null),Ie([l.action],Re.prototype,"setPatientTreatmentFilters",null),Ie([l.action],Re.prototype,"addPatientTreatmentFilters",null),Ie([l.action],Re.prototype,"clearSampleTreatmentFilters",null),Ie([l.action],Re.prototype,"setSampleTreatmentFilters",null),Ie([l.action],Re.prototype,"addSampleTreatmentFilters",null),Ie([l.action],Re.prototype,"setTreatmentFilters",null),Ie([l.action],Re.prototype,"clearPatientTreatmentTargetFilters",null),Ie([l.action],Re.prototype,"setPatientTreatmentTargetFilters",null),Ie([l.action],Re.prototype,"addPatientTreatmentTargetFilters",null),Ie([l.action],Re.prototype,"clearSampleTreatmentTargetFilters",null),Ie([l.action],Re.prototype,"setSampleTreatmentTargetFilters",null),Ie([l.action],Re.prototype,"addSampleTreatmentTargetFilters",null),Ie([l.action],Re.prototype,"clearPatientTreatmentGroupFilters",null),Ie([l.action],Re.prototype,"setPatientTreatmentGroupFilters",null),Ie([l.action],Re.prototype,"addPatientTreatmentGroupFilters",null),Ie([l.action],Re.prototype,"clearSampleTreatmentGroupFilters",null),Ie([l.action],Re.prototype,"setSampleTreatmentGroupFilters",null),Ie([l.action],Re.prototype,"addSampleTreatmentGroupFilters",null),Ie([l.action.bound],Re.prototype,"onTreatmentSelection",null),Ie([l.action.bound],Re.prototype,"removeTreatmentsFilter",null),Ie([l.computed],Re.prototype,"isGlobalMutationFilterActive",null),Ie([l.computed],Re.prototype,"isGlobalAlterationFilterActive",null),Ie([l.computed],Re.prototype,"isTiersFilterActive",null),Ie([l.computed],Re.prototype,"isAnnotationsFilterActive",null),Ie([l.computed],Re.prototype,"isStatusFilterActive",null),Ie([l.computed],Re.prototype,"doShowDriverAnnotationSectionInGlobalMenu",null),Ie([l.computed],Re.prototype,"doShowTierAnnotationSectionInGlobalMenu",null);var Ge=r(96877),Me=r(36903),Fe=r(6240),Le=r(59280),xe=r(54721),Be=r(22680);function je(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ue(e,t){return!t||"object"!==ze(t)&&"function"!=typeof t?qe(e):t}function qe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ke(e){return(Ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function We(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ye(e,t)}function Ye(e,t){return(Ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ze(e){return(ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var He=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":ze(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},Ze=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))},Xe=function(e){function t(){return Ve(this,t),Ue(this,Ke(t).apply(this,arguments))}return We(t,e),t}(Fe.ZP),Qe=function(e){function t(){var e;return Ve(this,t),e=Ue(this,Ke(t).apply(this,arguments)),Object.defineProperty(qe(e),"columns",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({invoke:function(){return Ze(qe(e),void 0,void 0,regeneratorRuntime.mark((function e(){var t,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[Object.assign(Object.assign({},this.getDefaultColumnConfig("patientId","Patient ID")),{render:function(e){return n.createElement("a",{href:(0,P.WU)(e.studyId,e.patientId),target:"_blank"},e.patientId)}}),Object.assign(Object.assign({},this.getDefaultColumnConfig("sampleId","Sample ID")),{render:function(e){return n.createElement("a",{href:(0,P.Qk)(e.studyId,e.sampleId),target:"_blank"},e.sampleId)}})],void 0!==o().find(this.props.store.visibleAttributes,(function(e){return e.uniqueKey===f.h_.CANCER_STUDIES}))&&t.push(Object.assign({},this.getDefaultColumnConfig("studyId","Cancer Study"))),e.abrupt("return",o().reduce(this.props.store.visibleAttributes.sort(f.HD),(function(e,t,n){return void 0!==t.clinicalAttribute&&e.push(Object.assign(Object.assign({},r.getDefaultColumnConfig((0,f.PG)(t.clinicalAttribute),t.clinicalAttribute.displayName,t.clinicalAttribute.datatype===f.g.NUMBER)),{tooltip:(0,f.ZY)(t.clinicalAttribute.displayName,t.description?t.description:"",t.clinicalAttribute?t.clinicalAttribute.clinicalAttributeId:void 0)})),e}),t));case 3:case"end":return e.stop()}}),e,this)})))},default:[]})}),e}var r,i,a;return We(t,e),r=t,(i=[{key:"getDefaultColumnConfig",value:function(e,t,r){return{name:t||"",headerRender:function(e){return n.createElement("span",{"data-test":e},e)},render:function(t){return(0,_.CB)(t[e])?n.createElement("a",{href:t[e],target:"_blank"},t[e]):n.createElement("span",{"data-test":t[e]},t[e])},download:function(t){return t[e]||""},sortBy:function(t){return t[e]?r?parseFloat(t[e]):t[e]:null},filter:function(t,r,n){return(t[e]||"").toUpperCase().includes(n)}}}},{key:"getProgressItems",value:function(e){return[{label:"Loading clinical data"+(e>2?" - this can take several seconds":""),promises:[this.props.store.getDataForClinicalDataTab]}]}},{key:"render",value:function(){return n.createElement("span",{"data-test":"clinical-data-tab-content"},n.createElement(Be.z,{offset:60},n.createElement(Le.If,{condition:this.columns.isPending||this.props.store.getDataForClinicalDataTab.isPending},n.createElement(Le.Then,null,n.createElement(Me.Z,{isLoading:this.columns.isPending||this.props.store.getDataForClinicalDataTab.isPending,size:"big",center:!0},n.createElement(xe.Z,{getItems:this.getProgressItems,show:this.columns.isPending||this.props.store.getDataForClinicalDataTab.isPending}))),n.createElement(Le.Else,null,n.createElement(Xe,{initialItemsPerPage:20,showCopyDownload:!0,showColumnVisibility:!1,data:this.props.store.getDataForClinicalDataTab.result||[],columns:this.columns.result,copyDownloadProps:{showCopy:!1,downloadFilename:this.props.store.clinicalDataDownloadFilename}})))))}}])&&je(r.prototype,i),a&&je(r,a),t}(n.Component);He([m.default],Qe.prototype,"getProgressItems",null),Qe=He([a.observer],Qe);var $e=r(14069),Je=r(14406),et=r(2028),tt=r.n(et),rt=r(31821),nt=r.n(rt),it=r(70956),ot=r.n(it),at=r(76127),st=r.n(at),lt=r(12758),ut=r(79280);function ct(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function pt(e){return(pt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function dt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ht(e,t){return(ht=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ft(e){return(ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var mt=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":ft(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},yt=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==ft(t)&&"function"!=typeof t?dt(e):t}(this,pt(t).call(this,e)),Object.defineProperty(dt(r),"binSeparator",{enumerable:!0,configurable:!0,writable:!0,value:","}),Object.defineProperty(dt(r),"currentBinsValue",{enumerable:!0,configurable:!0,writable:!0,value:""}),(0,l.makeObservable)(dt(r)),r.props.currentBins&&(r.currentBinsValue=o().sortBy(r.props.currentBins).join("".concat(r.binSeparator," "))),r}var r,i,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ht(e,t)}(t,e),r=t,(i=[{key:"updateCurrentBinsValue",value:function(){var e=o().sortBy(this.newStringBins.map((function(e){return Number(e.trim())})));this.currentBinsValue=e.join("".concat(this.binSeparator," ")),this.props.updateCustomBins(this.props.chartMeta.uniqueKey,e),this.props.onHide()}},{key:"render",value:function(){var e=this;return n.createElement(ut.Modal,{bsSize:"small",show:this.props.show,onHide:this.props.onHide,keyboard:!0},n.createElement(ut.Modal.Header,{closeButton:!0},n.createElement(ut.Modal.Title,null,"Custom Bins")),n.createElement(ut.Modal.Body,null,n.createElement("div",null,"Please specify bin boundaries of the x axis"),n.createElement("textarea",{style:{resize:"none"},rows:5,value:this.currentBinsValue,className:"form-control input-sm",onChange:function(t){return e.currentBinsValue=t.currentTarget.value}}),!this.contentIsValid&&n.createElement("div",{className:"alert alert-danger",role:"alert",style:{marginTop:"10px",marginBottom:"0"}},"Invalid bins")),n.createElement(ut.Modal.Footer,null,n.createElement("button",{className:"btn btn-primary btn-sm",onClick:this.updateCurrentBinsValue,disabled:!this.contentIsValid,style:{marginTop:"10px",marginBottom:"0"}},"Update")))}},{key:"newStringBins",get:function(){return this.currentBinsValue.trim().split(this.binSeparator)}},{key:"contentIsValid",get:function(){return(0,f.VX)(this.newStringBins)}}])&&ct(r.prototype,i),a&&ct(r,a),t}(n.Component);mt([l.observable],yt.prototype,"currentBinsValue",void 0),mt([m.default],yt.prototype,"updateCurrentBinsValue",null),mt([l.computed],yt.prototype,"newStringBins",null),mt([l.computed],yt.prototype,"contentIsValid",null);const bt=yt=mt([a.observer],yt);const gt=function(e){var t=e.width,i=e.style,o=e.className;return n.createElement("img",{src:r(80440),className:o||"",style:Object.assign({width:t,border:"1px solid black",padding:2},i||{})})};function vt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function St(e){return(St=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ct(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Tt(e,t){return(Tt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Et(e){return(Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var wt=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":Et(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},At=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==Et(t)&&"function"!=typeof t?Ct(e):t}(this,St(t).call(this,e)),Object.defineProperty(Ct(r),"menuOpen",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Ct(r),"downloadSubmenuOpen",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Ct(r),"comparisonSubmenuOpen",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Ct(r),"showCustomBinModal",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Ct(r),"closeMenuTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),(0,l.makeObservable)(Ct(r)),r}var r,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tt(e,t)}(t,e),r=t,(i=[{key:"openMenu",value:function(){this.menuOpen=!0,window.clearTimeout(this.closeMenuTimeout),this.closeMenuTimeout=void 0}},{key:"closeMenu",value:function(){var e=this;this.closeMenuTimeout||(this.closeMenuTimeout=window.setTimeout((function(){e.menuOpen=!1,e.closeMenuTimeout=void 0}),125))}},{key:"render",value:function(){return n.createElement("div",{className:st()(nt().header,"chartHeader"),style:{position:"relative",height:"".concat(this.props.height,"px"),lineHeight:"".concat(this.props.height,"px")}},n.createElement("div",{className:st()(nt().name,nt().draggable)},!this.props.hideLabel&&n.createElement("span",{className:"chartTitle"},this.props.title)),this.active&&n.createElement("div",{className:st()(nt().controls,"controls")},n.createElement("div",{className:"btn-group"},n.createElement(Le.If,{condition:!!this.props.description},n.createElement(_.ZD,{mouseEnterDelay:0,trigger:["hover"],placement:this.tooltipPosition,align:this.tooltipAlign,overlay:(0,f.ZY)(this.props.title,this.props.description?this.props.description.description:"",this.props.chartMeta.uniqueKey),destroyTooltipOnHide:!0},n.createElement("div",{className:st()("btn btn-xs btn-default",nt().item)},n.createElement("i",{className:st()("fa fa-xs fa-fw","fa-info-circle"),"aria-hidden":"true"})))),n.createElement(Le.If,{condition:!!this.props.chartMeta.clinicalAttribute||!!this.props.chartMeta.description},n.createElement(_.ZD,{mouseEnterDelay:0,trigger:["hover"],placement:this.tooltipPosition,align:this.tooltipAlign,overlay:(0,f.ZY)(this.props.chartMeta.displayName,this.props.chartMeta.description,this.props.chartMeta.clinicalAttribute?this.props.chartMeta.clinicalAttribute.clinicalAttributeId:void 0),destroyTooltipOnHide:!0},n.createElement("div",{className:st()("btn btn-xs btn-default",nt().item)},n.createElement("i",{className:st()("fa fa-xs fa-fw","fa-info-circle"),"aria-hidden":"true"})))),n.createElement(Le.If,{condition:this.props.chartControls&&!!this.props.chartControls.showResetIcon},n.createElement(_.ZD,{placement:this.tooltipPosition,align:this.tooltipAlign,overlay:n.createElement("span",null,"Reset filters in chart"),destroyTooltipOnHide:!0},n.createElement("button",{className:st()("btn btn-xs btn-default",nt().item),onClick:this.props.resetChart},n.createElement("i",{className:st()("fa fa-xs fa-fw","fa-undo",nt().undo,nt().clickable),"aria-hidden":"true"})))),n.createElement(_.ZD,{placement:this.tooltipPosition,align:this.tooltipAlign,overlay:n.createElement("span",null,"Delete chart")},n.createElement("button",{className:st()("btn btn-xs btn-default",nt().item),"data-test":"deleteChart",onClick:this.props.deleteChart},n.createElement("i",{className:st()("fa fa-xs fa-fw","fa-times",nt().clickable),"aria-hidden":"true"}))),this.menuItems.length>0&&n.createElement("div",{onMouseEnter:this.openMenu,onMouseLeave:this.closeMenu,"data-test":"chart-header-hamburger-icon",className:st()("dropdown btn-group",{show:this.menuOpen})},n.createElement("button",{className:st()("btn btn-xs btn-default dropdown-toggle",{active:this.menuOpen})},n.createElement("i",{className:st()("fa fa-xs fa-fw fa-bars")})),n.createElement("ul",{"data-test":"chart-header-hamburger-icon-menu",className:st()("dropdown-menu pull-right",{show:this.menuOpen}),style:{width:"190px"}},this.menuItems)))),this.active&&n.createElement("div",{style:{position:"absolute",top:2,right:2}}))}},{key:"fileName",get:function(){return this.props.chartMeta.displayName.replace(/[ \t]/g,"_")}},{key:"active",get:function(){return this.menuOpen||this.props.active}},{key:"comparisonButton",get:function(){var e,t,r,i=this;switch(this.props.chartType){case A.oV.BAR_CHART:return n.createElement("div",{className:st()("dropdown-item",nt().dropdownHoverEffect),style:{display:"flex",justifyContent:"space-between",padding:"3px 20px"},onMouseEnter:function(){return i.comparisonSubmenuOpen=!0},onMouseLeave:function(){return i.comparisonSubmenuOpen=!1}},n.createElement("div",{style:{display:"flex",alignItems:"center"}},n.createElement(gt,{className:st()("fa fa-fw",nt().menuItemIcon)}),n.createElement("span",null,"Compare Groups")),n.createElement("i",{className:"fa fa-xs fa-fw fa-caret-right",style:{lineHeight:"inherit"}}),this.comparisonSubmenuOpen&&n.createElement("ul",{className:st()("dropdown-menu",{show:this.comparisonSubmenuOpen}),style:{top:0,margin:"-6px 0",left:"left"===this.props.placement?-120:"100%",minWidth:120}},n.createElement("li",null,n.createElement("a",{className:"dropdown-item",onClick:function(){i.props.openComparisonPage({categorizationType:f.BX.QUARTILES})}},"Quartiles")),n.createElement("li",null,n.createElement("a",{className:"dropdown-item",onClick:function(){i.props.openComparisonPage({categorizationType:f.BX.MEDIAN})}},"Median")),n.createElement("li",null,n.createElement("a",{className:"dropdown-item",onClick:function(){return i.props.openComparisonPage({categorizationType:f.BX.BINS})}},"Current bins"))));case A.oV.MUTATED_GENES_TABLE:case A.oV.CNA_GENES_TABLE:case A.oV.STRUCTURAL_VARIANT_GENES_TABLE:case A.oV.SAMPLE_TREATMENT_GROUPS_TABLE:case A.oV.SAMPLE_TREATMENTS_TABLE:case A.oV.PATIENT_TREATMENT_GROUPS_TABLE:case A.oV.PATIENT_TREATMENTS_TABLE:return n.createElement("a",{className:st()("dropdown-item",(e={},t=nt().disabledMenuItem,r=this.props.selectedRowsKeys.length<2,t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e)),onClick:function(){i.props.selectedRowsKeys.length>=2&&i.props.openComparisonPage(ye(i.props.selectedRowsKeys,i.props.chartType))},style:{display:"flex",alignItems:"center"}},n.createElement(gt,{className:st()("fa fa-fw",nt().menuItemIcon)}),"Compare Groups");default:return n.createElement("a",{className:"dropdown-item",onClick:function(){return i.props.openComparisonPage({})},style:{display:"flex",alignItems:"center"}},n.createElement(gt,{className:st()("fa fa-fw",nt().menuItemIcon)}),"Compare Groups")}}},{key:"menuItems",get:function(){var e=this,t=[];return this.props.chartControls&&this.props.chartControls.showLogScaleToggle&&this.props.toggleLogScale&&t.push(n.createElement("li",null,n.createElement("a",{className:"dropdown-item logScaleCheckbox",onClick:this.props.toggleLogScale},n.createElement(lt.Z,{checked:!(!this.props.chartControls||!this.props.chartControls.logScaleChecked),label:n.createElement("span",{style:{marginTop:-3}},"Log Scale"),style:{marginTop:1,marginBottom:-3}})))),this.props.chartControls&&this.props.chartControls.showSwapAxes&&this.props.swapAxes&&t.push(n.createElement("li",null,n.createElement("a",{className:"dropdown-item","data-test":"swapAxes",onClick:this.props.swapAxes},n.createElement("i",{className:"fa fa-arrow-up"})," Swap Axes ",n.createElement("i",{className:"fa fa-arrow-down"})))),this.props.chartControls&&this.props.chartControls.showLogScaleXToggle&&this.props.toggleLogScaleX&&t.push(n.createElement("li",null,n.createElement("a",{className:"dropdown-item logScaleCheckbox",onClick:this.props.toggleLogScaleX},n.createElement(lt.Z,{checked:!(!this.props.chartControls||!this.props.chartControls.logScaleXChecked),label:n.createElement("span",{style:{marginTop:-3}},"Log Scale X"),style:{marginTop:1,marginBottom:-3}})))),this.props.chartControls&&this.props.chartControls.showLogScaleYToggle&&this.props.toggleLogScaleY&&t.push(n.createElement("li",null,n.createElement("a",{className:"dropdown-item logScaleCheckbox",onClick:this.props.toggleLogScaleY},n.createElement(lt.Z,{checked:!(!this.props.chartControls||!this.props.chartControls.logScaleYChecked),label:n.createElement("span",{style:{marginTop:-3}},"Log Scale Y"),style:{marginTop:1,marginBottom:-3}})))),this.props.chartControls&&this.props.chartControls.showViolinPlotToggle&&this.props.toggleViolinPlot&&t.push(n.createElement("li",null,n.createElement("a",{className:"dropdown-item violinCheckbox",onClick:this.props.toggleViolinPlot},n.createElement(lt.Z,{checked:!(!this.props.chartControls||!this.props.chartControls.violinPlotChecked),label:n.createElement("span",{style:{marginTop:-3}},"Show Violin Plot"),style:{marginTop:1,marginBottom:-3}})))),this.props.chartControls&&this.props.chartControls.showBoxPlotToggle&&this.props.toggleBoxPlot&&t.push(n.createElement("li",null,n.createElement("a",{className:"dropdown-item violinCheckbox",onClick:this.props.toggleBoxPlot},n.createElement(lt.Z,{checked:!(!this.props.chartControls||!this.props.chartControls.boxPlotChecked),label:n.createElement("span",{style:{marginTop:-3}},"Show Box Plot"),style:{marginTop:1,marginBottom:-3}})))),this.props.chartControls&&this.props.chartControls.showTableIcon&&t.push(n.createElement("li",null,n.createElement("a",{className:"dropdown-item",onClick:function(){return e.props.changeChartType(A.oV.TABLE)}},n.createElement("i",{className:st()("fa fa-xs fa-fw","fa-table",nt().menuItemIcon),"aria-hidden":"true"}),"Show Table"))),this.props.chartControls&&this.props.chartControls.showPieIcon&&t.push(n.createElement("li",null,n.createElement("a",{className:"dropdown-item",onClick:function(){return e.props.changeChartType(A.oV.PIE_CHART)}},n.createElement("i",{className:st()("fa fa-xs fa-fw","fa-pie-chart",nt().menuItemIcon),"aria-hidden":"true"}),"Show Pie"))),this.props.chartControls&&this.props.chartControls.showComparisonPageIcon&&t.push(n.createElement("li",{style:{position:"relative"}},this.comparisonButton)),this.props.chartType===A.oV.BAR_CHART&&(t.push(n.createElement("li",null,n.createElement("a",{className:"dropdown-item",onClick:function(){return e.showCustomBinModal=!0}},n.createElement("i",{className:st()("fa fa-xs fa-fw","fa-bar-chart",nt().menuItemIcon),"aria-hidden":"true"}),"Custom Bins"),n.createElement(bt,{show:this.showCustomBinModal,onHide:function(){return e.showCustomBinModal=!1},chartMeta:this.props.chartMeta,currentBins:this.props.store.getCurrentBins(this.props.chartMeta),updateCustomBins:this.props.store.updateCustomBins}))),this.props.chartControls&&this.props.chartControls.showNAToggle&&this.props.toggleNAValue&&t.push(n.createElement("li",null,n.createElement("a",{className:"dropdown-item",onClick:this.props.toggleNAValue},n.createElement(lt.Z,{checked:!(!this.props.chartControls||!this.props.chartControls.isShowNAChecked),label:n.createElement("span",{style:{marginTop:-3}},"Show NA"),style:{marginTop:1,marginBottom:-3}}))))),this.props.chartControls&&this.props.downloadTypes&&this.props.downloadTypes.length>0&&t.push(n.createElement("li",{style:{position:"relative"}},n.createElement("div",{className:st()("dropdown-item",nt().dropdownHoverEffect),style:{display:"flex",justifyContent:"space-between",padding:"3px 20px"},onMouseEnter:function(){return e.downloadSubmenuOpen=!0},onMouseLeave:function(){return e.downloadSubmenuOpen=!1}},n.createElement("div",null,n.createElement("i",{className:st()("fa fa-xs","fa-download",nt().menuItemIcon),"aria-hidden":"true"}),n.createElement("span",null,"Download")),n.createElement("i",{className:"fa fa-xs fa-fw fa-caret-right",style:{lineHeight:"inherit"}}),this.downloadSubmenuOpen&&n.createElement(_.t_,{filename:this.fileName,buttons:this.props.downloadTypes,getSvg:this.props.getSVG,getData:this.props.getData,type:"dropdown",className:st()({show:this.downloadSubmenuOpen}),style:{top:0,margin:"-6px 0",left:"left"===this.props.placement?-70:"100%",minWidth:70},dontFade:!0})))),t}},{key:"tooltipPosition",get:function(){return"left"==this.props.placement?"topRight":"top"}},{key:"tooltipAlign",get:function(){return"left"==this.props.placement?{offset:[0,-6]}:void 0}}])&&vt(r.prototype,i),o&&vt(r,o),t}(n.Component);wt([l.observable],At.prototype,"menuOpen",void 0),wt([l.observable],At.prototype,"downloadSubmenuOpen",void 0),wt([l.observable],At.prototype,"comparisonSubmenuOpen",void 0),wt([l.observable],At.prototype,"showCustomBinModal",void 0),wt([l.computed],At.prototype,"fileName",null),wt([l.action.bound],At.prototype,"openMenu",null),wt([l.action.bound],At.prototype,"closeMenu",null),wt([l.computed],At.prototype,"active",null),wt([l.computed],At.prototype,"comparisonButton",null),wt([l.computed],At.prototype,"menuItems",null),wt([l.computed],At.prototype,"tooltipPosition",null),wt([l.computed],At.prototype,"tooltipAlign",null),At=wt([a.observer],At);var Pt=r(49572),_t=r(99666),It=r(78448);function Ot(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Dt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Nt(e,t){return!t||"object"!==Lt(t)&&"function"!=typeof t?Rt(e):t}function Rt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Gt(e){return(Gt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Mt(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ft(e,t)}function Ft(e,t){return(Ft=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Lt(e){return(Lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var xt,Bt=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":Lt(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},jt=function(e){function t(){return Dt(this,t),Nt(this,Gt(t).apply(this,arguments))}return Mt(t,e),t}(It.Z);!function(e){e.CATEGORY="Category",e.NUMBER="#",e.FREQ="Freq"}(xt||(xt={}));var Vt=function(e){function t(e){var r;return Dt(this,t),r=Nt(this,Gt(t).call(this,e)),Object.defineProperty(Rt(r),"sortBy",{enumerable:!0,configurable:!0,writable:!0,value:A.Qo}),Object.defineProperty(Rt(r),"sortDirection",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),(0,l.makeObservable)(Rt(r)),r}var r,i,a;return Mt(t,e),r=t,(i=[{key:"onUserSelection",value:function(e){var t=(0,l.toJS)(this.props.filters);o().includes(t,e)?t=o().filter(t,(function(t){return t!==e})):t.push(e),this.props.onUserSelection(t)}},{key:"tooltipLabelMouseEnter",value:function(e){this.props.highlightedRow&&this.props.highlightedRow(e)}},{key:"tooltipLabelMouseLeave",value:function(){this.props.highlightedRow&&this.props.highlightedRow(void 0)}},{key:"addAll",value:function(e){this.props.onUserSelection(e.map((function(e){return e.value})))}},{key:"removeAll",value:function(e){var t=e.map((function(e){return e.value}));this.props.onUserSelection(this.props.filters.filter((function(e){return!t.includes(e)})))}},{key:"afterSorting",value:function(e,t){this.sortBy=e,this.sortDirection=t}},{key:"render",value:function(){return n.createElement(jt,{width:this.props.width,height:this.props.height,data:this.props.data||[],columns:this.columns,addAll:this.addAll,removeAll:this.removeAll,numberOfSelectedRows:this.props.filters.length,showAddRemoveAllButton:this.props.showAddRemoveAllButtons,extraButtons:this.extraButtons,sortBy:this.sortBy,sortDirection:this.sortDirection,afterSorting:this.afterSorting})}},{key:"columnsWidth",get:function(){var e,t=(0,f.C)(this.props.width-140);return Ot(e={},xt.CATEGORY,t),Ot(e,xt.NUMBER,80),Ot(e,xt.FREQ,60),e}},{key:"cellMargin",get:function(){var e;return Ot(e={},xt.CATEGORY,0),Ot(e,xt.NUMBER,0===this.props.data.length?0:(0,f.mA)((this.columnsWidth[xt.NUMBER]-10-((0,f.x2)(o().max(this.props.data.map((function(e){return e.count}))).toLocaleString())+20))/2)),Ot(e,xt.FREQ,0===this.props.data.length?0:(0,f.mA)((0,f.pt)(this.columnsWidth[xt.FREQ],o().sortBy(this.props.data,(function(e){return e.percentage}))[this.props.data.length-1].freq))),e}},{key:"firstColumnName",get:function(){return this.props.label?this.props.label:xt.CATEGORY}},{key:"columns",get:function(){var e=this;return[{name:this.firstColumnName,render:function(t){return n.createElement("div",{className:j().labelContent,onMouseEnter:function(r){e.tooltipLabelMouseEnter(t.value)},onMouseLeave:e.tooltipLabelMouseLeave},n.createElement("svg",{width:"18",height:"12",className:j().labelContentSVG},n.createElement("g",null,n.createElement("rect",{x:"0",y:"0",width:"12",height:"12",fill:t.color}))),n.createElement(_.CQ,{text:t.value}))},headerRender:function(){var t={},r=e.firstColumnName;return e.props.label||(t.opacity=0,r="."),n.createElement(_.CQ,{style:t,text:r,hideTooltip:!0})},tooltip:(0,f.ZY)(this.firstColumnName,this.props.labelDescription?this.props.labelDescription:""),filter:function(e,t,r){return e.value.toUpperCase().includes(r)},sortBy:function(e){return e.value},defaultSortDirection:"asc",width:this.columnsWidth[xt.CATEGORY]},{name:xt.NUMBER,headerRender:function(){return n.createElement("div",{style:{marginLeft:e.cellMargin[xt.NUMBER]}},"#")},render:function(t){return n.createElement(_t.Z,{checked:o().includes(e.props.filters,t.value),onChange:function(r){return e.onUserSelection(t.value)},labelProps:{style:{display:"flex",justifyContent:"space-between",marginLeft:e.cellMargin[xt.NUMBER],marginRight:e.cellMargin[xt.NUMBER]}},inputProps:{className:j().autoMarginCheckbox}},t.count.toLocaleString())},tooltip:n.createElement("span",null,"Number of"," ",this.props.patientAttribute?"patients":"samples"),filter:function(e,t){return e.count.toString().includes(t)},sortBy:function(e){return e.count},defaultSortDirection:"desc",width:this.columnsWidth[xt.NUMBER]},{name:xt.FREQ,headerRender:function(){return n.createElement("div",{style:{marginLeft:e.cellMargin[xt.FREQ]}},"Freq")},render:function(t){return n.createElement("span",{style:{flexDirection:"row-reverse",display:"flex",marginRight:e.cellMargin[xt.FREQ]}},t.freq)},tooltip:n.createElement("span",null,"Percentage of"," ",this.props.patientAttribute?"patients":"samples"),filter:function(e,t){return e.freq.includes(t)},sortBy:function(e){return e.percentage},defaultSortDirection:"desc",width:this.columnsWidth[xt.FREQ]}]}},{key:"selectedClinicalValues",get:function(){var e=o().keyBy(this.props.filters);return this.props.data.filter((function(t){return t.value in e}))}},{key:"extraButtons",get:function(){var e=this;return this.props.openComparisonPage?[{content:n.createElement("div",{style:{display:"flex",alignItems:"center"}},n.createElement(gt,{width:16,style:{marginRight:5}}),"Compare"),onClick:this.props.openComparisonPage,isDisabled:function(){return 1===e.selectedClinicalValues.length}}]:[]}}])&&kt(r.prototype,i),a&&kt(r,a),t}(n.Component);Object.defineProperty(Vt,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{width:300,showAddRemoveAllButtons:!1}}),Bt([l.observable],Vt.prototype,"sortBy",void 0),Bt([l.observable],Vt.prototype,"sortDirection",void 0),Bt([l.computed],Vt.prototype,"columnsWidth",null),Bt([l.computed],Vt.prototype,"cellMargin",null),Bt([l.computed],Vt.prototype,"firstColumnName",null),Bt([l.computed],Vt.prototype,"columns",null),Bt([m.default],Vt.prototype,"onUserSelection",null),Bt([m.default],Vt.prototype,"tooltipLabelMouseEnter",null),Bt([m.default],Vt.prototype,"tooltipLabelMouseLeave",null),Bt([m.default],Vt.prototype,"addAll",null),Bt([m.default],Vt.prototype,"removeAll",null),Bt([l.action.bound],Vt.prototype,"afterSorting",null),Bt([l.computed],Vt.prototype,"selectedClinicalValues",null),Bt([l.computed],Vt.prototype,"extraButtons",null);const Ut=Vt=Bt([a.observer],Vt);var qt=r(75508),Kt=r(60138);function Wt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Yt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function zt(e,t,r){return t&&Yt(e.prototype,t),r&&Yt(e,r),e}function Ht(e,t){return!t||"object"!==Jt(t)&&"function"!=typeof t?Xt(e):t}function Zt(e){return(Zt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Qt(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$t(e,t)}function $t(e,t){return($t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Jt(e){return(Jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var er=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":Jt(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},tr=function(e){function t(e){var r;return Wt(this,t),r=Ht(this,Zt(t).call(this,e)),Object.defineProperty(Xt(r),"svg",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Xt(r),"isTooltipHovered",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Xt(r),"tooltipHighlightedRow",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),(0,l.makeObservable)(Xt(r)),r}return Qt(t,e),zt(t,[{key:"onUserSelection",value:function(e){var t=(0,l.toJS)(this.filters);o().includes(t,e)?t=o().filter(t,(function(t){return t!==e})):t.push(e),this.props.onUserSelection(t)}},{key:"highlightedRow",value:function(e){this.tooltipHighlightedRow=e}},{key:"downloadData",value:function(){return this.props.data.map((function(e){return e.value+"\t"+e.count})).join("\n")}},{key:"toSVGDOMNode",value:function(){return(0,f.cJ)(this.svg,{legendGroupSelector:".studyViewPieChartLegend",chartGroupSelector:".studyViewPieChartGroup",centerLegend:!0})}},{key:"x",value:function(e){return e.value}},{key:"y",value:function(e){return e.count}},{key:"label",value:function(e){return e.count/this.totalCount>.5?e.count.toLocaleString():this.maxLength(e.count/this.totalCount,this.pieSliceRadius/3)<(0,_.mY)(e.count.toLocaleString(),_.Nv.axis.style.tickLabels.fontFamily,"".concat(_.Nv.axis.style.tickLabels.fontSize,"px"))?"":e.count.toLocaleString()}},{key:"maxLength",value:function(e,t){return Math.abs(Math.tan(Math.PI*e/2))*t*2}},{key:"render",value:function(){var e=this;return n.createElement(_.ZD,{placement:this.props.placement,overlay:n.createElement(Ut,{width:300,height:150,openComparisonPage:this.props.openComparisonPage,data:this.props.data,label:this.props.label,labelDescription:this.props.labelDescription,patientAttribute:this.props.patientAttribute,showAddRemoveAllButtons:!0,filters:this.filters,highlightedRow:this.highlightedRow,onUserSelection:this.props.onUserSelection}),destroyTooltipOnHide:!0,trigger:["hover"]},n.createElement("svg",{width:this.props.width,height:this.props.height,ref:function(t){return e.svg=t}},this.victoryPie,this.victoryLegend))}},{key:"filters",get:function(){var e=o().reduce(this.props.data,(function(e,t){return e[t.value.toLowerCase()]=t.value,e}),{});return this.props.filters.map((function(t){return e[t.toLowerCase()]||t}))}},{key:"userEvents",get:function(){return[{target:"data",eventHandlers:this.pieSliceOnClickEventHandlers},{target:"labels",eventHandlers:this.pieSliceOnClickEventHandlers}]}},{key:"pieSliceOnClickEventHandlers",get:function(){var e=this;return{onClick:function(){return[{target:"data",mutation:function(t){e.onUserSelection(t.datum.value)}}]}}}},{key:"totalCount",get:function(){return o().sumBy(this.props.data,(function(e){return e.count}))}},{key:"fill",get:function(){var e=this;return function(t){return o().isEmpty(e.filters)||o().includes(e.filters,t.value)?t.color:qt.pp}}},{key:"stroke",get:function(){var e=this;return function(t){return!o().isEmpty(e.filters)&&o().includes(e.filters,t.value)?"#cccccc":null}}},{key:"strokeWidth",get:function(){var e=this;return function(t){return!o().isEmpty(e.filters)&&o().includes(e.filters,t.value)?3:0}}},{key:"fillOpacity",get:function(){var e=this;return function(t){return o().isEmpty(e.filters)||o().includes(e.filters,t.value)?1:"0.5"}}},{key:"chartSize",get:function(){return Math.min(this.props.width,this.props.height)}},{key:"pieSliceRadius",get:function(){return(this.props.width>this.props.height?this.props.height:this.props.width)/2-A.$u.thresholds.piePadding}},{key:"victoryPie",get:function(){return n.createElement(Pt.VictoryPie,{standalone:!1,theme:_.Nv,containerComponent:n.createElement(Pt.VictoryContainer,{responsive:!1}),groupComponent:n.createElement("g",{className:"studyViewPieChartGroup",transform:"translate(0, -12)"}),width:this.props.width,height:this.chartSize,labelRadius:this.pieSliceRadius/3,radius:this.pieSliceRadius,labels:this.label,data:this.props.data,dataComponent:n.createElement(nr,null),labelComponent:n.createElement(Pt.VictoryLabel,null),events:this.userEvents,style:{data:{fill:(0,Kt.Z)(this.fill,"#cccccc"),stroke:(0,Kt.Z)(this.stroke,"0x000000"),strokeWidth:(0,Kt.Z)(this.strokeWidth,0),fillOpacity:(0,Kt.Z)(this.fillOpacity,1),cursor:"pointer"},labels:{fill:"white",cursor:"pointer"}},x:this.x,y:this.y})}},{key:"victoryLegend",get:function(){var e=this,t=this.props.data.map((function(t){return{name:"".concat(t.value,": ").concat(t.count," (").concat((0,f.jJ)(100*t.count/e.totalCount),")")}})),r=this.props.data.map((function(e){return e.color})),i=o().cloneDeep(_.Nv);return i.legend.style.data={type:"square",size:5,strokeWidth:0,stroke:"black"},n.createElement(Pt.VictoryLegend,{standalone:!1,theme:i,colorScale:r,x:0,y:this.props.height+1,rowGutter:-10,title:this.props.label||"Legend",centerTitle:!0,style:{title:{fontWeight:"bold"}},data:t,groupComponent:n.createElement("g",{className:"studyViewPieChartLegend"})})}}]),t}(n.Component);er([l.computed],tr.prototype,"filters",null),er([m.default],tr.prototype,"onUserSelection",null),er([l.observable],tr.prototype,"isTooltipHovered",void 0),er([l.observable],tr.prototype,"tooltipHighlightedRow",void 0),er([l.action.bound],tr.prototype,"highlightedRow",null),er([l.computed],tr.prototype,"totalCount",null),er([l.computed],tr.prototype,"fill",null),er([l.computed],tr.prototype,"stroke",null),er([l.computed],tr.prototype,"strokeWidth",null),er([l.computed],tr.prototype,"fillOpacity",null),er([m.default],tr.prototype,"x",null),er([m.default],tr.prototype,"y",null),er([m.default],tr.prototype,"label",null),er([l.computed],tr.prototype,"chartSize",null),er([l.computed],tr.prototype,"pieSliceRadius",null),er([l.computed],tr.prototype,"victoryPie",null),er([l.computed],tr.prototype,"victoryLegend",null);const rr=tr=er([a.observer],tr);var nr=function(e){function t(){return Wt(this,t),Ht(this,Zt(t).apply(this,arguments))}return Qt(t,e),zt(t,[{key:"render",value:function(){var e=this.props;return n.createElement("g",null,n.createElement(Pt.Slice,this.props),n.createElement("title",null,"".concat(e.datum.value,":").concat(e.datum.count)))}}]),t}(n.Component),ir=r(92955);function or(e){return(or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ar(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function lr(e,t){return!t||"object"!==or(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ur(e){return(ur=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function cr(e,t){return(cr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}const pr=function(e){function t(){return ar(this,t),lr(this,ur(t).apply(this,arguments))}var r,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cr(e,t)}(t,e),r=t,(i=[{key:"renderElements",value:function(e,t){var r=e.datum,i=e.active,o=e.inline,a=e.className,s=e.title,l=e.desc,u=e.events,c=this.getStyles(e),p=this.getHeight(e,"lineHeight"),d=e.textAnchor?Pt.Helpers.evaluateProp(e.textAnchor,r,i):"start",h=e.dx?Pt.Helpers.evaluateProp(e.dx,r,i):0,f=this.getDy(e,c,t,p),m=this.getTransform(e,c),y=void 0!==e.x?e.x:this.getPosition(e,"x"),b=void 0!==e.y?e.y:this.getPosition(e,"y"),g={x:o?void 0:e.x,dx:h,textAnchor:c[0].textAnchor||d,style:c[0],key:c[0].textAnchor||d},v=[];return t.length>1?(v.push(n.createElement("tspan",g,t[0])),v.push(n.createElement("tspan",{dy:-c[0].fontSize/2,style:Object.assign(Object.assign({},c[0]),{fontSize:.7*c[0].fontSize})},t[1]))):v.push(n.createElement("tspan",g,t[0])),n.cloneElement(e.textComponent,{dx:h,dy:f,x:y,y:b,events:u,transform:m,className:a,title:s,desc:l},v)}}])&&sr(r.prototype,i),o&&sr(r,o),t}(Pt.VictoryLabel);var dr=r(15757),hr=r(56066),fr=r.n(hr);function mr(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function yr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function br(e){return(br=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vr(e,t){return(vr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Sr(e){return(Sr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Cr=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":Sr(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};var Tr,Er=((Tr=o().cloneDeep(_.Nv)).axis.style.tickLabels.fontSize*=.85,Tr),wr=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==Sr(t)&&"function"!=typeof t?gr(e):t}(this,br(t).call(this,e)),Object.defineProperty(gr(r),"svgContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(gr(r),"mousePosition",{enumerable:!0,configurable:!0,writable:!0,value:{x:0,y:0}}),Object.defineProperty(gr(r),"currentBarIndex",{enumerable:!0,configurable:!0,writable:!0,value:-1}),Object.defineProperty(gr(r),"toolTipModel",{enumerable:!0,configurable:!0,writable:!0,value:null}),(0,l.makeObservable)(gr(r)),r}var r,i,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vr(e,t)}(t,e),r=t,(i=[{key:"onSelection",value:function(e){var t=o().flatten(e.map((function(e){return e.data.map((function(e){return e.dataBin}))})));this.props.onUserSelection(t)}},{key:"toSVGDOMNode",value:function(){return this.svgContainer.firstChild}},{key:"onMouseMove",value:function(e){this.mousePosition={x:e.pageX,y:e.pageY}}},{key:"render",value:function(){var e=this;return n.createElement("div",{onMouseMove:this.onMouseMove},this.barData.length>0&&n.createElement(Pt.VictoryChart,{containerComponent:n.createElement(Pt.VictorySelectionContainer,{containerRef:function(t){return e.svgContainer=t},selectionDimension:"x",onSelection:this.onSelection}),style:{parent:{width:this.props.width,height:this.props.height}},height:this.props.height-this.bottomPadding,width:this.props.width,padding:{left:40,right:20,top:10,bottom:this.bottomPadding},theme:Er},n.createElement(Pt.VictoryAxis,{tickValues:this.tickValuesBasedOnNA,tickFormat:function(t){return e.tickFormat[t-1]},domain:[0,this.maximumX],tickLabelComponent:n.createElement(pr,null),style:{tickLabels:{angle:50,verticalAnchor:"start",textAnchor:"start"}}}),n.createElement(Pt.VictoryAxis,{dependentAxis:!0,tickFormat:function(e){return Number.isInteger(e)?e.toFixed(0):""}}),n.createElement(Pt.VictoryBar,{barRatio:this.barRatio,style:{data:{fill:function(t){return(0,f.En)(t.dataBin,e.props.filters)||0===e.props.filters.length?A.$u.colors.theme.primary:qt.pp}}},data:this.barDataBasedOnNA,events:this.barPlotEvents}),this.labelShowingNA),fr().createPortal(n.createElement(dr.ZP,{mousePosition:this.mousePosition,windowWidth:v.Z.size.width,model:this.toolTipModel,totalBars:this.barData.length,currentBarIndex:this.currentBarIndex}),document.body))}},{key:"numericalBins",get:function(){return(0,f.Qq)(this.props.data)}},{key:"categoryBins",get:function(){return(0,f.GV)(this.props.data)}},{key:"numericalData",get:function(){return(0,f.D2)(this.numericalBins)}},{key:"categoricalData",get:function(){return(0,f.oy)(this.categoryBins,this.numericalTickFormat.length)}},{key:"numericalTickFormat",get:function(){return(0,f.Ob)(this.numericalBins).map((function(e){return e.includes("^")?e.split("^"):e}))}},{key:"barData",get:function(){return[].concat(mr(this.numericalData),mr(this.categoricalData))}},{key:"barDataBasedOnNA",get:function(){return this.props.showNAChecked?this.barData:this.barData.filter(_r)}},{key:"categories",get:function(){return this.categoryBins.map((function(e){return void 0===e.specialValue?"".concat(e.start):e.specialValue}))}},{key:"tickValues",get:function(){for(var e=[],t=1;t<=this.numericalTickFormat.length+this.categories.length;t++)e.push(t);return e}},{key:"barDataWithNA",get:function(){return this.barData.filter(Pr)}},{key:"numberOfNA",get:function(){return this.barDataWithNA.length}},{key:"tickValuesBasedOnNA",get:function(){return this.props.showNAChecked?this.tickValues:this.tickValues.slice(0,-this.numberOfNA)}},{key:"tickFormat",get:function(){return[].concat(mr(this.numericalTickFormat),mr(this.categories))}},{key:"bottomPadding",get:function(){return(0,_.Zo)(Er.axis.style.tickLabels.fontFamily,Er.axis.style.tickLabels.fontSize,this.tickFormat,50,40,10)}},{key:"barRatio",get:function(){return((0,f._1)(this.numericalBins)?this.barDataBasedOnNA.length/(this.barDataBasedOnNA.length+1):1)*A.$u.thresholds.barRatio}},{key:"barPlotEvents",get:function(){var e=this;return[{target:"data",eventHandlers:{onMouseEnter:function(){return[{target:"data",mutation:function(t){e.currentBarIndex=t.datum.eventKey,e.toolTipModel={start:e.barData[e.currentBarIndex].dataBin.start,end:e.barData[e.currentBarIndex].dataBin.end,special:e.barData[e.currentBarIndex].dataBin.specialValue,sampleCount:t.datum.y}}}]},onMouseLeave:function(){return[{target:"data",mutation:function(){e.toolTipModel=null}}]}}}]}},{key:"maximumX",get:function(){return this.tickValuesBasedOnNA[this.tickValuesBasedOnNA.length-1]+1}},{key:"maximumY",get:function(){var e=this.barData.filter(_r);return Math.max.apply(Math,mr(e.map((function(e){return e.y}))))}},{key:"labelShowingNA",get:function(){if(!this.props.showNAChecked){var e=this.barDataWithNA.map((function(e){return e.dataBin.count})).join(", ");return n.createElement(Pt.VictoryLabel,{text:"NA: ".concat(e),textAnchor:"end",datum:{x:this.maximumX,y:this.maximumY},style:{fontFamily:Er.axis.style.tickLabels.fontFamily,fontSize:Er.axis.style.tickLabels.fontSize}})}return null}}])&&yr(r.prototype,i),a&&yr(r,a),t}(n.Component);Cr([l.observable.ref],wr.prototype,"mousePosition",void 0),Cr([l.observable],wr.prototype,"currentBarIndex",void 0),Cr([l.observable],wr.prototype,"toolTipModel",void 0),Cr([m.default],wr.prototype,"onSelection",null),Cr([l.computed],wr.prototype,"numericalBins",null),Cr([l.computed],wr.prototype,"categoryBins",null),Cr([l.computed],wr.prototype,"numericalData",null),Cr([l.computed],wr.prototype,"categoricalData",null),Cr([l.computed],wr.prototype,"numericalTickFormat",null),Cr([l.computed],wr.prototype,"barData",null),Cr([l.computed],wr.prototype,"barDataBasedOnNA",null),Cr([l.computed],wr.prototype,"categories",null),Cr([l.computed],wr.prototype,"tickValues",null),Cr([l.computed],wr.prototype,"barDataWithNA",null),Cr([l.computed],wr.prototype,"numberOfNA",null),Cr([l.computed],wr.prototype,"tickValuesBasedOnNA",null),Cr([l.computed],wr.prototype,"tickFormat",null),Cr([l.computed],wr.prototype,"bottomPadding",null),Cr([l.computed],wr.prototype,"barRatio",null),Cr([m.default],wr.prototype,"onMouseMove",null),Cr([l.computed],wr.prototype,"maximumX",null),Cr([l.computed],wr.prototype,"maximumY",null),Cr([l.computed],wr.prototype,"labelShowingNA",null);const Ar=wr=Cr([a.observer],wr);var Pr=function(e){return"NA"===e.dataBin.specialValue},_r=function(e){return!Pr(e)},Ir=r(24999);function Or(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var kr=r(22045),Dr=r(58839);function Nr(){return(Nr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Rr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Mr(e,t,r){return t&&Gr(e.prototype,t),r&&Gr(e,r),e}function Fr(e,t){return!t||"object"!==Vr(t)&&"function"!=typeof t?Lr(e):t}function Lr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xr(e){return(xr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Br(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jr(e,t)}function jr(e,t){return(jr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Vr(e){return(Vr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Ur=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":Vr(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},qr=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r},Kr=function(e){function t(){return Rr(this,t),Fr(this,xr(t).apply(this,arguments))}return Br(t,e),Mr(t,[{key:"render",value:function(){var e=this.props,t=e.x,r=e.y,i=e.size,o=qr(e,["x","y","size"]);return n.createElement(Pt.Point,Nr({x:t+i,y:r-i,size:i},o))}}]),t}(n.Component);var Wr=function(e){function t(e){var r;return Rr(this,t),r=Fr(this,xr(t).call(this,e)),Object.defineProperty(Lr(r),"tooltipModel",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(Lr(r),"pointHovered",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Lr(r),"mouseIsDown",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Lr(r),"mouseEvents",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.xX)(Lr(r))}),Object.defineProperty(Lr(r),"xAxis",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(Lr(r),"yAxis",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(Lr(r),"container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Lr(r),"svg",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),(0,l.makeObservable)(Lr(r)),r}return Br(t,e),Mr(t,[{key:"containerRef",value:function(e){this.container=e}},{key:"svgRef",value:function(e){this.svg=e,this.props.svgRef&&this.props.svgRef(this.svg)}},{key:"toSVGDOMNode",value:function(){return this.svg}},{key:"tickFormat",value:function(e,t,r){return(0,_.kQ)(e,r)}},{key:"onMouseDown",value:function(){this.mouseIsDown=!0}},{key:"onMouseUp",value:function(){this.mouseIsDown=!1}},{key:"onSelection",value:function(e,t){if(this.xAxis&&this.yAxis){var r=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,o=Number.NEGATIVE_INFINITY,a=!0,s=!1,l=void 0;try{for(var u,c=e[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var p=u.value,d=!0,h=!1,f=void 0;try{for(var m,y=p.data[Symbol.iterator]();!(d=(m=y.next()).done);d=!0){var b=m.value;r=Math.min(r,b.x),n=Math.min(n,b.y),i=Math.max(i,b.x),o=Math.max(o,b.y)}}catch(e){h=!0,f=e}finally{try{d||null==y.return||y.return()}finally{if(h)throw f}}}}catch(e){s=!0,l=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw l}}i+=this.props.xBinSize,o+=this.props.yBinSize,Math.abs(o-this.dataDomain.y[1])<5e-5&&(o+=1),Math.abs(i-1)<5e-5&&(i+=1),r=+r.toFixed(2),i=+i.toFixed(2),n=+n.toFixed(2),o=+o.toFixed(2),this.props.onSelection({xStart:r,xEnd:i,yStart:n,yEnd:o})}}},{key:"xAxisRef",value:function(e){this.xAxis=e}},{key:"yAxisRef",value:function(e){this.yAxis=e}},{key:"render",value:function(){var e=this;return n.createElement("div",null,this.data.length>0&&n.createElement("div",{style:{width:this.props.width,height:this.props.height,position:"relative"},ref:this.containerRef,onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp},n.createElement(Pt.VictoryChart,{theme:_.Nv,containerComponent:n.createElement(_.Z0,{onSelection:this.onSelection,containerRef:function(t){t&&e.svgRef(t.firstChild)},legend:this.legend&&this.legend.legend,gradient:this.legend&&this.legend.gradient}),width:this.props.width,height:this.props.height,standalone:!0,domainPadding:15,singleQuadrantDomainPadding:!1},this.title,n.createElement(Pt.VictoryAxis,{ref:this.xAxisRef,domain:this.plotDomain.x,orientation:"bottom",offsetY:50,crossAxis:!1,tickCount:8,tickFormat:this.tickFormat,axisLabelComponent:n.createElement(Pt.VictoryLabel,{dy:20,style:[{fontSize:12,fontFamily:"Arial"}]}),label:this.props.axisLabelX}),n.createElement(Pt.VictoryAxis,{ref:this.yAxisRef,domain:this.plotDomain.y,orientation:"left",offsetX:50,crossAxis:!1,tickCount:8,tickFormat:this.tickFormat,dependentAxis:!0,axisLabelComponent:n.createElement(Pt.VictoryLabel,{dy:-27,style:[{fontSize:12,fontFamily:"Arial"}]}),label:this.props.axisLabelY}),this.scatters),n.createElement("span",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(255,255,255,0.8)",display:this.props.isLoading?"block":"none"}})),!this.props.isLoading&&0===this.data.length&&n.createElement("div",{className:"alert alert-info",style:{marginTop:175}},"No data to plot."),n.createElement(Me.Z,{isLoading:!!this.props.isLoading,style:{position:"absolute",top:"50%",left:"50%",marginLeft:-10}}),this.tooltipModel&&this.props.tooltip&&!this.mouseIsDown&&n.createElement(_.sO,{container:this.container,targetHovered:this.pointHovered,targetCoords:{x:this.tooltipModel.x,y:this.tooltipModel.y-3},overlay:this.props.tooltip(this.tooltipModel.datum)}))}},{key:"title",get:function(){return this.props.title?n.createElement(Pt.VictoryLabel,{style:{fontWeight:"bold",textAnchor:"middle"},x:this.props.width/2,y:"1.2em",text:this.props.title}):null}},{key:"plotDomain",get:function(){var e,t,r,n,i,o,a,s,l=[null===(t=null===(e=this.props.plotDomain)||void 0===e?void 0:e.x)||void 0===t?void 0:t.min,null===(n=null===(r=this.props.plotDomain)||void 0===r?void 0:r.x)||void 0===n?void 0:n.max],u=[null===(o=null===(i=this.props.plotDomain)||void 0===i?void 0:i.y)||void 0===o?void 0:o.min,null===(s=null===(a=this.props.plotDomain)||void 0===a?void 0:a.y)||void 0===s?void 0:s.max];return void 0===l[0]&&(l[0]=this.dataDomain.x[0]),void 0===l[1]&&(l[1]=this.dataDomain.x[1]),void 0===u[0]&&(u[0]=this.dataDomain.y[0]),void 0===u[1]&&(u[1]=this.dataDomain.y[1]),{x:l,y:u}}},{key:"dataDomain",get:function(){var e={x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY},t={x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},r=!0,n=!1,i=void 0;try{for(var o,a=this.data[Symbol.iterator]();!(r=(o=a.next()).done);r=!0){var s=o.value;e.x=Math.max(s.x+this.props.xBinSize,e.x),e.y=Math.max(s.y+this.props.yBinSize,e.y),t.x=Math.min(s.x,t.x),t.y=Math.min(s.y,t.y)}}catch(e){n=!0,i=e}finally{try{r||null==a.return||a.return()}finally{if(n)throw i}}return{x:[t.x,e.x],y:[t.y,e.y]}}},{key:"data",get:function(){return this.props.data.map((function(e){return Object.assign({},e,{x:e.binX,y:e.binY})}))}},{key:"plotComputations",get:function(){var e=Number.NEGATIVE_INFINITY,t=Number.POSITIVE_INFINITY,r=this.data,n=o().groupBy(r,(function(r){var n=r.count;return e=Math.max(n,e),t=Math.min(n,t),n}));t===e&&(t=1);var i,a,s,l=Math.log(e),u=Math.log(t),c=.75;return t===e?(i=function(){return 0},s=function(){return(0,kr.iA)(0)},a=null):(i=function(e){return(Math.log(e)-u)/(l-u)},a=function(e){return Math.exp(e*(l-u)/c+u)},s=function(e){return(0,kr.iA)(c*e)}),{selectedDataByAreaCount:n,unselectedDataByAreaCount:{},colorCoordToCount:a,colorCoordMax:c,countToSelectedColor:function(e){return s(i(e))},countToUnselectedColor:function(e){return"rgb(200,200,200)"},colorCoordToColor:s,countMax:e,countMin:t}}},{key:"numSamples",get:function(){return o().sumBy(this.data,(function(e){return e.count}))}},{key:"pearsonPValue",get:function(){return(0,Dr.pG)(this.props.pearsonCorr,this.numSamples)}},{key:"spearmanPValue",get:function(){return(0,Dr.pG)(this.props.spearmanCorr,this.numSamples)}},{key:"scatters",get:function(){var e=this;if(0===this.data.length)return[];for(var t=[],r=[{dataByAreaCount:this.plotComputations.selectedDataByAreaCount,countToColor:this.plotComputations.countToSelectedColor,size:3},{dataByAreaCount:this.plotComputations.unselectedDataByAreaCount,countToColor:this.plotComputations.countToUnselectedColor,size:2.5}],i=function(){var r=s[a];o().forEach(r.dataByAreaCount,(function(i,o){var a=r.countToColor(parseInt(o,10));t.push(n.createElement(Pt.VictoryScatter,{key:"".concat(o),style:{data:{fill:a,stroke:"black",strokeWidth:1,strokeOpacity:0}},size:r.size,symbol:"circle",data:i,events:e.mouseEvents,dataComponent:n.createElement(Kr,null)}))}))},a=0,s=r;a<s.length;a++)i();return t}},{key:"legend",get:function(){var e=this.plotComputations.colorCoordToCount;if(e){for(var t="legendGradient",r=[],i=0;i<30;i++)r.push(n.createElement("stop",{offset:"".concat((i/30*100).toFixed(0),"%"),stopColor:this.plotComputations.colorCoordToColor(i/30)}));var a,s=n.createElement("linearGradient",{id:t,key:t,x1:"0",y1:"1",x2:"0",y2:"0"},r),l=this.props.width-45,u=70,c=this.plotComputations.countMax-this.plotComputations.countMin>=2,p=c?68:38,d=n.createElement("rect",{fill:"url(#".concat(t,")"),x:l,y:u,width:10,height:p}),h=[n.createElement("text",{fontSize:11,x:l+10+4,y:u,dy:"1em"},this.plotComputations.countMax.toLocaleString()),n.createElement("text",{fontSize:11,x:l+10+4,y:u+p,dy:"-0.3em"},this.plotComputations.countMin.toLocaleString())],f=o().isNumber(this.props.pearsonCorr)?this.props.pearsonCorr.toFixed(4):this.props.pearsonCorr,m=o().isNumber(this.props.spearmanCorr)?this.props.spearmanCorr.toFixed(4):this.props.spearmanCorr;this.numSamples>2&&(a=[n.createElement("text",{fontSize:10,x:l-5,y:u+p+40,dy:"-0.3em"},"Pearson:"),n.createElement("text",{fontSize:10.5,x:l-5,y:u+p+55,dy:"-0.3em"},f),n.createElement("text",{fontSize:10.5,x:l-5,y:u+p+70,dy:"-0.3em"},"p=",this.pearsonPValue.toFixed(2)),n.createElement("text",{fontSize:10,x:l-5,y:u+p+100,dy:"-0.3em"},"Spearman:"),n.createElement("text",{fontSize:10.5,x:l-5,y:u+p+115,dy:"-0.3em"},m),n.createElement("text",{fontSize:10.5,x:l-5,y:u+p+130,dy:"-0.3em"},"p=",this.spearmanPValue.toFixed(2))]),c&&h.push(n.createElement("text",{fontSize:11,x:l+10+4,y:u+p/2,dy:"0.3em"},Math.round(e(.5)).toLocaleString()));var y=n.createElement("text",{fontSize:11,x:l,y:u,dy:"-0.5em",dx:"-12px"},"# samples");return{gradient:s,legend:n.createElement("g",null,y,d,h,a)}}return null}}]),t}(n.Component);Ur([l.observable],Wr.prototype,"tooltipModel",void 0),Ur([l.observable],Wr.prototype,"pointHovered",void 0),Ur([l.observable],Wr.prototype,"mouseIsDown",void 0),Ur([l.observable.ref],Wr.prototype,"container",void 0),Ur([m.default],Wr.prototype,"containerRef",null),Ur([m.default],Wr.prototype,"svgRef",null),Ur([l.computed],Wr.prototype,"plotDomain",null),Ur([l.computed],Wr.prototype,"dataDomain",null),Ur([m.default],Wr.prototype,"tickFormat",null),Ur([m.default],Wr.prototype,"onMouseDown",null),Ur([m.default],Wr.prototype,"onMouseUp",null),Ur([m.default],Wr.prototype,"onSelection",null),Ur([l.computed],Wr.prototype,"data",null),Ur([l.computed],Wr.prototype,"plotComputations",null),Ur([l.computed],Wr.prototype,"numSamples",null),Ur([l.computed],Wr.prototype,"pearsonPValue",null),Ur([l.computed],Wr.prototype,"spearmanPValue",null),Ur([l.computed],Wr.prototype,"scatters",null),Ur([l.computed],Wr.prototype,"legend",null),Ur([m.default],Wr.prototype,"xAxisRef",null),Ur([m.default],Wr.prototype,"yAxisRef",null);const Yr=Wr=Ur([a.observer],Wr);var zr=r(34974),Hr=r(24892),Zr=r(80835);function Xr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Qr(e){return(Qr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jr(e,t){return(Jr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function en(e){return(en="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var tn=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":en(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},rn=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==en(t)&&"function"!=typeof t?$r(e):t}(this,Qr(t).call(this,e)),Object.defineProperty($r(r),"isVisible",{enumerable:!0,configurable:!0,writable:!0,value:!1}),(0,l.makeObservable)($r(r)),r}var r,i,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jr(e,t)}(t,e),r=t,(i=[{key:"onVisibleChange",value:function(e){this.isVisible=e}},{key:"render",value:function(){var e=this,t=o().includes(this.props.selectedGenes,this.props.hugoGeneSymbol);return n.createElement(_.ZD,{placement:"left",disabled:!this.props.isCancerGene,overlay:(0,M.IE)(this.props.hugoGeneSymbol,t,this.props.isCancerGene,this.props.oncokbAnnotated,this.props.isOncogene,this.props.isTumorSuppressorGene),destroyTooltipOnHide:!0},n.createElement("div",{"data-test":"geneNameCell",className:st()(j().geneSymbol,j().displayFlex),onMouseEnter:function(){return e.onVisibleChange(!0)},onMouseLeave:function(){return e.onVisibleChange(!1)},onClick:function(){return e.props.onGeneSelect(e.props.hugoGeneSymbol)}},n.createElement(_.CQ,{text:this.props.hugoGeneSymbol,hideTooltip:this.props.isCancerGene}),n.createElement("span",{style:{marginLeft:5}},n.createElement(Le.If,{condition:t},n.createElement(Le.Then,null,n.createElement("i",{className:"fa fa-check-square-o"})),n.createElement(Le.Else,null,n.createElement(Le.If,{condition:this.isVisible},n.createElement("i",{className:"fa fa-square-o"}))))),n.createElement(Le.If,{condition:!o().isUndefined(this.props.qValue)},n.createElement("span",{style:{marginLeft:2,marginTop:2}},n.createElement(Le.If,{condition:this.props.tableType===M.Zh.MUTATION},n.createElement(Le.Then,null,n.createElement(Zr.Z,{qValue:this.props.qValue})),n.createElement(Le.Else,null,n.createElement(Hr.Z,{qValue:this.props.qValue})))))))}}])&&Xr(r.prototype,i),a&&Xr(r,a),t}(n.Component);function nn(e){return(nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function on(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function an(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function sn(e,t){return!t||"object"!==nn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ln(e){return(ln=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function un(e,t){return(un=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}tn([l.observable],rn.prototype,"isVisible",void 0),tn([l.action.bound],rn.prototype,"onVisibleChange",null),rn=tn([a.observer],rn);var cn,pn=function(e){function t(){return on(this,t),sn(this,ln(t).apply(this,arguments))}var r,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&un(e,t)}(t,e),r=t,(i=[{key:"render",value:function(){return n.createElement("div",{style:{marginLeft:this.props.cellMargin},className:j().displayFlex,"data-test":this.props.dataTest},this.props.showFilter&&n.createElement(_.ZD,{mouseEnterDelay:0,placement:"top",disabled:!this.props.overlay,overlay:this.props.overlay||null},n.createElement("div",{onClick:this.props.onClickCallback,className:j().displayFlex},n.createElement("span",{"data-test":"header-filter-icon",className:st()(j().cancerGeneIcon,j().displayFlex),style:{color:this.props.isFiltered?qt.ds:qt.LN}},n.createElement("i",{className:"fa fa-filter"})))),this.props.children)}}])&&an(r.prototype,i),o&&an(r,o),t}(n.Component);function dn(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function hn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function fn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mn(e,t){return!t||"object"!==Cn(t)&&"function"!=typeof t?yn(e):t}function yn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bn(e){return(bn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gn(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vn(e,t)}function vn(e,t){return(vn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Sn(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cn(e){return(Cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Tn,En=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":Cn(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};!function(e){e.GENE="Gene",e.MOLECULAR_PROFILE="Molecular Profile",e.CASE_LIST="Name",e.NUMBER_STRUCTURAL_VARIANTS="# SV",e.NUMBER_MUTATIONS="# Mut",e.CYTOBAND="Cytoband",e.CNA="CNA",e.NUMBER="#",e.FREQ="Freq"}(Tn||(Tn={}));var wn=(Sn(cn={},Tn.GENE,.35),Sn(cn,Tn.MOLECULAR_PROFILE,.6),Sn(cn,Tn.CASE_LIST,.6),Sn(cn,Tn.NUMBER_MUTATIONS,.25),Sn(cn,Tn.NUMBER_STRUCTURAL_VARIANTS,.2),Sn(cn,Tn.NUMBER,.25),Sn(cn,Tn.FREQ,.15),Sn(cn,Tn.CYTOBAND,.25),Sn(cn,Tn.CNA,.14),cn),An=function(e){function t(){return fn(this,t),mn(this,bn(t).apply(this,arguments))}return gn(t,e),t}(It.Z),Pn=function(e){function t(e,r){var i;return fn(this,t),i=mn(this,bn(t).call(this,e,r)),Object.defineProperty(yn(i),"sortBy",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(yn(i),"sortDirection",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(yn(i),"modalSettings",{enumerable:!0,configurable:!0,writable:!0,value:{modalOpen:!1,modalPanelName:""}}),Object.defineProperty(yn(i),"getDefaultColumnDefinition",{enumerable:!0,configurable:!0,writable:!0,value:function(e,t,r){var a;return(Sn(a={},Tn.GENE,{name:e,headerRender:function(){return n.createElement(pn,{cellMargin:r,dataTest:"gene-column-header",className:j().displayFlex,showFilter:!!i.props.cancerGeneFilterEnabled,isFiltered:!!i.isFilteredByCancerGeneList,onClickCallback:i.toggleCancerGeneFilter},n.createElement("span",null,e))},render:function(e){return n.createElement(rn,{tableType:i.props.tableType,selectedGenes:i.props.selectedGenes,hugoGeneSymbol:e.label,qValue:e.qValue,isCancerGene:e.isCancerGene,oncokbAnnotated:e.oncokbAnnotated,isOncogene:e.isOncokbOncogene,isTumorSuppressorGene:e.isOncokbTumorSuppressorGene,onGeneSelect:i.props.onGeneSelect})},sortBy:function(e){return e.label},defaultSortDirection:"asc",filter:function(e,t,r){return e.label.toUpperCase().includes(r)},width:t}),Sn(a,Tn.MOLECULAR_PROFILE,{name:e,headerRender:function(){return n.createElement("div",{style:{marginLeft:r},className:j().displayFlex,"data-test":"profile-column-header"},e)},render:function(e){return n.createElement("div",{className:j().labelContent},n.createElement(_.CQ,{text:e.label}))},sortBy:function(e){return e.label},defaultSortDirection:"asc",filter:function(e,t,r){return e.label.toUpperCase().includes(r)},width:t}),Sn(a,Tn.CASE_LIST,{name:e,headerRender:function(){return n.createElement("div",{style:{marginLeft:r},className:j().displayFlex,"data-test":"profile-column-header"},e)},render:function(e){return n.createElement("div",{className:j().labelContent},n.createElement(_.CQ,{text:e.label}))},sortBy:function(e){return e.label},defaultSortDirection:"asc",filter:function(e,t,r){return e.label.toUpperCase().includes(r)},width:t}),Sn(a,Tn.NUMBER,{name:e,tooltip:n.createElement("span",null,(0,M.gB)(i.props.tableType,!1)),headerRender:function(){return n.createElement(pn,{cellMargin:r,dataTest:"number-column-header",className:j().displayFlex,showFilter:!!i.props.alterationFilterEnabled,isFiltered:!!i.props.filterAlterations},n.createElement("span",null,e))},render:function(e){return n.createElement(_t.Z,{checked:i.isChecked(e.uniqueKey),disabled:i.isDisabled(e.uniqueKey),onChange:function(t){return i.toggleSelectRow(e.uniqueKey)},labelProps:{style:{display:"flex",justifyContent:"space-between",marginLeft:r,marginRight:r}},inputProps:{className:j().autoMarginCheckbox}},n.createElement("span",{"data-test":"numberOfAlteredCasesText"},e.numberOfAlteredCases.toLocaleString()))},sortBy:function(e){return e.numberOfAlteredCases},defaultSortDirection:"desc",filter:function(e,t){return o().toString(e.numberOfAlteredCases).includes(t)},width:t}),Sn(a,Tn.FREQ,{name:e,tooltip:n.createElement("span",null,(0,M.gB)(i.props.tableType,!0)),headerRender:function(){return n.createElement("div",{style:{marginLeft:r}},"Freq")},render:function(e){return(0,M.$o)(i.props.tableType,e.numberOfProfiledCases,e.numberOfAlteredCases,e.matchingGenePanelIds||[],i.toggleModal,{marginLeft:r})},sortBy:function(e){return e.numberOfAlteredCases/e.numberOfProfiledCases*100},defaultSortDirection:"desc",filter:function(e,t){return o().toString((0,f.jJ)(e.numberOfAlteredCases/e.numberOfProfiledCases)).includes(t)},width:t}),Sn(a,Tn.NUMBER_MUTATIONS,{name:e,tooltip:n.createElement("span",null,"Total number of mutations"),headerRender:function(){return n.createElement("div",{style:{marginLeft:r}},Tn.NUMBER_MUTATIONS)},render:function(e){return n.createElement("span",{"data-test":"numberOfAlterations",style:{flexDirection:"row-reverse",display:"flex",marginRight:r}},e.totalCount.toLocaleString())},sortBy:function(e){return e.totalCount},defaultSortDirection:"desc",filter:function(e,t){return o().toString(e.totalCount).includes(t)},width:t}),Sn(a,Tn.NUMBER_STRUCTURAL_VARIANTS,{name:e,tooltip:n.createElement("span",null,"Total number of structural variants"),headerRender:function(){return n.createElement("div",{style:{marginLeft:r}},Tn.NUMBER_STRUCTURAL_VARIANTS)},render:function(e){return n.createElement("span",{"data-test":"numberOfAlterations",style:{flexDirection:"row-reverse",display:"flex",marginRight:r}},e.totalCount.toLocaleString())},sortBy:function(e){return e.totalCount},defaultSortDirection:"desc",filter:function(e,t){return o().toString(e.totalCount).includes(t)},width:t}),Sn(a,Tn.CNA,{name:Tn.CNA,tooltip:n.createElement("span",null,"Copy number alteration, only amplifications and deep deletions are shown"),render:function(e){return n.createElement("span",{"data-test":"cnaCell",style:{color:(0,f.H8)((0,f.$9)(e.alteration)),fontWeight:"bold"}},(0,f.$9)(e.alteration))},sortBy:function(e){return e.alteration},defaultSortDirection:"asc",filter:function(e,t,r){return(0,f.$9)(e.alteration).includes(r)},width:t}),Sn(a,Tn.CYTOBAND,{name:Tn.CYTOBAND,tooltip:n.createElement("span",null,"Cytoband"),render:function(e){return n.createElement("span",null,e.cytoband)},sortBy:function(e){return e.cytoband},defaultSortDirection:"asc",filter:function(e,t,r){return!o().isUndefined(e.cytoband)&&e.cytoband.toUpperCase().includes(r)},width:t}),a)[e]}}),Object.defineProperty(yn(i),"getDefaultCellMargin",{enumerable:!0,configurable:!0,writable:!0,value:function(e,t){var r;return(Sn(r={},Tn.GENE,0),Sn(r,Tn.MOLECULAR_PROFILE,0),Sn(r,Tn.CASE_LIST,0),Sn(r,Tn.NUMBER_MUTATIONS,(0,f.mA)((0,f.pt)(t,i.totalCountLocaleString))),Sn(r,Tn.NUMBER_STRUCTURAL_VARIANTS,(0,f.mA)((0,f.pt)(t,i.totalCountLocaleString))),Sn(r,Tn.NUMBER,(0,f.mA)((t-10-((0,f.x2)(i.alteredCasesLocaleString)+20))/2)),Sn(r,Tn.FREQ,(0,f.mA)((0,f.pt)(t,(0,f.jJ)(o().max(i.tableData.map((function(e){return e.numberOfAlteredCases/e.numberOfProfiledCases*100}))))))),Sn(r,Tn.CYTOBAND,0),Sn(r,Tn.CNA,0),r)[e]}}),Object.defineProperty(yn(i),"_selectionType",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),(0,l.makeObservable)(yn(i)),i.sortBy=i.props.defaultSortBy,i}var r,i,a;return gn(t,e),r=t,(i=[{key:"toggleModal",value:function(e){this.modalSettings.modalOpen=!this.modalSettings.modalOpen,this.modalSettings.modalOpen&&(this.modalSettings.modalPanelName=e)}},{key:"closeModal",value:function(){this.modalSettings.modalOpen=!this.modalSettings.modalOpen}},{key:"toggleCancerGeneFilter",value:function(e){e.stopPropagation(),this.props.onChangeCancerGeneFilter(!this.props.filterByCancerGenes)}},{key:"isChecked",value:function(e){return!!this.allSelectedRowsKeysSet[e]}},{key:"isDisabled",value:function(e){return o().some(this.preSelectedRowsKeys,(function(t){return t===e}))}},{key:"toggleSelectRow",value:function(e){var t=o().find(this.props.selectedRowsKeys,(function(t){return t===e}));o().isUndefined(t)?this.props.onChangeSelectedRows(this.props.selectedRowsKeys.concat([e])):this.props.onChangeSelectedRows(o().xorBy(this.props.selectedRowsKeys,[t]))}},{key:"afterSelectingRows",value:function(){this.selectionType===M.LY.UNION?this.props.onSubmitSelection([this.props.selectedRowsKeys]):this.props.onSubmitSelection(this.props.selectedRowsKeys.map((function(e){return[e]}))),this.props.onChangeSelectedRows([])}},{key:"toggleSelectionOperator",value:function(){(this._selectionType||this.selectionType)===M.LY.INTERSECTION?this._selectionType=M.LY.UNION:this._selectionType=M.LY.INTERSECTION,localStorage.setItem(this.props.tableType,this.selectionType)}},{key:"isSelectedRow",value:function(e){return this.isChecked(e.uniqueKey)}},{key:"selectedRowClassName",value:function(e){var t=this.filterKeyToIndexSet[e.uniqueKey];return void 0===t?this.props.filters.length%2==0?j().highlightedEvenRow:j().highlightedOddRow:t%2==0?j().highlightedEvenRow:j().highlightedOddRow}},{key:"afterSorting",value:function(e,t){this.sortBy=e,this.sortDirection=t}},{key:"render",value:function(){var e="".concat(this.props.tableType,"-table");return n.createElement("div",{"data-test":e,key:e},this.props.promise.isComplete&&n.createElement(An,{width:this.props.width,height:this.props.height,data:this.selectableTableData,columns:this.tableColumns,isSelectedRow:this.isSelectedRow,afterSelectingRows:this.afterSelectingRows,defaultSelectionOperator:this.selectionType,toggleSelectionOperator:this.toggleSelectionOperator,extraButtons:this.props.extraButtons,sortBy:this.sortBy,sortDirection:this.sortDirection,afterSorting:this.afterSorting,fixedTopRowsData:this.preSelectedRows,highlightedRowClassName:this.selectedRowClassName,showSetOperationsButton:!0,numberOfSelectedRows:this.props.selectedRowsKeys.length}),this.props.genePanelCache?n.createElement(zr.N,{show:this.modalSettings.modalOpen,genePanelCache:this.props.genePanelCache,panelName:this.modalSettings.modalPanelName,onHide:this.closeModal}):null)}},{key:"maxNumberTotalCount",get:function(){return o().max(this.tableData.map((function(e){return e.totalCount})))}},{key:"maxNumberAlteredCasesColumn",get:function(){return o().max(this.tableData.map((function(e){return e.numberOfAlteredCases})))}},{key:"totalCountLocaleString",get:function(){return void 0===this.maxNumberTotalCount?"":this.maxNumberTotalCount.toLocaleString()}},{key:"alteredCasesLocaleString",get:function(){return void 0===this.maxNumberAlteredCasesColumn?"":this.maxNumberAlteredCasesColumn.toLocaleString()}},{key:"columnsWidth",get:function(){var e=this;return o().reduce(this.props.columns,(function(t,r){return t[r.columnKey]=(0,f.C)((r.columnWidthRatio?r.columnWidthRatio:wn[r.columnKey])*e.props.width),t}),{})}},{key:"cellMargin",get:function(){var e=this;return o().reduce(this.props.columns,(function(t,r){return t[r.columnKey]=e.getDefaultCellMargin(r.columnKey,e.columnsWidth[r.columnKey]),t}),{})}},{key:"tableData",get:function(){return this.isFilteredByCancerGeneList?o().filter(this.props.promise.result,(function(e){return e.isCancerGene})):this.props.promise.result||[]}},{key:"flattenedFilters",get:function(){return o().flatMap(this.props.filters)}},{key:"selectableTableData",get:function(){var e=this;return 0===this.flattenedFilters.length?this.tableData:o().filter(this.tableData,(function(t){return!e.flattenedFilters.includes(t.uniqueKey)}))}},{key:"preSelectedRows",get:function(){var e=this;if(0===this.flattenedFilters.length)return[];var t=(0,_.ky)(this.flattenedFilters);return o().chain(this.tableData).filter((function(t){return e.flattenedFilters.includes(t.uniqueKey)})).sortBy((function(e){return(0,Kt.Z)(t[e.uniqueKey],Number.POSITIVE_INFINITY)})).value()}},{key:"preSelectedRowsKeys",get:function(){return this.preSelectedRows.map((function(e){return e.uniqueKey}))}},{key:"tableColumns",get:function(){var e=this;return this.props.columns.map((function(t){var r=e.getDefaultColumnDefinition(t.columnKey,e.columnsWidth[t.columnKey],e.cellMargin[t.columnKey]);return t.columnTooltip&&(r.tooltip=t.columnTooltip),r}))}},{key:"isFilteredByCancerGeneList",get:function(){return!!this.props.cancerGeneFilterEnabled&&this.props.filterByCancerGenes}},{key:"allSelectedRowsKeysSet",get:function(){return(0,_.cD)([].concat(dn(this.props.selectedRowsKeys),dn(this.preSelectedRowsKeys)))}},{key:"selectionType",get:function(){if(this._selectionType)return this._selectionType;switch((localStorage.getItem(this.props.tableType)||"").toUpperCase()){case M.LY.INTERSECTION:return M.LY.INTERSECTION;case M.LY.UNION:return M.LY.UNION;default:return this.props.tableType===M.Zh.DATA?M.LY.INTERSECTION:M.LY.UNION}}},{key:"filterKeyToIndexSet",get:function(){return o().reduce(this.props.filters,(function(e,t,r){return t.forEach((function(t){e[t]=r})),e}),{})}}])&&hn(r.prototype,i),a&&hn(r,a),t}(n.Component);function _n(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function In(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function On(e){return(On=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function kn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dn(e,t){return(Dn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Nn(e){return(Nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(Pn,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{cancerGeneFilterEnabled:!1}}),En([l.observable],Pn.prototype,"sortBy",void 0),En([l.observable],Pn.prototype,"sortDirection",void 0),En([l.observable],Pn.prototype,"modalSettings",void 0),En([l.computed],Pn.prototype,"maxNumberTotalCount",null),En([l.computed],Pn.prototype,"maxNumberAlteredCasesColumn",null),En([l.computed],Pn.prototype,"totalCountLocaleString",null),En([l.computed],Pn.prototype,"alteredCasesLocaleString",null),En([l.computed],Pn.prototype,"columnsWidth",null),En([l.computed],Pn.prototype,"cellMargin",null),En([l.computed],Pn.prototype,"tableData",null),En([l.computed],Pn.prototype,"flattenedFilters",null),En([l.computed],Pn.prototype,"selectableTableData",null),En([l.computed],Pn.prototype,"preSelectedRows",null),En([l.computed],Pn.prototype,"preSelectedRowsKeys",null),En([l.computed],Pn.prototype,"tableColumns",null),En([l.action.bound],Pn.prototype,"toggleModal",null),En([l.action.bound],Pn.prototype,"closeModal",null),En([m.default],Pn.prototype,"toggleCancerGeneFilter",null),En([l.computed],Pn.prototype,"isFilteredByCancerGeneList",null),En([l.computed],Pn.prototype,"allSelectedRowsKeysSet",null),En([m.default],Pn.prototype,"isChecked",null),En([m.default],Pn.prototype,"isDisabled",null),En([l.action.bound],Pn.prototype,"toggleSelectRow",null),En([l.observable],Pn.prototype,"_selectionType",void 0),En([l.action.bound],Pn.prototype,"afterSelectingRows",null),En([l.computed],Pn.prototype,"selectionType",null),En([l.action.bound],Pn.prototype,"toggleSelectionOperator",null),En([m.default],Pn.prototype,"isSelectedRow",null),En([l.computed],Pn.prototype,"filterKeyToIndexSet",null),En([m.default],Pn.prototype,"selectedRowClassName",null),En([l.action.bound],Pn.prototype,"afterSorting",null),Pn=En([a.observer],Pn);var Rn,Gn=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":Nn(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},Mn=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==Nn(t)&&"function"!=typeof t?kn(e):t}(this,On(t).call(this,e)),Object.defineProperty(kn(r),"_selectionType",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(kn(r),"sortDirection",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(kn(r),"modalSettings",{enumerable:!0,configurable:!0,writable:!0,value:{modalOpen:!1,modalPanelName:""}}),(0,l.makeObservable)(kn(r)),r}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Dn(e,t)}(t,e),r=t,(n=[{key:"isDisabled",value:function(e){return o().some(this.preSelectedRowsKeys,(function(t){return t===e}))}},{key:"isChecked",value:function(e){return!!this.allSelectedRowsKeysSet[e]}},{key:"toggleModal",value:function(e){this.modalSettings.modalOpen=!this.modalSettings.modalOpen,this.modalSettings.modalOpen&&(this.modalSettings.modalPanelName=e)}},{key:"closeModal",value:function(){this.modalSettings.modalOpen=!this.modalSettings.modalOpen}},{key:"toggleSelectRow",value:function(e){var t=o().find(this.props.selectedRowsKeys,(function(t){return t===e}));o().isUndefined(t)?this.props.onChangeSelectedRows(this.props.selectedRowsKeys.concat([e])):this.props.onChangeSelectedRows(o().xorBy(this.props.selectedRowsKeys,[t]))}},{key:"afterSelectingRows",value:function(){this.selectionType===M.LY.UNION?this.props.onSubmitSelection([this.props.selectedRowsKeys]):this.props.onSubmitSelection(this.props.selectedRowsKeys.map((function(e){return[e]}))),this.props.onChangeSelectedRows([])}},{key:"toggleSelectionOperator",value:function(){(this._selectionType||this.selectionType)===M.LY.INTERSECTION?this._selectionType=M.LY.UNION:this._selectionType=M.LY.INTERSECTION,localStorage.setItem(this.props.tableType,this.selectionType)}},{key:"isSelectedRow",value:function(e){return this.isChecked(X(e))}},{key:"selectedRowClassName",value:function(e){var t=this.filterKeyToIndexSet[X(e)];return void 0===t?this.props.filters.length%2==0?j().highlightedEvenRow:j().highlightedOddRow:t%2==0?j().highlightedEvenRow:j().highlightedOddRow}},{key:"flattenedFilters",get:function(){return o().flatMap(this.props.filters)}},{key:"allSelectedRowsKeysSet",get:function(){return(0,_.cD)([].concat(_n(this.props.selectedRowsKeys),_n(this.preSelectedRowsKeys)))}},{key:"filterKeyToIndexSet",get:function(){return o().reduce(this.props.filters,(function(e,t,r){return t.forEach((function(t){e[t]=r})),e}),{})}},{key:"selectionType",get:function(){if(this._selectionType)return this._selectionType;switch((localStorage.getItem(this.props.tableType)||"").toUpperCase()){case M.LY.INTERSECTION:return M.LY.INTERSECTION;case M.LY.UNION:default:return M.LY.UNION}}}])&&In(r.prototype,n),i&&In(r,i),t}(n.Component);function Fn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ln(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xn(e,t){return!t||"object"!==Kn(t)&&"function"!=typeof t?Bn(e):t}function Bn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jn(e){return(jn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Vn(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Un(e,t)}function Un(e,t){return(Un=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qn(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Kn(e){return(Kn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Gn([l.observable],Mn.prototype,"_selectionType",void 0),Gn([l.observable],Mn.prototype,"sortDirection",void 0),Gn([l.observable],Mn.prototype,"modalSettings",void 0),Gn([l.computed],Mn.prototype,"flattenedFilters",null),Gn([l.computed],Mn.prototype,"allSelectedRowsKeysSet",null),Gn([l.computed],Mn.prototype,"filterKeyToIndexSet",null),Gn([l.computed],Mn.prototype,"selectionType",null),Gn([m.default],Mn.prototype,"isDisabled",null),Gn([m.default],Mn.prototype,"isChecked",null),Gn([l.action.bound],Mn.prototype,"toggleModal",null),Gn([l.action.bound],Mn.prototype,"closeModal",null),Gn([l.action.bound],Mn.prototype,"toggleSelectRow",null),Gn([l.action.bound],Mn.prototype,"afterSelectingRows",null),Gn([l.action.bound],Mn.prototype,"toggleSelectionOperator",null),Gn([m.default],Mn.prototype,"isSelectedRow",null),Gn([m.default],Mn.prototype,"selectedRowClassName",null);var Wn,Yn=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":Kn(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};!function(e){e.TREATMENT="Treatment",e.TIME="Pre / Post",e.COUNT="#"}(Wn||(Wn={}));var zn,Hn=(qn(Rn={},Wn.TREATMENT,.6),qn(Rn,Wn.TIME,.3),qn(Rn,Wn.COUNT,.2),Rn),Zn=function(e){function t(){return Ln(this,t),xn(this,jn(t).apply(this,arguments))}return Vn(t,e),t}(It.Z),Xn=function(e){function t(e){var r;return Ln(this,t),r=xn(this,jn(t).call(this,e)),Object.defineProperty(Bn(r),"sortBy",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Bn(r),"getDefaultColumnDefinition",{enumerable:!0,configurable:!0,writable:!0,value:function(e,t,i){var o;return(qn(o={},Wn.TREATMENT,{name:e,headerRender:function(){return n.createElement(Q,{margin:i,headerName:e})},render:function(e){return n.createElement($,{row:e})},sortBy:function(e){return e.treatment},defaultSortDirection:"asc",filter:J,width:t}),qn(o,Wn.TIME,{name:e,headerRender:function(){return n.createElement(Q,{margin:i,headerName:e})},render:r.createTemporalRelationColumnCell,sortBy:function(e){return e.time},defaultSortDirection:"asc",filter:J,width:t}),qn(o,Wn.COUNT,{tooltip:n.createElement("span",null,"Number of samples acquired before treatment or after/on treatment"),name:e,headerRender:function(){return n.createElement(Q,{margin:i,headerName:e})},render:function(e){return r.createNubmerColumnCell(e,28)},sortBy:function(e){return r.calculateMaxValueForTreatment(e)+ee(e.time+e.treatment)},defaultSortDirection:"desc",filter:J,width:t}),o)[e]}}),(0,l.makeObservable)(Bn(r)),r.sortBy=r.props.defaultSortBy,r}var r,i,a;return Vn(t,e),r=t,(i=[{key:"createTemporalRelationColumnCell",value:function(e){return n.createElement("div",null,e.time)}},{key:"createNubmerColumnCell",value:function(e,t){var r=this;return n.createElement(_t.Z,{checked:this.isChecked(X(e)),disabled:this.isDisabled(X(e)),onChange:function(t){return r.toggleSelectRow(X(e))},labelProps:{style:{display:"flex",justifyContent:"space-between",marginLeft:0,marginRight:t}},inputProps:{className:j().autoMarginCheckbox}},n.createElement("span",null,e.count.toLocaleString()))}},{key:"calculateMaxValueForTreatment",value:function(e){var t=this.tableData.filter((function(t){return t.treatment==e.treatment})).sort((function(e,t){return t.count-e.count}));return 0==t.length?0:t[0].count}},{key:"afterSorting",value:function(e,t){this.sortBy=e,this.sortDirection=t}},{key:"render",value:function(){var e="".concat(this.props.tableType,"-table");return n.createElement("div",{"data-test":e,key:e},this.props.promise.isComplete&&n.createElement(Zn,{width:this.props.width,height:this.props.height,data:this.selectableTableData,columns:this.tableColumns,isSelectedRow:this.isSelectedRow,afterSelectingRows:this.afterSelectingRows,defaultSelectionOperator:this.selectionType,toggleSelectionOperator:this.toggleSelectionOperator,extraButtons:this.props.extraButtons,sortBy:this.sortBy,sortDirection:this.sortDirection,afterSorting:this.afterSorting,fixedTopRowsData:this.preSelectedRows,highlightedRowClassName:this.selectedRowClassName,numberOfSelectedRows:this.props.selectedRowsKeys.length,showSetOperationsButton:!0}))}},{key:"columnsWidth",get:function(){var e=this;return o().reduce(this.props.columns,(function(t,r){return t[r.columnKey]=(0,f.C)((r.columnWidthRatio?r.columnWidthRatio:Hn[r.columnKey])*e.props.width),t}),{})}},{key:"cellMargin",get:function(){return o().reduce(this.props.columns,(function(e,t){return e[t.columnKey]=0,e}),{})}},{key:"tableData",get:function(){return this.props.promise.result||[]}},{key:"selectableTableData",get:function(){var e=this;return 0===this.flattenedFilters.length?this.tableData:o().filter(this.tableData,(function(t){return!e.flattenedFilters.includes(X(t))}))}},{key:"preSelectedRows",get:function(){var e=this;if(0===this.flattenedFilters.length)return[];var t=(0,_.ky)(this.flattenedFilters);return o().chain(this.tableData).filter((function(t){return e.flattenedFilters.includes(X(t))})).sortBy((function(e){return(0,Kt.Z)(t[X(e)],Number.POSITIVE_INFINITY)})).value()}},{key:"preSelectedRowsKeys",get:function(){return this.preSelectedRows.map((function(e){return X(e)}))}},{key:"tableColumns",get:function(){var e=this;return this.props.columns.map((function(t){return e.getDefaultColumnDefinition(t.columnKey,e.columnsWidth[t.columnKey],e.cellMargin[t.columnKey])}))}}])&&Fn(r.prototype,i),a&&Fn(r,a),t}(Mn);function Qn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function $n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jn(e,t){return!t||"object"!==oi(t)&&"function"!=typeof t?ei(e):t}function ei(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ti(e){return(ti=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ri(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ni(e,t)}function ni(e,t){return(ni=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ii(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oi(e){return(oi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(Xn,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{cancerGeneFilterEnabled:!1}}),Yn([l.observable],Xn.prototype,"sortBy",void 0),Yn([l.computed],Xn.prototype,"columnsWidth",null),Yn([l.computed],Xn.prototype,"cellMargin",null),Yn([l.computed],Xn.prototype,"tableData",null),Yn([l.computed],Xn.prototype,"selectableTableData",null),Yn([l.computed],Xn.prototype,"preSelectedRows",null),Yn([l.computed],Xn.prototype,"preSelectedRowsKeys",null),Yn([l.computed],Xn.prototype,"tableColumns",null),Yn([l.action.bound],Xn.prototype,"afterSorting",null),Xn=Yn([a.observer],Xn);var ai,si=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":oi(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};!function(e){e.TREATMENT="Treatment",e.COUNT="#"}(ai||(ai={}));var li=(ii(zn={},ai.TREATMENT,.8),ii(zn,ai.COUNT,.2),zn),ui=function(e){function t(){return $n(this,t),Jn(this,ti(t).apply(this,arguments))}return ri(t,e),t}(It.Z),ci=function(e){function t(e){var r;return $n(this,t),r=Jn(this,ti(t).call(this,e)),Object.defineProperty(ei(r),"sortBy",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(ei(r),"getDefaultColumnDefinition",{enumerable:!0,configurable:!0,writable:!0,value:function(e,t,i){var o;return(ii(o={},ai.TREATMENT,{name:e,headerRender:function(){return n.createElement(Q,{margin:i,headerName:e})},render:function(e){return n.createElement($,{row:e})},sortBy:function(e){return e.treatment},defaultSortDirection:"asc",filter:J,width:t}),ii(o,ai.COUNT,{tooltip:n.createElement("span",null,"Number of patients treated"),name:e,headerRender:function(){return n.createElement(Q,{margin:i,headerName:e})},render:function(e){return r.createNubmerColumnCell(e,28)},sortBy:function(e){return e.count+ee(e.treatment)},defaultSortDirection:"desc",filter:J,width:t}),o)[e]}}),(0,l.makeObservable)(ei(r)),r.sortBy=r.props.defaultSortBy,r}var r,i,a;return ri(t,e),r=t,(i=[{key:"createNubmerColumnCell",value:function(e,t){var r=this;return n.createElement(_t.Z,{checked:this.isChecked(X(e)),disabled:this.isDisabled(X(e)),onChange:function(t){return r.toggleSelectRow(X(e))},labelProps:{style:{display:"flex",justifyContent:"space-between",marginLeft:0,marginRight:t}},inputProps:{className:j().autoMarginCheckbox}},n.createElement("span",null,e.count.toLocaleString()))}},{key:"afterSorting",value:function(e,t){this.sortBy=e,this.sortDirection=t}},{key:"render",value:function(){var e="".concat(this.props.tableType,"-table");return n.createElement("div",{"data-test":e,key:e},this.props.promise.isComplete&&n.createElement(ui,{width:this.props.width,height:this.props.height,data:this.selectableTableData,columns:this.tableColumns,isSelectedRow:this.isSelectedRow,afterSelectingRows:this.afterSelectingRows,defaultSelectionOperator:this.selectionType,toggleSelectionOperator:this.toggleSelectionOperator,extraButtons:this.props.extraButtons,sortBy:this.sortBy,sortDirection:this.sortDirection,afterSorting:this.afterSorting,fixedTopRowsData:this.preSelectedRows,highlightedRowClassName:this.selectedRowClassName,numberOfSelectedRows:this.props.selectedRowsKeys.length,showSetOperationsButton:!0}))}},{key:"columnsWidth",get:function(){var e=this;return o().reduce(this.props.columns,(function(t,r){return t[r.columnKey]=(0,f.C)((r.columnWidthRatio?r.columnWidthRatio:li[r.columnKey])*e.props.width),t}),{})}},{key:"cellMargin",get:function(){return o().reduce(this.props.columns,(function(e,t){return e[t.columnKey]=0,e}),{})}},{key:"tableData",get:function(){return this.props.promise.result||[]}},{key:"selectableTableData",get:function(){var e=this;return 0===this.flattenedFilters.length?this.tableData:o().filter(this.tableData,(function(t){return!e.flattenedFilters.includes(X(t))}))}},{key:"preSelectedRows",get:function(){var e=this;if(0===this.flattenedFilters.length)return[];var t=(0,_.ky)(this.flattenedFilters);return o().chain(this.tableData).filter((function(t){return e.flattenedFilters.includes(X(t))})).sortBy((function(e){return(0,Kt.Z)(t[X(e)],Number.POSITIVE_INFINITY)})).value()}},{key:"preSelectedRowsKeys",get:function(){return this.preSelectedRows.map((function(e){return X(e)}))}},{key:"tableColumns",get:function(){var e=this;return this.props.columns.map((function(t){return e.getDefaultColumnDefinition(t.columnKey,e.columnsWidth[t.columnKey],e.cellMargin[t.columnKey])}))}}])&&Qn(r.prototype,i),a&&Qn(r,a),t}(Mn);Object.defineProperty(ci,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{cancerGeneFilterEnabled:!1}}),si([l.observable],ci.prototype,"sortBy",void 0),si([l.computed],ci.prototype,"columnsWidth",null),si([l.computed],ci.prototype,"cellMargin",null),si([l.computed],ci.prototype,"tableData",null),si([l.computed],ci.prototype,"selectableTableData",null),si([l.computed],ci.prototype,"preSelectedRows",null),si([l.computed],ci.prototype,"preSelectedRowsKeys",null),si([l.computed],ci.prototype,"tableColumns",null),si([l.action.bound],ci.prototype,"afterSorting",null),ci=si([a.observer],ci);var pi=r(38383),di=r(71780),hi=r(87097);function fi(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function mi(e,t,r){return t.min+(e-gi)*(t.max-t.min)/r}function yi(e,t,r){return gi+(e-t.min)*r/(t.max-t.min)}function bi(e){var t=e.toString();return"1"===t[0]&&0===parseFloat(t.substring(1))}var gi=5,vi=30;function Si(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Ci(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ti(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ei(e,t){return!t||"object"!==Pi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function wi(e){return(wi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ai(e,t){return(Ai=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Pi(e){return(Pi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var _i=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":Pi(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},Ii=function(e){function t(){return Ci(this,t),Ei(this,wi(t).apply(this,arguments))}var r,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ai(e,t)}(t,e),r=t,(i=[{key:"renderCurve",value:function(){if(this.props.curveMagnitudes.length>0){for(var e=15,t=Math.min(1,12/Math.max.apply(Math,Si(this.props.curveMagnitudes))),r=this.props.curveMagnitudes.map((function(e){return t*e})),i=this.violinWidth/(r.length-1),o="M 0 ".concat(e," L 0 ").concat(e-r[0]),a="M 0 ".concat(e," L 0 ").concat(e+r[0]),s=1;s<r.length;s++)o="".concat(o," L ").concat(s*i," ").concat(e-r[s]),a="".concat(a," L ").concat(s*i," ").concat(e+r[s]);return o="".concat(o," L ").concat(this.violinWidth," ").concat(e," L 0 ").concat(e),a="".concat(a," L ").concat(this.violinWidth," ").concat(e," L 0 ").concat(e),n.createElement("g",{transform:"translate(".concat(gi,", 0)")},n.createElement("path",{d:o,fill:"gray"}),n.createElement("path",{d:a,fill:"gray"}))}return null}},{key:"x",value:function(e){return yi(e,this.props.violinBounds,this.violinWidth)}},{key:"renderPoints",value:function(){var e=this;return this.props.individualPoints.map((function(t){return n.createElement("circle",{key:"".concat(t.studyId,":").concat(t.sampleId),onMouseMove:function(r){e.props.onMouseOverPoint(t,r.pageX,r.pageY),r.stopPropagation()},cx:e.x(t.value),cy:15,r:3})}))}},{key:"renderBox",value:function(){var e=this,t=this.x(this.props.boxData.whiskerLower),r=this.x(this.props.boxData.whiskerUpper),i=this.x(this.props.boxData.q3)-this.x(this.props.boxData.q1),o=this.x(this.props.boxData.q1),a=this.x(this.props.boxData.median);return n.createElement(n.Fragment,null,n.createElement("line",{x1:t,x2:t,y1:12,y2:18,stroke:"black",strokeWidth:.5}),n.createElement("line",{x1:t,x2:r,y1:15,y2:15,stroke:"black",strokeWidth:.5}),n.createElement("line",{x1:r,x2:r,y1:12,y2:18,stroke:"black",strokeWidth:.5}),n.createElement("rect",{x:o,y:10,width:i,height:10,fill:"#dddddd",stroke:"black",strokeWidth:.2,onMouseOver:function(t){return e.props.onMouseOverBoxPlot(t.pageX,t.pageY)}}),n.createElement("line",{x1:a,x2:a,y1:10,y2:20,stroke:"black"}))}},{key:"renderGridLines",value:function(){var e=this;return n.createElement(n.Fragment,null,this.props.gridValues.map((function(t,r){var i=e.x(t);return n.createElement(n.Fragment,null,n.createElement("line",{x1:i,x2:i,y1:0,y2:vi,stroke:"#aaa",strokeWidth:1,strokeDasharray:"3,2"}))})))}},{key:"render",value:function(){return n.createElement("svg",{width:this.svgWidth,height:vi,style:{marginTop:5}},this.renderGridLines(),this.props.curveMagnitudes.length>0&&this.props.showViolin&&this.renderCurve(),n.createElement("rect",{width:this.svgWidth,height:vi,fillOpacity:0,onMouseMove:this.props.onMouseOverBackground}),this.props.curveMagnitudes.length>0&&this.props.showBox&&this.renderBox(),(this.props.showViolin||this.props.showBox)&&this.renderPoints())}},{key:"svgWidth",get:function(){return this.props.width}},{key:"violinWidth",get:function(){return this.svgWidth-2*gi}}])&&Ti(r.prototype,i),o&&Ti(r,o),t}(n.Component);_i([l.computed],Ii.prototype,"svgWidth",null),_i([l.computed],Ii.prototype,"violinWidth",null);const Oi=Ii=_i([a.observer],Ii);var ki=r(5985),Di=r.n(ki),Ni=r(3563);function Ri(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Gi(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Mi(e){return(Mi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Fi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Li(e,t){return(Li=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xi(e){return(xi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Bi=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":xi(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},ji="#",Vi=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==xi(t)&&"function"!=typeof t?Fi(e):t}(this,Mi(t).call(this,e)),Object.defineProperty(Fi(r),"ref",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Fi(r),"categoryColumnDragging",{enumerable:!0,configurable:!0,writable:!0,value:{_extraCategoryColumnWidth:0,dragging:!1,mouseXStart:-1,_extraWidthStart:0}}),Object.defineProperty(Fi(r),"rangeSelection",{enumerable:!0,configurable:!0,writable:!0,value:{mouseX:void 0,startX:void 0,dragging:!1,get rectX(){return Math.min(this.mouseX,this.startX)},get rectWidth(){return Math.abs(this.mouseX-this.startX)}}}),Object.defineProperty(Fi(r),"tooltipModel",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(Fi(r),"tooltipResetTimer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(Fi(r),"mouseInTooltip",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Fi(r),"sampleNumberFilter",{enumerable:!0,configurable:!0,writable:!0,value:"10"}),Object.defineProperty(Fi(r),"handlers",{enumerable:!0,configurable:!0,writable:!0,value:{isMouseInside:function(e){return e>=r.violinPlotStartX-3&&e<=r.violinPlotStartX+r.violinColumnWidth-2*gi+3},onMouseMove:(0,l.action)((function(e){if(r.mouseInteractionPossible){r.doCategoryColumnDrag(e);var t=r.ref.getBoundingClientRect().x,n=e.pageX-t;r.handlers.isMouseInside(n)?r.rangeSelection.mouseX=n:(r.rangeSelection.dragging&&r.executeRangeSelection(),r.stopRangeSelectionDrag(e))}})),onMouseLeave:(0,l.action)((function(e){r.stopRangeSelectionDrag(e),r.stopCategoryColumnDrag(e)})),onMouseDown:(0,l.action)((function(e){if(r.mouseInteractionPossible){var t=r.ref.getBoundingClientRect().x,n=e.pageX-t;r.handlers.isMouseInside(n)&&(r.rangeSelection.startX=n,r.rangeSelection.dragging=!0)}})),onMouseUp:(0,l.action)((function(e){r.mouseInteractionPossible&&(r.rangeSelection.dragging&&r.executeRangeSelection(),r.stopRangeSelectionDrag(e),r.stopCategoryColumnDrag(e))}))}}),(0,l.makeObservable)(Fi(r)),r}var r,i,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Li(e,t)}(t,e),r=t,(i=[{key:"setRef",value:function(e){this.ref=e}},{key:"onMouseEnterTooltip",value:function(){this.mouseInTooltip=!0}},{key:"onMouseLeaveTooltip",value:function(){this.mouseInTooltip=!1}},{key:"setSampleNumberFilter",value:function(e){this.sampleNumberFilter=e}},{key:"violinX",value:function(e){return yi(e,this.props.violinBounds,this.violinPlotWidth)}},{key:"onMouseOverBoxPlot",value:function(e,t,r,n){this.onMouseLeaveTooltip(),this.cancelResetTooltip(),this.tooltipModel&&this.tooltipModel.category===n&&o().isEqual(this.tooltipModel.boxData,e)||(this.tooltipModel={boxData:e,category:n,mouseX:t,mouseY:r})}},{key:"onMouseOverPoint",value:function(e,t,r,n){this.onMouseLeaveTooltip(),this.cancelResetTooltip(),this.tooltipModel&&this.tooltipModel.category===n&&o().isEqual(this.tooltipModel.point,e)||(this.tooltipModel={point:e,category:n,mouseX:t,mouseY:r})}},{key:"onMouseOverBackground",value:function(){var e=this;this.onMouseLeaveTooltip(),null===this.tooltipResetTimer&&(this.tooltipResetTimer=setTimeout((function(){e.tooltipResetTimer=null,e.mouseInTooltip||(e.tooltipModel=null)}),400))}},{key:"cancelResetTooltip",value:function(){clearTimeout(this.tooltipResetTimer),this.tooltipResetTimer=null}},{key:"isCategorySelected",value:function(e){return e in this.selectedCategories}},{key:"onSelectCategory",value:function(e){this.props.selectedCategories.includes(e)?this.props.setFilters("categorical",this.props.selectedCategories.filter((function(t){return t!==e}))):this.props.setFilters("categorical",[e].concat(Ri(this.props.selectedCategories)))}},{key:"onSelectRange",value:function(e){this.props.setFilters("numerical",e)}},{key:"startCategoryColumnDrag",value:function(e){e.stopPropagation(),e.preventDefault(),this.categoryColumnDragging.dragging=!0,this.categoryColumnDragging.mouseXStart=e.pageX,this.categoryColumnDragging._extraWidthStart=this.extraCategoryColumnWidth}},{key:"doCategoryColumnDrag",value:function(e){this.categoryColumnDragging.dragging&&(this.categoryColumnDragging._extraCategoryColumnWidth=this.categoryColumnDragging._extraWidthStart+e.pageX-this.categoryColumnDragging.mouseXStart)}},{key:"stopCategoryColumnDrag",value:function(e){this.categoryColumnDragging.dragging&&(e.stopPropagation(),e.preventDefault()),this.categoryColumnDragging.dragging=!1}},{key:"executeRangeSelection",value:function(){if(this.rangeSelection.rectWidth>5){var e=(0,Ni.u)(mi(this.rangeSelection.rectX-this.violinPlotStartX+4,this.props.violinBounds,this.violinPlotWidth),this.props.violinBounds.min,this.props.violinBounds.max),t=(0,Ni.u)(mi(this.rangeSelection.rectX+this.rangeSelection.rectWidth-this.violinPlotStartX+4,this.props.violinBounds,this.violinPlotWidth),this.props.violinBounds.min,this.props.violinBounds.max);this.props.logScale&&(e=Math.exp(e)-1,t=Math.exp(t)-1),this.onSelectRange({start:e,end:t})}}},{key:"stopRangeSelectionDrag",value:function(e){this.rangeSelection.mouseX=void 0,this.rangeSelection.dragging=!1}},{key:"renderGridLabels",value:function(){var e=this;return n.createElement("svg",{style:{position:"absolute",top:52},width:this.props.width,height:20},n.createElement("rect",{width:this.props.width,height:20,fill:"#ffffff"}),n.createElement("g",{transform:"translate(".concat(this.gridLabelsOffset,",0)")},this.gridTicks.map((function(t,r){var i=e.violinX(t);return n.createElement("text",{x:i,y:15,textAnchor:"middle",fill:"#aaa",fontSize:10},e.props.logScale?(0,di.qm)(Math.exp(t)-1,1):(0,di.qm)(t,2))}))))}},{key:"renderTooltip",value:function(){var e,t,r,i,a=this.tooltipModel;return a?(a.point?(t=a.point,r=this.props.violinColumnName,i=this.props.logScale,e=n.createElement(n.Fragment,null,n.createElement("b",null,"Study ID:")," ",n.createElement("a",{href:(0,P.yY)(t.studyId)},t.studyId),n.createElement("br",null),n.createElement("b",null,"Sample ID:")," ",n.createElement("a",{href:(0,P.Qk)(t.studyId,t.sampleId)},t.sampleId),n.createElement("br",null),n.createElement("b",null,r,":")," ",(0,di.qm)(i?Math.exp(t.value)-1:t.value,2))):a.boxData&&(e=function(e,t){return n.createElement(n.Fragment,null,(0,hi.Z)(o().map({median:"Median",q1:"Quartile 1",q3:"Quartile 3"},(function(r,i){return n.createElement(n.Fragment,null,n.createElement("b",null,r,":")," ",n.createElement("span",null,(0,di.qm)(t?Math.exp(e[i])-1:e[i],2)))})),n.createElement("br",null)))}(a.boxData,this.props.logScale)),hr.createPortal(n.createElement(ut.Popover,{arrowOffsetTop:17,className:st()("cbioportal-frontend","cbioTooltip",Di().Tooltip),positionLeft:a.mouseX+7,positionTop:a.mouseY-19,onMouseEnter:this.onMouseEnterTooltip,onMouseLeave:this.onMouseLeaveTooltip},e),document.body)):null}},{key:"onScroll",value:function(){this.tooltipModel=null,this.cancelResetTooltip()}},{key:"renderRangeSelectUI",value:function(){return this.mouseInteractionPossible?this.rangeSelection.dragging?n.createElement("div",{style:{top:73,height:this.props.height-50,position:"absolute",background:"#ccc",left:this.rangeSelection.rectX,width:this.rangeSelection.rectWidth,zIndex:100,opacity:.3}}):void 0===this.rangeSelection.mouseX||this.categoryColumnDragging.dragging?void 0:n.createElement("div",{style:{top:73,height:this.props.height-50,position:"absolute",left:this.rangeSelection.mouseX,borderLeft:"1px dashed #999",width:1,zIndex:100,overflow:"visible",pointerEvents:"none"}}):null}},{key:"renderLoadingIndicator",value:function(){return this.props.isLoading?n.createElement("div",{style:{position:"absolute",left:0,top:0,width:this.props.width,height:this.props.height+50}},n.createElement("div",{style:{position:"absolute",width:"100%",height:this.props.height+2,top:20,background:"#fff",left:0,opacity:.8}}),n.createElement(Me.Z,{centerRelativeToContainer:!0,isLoading:!0,className:ot().chartLoader})):null}},{key:"render",value:function(){return n.createElement("div",{ref:this.setRef,onMouseMove:this.handlers.onMouseMove,onMouseLeave:this.handlers.onMouseLeave,onMouseDown:this.handlers.onMouseDown,onMouseUp:this.handlers.onMouseUp,className:this.rangeSelection.dragging||this.categoryColumnDragging.dragging?"noselect":""},n.createElement(n.Fragment,null,n.createElement(It.Z,{columns:this.columns,data:this.data,headerHeight:50,headerClassName:st()("violinPlotTableHeader",{nomouse:this.categoryColumnDragging.dragging}),rowHeight:30,width:this.props.width,height:this.props.height,sortBy:ji,sortDirection:"desc",extraFooterElements:this.extraFooterElements,onScroll:this.onScroll}),this.renderGridLabels(),this.renderRangeSelectUI(),this.renderTooltip(),this.renderLoadingIndicator()),0===this.data.length&&n.createElement("div",{style:{position:"absolute",left:0,top:70,width:this.props.width,height:this.props.height-70,display:"flex",alignItems:"center",justifyContent:"center"}},"No data."))}},{key:"extraCategoryColumnWidth",get:function(){return(0,Ni.u)(this.categoryColumnDragging._extraCategoryColumnWidth,0,this.violinColumnWidthWithoutColumnResize/2)}},{key:"violinColumnWidthWithoutColumnResize",get:function(){var e=0;return this.props.dimension.w>3&&(e=(this.props.dimension.w-3)*A.$u.layout.grid.w),160+e}},{key:"violinColumnWidth",get:function(){return this.violinColumnWidthWithoutColumnResize-this.extraCategoryColumnWidth}},{key:"violinPlotWidth",get:function(){return this.violinColumnWidth-2*gi}},{key:"selectedCategories",get:function(){return o().keyBy(this.props.selectedCategories)}},{key:"columns",get:function(){var e=this;return[{name:this.props.categoryColumnName,render:function(e){return n.createElement("span",null,e.category)},headerRender:function(){return n.createElement("div",{style:{display:"flex",justifyContent:"space-between",width:"100%"}},n.createElement("span",null,e.props.categoryColumnName),n.createElement("div",{onMouseDown:e.startCategoryColumnDrag,style:{color:"#ddd",width:1,height:15,cursor:"ew-resize"}},"|"))},width:120+this.extraCategoryColumnWidth,sortBy:function(e){return e.category},filter:function(e,t,r){return e.category.toUpperCase().includes(r)},visible:!0,resizable:!0},{name:this.props.violinColumnName,render:function(t,r){return n.createElement(Oi,{curveMagnitudes:t.curveData,violinBounds:e.props.violinBounds,individualPoints:t.individualPoints,boxData:t.boxData,showViolin:e.props.showViolin,showBox:e.props.showBox,width:e.violinColumnWidth,gridValues:e.gridTicks,onMouseOverPoint:function(r,n,i){return e.onMouseOverPoint(r,n,i,t.category)},onMouseOverBoxPlot:function(r,n){e.onMouseOverBoxPlot(t.boxData,r,n,t.category)},onMouseOverBackground:e.onMouseOverBackground})},sortBy:function(e){return e.boxData.median},width:this.violinColumnWidth,visible:!0},{name:ji,render:function(t){return n.createElement(_t.Z,{checked:e.isCategorySelected(t.category),onChange:function(){return e.onSelectCategory(t.category)},labelProps:{style:{display:"flex",justifyContent:"space-between"}},inputProps:{className:j().autoMarginCheckbox}},n.createElement("span",{"data-test":"fixedHeaderTableRightJustified"},t.numSamples))},sortBy:function(e){return e.numSamples},visible:!0,width:60},{name:"Median",render:function(e){return n.createElement("span",{className:"fixedHeaderTableRightJustified"},(0,di.qm)(e.boxData.median,2))},sortBy:function(e){return e.boxData.median},visible:this.props.dimension.w>2,width:42},{name:"Quartile 1",render:function(e){return n.createElement("span",{className:"fixedHeaderTableRightJustified"},(0,di.qm)(e.boxData.q1,2))},sortBy:function(e){return e.boxData.q1},visible:this.props.dimension.w>2,width:50},{name:"Quartile 3",render:function(e){return n.createElement("span",{className:"fixedHeaderTableRightJustified"},(0,di.qm)(e.boxData.q3,2))},sortBy:function(e){return e.boxData.q3},visible:this.props.dimension.w>2,width:50}].filter((function(e){return e.visible}))}},{key:"gridLabelsOffset",get:function(){var e=0;return this.props.dimension.w>2?e+=140:e+=139,e+=this.extraCategoryColumnWidth}},{key:"gridTicks",get:function(){if(this.data.length>0){var e=function(e,t,r){var n=[e.min,e.max],i=fi(n),a=2*t-2;if(r){var s;n=n.map(Math.exp);var l=(0,pi.p2)().domain(n).ticks();for(l.length>a&&(l=l.filter((function(e){return e%10==0}))),l.length>a&&(l=l.filter(bi));l.length>a;)l=l.filter((function(e,t){return t%2==0}));(s=i).push.apply(s,fi(l.map((function(e){return Math.log(e+1)}))))}else{var u;(u=i).push.apply(u,fi((0,pi.BY)().domain(n).ticks(2*t-2)))}return o().sortBy(o().uniq(i))}(this.props.violinBounds,this.props.dimension.w,this.props.logScale);return e.length>2&&this.violinX(e[1])<this.violinX(e[0])+30&&e.splice(1,1),e.length>2&&this.violinX(e[e.length-2])>this.violinX(e[e.length-1])-30&&e.splice(e.length-2,1),e}return[]}},{key:"data",get:function(){var e=this;return this.props.rows.filter((function(t){return t.numSamples>=parseFloat(e.sampleNumberFilter)}))}},{key:"extraFooterElements",get:function(){var e=[n.createElement("div",{style:{border:"1px solid #cccccc",padding:"1px 4px 1px 4px",borderRadius:4}},n.createElement("span",null,"Hide # <"),n.createElement(_.m1,{value:this.sampleNumberFilter,setValue:this.setSampleNumberFilter,style:{width:50,marginTop:0,marginLeft:5,lineHeight:"15px"},numericOnly:!0,textFieldAppearance:!0}))];return this.props.dimension.w<=2&&e.push(n.createElement("div",{style:{width:71,position:"absolute",right:18,fontSize:11,lineHeight:1.1}},"Expand to see quartiles →")),e}},{key:"mouseInteractionPossible",get:function(){return!this.props.isLoading&&this.data.length>0}},{key:"violinPlotStartX",get:function(){return this.extraCategoryColumnWidth+143}}])&&Gi(r.prototype,i),a&&Gi(r,a),t}(n.Component);Bi([l.observable],Vi.prototype,"categoryColumnDragging",void 0),Bi([l.computed],Vi.prototype,"extraCategoryColumnWidth",null),Bi([m.default],Vi.prototype,"setRef",null),Bi([l.observable],Vi.prototype,"rangeSelection",void 0),Bi([l.observable],Vi.prototype,"tooltipModel",void 0),Bi([m.default],Vi.prototype,"onMouseEnterTooltip",null),Bi([m.default],Vi.prototype,"onMouseLeaveTooltip",null),Bi([l.observable],Vi.prototype,"sampleNumberFilter",void 0),Bi([l.action.bound],Vi.prototype,"setSampleNumberFilter",null),Bi([l.computed],Vi.prototype,"violinColumnWidthWithoutColumnResize",null),Bi([l.computed],Vi.prototype,"violinColumnWidth",null),Bi([l.computed],Vi.prototype,"violinPlotWidth",null),Bi([l.action.bound],Vi.prototype,"onMouseOverBoxPlot",null),Bi([l.action.bound],Vi.prototype,"onMouseOverPoint",null),Bi([l.action.bound],Vi.prototype,"onMouseOverBackground",null),Bi([l.action.bound],Vi.prototype,"onSelectCategory",null),Bi([l.action.bound],Vi.prototype,"onSelectRange",null),Bi([l.action.bound],Vi.prototype,"startCategoryColumnDrag",null),Bi([l.action.bound],Vi.prototype,"doCategoryColumnDrag",null),Bi([l.action.bound],Vi.prototype,"stopCategoryColumnDrag",null),Bi([l.action.bound],Vi.prototype,"executeRangeSelection",null),Bi([l.action.bound],Vi.prototype,"stopRangeSelectionDrag",null),Bi([l.computed],Vi.prototype,"selectedCategories",null),Bi([l.computed],Vi.prototype,"columns",null),Bi([l.computed],Vi.prototype,"gridLabelsOffset",null),Bi([l.computed],Vi.prototype,"gridTicks",null),Bi([l.computed],Vi.prototype,"data",null),Bi([l.computed],Vi.prototype,"extraFooterElements",null),Bi([l.action.bound],Vi.prototype,"onScroll",null),Bi([l.computed],Vi.prototype,"mouseInteractionPossible",null),Bi([l.computed],Vi.prototype,"violinPlotStartX",null);const Ui=Vi=Bi([a.observer],Vi);function qi(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ki(e){return(Ki=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Wi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Yi(e,t){return(Yi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function zi(e){return(zi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Hi=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":zi(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},Zi=[A.oV.PIE_CHART,A.oV.TABLE,A.oV.BAR_CHART,A.oV.MUTATED_GENES_TABLE,A.oV.CNA_GENES_TABLE,A.oV.SAMPLE_TREATMENTS_TABLE,A.oV.SAMPLE_TREATMENT_GROUPS_TABLE,A.oV.SAMPLE_TREATMENT_TARGET_TABLE,A.oV.PATIENT_TREATMENTS_TABLE,A.oV.PATIENT_TREATMENT_GROUPS_TABLE,A.oV.PATIENT_TREATMENT_TARGET_TABLE,A.oV.STRUCTURAL_VARIANT_GENES_TABLE],Xi=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==zi(t)&&"function"!=typeof t?Wi(e):t}(this,Ki(t).call(this,e)),Object.defineProperty(Wi(r),"chartHeaderHeight",{enumerable:!0,configurable:!0,writable:!0,value:20}),Object.defineProperty(Wi(r),"handlers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Wi(r),"plot",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Wi(r),"mouseLeaveTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Wi(r),"mouseInChart",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Wi(r),"placement",{enumerable:!0,configurable:!0,writable:!0,value:"right"}),Object.defineProperty(Wi(r),"chartType",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Wi(r),"newlyAdded",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Wi(r),"selectedRowsKeys",{enumerable:!0,configurable:!0,writable:!0,value:[]}),(0,l.makeObservable)(Wi(r)),r.chartType=r.props.chartType,r.handlers={ref:function(e){r.plot=e},resetFilters:(0,l.action)((function(){r.props.onResetSelection(r.props.chartMeta,[])})),onValueSelection:(0,l.action)((function(e){r.props.onValueSelection(r.props.chartMeta,e)})),onChangeSelectedRows:(0,l.action)((function(e){r.selectedRowsKeys=e})),onDataBinSelection:(0,l.action)((function(e){r.props.onDataBinSelection(r.props.chartMeta,e)})),onToggleLogScale:(0,l.action)((function(){var e,t;null===(t=(e=r.props).onToggleLogScale)||void 0===t||t.call(e,r.props.chartMeta)})),onToggleLogScaleX:(0,l.action)((function(){var e,t;null===(t=(e=r.props).onToggleLogScaleX)||void 0===t||t.call(e,r.props.chartMeta)})),onToggleLogScaleY:(0,l.action)((function(){var e,t;null===(t=(e=r.props).onToggleLogScaleY)||void 0===t||t.call(e,r.props.chartMeta)})),onToggleBoxPlot:(0,l.action)((function(){var e,t;null===(t=(e=r.props).onToggleBoxPlot)||void 0===t||t.call(e,r.props.chartMeta)})),onToggleViolinPlot:(0,l.action)((function(){var e,t;null===(t=(e=r.props).onToggleViolinPlot)||void 0===t||t.call(e,r.props.chartMeta)})),onToggleNAValue:(0,l.action)((function(){var e,t;null===(t=(e=r.props).onToggleNAValue)||void 0===t||t.call(e,r.props.chartMeta)})),onSwapAxes:(0,l.action)((function(){var e,t;null===(t=(e=r.props).onSwapAxes)||void 0===t||t.call(e,r.props.chartMeta)})),onMouseEnterChart:(0,l.action)((function(e){r.mouseLeaveTimeout&&clearTimeout(r.mouseLeaveTimeout),r.placement=e.nativeEvent.x>v.Z.size.width-400?"left":"right",r.mouseInChart=!0})),onMouseLeaveChart:(0,l.action)((function(){r.mouseLeaveTimeout=setTimeout((function(){r.placement="right",r.mouseInChart=!1}),100)})),defaultDownload:{SVG:function(){return Promise.resolve((new XMLSerializer).serializeToString(r.toSVGDOMNode()))},PNG:function(){return Promise.resolve(r.toSVGDOMNode())},PDF:function(){return Promise.resolve(r.toSVGDOMNode())}},onChangeChartType:function(e){r.mouseInChart=!1,r.props.onChangeChartType(r.props.chartMeta,e)},onDeleteChart:function(){r.props.onDeleteChart(r.props.chartMeta)}},(0,l.makeObservable)(Wi(r)),r}var r,i,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yi(e,t)}(t,e),r=t,(i=[{key:"toSVGDOMNode",value:function(){return this.plot?this.plot.toSVGDOMNode():document.createElementNS("http://www.w3.org/2000/svg","svg")}},{key:"changeChartType",value:function(e){this.chartType=e,this.handlers.onChangeChartType(e)}},{key:"openComparisonPage",value:function(e){var t=this;if(this.comparisonPagePossible)switch(this.props.chartType){case A.oV.PIE_CHART:case A.oV.TABLE:t.props.store.openComparisonPage(t.props.chartMeta,{clinicalAttributeValues:t.props.promise.result});break;default:this.props.store.openComparisonPage(this.props.chartMeta,e||{})}}},{key:"getScatterPlotHeight",value:function(e){return A.$u.layout.grid.h*e-this.chartHeaderHeight+33}},{key:"componentDidMount",value:function(){var e=this;this.props.isNewlyAdded(this.props.chartMeta.uniqueKey)&&(this.newlyAdded=!0,setTimeout((function(){return e.newlyAdded=!1}),A.$u.thresholds.chartHighlight))}},{key:"componentWillReceiveProps",value:function(e,t){e.chartType!==this.chartType&&(this.chartType=e.chartType)}},{key:"render",value:function(){var e,t,r,i=this;return n.createElement("div",{className:st()(ot().chart,(e={},t=ot().highlight,r=this.highlightChart,t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e)),"data-test":"chart-container-".concat(this.props.chartMeta.uniqueKey),onMouseEnter:this.handlers.onMouseEnterChart,onMouseLeave:this.handlers.onMouseLeaveChart},n.createElement(At,{height:this.chartHeaderHeight,chartMeta:this.props.chartMeta,chartType:this.props.chartType,store:this.props.store,title:this.props.title,active:this.mouseInChart,resetChart:this.handlers.resetFilters,deleteChart:this.handlers.onDeleteChart,selectedRowsKeys:this.selectedRowsKeys,toggleLogScale:this.handlers.onToggleLogScale,toggleLogScaleX:this.handlers.onToggleLogScaleX,toggleLogScaleY:this.handlers.onToggleLogScaleY,toggleBoxPlot:this.handlers.onToggleBoxPlot,toggleViolinPlot:this.handlers.onToggleViolinPlot,swapAxes:this.handlers.onSwapAxes,toggleNAValue:this.handlers.onToggleNAValue,chartControls:this.chartControls,changeChartType:this.changeChartType,getSVG:function(){return Promise.resolve(i.toSVGDOMNode())},getData:this.props.getData,downloadTypes:this.props.downloadTypes,openComparisonPage:this.openComparisonPage,placement:this.placement,description:this.props.description}),n.createElement("div",{className:ot().chartInnerWrapper},this.props.promise.isPending&&n.createElement(Me.Z,{isLoading:!0,className:ot().chartLoader}),this.props.promise.isError&&n.createElement("div",{className:ot().chartError},n.createElement("i",{className:"fa fa-warning","aria-hidden":"true"})," ","Error when loading data."),(!this.props.chartMeta.renderWhenDataChange||this.props.promise.isComplete)&&n.createElement("div",{style:{visibility:this.props.promise.isPending?"hidden":"visible",display:"flex"}},this.chart&&this.chart())))}},{key:"chartControls",get:function(){var e={};switch(this.chartType){case A.oV.BAR_CHART:e={showLogScaleToggle:this.props.showLogScaleToggle,logScaleChecked:this.props.logScaleChecked,isShowNAChecked:this.props.isShowNAChecked,showNAToggle:this.props.showNAToggle};break;case A.oV.SCATTER:e={showLogScaleXToggle:this.props.showLogScaleXToggle,logScaleXChecked:this.props.logScaleXChecked,showLogScaleYToggle:this.props.showLogScaleYToggle,logScaleYChecked:this.props.logScaleYChecked,showSwapAxes:!!this.props.onSwapAxes};break;case A.oV.VIOLIN_PLOT_TABLE:e={showLogScaleToggle:this.props.showLogScaleToggle,logScaleChecked:this.props.logScaleChecked,showViolinPlotToggle:this.props.showViolinPlotToggle,violinPlotChecked:this.props.violinPlotChecked,showBoxPlotToggle:this.props.showBoxPlotToggle,boxPlotChecked:this.props.boxPlotChecked};break;case A.oV.PIE_CHART:e={showTableIcon:!0};break;case A.oV.TABLE:e={showPieIcon:!0}}return this.comparisonPagePossible&&(e.showComparisonPageIcon=!0),Object.assign(Object.assign({},e),{showResetIcon:this.props.filters&&this.props.filters.length>0})}},{key:"comparisonPagePossible",get:function(){return this.props.promise.isComplete&&this.props.promise.result.length>1&&Zi.indexOf(this.props.chartType)>-1}},{key:"survivalChartData",get:function(){var e,t,r,n,i,a,s,l=this;if(this.props.promise.isComplete&&this.props.patientToAnalysisGroup&&this.props.patientToAnalysisGroup.isComplete){var u=o().find(this.props.promise.result,(function(e){return e.id===l.props.chartMeta.uniqueKey}));return e=u.survivalData,t=this.props.analysisGroupsSettings.groups,r=this.props.patientToAnalysisGroup.result,n=o().mapValues(r,(function(e){return[e]})),i=o().reduce(e,(function(e,t){return t.uniquePatientKey in n&&n[t.uniquePatientKey].forEach((function(r){e[r]=e[r]||[],e[r].push(t)})),e}),{}),a=o().mapValues(i,(function(e){return e.sort((function(e,t){return e.months-t.months}))})),s=null,t.length>1&&(s=Ir.M.apply(void 0,Or(t.map((function(e){return a[e.value]||[]}))))),{patientToAnalysisGroups:n,analysisGroups:t,sortedGroupedSurvivals:a,pValue:s}}}},{key:"borderWidth",get:function(){return this.highlightChart?2:1}},{key:"comparisonButtonForTables",get:function(){var e=this;return this.selectedRowsKeys.length>=2?{content:n.createElement("div",{style:{display:"flex",alignItems:"center"}},n.createElement(gt,{className:st()("fa fa-fw"),style:{marginRight:4}}),"Compare"),onClick:function(){e.openComparisonPage(ye(e.selectedRowsKeys,e.chartType))},isDisabled:function(){return e.selectedRowsKeys.length<2}}:void 0}},{key:"chart",get:function(){var e=this;switch(this.chartType){case A.oV.PIE_CHART:return function(){return n.createElement(rr,{width:(0,f.Ft)(e.props.dimension,e.borderWidth),height:(0,f.xJ)(e.props.dimension,e.chartHeaderHeight),ref:e.handlers.ref,onUserSelection:e.handlers.onValueSelection,openComparisonPage:e.openComparisonPage,filters:e.props.filters,data:e.props.promise.result,placement:e.placement,label:e.props.title,labelDescription:e.props.chartMeta.description,patientAttribute:e.props.chartMeta.patientAttribute})};case A.oV.BAR_CHART:return function(){return n.createElement(Ar,{width:(0,f.Ft)(e.props.dimension,e.borderWidth),height:(0,f.xJ)(e.props.dimension,e.chartHeaderHeight),ref:e.handlers.ref,onUserSelection:e.handlers.onDataBinSelection,filters:e.props.filters,data:e.props.promise.result,showNAChecked:e.props.store.isShowNAChecked(e.props.chartMeta.uniqueKey)})};case A.oV.TABLE:return function(){return n.createElement(Ut,{data:e.props.promise.result,width:(0,f.Ft)(e.props.dimension,e.borderWidth),height:(0,f.qU)(e.props.dimension,e.chartHeaderHeight),filters:e.props.filters,onUserSelection:e.handlers.onValueSelection,labelDescription:e.props.chartMeta.description,patientAttribute:e.props.chartMeta.patientAttribute,showAddRemoveAllButtons:e.mouseInChart})};case A.oV.MUTATED_GENES_TABLE:return function(){var t={columnKey:Tn.NUMBER};return e.props.store.isGlobalMutationFilterActive&&(t.columnTooltip=n.createElement("span",{"data-test":"hidden-mutation-alterations"},"Total number of mutations",n.createElement("br",null),"This table is filtered based on selections in the ",n.createElement("i",null,"Alteration Filter")," menu.")),n.createElement(Pn,{tableType:M.Zh.MUTATION,promise:e.props.promise,width:(0,f.Ft)(e.props.dimension,e.borderWidth),height:(0,f.qU)(e.props.dimension,e.chartHeaderHeight),filters:e.props.filters,onSubmitSelection:e.handlers.onValueSelection,onChangeSelectedRows:e.handlers.onChangeSelectedRows,extraButtons:e.comparisonButtonForTables&&[e.comparisonButtonForTables],selectedRowsKeys:e.selectedRowsKeys,onGeneSelect:e.props.onGeneSelect,selectedGenes:e.props.selectedGenes,genePanelCache:e.props.genePanelCache,cancerGeneFilterEnabled:e.props.cancerGeneFilterEnabled,filterByCancerGenes:e.props.filterByCancerGenes,onChangeCancerGeneFilter:e.props.onChangeCancerGeneFilter,alterationFilterEnabled:e.props.alterationFilterEnabled,filterAlterations:e.props.filterAlterations,columns:[{columnKey:Tn.GENE},{columnKey:Tn.NUMBER_MUTATIONS},t,{columnKey:Tn.FREQ}],defaultSortBy:Tn.FREQ})};case A.oV.STRUCTURAL_VARIANT_GENES_TABLE:return function(){var t={columnKey:Tn.NUMBER};return e.props.store.isGlobalMutationFilterActive&&(t.columnTooltip=n.createElement("span",{"data-test":"hidden-fusion-alterations"},"Total number of fusions",n.createElement("br",null),"This table is filtered based on selections in the ",n.createElement("i",null,"Alteration Filter")," menu.")),n.createElement(Pn,{tableType:M.Zh.STRUCTURAL_VARIANT,promise:e.props.promise,width:(0,f.Ft)(e.props.dimension,e.borderWidth),height:(0,f.qU)(e.props.dimension,e.chartHeaderHeight),filters:e.props.filters,onSubmitSelection:e.handlers.onValueSelection,onChangeSelectedRows:e.handlers.onChangeSelectedRows,extraButtons:e.comparisonButtonForTables&&[e.comparisonButtonForTables],selectedRowsKeys:e.selectedRowsKeys,onGeneSelect:e.props.onGeneSelect,selectedGenes:e.props.selectedGenes,genePanelCache:e.props.genePanelCache,cancerGeneFilterEnabled:e.props.cancerGeneFilterEnabled,filterByCancerGenes:e.props.filterByCancerGenes,onChangeCancerGeneFilter:e.props.onChangeCancerGeneFilter,alterationFilterEnabled:e.props.alterationFilterEnabled,filterAlterations:e.props.filterAlterations,columns:[{columnKey:Tn.GENE},{columnKey:Tn.NUMBER_STRUCTURAL_VARIANTS},t,{columnKey:Tn.FREQ}],defaultSortBy:Tn.FREQ})};case A.oV.CNA_GENES_TABLE:return function(){var t={columnKey:Tn.NUMBER,columnWidthRatio:.17};return e.props.store.isGlobalAlterationFilterActive&&(t.columnTooltip=n.createElement("span",{"data-test":"hidden-fusion-alterations"},"Number of samples with one or more copy number alterations",n.createElement("br",null),"This table is filtered based on selections in the ",n.createElement("i",null,"Alteration Filter")," menu.")),n.createElement(Pn,{tableType:M.Zh.CNA,promise:e.props.promise,width:(0,f.Ft)(e.props.dimension,e.borderWidth),height:(0,f.qU)(e.props.dimension,e.chartHeaderHeight),filters:e.props.filters,onSubmitSelection:e.handlers.onValueSelection,onChangeSelectedRows:e.handlers.onChangeSelectedRows,extraButtons:e.comparisonButtonForTables&&[e.comparisonButtonForTables],selectedRowsKeys:e.selectedRowsKeys,onGeneSelect:e.props.onGeneSelect,selectedGenes:e.props.selectedGenes,genePanelCache:e.props.genePanelCache,cancerGeneFilterEnabled:e.props.cancerGeneFilterEnabled,filterByCancerGenes:e.props.filterByCancerGenes,onChangeCancerGeneFilter:e.props.onChangeCancerGeneFilter,alterationFilterEnabled:e.props.alterationFilterEnabled,filterAlterations:e.props.filterAlterations,columns:[{columnKey:Tn.GENE,columnWidthRatio:.24},{columnKey:Tn.CYTOBAND,columnWidthRatio:.24},{columnKey:Tn.CNA,columnWidthRatio:.18},t,{columnKey:Tn.FREQ,columnWidthRatio:.17}],defaultSortBy:Tn.FREQ})};case A.oV.GENOMIC_PROFILES_TABLE:return function(){return n.createElement(Pn,{tableType:M.Zh.DATA,promise:e.props.promise,width:(0,f.Ft)(e.props.dimension,e.borderWidth),height:(0,f.qU)(e.props.dimension,e.chartHeaderHeight),filters:e.props.filters,onSubmitSelection:e.handlers.onValueSelection,onChangeSelectedRows:e.handlers.onChangeSelectedRows,selectedRowsKeys:e.selectedRowsKeys,onGeneSelect:e.props.onGeneSelect,selectedGenes:e.props.selectedGenes,genePanelCache:e.props.genePanelCache,cancerGeneFilterEnabled:e.props.cancerGeneFilterEnabled,filterByCancerGenes:e.props.filterByCancerGenes,onChangeCancerGeneFilter:e.props.onChangeCancerGeneFilter,columns:[{columnKey:Tn.MOLECULAR_PROFILE},{columnKey:Tn.NUMBER},{columnKey:Tn.FREQ}],defaultSortBy:Tn.FREQ})};case A.oV.CASE_LIST_TABLE:return function(){return n.createElement(Pn,{tableType:M.Zh.DATA,promise:e.props.promise,width:(0,f.Ft)(e.props.dimension,e.borderWidth),height:(0,f.qU)(e.props.dimension,e.chartHeaderHeight),filters:e.props.filters,onSubmitSelection:e.handlers.onValueSelection,onChangeSelectedRows:e.handlers.onChangeSelectedRows,selectedRowsKeys:e.selectedRowsKeys,onGeneSelect:e.props.onGeneSelect,selectedGenes:e.props.selectedGenes,genePanelCache:e.props.genePanelCache,cancerGeneFilterEnabled:e.props.cancerGeneFilterEnabled,filterByCancerGenes:e.props.filterByCancerGenes,onChangeCancerGeneFilter:e.props.onChangeCancerGeneFilter,columns:[{columnKey:Tn.CASE_LIST},{columnKey:Tn.NUMBER},{columnKey:Tn.FREQ}],defaultSortBy:Tn.FREQ})};case A.oV.SURVIVAL:if(this.survivalChartData){var t=this.survivalChartData;return function(){return n.createElement(ir.Z,{ref:e.handlers.ref,sortedGroupedSurvivals:t.sortedGroupedSurvivals,patientToAnalysisGroups:t.patientToAnalysisGroups,pValue:t.pValue,analysisGroups:t.analysisGroups,legendLocation:ir.L.TOOLTIP,title:e.props.title,totalCasesHeader:"Number of Cases, Total",statusCasesHeader:"Number of Events",medianMonthsHeader:"Median Months Survival",yLabelTooltip:x.Ic,xLabelWithEventTooltip:x.qm,xLabelWithoutEventTooltip:x.jM,showDownloadButtons:!1,showSlider:!1,showTable:!1,styleOpts:{padding:{top:15,bottom:30,left:45,right:20},width:(0,f.Ft)(e.props.dimension,e.borderWidth),height:(0,f.xJ)(e.props.dimension,e.chartHeaderHeight),tooltipXOffset:10,tooltipYOffset:-58,pValue:{x:(0,f.Ft)(e.props.dimension,e.borderWidth)-10,y:30,textAnchor:"end"},axis:{y:{axisLabel:{padding:40}}}},fileName:e.props.title.replace(" ","_"),yAxisTickCount:2,xAxisTickCount:4})}}return null;case A.oV.SAMPLE_TREATMENT_TARGET_TABLE:case A.oV.SAMPLE_TREATMENT_GROUPS_TABLE:case A.oV.SAMPLE_TREATMENTS_TABLE:return function(){return n.createElement(Xn,{tableType:w.SAMPLE,promise:e.props.promise,width:(0,f.Ft)(e.props.dimension,e.borderWidth),height:(0,f.qU)(e.props.dimension,e.chartHeaderHeight),filters:e.props.filters,onSubmitSelection:e.handlers.onValueSelection,onChangeSelectedRows:e.handlers.onChangeSelectedRows,extraButtons:e.comparisonButtonForTables&&[e.comparisonButtonForTables],selectedRowsKeys:e.selectedRowsKeys,columns:[{columnKey:Wn.TREATMENT},{columnKey:Wn.TIME},{columnKey:Wn.COUNT}],defaultSortBy:Wn.COUNT,selectedTreatments:[]})};case A.oV.PATIENT_TREATMENT_TARGET_TABLE:case A.oV.PATIENT_TREATMENT_GROUPS_TABLE:case A.oV.PATIENT_TREATMENTS_TABLE:return function(){return n.createElement(ci,{tableType:w.PATIENT,promise:e.props.promise,width:(0,f.Ft)(e.props.dimension,e.borderWidth),height:(0,f.qU)(e.props.dimension,e.chartHeaderHeight),filters:e.props.filters,onSubmitSelection:e.handlers.onValueSelection,onChangeSelectedRows:e.handlers.onChangeSelectedRows,extraButtons:e.comparisonButtonForTables&&[e.comparisonButtonForTables],selectedRowsKeys:e.selectedRowsKeys,columns:[{columnKey:ai.TREATMENT},{columnKey:ai.COUNT}],defaultSortBy:ai.COUNT,selectedTreatments:[]})};case A.oV.SCATTER:return function(){return n.createElement("div",{style:{overflow:"hidden",height:(0,f.xJ)(e.props.dimension,e.chartHeaderHeight)}},n.createElement("div",{style:{marginTop:-33}},n.createElement(Yr,{ref:e.handlers.ref,width:(0,f.Ft)(e.props.dimension,e.borderWidth),height:e.getScatterPlotHeight(e.props.dimension.h),spearmanCorr:e.props.promise.result.spearmanCorr,pearsonCorr:e.props.promise.result.pearsonCorr,plotDomain:e.props.plotDomain,yBinsMin:f.fh,onSelection:e.props.onValueSelection,selectionBounds:e.props.filters&&e.props.filters.length>0?e.props.filters[0]:void 0,data:e.props.promise.result.bins,xBinSize:e.props.promise.result.xBinSize,yBinSize:e.props.promise.result.yBinSize,isLoading:e.props.promise.isPending,axisLabelX:e.props.axisLabelX,axisLabelY:e.props.axisLabelY,tooltip:e.props.tooltip})))};case A.oV.VIOLIN_PLOT_TABLE:this.props.store.getXvsYChartSettings(this.props.chartMeta.uniqueKey);var r=this.props.store.getXvsYViolinChartInfo(this.props.chartMeta.uniqueKey);return function(){var t=e.props.store.clinicalDataBinPromises[r.numericalAttr.clinicalAttributeId]&&e.props.store.clinicalDataBinPromises[r.numericalAttr.clinicalAttributeId].isPending||e.props.promise.isPending;return n.createElement(Ui,{dimension:e.props.dimension,width:(0,f.Ft)(e.props.dimension,e.borderWidth),height:(0,f.qU)(e.props.dimension,e.chartHeaderHeight),categoryColumnName:e.props.axisLabelX,violinColumnName:e.props.axisLabelY,violinBounds:{min:e.props.promise.result.data.axisStart,max:e.props.promise.result.data.axisEnd},rows:e.props.promise.result.data.rows||[],showViolin:e.props.violinPlotChecked,showBox:e.props.boxPlotChecked,logScale:e.props.promise.result.violinLogScale,setFilters:e.props.onValueSelection,selectedCategories:e.props.selectedCategories,isLoading:t})};default:return null}}},{key:"highlightChart",get:function(){return this.newlyAdded}}])&&qi(r.prototype,i),a&&qi(r,a),t}(n.Component);Hi([l.observable],Xi.prototype,"mouseInChart",void 0),Hi([l.observable],Xi.prototype,"placement",void 0),Hi([l.observable],Xi.prototype,"chartType",void 0),Hi([l.observable],Xi.prototype,"newlyAdded",void 0),Hi([l.observable],Xi.prototype,"selectedRowsKeys",void 0),Hi([l.computed],Xi.prototype,"chartControls",null),Hi([l.action.bound],Xi.prototype,"changeChartType",null),Hi([l.computed],Xi.prototype,"comparisonPagePossible",null),Hi([l.action.bound],Xi.prototype,"openComparisonPage",null),Hi([l.computed],Xi.prototype,"survivalChartData",null),Hi([l.computed],Xi.prototype,"borderWidth",null),Hi([l.computed],Xi.prototype,"comparisonButtonForTables",null),Hi([l.computed],Xi.prototype,"chart",null),Hi([l.computed],Xi.prototype,"highlightChart",null),Xi=Hi([a.observer],Xi);var Qi=r(10300),$i=r.n(Qi);function Ji(e){return(Ji="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function to(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ro(e,t){return!t||"object"!==Ji(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function no(e){return(no=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function io(e,t){return(io=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var oo=function(e){function t(){return eo(this,t),ro(this,no(t).apply(this,arguments))}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&io(e,t)}(t,e),r=t,(n=[{key:"shouldComponentUpdate",value:function(){var e=this;return setTimeout((function(){return e.forceUpdate()}),0),!1}},{key:"render",value:function(){return this.props.children}}])&&to(r.prototype,n),i&&to(r,i),t}(n.Component),ao=r(41940);function so(){return(so=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function lo(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function uo(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function co(e){return(co=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function po(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ho(e,t){return(ho=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fo(e){return(fo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var mo=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":fo(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},yo=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==fo(t)&&"function"!=typeof t?po(e):t}(this,co(t).call(this,e)),Object.defineProperty(po(r),"store",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(po(r),"handlers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(po(r),"showErrorMessage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(po(r),"renderAttributeChart",{enumerable:!0,configurable:!0,writable:!0,value:function(e){var t={chartMeta:e,chartType:r.props.store.chartsType.get(e.uniqueKey),store:r.props.store,dimension:r.store.chartsDimension.get(e.uniqueKey),title:e.displayName,filters:[],onDeleteChart:r.handlers.onDeleteChart,isNewlyAdded:r.handlers.isNewlyAdded,studyViewFilters:r.store.filters,analysisGroupsSettings:r.store.analysisGroupsSettings,cancerGeneFilterEnabled:r.store.oncokbCancerGeneFilterEnabled,setComparisonConfirmationModal:r.store.setComparisonConfirmationModal};switch(r.store.chartsType.get(e.uniqueKey)){case A.oV.PIE_CHART:r.store.isUserDefinedCustomDataChart(e.uniqueKey)?(t.filters=r.store.getCustomDataFiltersByUniqueKey(e.uniqueKey).map((function(e){return e.value})),t.onValueSelection=r.handlers.setCustomChartFilters,t.onResetSelection=r.handlers.setCustomChartFilters,t.promise=r.store.getCustomDataCount(e)):r.store.isGenericAssayChart(e.uniqueKey)?(t.filters=r.store.getGenericAssayDataFiltersByUniqueKey(t.chartMeta.uniqueKey).map((function(e){return e.value})),t.onValueSelection=r.handlers.onGenericAssayCategoricalValueSelection,t.onResetSelection=r.handlers.onGenericAssayCategoricalValueSelection,t.promise=r.store.getGenericAssayChartDataCount(e)):(t.promise=r.store.getClinicalDataCount(e),t.filters=r.store.getClinicalDataFiltersByUniqueKey(e.uniqueKey).map((function(e){return e.value})),t.onValueSelection=r.handlers.onValueSelection,t.onResetSelection=r.handlers.onValueSelection),t.onChangeChartType=r.handlers.onChangeChartType,t.getData=function(t){return r.store.getPieChartDataDownload(e,t)},t.downloadTypes=["Summary Data","Full Data","SVG","PDF"];break;case A.oV.BAR_CHART:r.store.isGeneSpecificChart(e.uniqueKey)?(t.promise=r.store.getGenomicChartDataBin(e),t.filters=r.store.getGenomicDataIntervalFiltersByUniqueKey(t.chartMeta.uniqueKey),t.onDataBinSelection=r.handlers.onGenomicDataBinSelection,t.onResetSelection=r.handlers.onGenomicDataBinSelection,t.getData=function(){return r.store.getChartDownloadableData(e)}):r.store.isGenericAssayChart(e.uniqueKey)?(t.promise=r.store.getGenericAssayChartDataBin(e),t.filters=r.store.getGenericAssayDataFiltersByUniqueKey(t.chartMeta.uniqueKey),t.onDataBinSelection=r.handlers.onGenericAssayDataBinSelection,t.onResetSelection=r.handlers.onGenericAssayDataBinSelection,t.getData=function(){return r.store.getChartDownloadableData(e)}):(t.promise=r.store.getClinicalDataBin(e),t.filters=r.store.getClinicalDataFiltersByUniqueKey(e.uniqueKey),t.onDataBinSelection=r.handlers.onDataBinSelection,t.onResetSelection=r.handlers.onDataBinSelection,t.getData=function(){return r.store.getChartDownloadableData(e)}),t.onToggleLogScale=r.handlers.onToggleLogScale,t.onToggleNAValue=r.handlers.onToggleNAValue,t.showLogScaleToggle=r.store.isLogScaleToggleVisible(e.uniqueKey,t.promise.result),t.logScaleChecked=r.store.isLogScaleChecked(e.uniqueKey),t.isShowNAChecked=r.store.isShowNAChecked(e.uniqueKey),t.showNAToggle=r.store.isShowNAToggleVisible(t.promise.result),t.downloadTypes=["Data","SVG","PDF"];break;case A.oV.TABLE:r.store.isUserDefinedCustomDataChart(e.uniqueKey)?(t.filters=r.store.getCustomDataFiltersByUniqueKey(e.uniqueKey).map((function(e){return e.value})),t.onValueSelection=r.handlers.setCustomChartFilters,t.onResetSelection=r.handlers.setCustomChartFilters,t.promise=r.store.getCustomDataCount(e)):r.store.isGenericAssayChart(e.uniqueKey)?(t.filters=r.store.getGenericAssayDataFiltersByUniqueKey(t.chartMeta.uniqueKey).map((function(e){return e.value})),t.onValueSelection=r.handlers.onGenericAssayCategoricalValueSelection,t.onResetSelection=r.handlers.onGenericAssayCategoricalValueSelection,t.promise=r.store.getGenericAssayChartDataCount(e)):(t.filters=r.store.getClinicalDataFiltersByUniqueKey(e.uniqueKey).map((function(e){return e.value})),t.promise=r.store.getClinicalDataCount(e),t.onValueSelection=r.handlers.onValueSelection,t.onResetSelection=r.handlers.onValueSelection),t.onChangeChartType=r.handlers.onChangeChartType,t.getData=function(){return r.store.getChartDownloadableData(e)},t.downloadTypes=["Data"];break;case A.oV.MUTATED_GENES_TABLE:t.filters=r.store.getGeneFiltersByUniqueKey(e.uniqueKey),t.promise=r.store.mutatedGeneTableRowData,t.onValueSelection=r.store.addGeneFilters,t.onResetSelection=function(){return r.store.resetGeneFilter(e.uniqueKey)},t.selectedGenes=r.store.selectedGenes,t.onGeneSelect=r.store.onCheckGene,t.title=r.store.getChartTitle(A.oV.MUTATED_GENES_TABLE,t.title),t.getData=function(){return r.store.getMutatedGenesDownloadData()},t.genePanelCache=r.store.genePanelCache,t.downloadTypes=["Data"],t.filterByCancerGenes=r.store.filterMutatedGenesTableByCancerGenes,t.onChangeCancerGeneFilter=r.store.updateMutatedGenesTableByCancerGenesFilter,t.alterationFilterEnabled=(0,Ce.Ib)().skin_show_settings_menu,t.filterAlterations=r.store.isGlobalMutationFilterActive;break;case A.oV.STRUCTURAL_VARIANT_GENES_TABLE:t.filters=r.store.getGeneFiltersByUniqueKey(e.uniqueKey),t.promise=r.store.structuralVariantGeneTableRowData,t.onValueSelection=r.store.addGeneFilters,t.onResetSelection=function(){return r.store.resetGeneFilter(e.uniqueKey)},t.selectedGenes=r.store.selectedGenes,t.onGeneSelect=r.store.onCheckGene,t.title=r.store.getChartTitle(A.oV.STRUCTURAL_VARIANT_GENES_TABLE,t.title),t.getData=function(){return r.store.getStructuralVariantGenesDownloadData()},t.genePanelCache=r.store.genePanelCache,t.downloadTypes=["Data"],t.filterByCancerGenes=r.store.filterSVGenesTableByCancerGenes,t.onChangeCancerGeneFilter=r.store.updateSVGenesTableByCancerGenesFilter,t.alterationFilterEnabled=(0,Ce.Ib)().skin_show_settings_menu,t.filterAlterations=r.store.isGlobalMutationFilterActive;break;case A.oV.CNA_GENES_TABLE:t.filters=r.store.getGeneFiltersByUniqueKey(e.uniqueKey),t.promise=r.store.cnaGeneTableRowData,t.onValueSelection=r.store.addGeneFilters,t.onResetSelection=function(){return r.store.resetGeneFilter(e.uniqueKey)},t.selectedGenes=r.store.selectedGenes,t.onGeneSelect=r.store.onCheckGene,t.title=r.store.getChartTitle(A.oV.CNA_GENES_TABLE,t.title),t.getData=function(){return r.store.getGenesCNADownloadData()},t.genePanelCache=r.store.genePanelCache,t.downloadTypes=["Data"],t.filterByCancerGenes=r.store.filterCNAGenesTableByCancerGenes,t.onChangeCancerGeneFilter=r.store.updateCNAGenesTableByCancerGenesFilter,t.alterationFilterEnabled=(0,Ce.Ib)().skin_show_settings_menu,t.filterAlterations=r.store.isGlobalAlterationFilterActive;break;case A.oV.GENOMIC_PROFILES_TABLE:t.filters=(0,l.toJS)(r.store.genomicProfilesFilter),t.promise=r.store.molecularProfileSampleCounts,t.onValueSelection=r.store.addGenomicProfilesFilter,t.onResetSelection=function(){r.store.setGenomicProfilesFilter([])};break;case A.oV.CASE_LIST_TABLE:t.filters=(0,l.toJS)(r.store.caseListsFilter),t.promise=r.store.caseListSampleCounts,t.onValueSelection=r.store.addCaseListsFilter,t.onResetSelection=function(){r.store.setCaseListsFilter([])};break;case A.oV.SURVIVAL:t.promise=r.store.survivalPlotData,t.getData=function(){return r.store.getSurvivalDownloadData(e)},t.patientToAnalysisGroup=r.store.patientToAnalysisGroup,t.downloadTypes=["Data","SVG","PDF"],t.description=r.store.survivalDescriptions.result?r.store.survivalDescriptions.result[e.uniqueKey.substring(0,e.uniqueKey.lastIndexOf("_SURVIVAL"))][0]:void 0;break;case A.oV.VIOLIN_PLOT_TABLE:var i=r.store.getXvsYViolinChartInfo(t.chartMeta.uniqueKey),o=r.store.getXvsYChartSettings(t.chartMeta.uniqueKey);t.filters=[].concat(lo(r.store.getClinicalDataFiltersByUniqueKey(i.categoricalAttr.clinicalAttributeId)),lo(r.store.getClinicalDataFiltersByUniqueKey(i.numericalAttr.clinicalAttributeId))),t.title="".concat(i.numericalAttr.displayName).concat(o.violinLogScale?" (log)":""," vs ").concat(i.categoricalAttr.displayName),t.promise=r.store.clinicalViolinDataCache.get({chartInfo:i,violinLogScale:!!o.violinLogScale}),t.axisLabelX=i.categoricalAttr.displayName,t.axisLabelY=i.numericalAttr.displayName,t.showLogScaleToggle=(0,f.S6)(i.numericalAttr.clinicalAttributeId),t.logScaleChecked=o.violinLogScale,t.onToggleLogScale=function(){var e=r.store.getXvsYChartSettings(t.chartMeta.uniqueKey);e.violinLogScale=!e.violinLogScale},t.showViolinPlotToggle=!0,t.violinPlotChecked=o.showViolin,t.onToggleViolinPlot=function(){var e=r.store.getXvsYChartSettings(t.chartMeta.uniqueKey);e.showViolin=!e.showViolin},t.showBoxPlotToggle=!0,t.boxPlotChecked=o.showBox,t.onToggleBoxPlot=function(){var e=r.store.getXvsYChartSettings(t.chartMeta.uniqueKey);e.showBox=!e.showBox},t.onValueSelection=function(e,t){switch(e){case"categorical":r.store.updateClinicalAttributeFilterByValues(i.categoricalAttr.clinicalAttributeId,t.map((function(e){return{value:e}})));break;case"numerical":r.store.updateClinicalDataCustomIntervalFilter(i.numericalAttr.clinicalAttributeId,t)}},t.selectedCategories=r.store.getClinicalDataFiltersByUniqueKey(i.categoricalAttr.clinicalAttributeId).map((function(e){return e.value})),t.onResetSelection=function(){r.store.updateClinicalAttributeFilterByValues(i.categoricalAttr.clinicalAttributeId,[]),r.store.updateClinicalAttributeFilterByValues(i.numericalAttr.clinicalAttributeId,[])};break;case A.oV.SCATTER:t.filters=r.store.getScatterPlotFiltersByUniqueKey(t.chartMeta.uniqueKey);var a=r.store.getXvsYScatterChartInfo(t.chartMeta.uniqueKey),s=r.store.getXvsYChartSettings(t.chartMeta.uniqueKey);t.title=t.chartMeta.displayName,t.promise=r.store.clinicalDataDensityCache.get({chartInfo:a,xAxisLogScale:!!s.xLogScale,yAxisLogScale:!!s.yLogScale}),t.showLogScaleXToggle=(0,f.S6)(a.xAttr.clinicalAttributeId),t.showLogScaleYToggle=(0,f.S6)(a.yAttr.clinicalAttributeId),t.logScaleXChecked=s.xLogScale,t.logScaleYChecked=s.yLogScale,t.onToggleLogScaleX=function(){var e=r.store.getXvsYChartSettings(t.chartMeta.uniqueKey);e.xLogScale=!e.xLogScale},t.onToggleLogScaleY=function(){var e=r.store.getXvsYChartSettings(t.chartMeta.uniqueKey);e.yLogScale=!e.yLogScale},t.onSwapAxes=function(){r.store.swapXvsYChartAxes(t.chartMeta.uniqueKey)},t.plotDomain=a.plotDomain,t.axisLabelX="".concat(a.xAttr.displayName).concat(s.xLogScale?" (log)":""),t.axisLabelY="".concat(a.yAttr.displayName).concat(s.yLogScale?" (log)":""),t.tooltip=(0,f.Jd)(a,s),t.onValueSelection=function(e){r.store.updateScatterPlotFilterByValues(t.chartMeta.uniqueKey,e)},t.onResetSelection=function(){r.store.updateScatterPlotFilterByValues(t.chartMeta.uniqueKey)},t.sampleToAnalysisGroup=r.store.sampleToAnalysisGroup,t.getData=function(){return r.store.getScatterDownloadData(t.chartMeta.uniqueKey)},t.downloadTypes=["Data","SVG","PDF"];break;case A.oV.SAMPLE_TREATMENTS_TABLE:t.filters=r.store.sampleTreatmentFiltersAsStrings,t.promise=r.store.sampleTreatments,t.onValueSelection=r.store.onTreatmentSelection,t.onResetSelection=function(){r.store.clearSampleTreatmentFilters()};break;case A.oV.SAMPLE_TREATMENT_GROUPS_TABLE:t.filters=r.store.sampleTreatmentGroupFiltersAsStrings,t.promise=r.store.sampleTreatmentGroups,t.onValueSelection=r.store.onTreatmentSelection,t.onResetSelection=function(){r.store.clearSampleTreatmentGroupFilters()};break;case A.oV.SAMPLE_TREATMENT_TARGET_TABLE:t.filters=r.store.sampleTreatmentTargetFiltersAsStrings,t.promise=r.store.sampleTreatmentTarget,t.onValueSelection=r.store.onTreatmentSelection,t.onResetSelection=function(){r.store.clearSampleTreatmentTargetFilters()};break;case A.oV.PATIENT_TREATMENTS_TABLE:t.filters=r.store.patientTreatmentFiltersAsStrings,t.promise=r.store.patientTreatments,t.onValueSelection=r.store.onTreatmentSelection,t.onResetSelection=function(){r.store.clearPatientTreatmentFilters()};break;case A.oV.PATIENT_TREATMENT_GROUPS_TABLE:t.filters=r.store.patientTreatmentGroupFiltersAsStrings,t.promise=r.store.patientTreatmentGroups,t.onValueSelection=r.store.onTreatmentSelection,t.onResetSelection=function(){r.store.clearPatientTreatmentGroupFilters()};break;case A.oV.PATIENT_TREATMENT_TARGET_TABLE:t.filters=r.store.patientTreatmentTargetFiltersAsStrings,t.promise=r.store.patientTreatmentTarget,t.onValueSelection=r.store.onTreatmentSelection,t.onResetSelection=function(){r.store.clearPatientTreatmentTargetFilters()}}return n.createElement("div",{key:e.uniqueKey},n.createElement(oo,null,n.createElement(Xi,so({key:e.uniqueKey},t))))}}),(0,l.makeObservable)(po(r)),r.store=e.store,r.handlers={onValueSelection:function(e,t){r.store.updateClinicalDataFilterByValues(e.uniqueKey,t.map((function(e){return{value:e}})))},onDataBinSelection:function(e,t){r.store.updateClinicalDataIntervalFilters(e.uniqueKey,t)},onToggleLogScale:function(e){r.store.toggleLogScale(e.uniqueKey)},onToggleNAValue:function(e){r.store.toggleNAValue(e.uniqueKey)},onDeleteChart:function(e){r.store.resetFilterAndChangeChartVisibility(e.uniqueKey,!1)},onChangeChartType:function(e,t){r.store.changeChartType(e,t)},isNewlyAdded:function(e){return r.store.isNewlyAdded(e)},setCustomChartFilters:function(e,t){r.store.setCustomChartFilters(e.uniqueKey,t)},onLayoutChange:function(e){r.store.updateCurrentGridLayout(e),r.onResize(e)},resetGeneFilter:function(e){r.store.resetGeneFilter(e.uniqueKey)},onGenomicDataBinSelection:function(e,t){r.store.updateGenomicDataIntervalFilters(e.uniqueKey,t)},onGenericAssayDataBinSelection:function(e,t){r.store.updateGenericAssayDataFilters(e.uniqueKey,t)},onGenericAssayCategoricalValueSelection:function(e,t){r.store.updateCategoricalGenericAssayDataFilters(e.uniqueKey,t)}},r}var r,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ho(e,t)}(t,e),r=t,(i=[{key:"onResize",value:function(e){var t=this;e.filter((function(e){var r=t.store.chartsDimension.get(e.i);return r&&(r.h!==e.h||r.w!==e.w)})).forEach((function(e){var r=e.i,n=t.store.chartsDimension.get(r);n.h=e.h,n.w=e.w,t.store.chartsDimension.set(r,n)}))}},{key:"getProgressItems",value:function(e){var t=[this.store.initialVisibleAttributesClinicalDataBinCountData,this.store.initialVisibleAttributesClinicalDataCountData],r=[this.store.caseListSampleCounts,this.store.selectedSamples],n=e>2&&"pending"===ao.CX.apply(void 0,t),i=e>2&&"pending"===ao.CX.apply(void 0,r);return[{label:"Loading meta information",promises:[this.store.defaultVisibleAttributes,this.store.mutationProfiles,this.store.cnaProfiles]},{label:"Loading clinical data"+(n?" - this can take several seconds":""),promises:t},{label:"Loading sample data"+(i?" - this can take several seconds":""),promises:r},{label:"Rendering"}]}},{key:"render",value:function(){var e=this;return n.createElement("div",null,n.createElement(Me.Z,{isLoading:this.store.loadingInitialDataForSummaryTab,size:"big",center:!0},n.createElement(xe.Z,{getItems:this.getProgressItems,show:this.store.loadingInitialDataForSummaryTab,sequential:!0})),this.store.invalidSampleIds.result.length>0&&this.showErrorMessage&&n.createElement("div",null,n.createElement("div",{className:"alert alert-danger"},n.createElement("button",{type:"button",className:"close",onClick:function(){return e.showErrorMessage=!1}},"×"),"The following sample(s) might have been deleted/updated with the recent data updates",n.createElement("br",null),n.createElement("ul",{style:{listStyle:"none",padding:"10px",maxHeight:"300px",overflowY:"scroll"}},this.store.invalidSampleIds.result.map((function(e){return n.createElement("li",null,e.studyId+":"+e.sampleId)}))))),this.store.showSettingRestoreMsg&&n.createElement("div",null,n.createElement("div",{className:"alert alert-info"},n.createElement("button",{type:"button",className:"close",onClick:function(){e.store.hideRestoreSettingsMsg=!0}},"×"),"Your previously saved layout preferences have been applied.",n.createElement("button",{className:"btn btn-primary btn-sm",onClick:function(){e.store.hideRestoreSettingsMsg=!0},style:{marginLeft:"10px"}},"Keep Saved Layout"),n.createElement("button",{className:"btn btn-primary btn-sm",onClick:function(){e.store.hideRestoreSettingsMsg=!0,e.store.undoUserChartSettings()},style:{marginLeft:"10px"}},"Revert to Previous Layout"))),!this.store.loadingInitialDataForSummaryTab&&!this.store.blockLoading&&n.createElement("div",{"data-test":"summary-tab-content"},n.createElement("div",{className:tt().studyViewFlexContainer},this.store.defaultVisibleAttributes.isComplete&&n.createElement($i(),{className:"layout",style:{width:this.store.containerWidth},width:this.store.containerWidth,cols:this.store.studyViewPageLayoutProps.cols,rowHeight:this.store.studyViewPageLayoutProps.grid.h,layout:this.store.studyViewPageLayoutProps.layout,margin:[A.$u.layout.gridMargin.x,A.$u.layout.gridMargin.y],useCSSTransforms:!1,draggableHandle:".".concat(nt().draggable),onLayoutChange:this.handlers.onLayoutChange,onResizeStop:this.onResize},this.store.visibleAttributes.map(this.renderAttributeChart)))),this.props.store.selectedSamples.isComplete&&0===this.props.store.selectedSamples.result.length&&n.createElement("div",{className:tt().studyViewNoSamples},n.createElement("div",{className:tt().studyViewNoSamplesInner},n.createElement("p",null,"The filters you have selected have filtered out all the samples in this study; because of this, no data visualizations are shown."),n.createElement("p",null,"You can remove filters in the header of this page to widen your search criteria and add samples back to your results."))))}}])&&uo(r.prototype,i),o&&uo(r,o),t}(n.Component);mo([l.observable],yo.prototype,"showErrorMessage",void 0),mo([m.default],yo.prototype,"onResize",null),mo([m.default],yo.prototype,"getProgressItems",null),yo=mo([a.observer],yo);var bo=r(28358),go=r.n(bo),vo=r(17790);function So(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Co(e){return(Co=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function To(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Eo(e,t){return(Eo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function wo(e){return(wo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Ao=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":wo(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},Po=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==wo(t)&&"function"!=typeof t?To(e):t}(this,Co(t).call(this,e)),Object.defineProperty(To(r),"downloadingData",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(To(r),"showDownloadErrorMessage",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(To(r),"geneValidationHasIssue",{enumerable:!0,configurable:!0,writable:!0,value:!1}),(0,l.makeObservable)(To(r)),r}var r,i,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Eo(e,t)}(t,e),r=t,(i=[{key:"updateSelectedGenes",value:function(e,t,r){this.geneValidationHasIssue=""===r||!o().isUndefined(e.error)||0!==t.suggestions.length,this.props.store.updateSelectedGenes(e.query,r)}},{key:"render",value:function(){var e=this;return n.createElement("div",{className:"studyViewSummaryHeader"},n.createElement("div",{className:go().rightPanel},n.createElement("div",{className:"small"},n.createElement(vo.Z,{inputGeneQuery:this.props.store.geneQueryStr,validateInputGeneQuery:!0,callback:this.updateSelectedGenes,location:vo.e.STUDY_VIEW_PAGE,error:this.oqlSubmitError,messages:this.oqlMessages})),n.createElement("button",{disabled:this.isQueryButtonDisabled,className:st()("btn btn-primary btn-sm",go().submitQuery),"data-event":(0,I.XO)({category:"studyPage",action:"submitQuery",label:this.props.store.queriedPhysicalStudyIds.result}),"data-test":"geneSetSubmit",onClick:function(){return e.props.store.onSubmitQuery()}},"Query")))}},{key:"isQueryButtonDisabled",get:function(){return""===this.props.store.geneQueryStr||this.geneValidationHasIssue||!!this.oqlSubmitError}},{key:"isQueryLimitReached",get:function(){return!!this.props.store.selectedSamples.isComplete&&this.props.store.geneQueries.length*this.props.store.selectedSamples.result.length>(0,Ce.Ib)().query_product_limit}},{key:"geneLimit",get:function(){return this.props.store.selectedSamples.isComplete?Math.floor((0,Ce.Ib)().query_product_limit/this.props.store.selectedSamples.result.length):0}},{key:"oqlMessages",get:function(){return(0,d.ym)(this.props.store.geneQueries)}},{key:"oqlSubmitError",get:function(){if(this.props.store.isSingleNonVirtualStudyQueried){if(this.props.store.alterationTypesInOQL.haveMutInQuery&&!this.props.store.defaultMutationProfile)return"Mutation data query specified in OQL, but no mutation profile is available for the selected study.";if(this.props.store.alterationTypesInOQL.haveCnaInQuery&&!this.props.store.defaultCnaProfile)return"CNA data query specified in OQL, but no CNA profile is available in the selected study.";if(this.props.store.alterationTypesInOQL.haveMrnaInQuery&&!this.props.store.defaultMrnaProfile)return"mRNA expression data query specified in OQL, but no mRNA profile is available in the selected study.";if(this.props.store.alterationTypesInOQL.haveProtInQuery&&!this.props.store.defaultProtProfile)return"Protein level data query specified in OQL, but no protein level profile is available in the selected study."}return this.props.store.alterationTypesInOQL.haveMrnaInQuery&&this.props.store.displayedStudies.isComplete&&this.props.store.displayedStudies.result.length>1?"Expression filtering in the gene list (the EXP command) is not supported when doing cross cancer queries.":this.props.store.alterationTypesInOQL.haveProtInQuery&&this.props.store.displayedStudies.isComplete&&this.props.store.displayedStudies.result.length>1?"Protein level filtering in the gene list (the PROT command) is not supported when doing cross cancer queries.":this.isQueryLimitReached?"Please limit your queries to ".concat(this.geneLimit," genes or fewer."):void 0}}])&&So(r.prototype,i),a&&So(r,a),t}(n.Component);Ao([l.observable],Po.prototype,"downloadingData",void 0),Ao([l.observable],Po.prototype,"showDownloadErrorMessage",void 0),Ao([l.observable],Po.prototype,"geneValidationHasIssue",void 0),Ao([l.action.bound],Po.prototype,"updateSelectedGenes",null),Ao([l.computed],Po.prototype,"isQueryButtonDisabled",null),Ao([l.computed],Po.prototype,"isQueryLimitReached",null),Ao([l.computed],Po.prototype,"geneLimit",null),Ao([l.computed],Po.prototype,"oqlMessages",null),Ao([l.computed],Po.prototype,"oqlSubmitError",null);const _o=Po=Ao([a.observer],Po);var Io=r(44035),Oo=r(9405);function ko(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Do(e){return(Do=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function No(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ro(e,t){return(Ro=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Go(e){return(Go="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Mo=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":Go(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},Fo=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==Go(t)&&"function"!=typeof t?No(e):t}(this,Do(t).call(this,e)),Object.defineProperty(No(r),"showMoreDescription",{enumerable:!0,configurable:!0,writable:!0,value:!1}),(0,l.makeObservable)(No(r)),r}var r,i,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ro(e,t)}(t,e),r=t,(i=[{key:"render",value:function(){var e=this;return n.createElement("div",{className:st()(go().summary)},n.createElement("h3",{style:{marginBottom:3,display:"flex",alignItems:"baseline"}},this.name,this.props.isMixedReferenceGenome&&(0,te.gM)(),this.props.hasRawDataForDownload&&n.createElement(_.ZD,{trigger:["hover"],placement:"top",overlay:n.createElement("span",null,"Download all clinical and genomic data of this study")},n.createElement("span",{"data-test":"studySummaryRawDataDownloadIcon","data-event":(0,I.XO)({category:"studyPage",action:"dataDownload",label:this.props.studies.map((function(e){return e.studyId})).join(",")}),style:{marginLeft:"10px",fontSize:"14px"}},n.createElement(Oo.x,{studyId:this.props.studies[0].studyId})))),n.createElement("div",{className:go().description},n.createElement("div",null,this.descriptionFirstLine,this.hasMoreDescription&&n.createElement("i",{className:"fa fa-".concat(this.showMoreDescription?"minus":"plus","-circle"),onClick:function(){return e.showMoreDescription=!e.showMoreDescription},style:{marginLeft:"5px",cursor:"pointer"}})),this.showMoreDescription&&n.createElement("div",null,n.createElement("ul",{className:go().studyLinks},this.descriptionRemainingLines),this.props.showOriginStudiesInSummaryDescription&&n.createElement("div",null,this.props.originStudies.isComplete&&this.props.originStudies.result.length>0&&n.createElement("span",null,n.createElement("span",{style:{fontWeight:"bold",marginBottom:"5px",display:"block"}},"This virtual study was derived from:"),this.props.originStudies.result.map((function(e){return n.createElement(Io.w,e)}))),n.createElement(Me.Z,{isLoading:this.props.originStudies.isPending,center:!0,size:"big"})))))}},{key:"name",get:function(){return 1===this.props.studies.length?this.props.studies[0].name:"Combined Study"}},{key:"descriptionFirstLine",get:function(){if(1===this.props.studies.length){var e=[n.createElement("span",{dangerouslySetInnerHTML:{__html:this.props.studies[0].description.split(/\n+/g)[0]}})];return this.props.studies[0].pmid&&e.push(n.createElement("a",{target:"_blank",href:(0,_.H6)("/pubmed/".concat(this.props.studies[0].pmid)),style:{marginLeft:"5px"}},"PubMed")),n.createElement("span",null,e)}return n.createElement("span",null,"This combined study contains samples from ".concat(this.props.studies.length," studies"))}},{key:"hasMoreDescription",get:function(){return this.props.showOriginStudiesInSummaryDescription||this.props.studies.length>1||this.props.studies[0].description.split(/\n/g).length>1}},{key:"descriptionRemainingLines",get:function(){if(1!==this.props.studies.length)return o().map(this.props.studies,(function(e){return n.createElement("li",null,n.createElement("a",{href:(0,P.yY)(e.studyId),target:"_blank"},e.name))}));var e=this.props.studies[0].description.split(/\n/g);return e.length>1?[n.createElement("span",{style:{whiteSpace:"pre"},dangerouslySetInnerHTML:{__html:e.slice(1).join("\n")}})]:[]}}])&&ko(r.prototype,i),a&&ko(r,a),t}(n.Component);Mo([l.observable],Fo.prototype,"showMoreDescription",void 0),Mo([l.computed],Fo.prototype,"name",null),Mo([l.computed],Fo.prototype,"descriptionFirstLine",null),Mo([l.computed],Fo.prototype,"hasMoreDescription",null),Mo([l.computed],Fo.prototype,"descriptionRemainingLines",null);const Lo=Fo=Mo([a.observer],Fo);var xo=r(35286),Bo=r.n(xo),jo=r(92576),Vo=r.n(jo),Uo=r(90637),qo=r.n(Uo);function Ko(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Wo(e){return(Wo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Yo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zo(e,t){return(zo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ho(e){return(Ho="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Zo=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":Ho(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},Xo=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==Ho(t)&&"function"!=typeof t?Yo(e):t}(this,Wo(t).call(this,e)),(0,l.makeObservable)(Yo(r)),r}var r,i,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zo(e,t)}(t,e),r=t,(i=[{key:"render",value:function(){return n.createElement("div",{className:Vo().main,style:{background:this.props.backgroundColor,color:this.contentColor}},n.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"}},n.createElement("span",{className:Vo().content},this.props.content),this.props.infoSection),n.createElement(Le.If,{condition:o().isFunction(this.props.onDelete)},n.createElement("span",{"data-test":"pill-tag-delete",className:Vo().delete,onClick:this.props.onDelete},n.createElement("i",{className:"fa fa-times-circle"}))))}},{key:"contentColor",get:function(){return"light"===qo()(this.props.backgroundColor)?"#000":"#fff"}}])&&Ko(r.prototype,i),a&&Ko(r,a),t}(n.Component);Zo([l.computed],Xo.prototype,"contentColor",null);var Qo=r(68824),$o=r.n(Qo);function Jo(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ea(e){return(ea=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ta(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ra(e,t){return(ra=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function na(e){return(na="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ia=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":na(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},oa=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==na(t)&&"function"!=typeof t?ta(e):t}(this,ea(t).call(this,e)),(0,l.makeObservable)(ta(r)),r}var r,i,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ra(e,t)}(t,e),r=t,(i=[{key:"render",value:function(){return n.createElement("div",{className:$o().main},this.child)}},{key:"child",get:function(){var e=this,t=[];return this.props.group&&t.push(n.createElement("span",{className:st()($o().text,$o().mostLeft)},"(")),o().reduce(this.props.components,(function(t,r,i){return i>0&&t.push(n.createElement("span",{className:$o().text},e.props.operation)),t.push(r),t}),t),this.props.group&&t.push(n.createElement("span",{className:st()($o().text,$o().mostRight)},")")),t}}])&&Jo(r.prototype,i),a&&Jo(r,a),t}(n.Component);function aa(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function sa(e){return(sa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function la(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ua(e,t){return(ua=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ca(e){return(ca="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}ia([l.computed],oa.prototype,"child",null),oa=ia([a.observer],oa);var pa=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":ca(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},da=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==ca(t)&&"function"!=typeof t?la(e):t}(this,sa(t).call(this,e)),(0,l.makeObservable)(la(r)),r}var r,i,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ua(e,t)}(t,e),r=t,(i=[{key:"renderClinicalDataFilters",value:function(e,t,r){var i=this;return o().reduce(e||[],(function(e,t){var o=i.props.attributesMetaSet[t.attributeId];if(o){var a=i.props.clinicalAttributeIdToDataType[t.attributeId]===f.g.STRING?i.renderCategoricalDataFilter(t,r,o):i.renderDataBinFilter(t.values,(function(e,t){(0,f.oM)(t,o,i.props.store.getClinicalDataBin,i.props.store.getClinicalDataFiltersByUniqueKey,i.props.store.updateCustomBins,i.props.store.updateClinicalDataIntervalFilters)}),r,o);e.push(n.createElement("div",{className:Bo().parentGroupLogic},n.createElement(oa,{components:[n.createElement("span",{className:Bo().filterClinicalAttrName},o.displayName),a],operation:":",group:!1})))}return e}),t)}},{key:"renderDataBinFilter",value:function(e,t,r,i){return n.createElement(Xo,{content:(0,f.JA)(e,(function(e){return t(i.uniqueKey,e)})),backgroundColor:A.$u.colors.theme.clinicalFilterContent,onDelete:function(){return r(i.uniqueKey,[])}})}},{key:"renderCategoricalDataFilter",value:function(e,t,r){return n.createElement(oa,{components:e.values.map((function(i){return n.createElement(Xo,{content:i.value,backgroundColor:A.$u.colors.theme.clinicalFilterContent,onDelete:function(){return t(r.uniqueKey,o().remove(e.values,(function(e){return e.value!==i.value})))}})})),operation:"or",group:!1})}},{key:"renderTreatmentFilter",value:function(e,t){var r=this,i=e.filters.map((function(e,i){var o=e.filters.map((function(e,o){var a=e.hasOwnProperty("time")?e.time:"";return n.createElement(Xo,{content:e.treatment+" "+a,backgroundColor:A.$u.colors.theme.clinicalFilterContent,onDelete:function(){r.props.removeTreatmentsFilter(i,o,t)}})}));return n.createElement(oa,{components:o,operation:"or",group:!0})}));return n.createElement(oa,{components:i,operation:"and",group:!1})}},{key:"groupedGeneQueries",value:function(e,t){var r=this;return e.map((function(e){var i=qt.pp,o=e.hugoGeneSymbol;switch(t.chartType){case A.oV.MUTATED_GENES_TABLE:i=_.C_;break;case A.oV.STRUCTURAL_VARIANT_GENES_TABLE:i=_.p0;break;case A.oV.CNA_GENES_TABLE:if(1===e.alterations.length){var a=(0,f.H8)(e.alterations[0]);a&&(i=a)}}return n.createElement(Xo,{content:o,backgroundColor:i,infoSection:n.createElement(f.nK,{chartType:t.chartType,geneFilterQuery:e}),onDelete:function(){return r.props.removeGeneFilter(t.uniqueKey,(0,f.zU)(e))}})}))}},{key:"groupedGenomicProfiles",value:function(e){var t=this;return e.map((function(e){return n.createElement(Xo,{content:t.props.molecularProfileNameSet[e]||e,backgroundColor:A.$u.colors.theme.clinicalFilterContent,onDelete:function(){return t.props.removeGenomicProfileFilter(e)}})}))}},{key:"groupedCaseLists",value:function(e){var t=this;return e.map((function(e){return n.createElement(Xo,{content:t.props.caseListNameSet[e]||e,backgroundColor:A.$u.colors.theme.clinicalFilterContent,onDelete:function(){return t.props.removeCaseListsFilter(e)}})}))}},{key:"render",value:function(){return this.showFilters?n.createElement("div",{className:st()(Bo().userSelections,"userSelections")},this.allComponents,n.createElement("button",{"data-test":"clear-all-filters",className:st()("btn btn-default btn-sm",Bo().summaryClearAllBtn),onClick:this.props.clearAllFilters},"Clear All Filters"),n.createElement(_.ZD,{placement:"topLeft",overlay:n.createElement("div",null,"Get bookmark link for this filter")},n.createElement("a",{onClick:this.props.onBookmarkClick,className:Bo().bookmarkButton},n.createElement("span",{className:"fa-stack fa-4x"},n.createElement("i",{className:"fa fa-circle fa-stack-2x"}),n.createElement("i",{className:"fa fa-link fa-stack-1x"}))))):null}},{key:"showFilters",get:function(){return this.allComponents.length>0}},{key:"allComponents",get:function(){var e=this,t=[];if(this.props.numberOfSelectedSamplesInCustomSelection>0&&t.push(n.createElement("div",{className:Bo().parentGroupLogic},n.createElement(oa,{components:[n.createElement("span",{className:Bo().filterClinicalAttrName},"Custom Selection"),n.createElement(Xo,{content:"".concat(this.props.numberOfSelectedSamplesInCustomSelection," sample").concat(this.props.numberOfSelectedSamplesInCustomSelection>1?"s":""),backgroundColor:A.$u.colors.theme.clinicalFilterContent,onDelete:function(){return e.props.removeCustomSelectionFilter()}})],operation:":",group:!1}))),this.props.comparisonGroupSelection.length>0){var r=(0,k.b)(this.props.comparisonGroupSelection).length,i=(0,f.x1)(this.props.comparisonGroupSelection).length;t.push(n.createElement("div",{className:Bo().parentGroupLogic},n.createElement(oa,{components:[n.createElement("span",{className:Bo().filterClinicalAttrName},(0,f.FR)(this.props.comparisonGroupSelection)),n.createElement(Xo,{content:(0,k.L3)(r,i),backgroundColor:A.$u.colors.theme.clinicalFilterContent,onDelete:function(){return e.props.removeComparisonGroupSelectionFilter()}})],operation:":",group:!1})))}this.renderClinicalDataFilters(this.props.filter.clinicalDataFilters,t,this.props.updateClinicalDataFilterByValues),this.renderClinicalDataFilters(this.props.filter.customDataFilters,t,(function(t,r){e.props.updateCustomChartFilter(t,r.map((function(e){return e.value})))})),o().reduce(this.props.filter.genomicDataFilters||[],(function(t,r){var i=(0,f.Xq)(r.hugoGeneSymbol,r.profileType),o=e.props.attributesMetaSet[i];return o&&t.push(n.createElement("div",{className:Bo().parentGroupLogic},n.createElement(oa,{components:[n.createElement("span",{className:Bo().filterClinicalAttrName},o.displayName),e.renderDataBinFilter(r.values,(function(t,r){(0,f.oM)(r,o,e.props.store.getGenomicChartDataBin,e.props.store.getGenomicDataIntervalFiltersByUniqueKey,e.props.store.updateCustomBins,e.props.store.updateGenomicDataIntervalFilters)}),e.props.updateGenomicDataIntervalFilter,o)],operation:":",group:!1}))),t}),t);var a=[];if(this.props.filter.genericAssayDataFilters&&o().forEach(this.props.filter.genericAssayDataFilters,(function(t){var r=(0,f.XP)(t.stableId,t.profileType),i=e.props.attributesMetaSet[r];i&&a.push(n.createElement("div",{className:Bo().parentGroupLogic},n.createElement(oa,{components:[n.createElement("span",{className:Bo().filterClinicalAttrName},i.displayName),n.createElement(Xo,{content:(0,f.JA)(t.values,(function(t){(0,f.oM)(t,i,e.props.store.getGenericAssayChartDataBin,e.props.store.getGenericAssayDataFiltersByUniqueKey,e.props.store.updateCustomBins,e.props.store.updateGenericAssayDataFilters)})),backgroundColor:A.$u.colors.theme.clinicalFilterContent,onDelete:function(){return e.props.updateGenericAssayDataFilter(i.uniqueKey,[])}})],operation:":",group:!1})))})),this.renderClinicalDataFilters(this.props.customChartsFilter,t,(function(t,r){e.props.updateCustomChartFilter(t,r.map((function(e){return e.value})))})),o().reduce(this.props.filter.geneFilters||[],(function(t,r){var i=(0,f.wl)(r.molecularProfileIds),o=e.props.attributesMetaSet[i];return o&&t.push(n.createElement("div",{className:Bo().parentGroupLogic},n.createElement(oa,{components:r.geneQueries.map((function(t){return n.createElement(oa,{components:e.groupedGeneQueries(t,o),operation:"or",group:t.length>1})})),operation:"and",group:!1}))),t}),t),o().isEmpty(this.props.filter.genomicProfiles)||t.push(n.createElement("div",{className:Bo().parentGroupLogic},n.createElement(oa,{components:this.props.filter.genomicProfiles.map((function(t){return n.createElement(oa,{components:e.groupedGenomicProfiles(t),operation:"or",group:t.length>1})})),operation:"and",group:!1}))),o().isEmpty(this.props.filter.caseLists)||t.push(n.createElement("div",{className:Bo().parentGroupLogic},n.createElement(oa,{components:this.props.filter.caseLists.map((function(t){return n.createElement(oa,{components:e.groupedCaseLists(t),operation:"or",group:t.length>1})})),operation:"and",group:!1}))),a&&t.push.apply(t,a),this.props.filter.sampleTreatmentFilters&&this.props.filter.sampleTreatmentFilters.filters.length>0){var s=this.renderTreatmentFilter(this.props.filter.sampleTreatmentFilters,"SAMPLE_TREATMENTS");t.push(s)}if(this.props.filter.patientTreatmentFilters&&this.props.filter.patientTreatmentFilters.filters.length>0){var l=this.renderTreatmentFilter(this.props.filter.patientTreatmentFilters,"PATIENT_TREATMENTS");t.push(l)}if(this.props.filter.sampleTreatmentGroupFilters&&this.props.filter.sampleTreatmentGroupFilters.filters.length>0){var u=this.renderTreatmentFilter(this.props.filter.sampleTreatmentGroupFilters,"SAMPLE_TREATMENT_GROUPS");t.push(u)}if(this.props.filter.patientTreatmentGroupFilters&&this.props.filter.patientTreatmentGroupFilters.filters.length>0){var c=this.renderTreatmentFilter(this.props.filter.patientTreatmentGroupFilters,"PATIENT_TREATMENT_GROUPS");t.push(c)}if(this.props.filter.sampleTreatmentTargetFilters&&this.props.filter.sampleTreatmentTargetFilters.filters.length>0){var p=this.renderTreatmentFilter(this.props.filter.sampleTreatmentTargetFilters,"SAMPLE_TREATMENT_TARGET");t.push(p)}if(this.props.filter.patientTreatmentTargetFilters&&this.props.filter.patientTreatmentTargetFilters.filters.length>0){var d=this.renderTreatmentFilter(this.props.filter.patientTreatmentTargetFilters,"PATIENT_TREATMENT_TARGET");t.push(d)}return t}}])&&aa(r.prototype,i),a&&aa(r,a),t}(n.Component);pa([l.computed],da.prototype,"showFilters",null),pa([l.computed],da.prototype,"allComponents",null);const ha=da=pa([a.observer],da);function fa(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ma(e,t){return!t||"object"!==ga(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ya(e){return(ya=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ba(e,t){return(ba=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ga(e){return(ga="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var va=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":ga(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},Sa=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ma(this,ya(t).call(this,e))}var r,i,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ba(e,t)}(t,e),r=t,(i=[{key:"render",value:function(){return n.createElement("div",{className:"headBlock","data-test":"study-view-header"},o().keys(this.props.store.pageStatusMessages).length>0&&n.createElement("div",null,o().values(this.props.store.pageStatusMessages).map((function(e){return n.createElement("div",{className:"alert alert-".concat(e.status)},e.message)}))),n.createElement("div",{style:{display:"flex"}},n.createElement(Lo,{hasRawDataForDownload:this.props.store.hasRawDataForDownload.result,studies:this.props.store.displayedStudies.result,originStudies:this.props.store.originStudies,showOriginStudiesInSummaryDescription:this.props.store.showOriginStudiesInSummaryDescription,isMixedReferenceGenome:this.props.store.isMixedReferenceGenome}),n.createElement(_o,{store:this.props.store})),this.props.store.clinicalAttributeIdToDataType.isComplete&&n.createElement(ha,{store:this.props.store,filter:this.props.store.userSelections,comparisonGroupSelection:this.props.store.filterComparisonGroups,numberOfSelectedSamplesInCustomSelection:this.props.store.numberOfSelectedSamplesInCustomSelection,customChartsFilter:Array.from(this.props.store.preDefinedCustomChartFilterSet.values()),attributesMetaSet:this.props.store.chartMetaSetWithChartType,clinicalAttributeIdToDataType:this.props.store.clinicalAttributeIdToDataType.result,updateClinicalDataFilterByValues:this.props.store.updateClinicalDataFilterByValues,updateGenomicDataIntervalFilter:this.props.store.updateGenomicDataIntervalFiltersByValues,updateGenericAssayDataFilter:this.props.store.updateGenericAssayDataFiltersByValues,updateCustomChartFilter:this.props.store.setCustomChartFilters,removeGeneFilter:this.props.store.removeGeneFilter,removeCustomSelectionFilter:this.props.store.removeCustomSelectFilter,removeComparisonGroupSelectionFilter:this.props.store.removeComparisonGroupSelectionFilter,onBookmarkClick:this.props.onBookmarkClick,clearAllFilters:this.props.store.clearAllFilters,molecularProfileNameSet:this.props.store.molecularProfileNameSet.result||{},removeGenomicProfileFilter:this.props.store.removeGenomicProfileFilter,caseListNameSet:this.props.store.caseListNameSet.result||{},removeCaseListsFilter:this.props.store.removeCaseListsFilter,removeTreatmentsFilter:this.props.store.removeTreatmentsFilter}))}}])&&fa(r.prototype,i),a&&fa(r,a),t}(n.Component);const Ca=Sa=va([a.observer],Sa);var Ta=r(32434),Ea=r(86002),wa=r(50619),Aa=r(5374);function Pa(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _a(e){return(_a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ia(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Oa(e,t){return(Oa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ka(e){return(ka="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Da=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":ka(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},Na=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==ka(t)&&"function"!=typeof t?Ia(e):t}(this,_a(t).call(this,e)),Object.defineProperty(Ia(r),"renderingComplete",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Ia(r),"segmentTrackMaxHeight",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Ia(r),"lastSelectedLocus",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),(0,l.makeObservable)(Ia(r)),r.segmentTrackMaxHeight=.7*v.Z.size.height,r}var r,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Oa(e,t)}(t,e),r=t,(i=[{key:"updateLastSelectedLocus",value:function(e){this.lastSelectedLocus=e}},{key:"render",value:function(){var e=this;return n.createElement("div",null,n.createElement(Me.Z,{isLoading:this.isSampleCountWithinThreshold&&this.isHidden,size:"big",center:!0},n.createElement(xe.Z,{getItems:function(){return e.progressItems},show:this.isSampleCountWithinThreshold&&this.isHidden,sequential:!0})),n.createElement("div",{style:{marginBottom:15,marginLeft:15}},n.createElement("span",null,this.selectionInfo),!this.hasNoSegmentData&&n.createElement(Aa.Z,{promise:this.activePromise,filename:this.filename})),n.createElement("div",{style:this.isHidden||this.hasNoSegmentData||!this.isSampleCountWithinThreshold?{opacity:0}:void 0},n.createElement(Ta.Z,{tracks:[Object.assign(Object.assign({},(0,Ea.O4)()),{height:this.segmentTrackHeight,features:this.features})],genome:this.genome,locus:this.lastSelectedLocus,onLocusChange:this.updateLastSelectedLocus,onRenderingStart:this.onIgvRenderingStart,onRenderingComplete:this.onIgvRenderingComplete,isVisible:this.props.store.currentTab===Ge.rM.CN_SEGMENTS&&!this.isHidden})))}},{key:"onIgvRenderingStart",value:function(){this.renderingComplete=!1}},{key:"onIgvRenderingComplete",value:function(){this.renderingComplete=!0}},{key:"segmentTrackHeight",get:function(){return(0,Ea.SG)(this.features,this.segmentTrackMaxHeight)}},{key:"features",get:function(){var e=this.activePromise&&this.activePromise.result||[];return(0,Ea.cG)(e)}},{key:"filename",get:function(){return"".concat(this.props.store.downloadFilenamePrefix,"segments.seg")}},{key:"isHidden",get:function(){return this.isLoading||!this.renderingComplete}},{key:"isLoading",get:function(){return!!this.isSampleCountWithinThreshold&&(!this.activePromise||this.activePromise.isPending)}},{key:"isSampleCountWithinThreshold",get:function(){return!this.props.store.selectedSamples.result||!this.props.sampleThreshold||this.props.store.selectedSamples.result.length<=this.props.sampleThreshold}},{key:"activePromise",get:function(){return this.props.store.selectedSamples.result&&this.isSampleCountWithinThreshold?this.props.store.cnSegments:void 0}},{key:"progressItems",get:function(){return this.activePromise?[{label:"Loading copy number segments data...",promises:[this.activePromise]},{label:"Rendering"}]:[]}},{key:"hasNoSegmentData",get:function(){var e;return(null===(e=this.activePromise)||void 0===e?void 0:e.isComplete)&&(!this.activePromise.result||0===this.activePromise.result.length)}},{key:"genome",get:function(){var e=this.props.store.queriedPhysicalStudies.result?this.props.store.queriedPhysicalStudies.result[0]:void 0;return e?e.referenceGenome:wa.Xi}},{key:"selectionInfo",get:function(){var e;if(this.isSampleCountWithinThreshold){var t=this.hasNoSegmentData?"No segmented":"Segmented",r=this.props.store.selectedSamples.result?"".concat(this.props.store.selectedSamples.result.length," "):"",n=1===(null===(e=this.props.store.selectedSamples.result)||void 0===e?void 0:e.length)?"sample":"samples";return"".concat(t," copy-number data for the selected ").concat(r).concat(n,".")}return"Too many samples (>".concat(this.props.sampleThreshold,") for copy number segmentation view, make a selection on Summary tab first.")}}])&&Pa(r.prototype,i),o&&Pa(r,o),t}(n.Component);Object.defineProperty(Na,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{sampleThreshold:2e4}}),Da([l.observable],Na.prototype,"renderingComplete",void 0),Da([l.observable.ref],Na.prototype,"segmentTrackMaxHeight",void 0),Da([m.default],Na.prototype,"updateLastSelectedLocus",null),Da([l.computed],Na.prototype,"segmentTrackHeight",null),Da([l.computed],Na.prototype,"features",null),Da([l.computed],Na.prototype,"filename",null),Da([l.computed],Na.prototype,"isHidden",null),Da([l.computed],Na.prototype,"isLoading",null),Da([l.computed],Na.prototype,"isSampleCountWithinThreshold",null),Da([l.computed],Na.prototype,"activePromise",null),Da([l.computed],Na.prototype,"progressItems",null),Da([l.computed],Na.prototype,"hasNoSegmentData",null),Da([l.computed],Na.prototype,"genome",null),Da([l.action.bound],Na.prototype,"onIgvRenderingStart",null),Da([l.action.bound],Na.prototype,"onIgvRenderingComplete",null);const Ra=Na=Da([a.observer],Na);var Ga=r(97392),Ma=r(25290),Fa=r.n(Ma),La=r(2958),xa=r.n(La);function Ba(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var ja,Va,Ua="custom_value";function qa(e){return o().reduce(e.trim().split(/\n|\r/g),(function(e,t){return(t=t.trim())&&e.push(function(e){var t={line:e,caseId:""},r=e.split(":");if(1===r.length)t.caseId=r[0];else if(r.length>1){t.studyId=r[0];var n=r[1].split(/\s|\t/g);n.length>1&&(t.value=n[1]),t.caseId=n[0]}return t}(t)),e}),[])}function Ka(e,t){return"".concat(e,":").concat(t)}function Wa(e){return[e.studyId||"",e.caseId,e.value||""].join("&")}function Ya(e,t,r,n,i){var a=[],s=[],l=[],u=o().reduce(r,(function(e,r){return e["".concat(r.studyId,":").concat(t===f.EU.PATIENT?r.patientId:r.sampleId)]=!0,e}),{}),c={},p={};o().reduce(o().uniqBy(e,(function(e){return Wa(e)})),(function(e,r){var p="",d=!0;return void 0===r.studyId||""===r.studyId?n?(p=Ka(i[0],r.caseId),u[p]?(void 0===c[p]&&(c[p]=0),c[p]++):(l.push(r.caseId),d=!1)):(s.push({code:ja.INVALID_CASE_ID,message:new Error("No study specified for ".concat(t," id: ").concat(r.caseId,", and more than one study selected for query. The case will be ignored."))}),d=!1):o().includes(i,r.studyId)?(p=Ka(r.studyId,r.caseId),void 0!==u[p]?(void 0===c[p]&&(c[p]=0),c[p]++):(l.push(r.caseId),d=!1)):(a.push({code:ja.STUDY_NOT_SELECTED,message:new Error("Incorrect study id: ".concat(r.studyId))}),d=!1),d&&(e[Wa(r)]=r),e}),p);var d=o().reduce(c,(function(e,t,r){return t>1&&e.push(r),e}),[]);if(d.length>0){var h=o().reduce(e,(function(e,t){var r=t.value?t.value:"_TEST_";return void 0===e[r]&&(e[r]=[]),e[r].push(Ka(t.studyId?t.studyId:"",t.caseId)),e}),{}),m=o().reduce(h,(function(e,t){return e+=t.length-o().uniq(t).length}),0);o().keys(h).length>1&&m!==d.length&&s.push({code:ja.POTENTIAL_OVERLAP,message:new Error("".concat(d.join(", ")," ").concat(xa()("exist",d.length-m)," in different groups."))})}return l.length>0&&s.push({code:ja.INVALID_CASE_ID,message:new Error("The following ".concat(xa()("case",l.length)," ").concat(xa()("is",l.length)," invalid and will be ignored. ").concat(l.join(", ")))}),{error:a,warning:s,updatedLines:o().values(p)}}function za(e,t,r,n,i){var a={},s={},l=r===f.EU.PATIENT;return o().each(n,(function(e){a["".concat(e.studyId,":").concat(e.sampleId)]=e;var t="".concat(e.studyId,":").concat(e.patientId);void 0===s[t]&&(s[t]=[]),s[t].push(e)})),o().flatMap(e,(function(e){var r=e.value||(i?"Unselected":Ua),n=void 0===e.studyId?"".concat(t,":").concat(e.caseId):"".concat(e.studyId,":").concat(e.caseId);return(l?s[n]:[a[n]]).map((function(n){return{studyId:e.studyId||t,sampleId:n.sampleId,patientId:n.patientId,value:r}}))}))}!function(e){e.OVERLAP="OVERLAP",e.POTENTIAL_OVERLAP="POTENTIAL_OVERLAP",e.INVALID="INVALID",e.INVALID_CASE_ID="INVALID_CASE_ID",e.STUDY_NOT_SELECTED="STUDY_NOT_SELECTED",e.INPUT_ERROR="INPUT_ERROR",e.NO_CHART_NAME="NO_CHART_NAME",e.NO_GROUP_NAME="NO_GROUP_NAME"}(ja||(ja={})),function(e){e.GROUP_NAME="GROUP_NAME",e.CHART_NAME="CHART_NAME",e.CASE_ID="CASE_ID"}(Va||(Va={}));var Ha=r(77906);function Za(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Xa(e){return(Xa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qa(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $a(e,t){return($a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ja(e){return(Ja="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var es,ts=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":Ja(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},rs=[{value:f.EU.SAMPLE,label:"By sample ID"},{value:f.EU.PATIENT,label:"By patient ID"}];!function(e){e[e.SELECTED=0]="SELECTED",e[e.UNSELECTED=1]="UNSELECTED"}(es||(es={}));var ns=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==Ja(t)&&"function"!=typeof t?Qa(e):t}(this,Xa(t).call(this,e)),Object.defineProperty(Qa(r),"validateContent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Qa(r),"chartNameValidation",{enumerable:!0,configurable:!0,writable:!0,value:{warning:[],error:[]}}),Object.defineProperty(Qa(r),"chartName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Qa(r),"showCaseIds",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Qa(r),"caseIdsMode",{enumerable:!0,configurable:!0,writable:!0,value:f.EU.SAMPLE}),Object.defineProperty(Qa(r),"content",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(Qa(r),"validContent",{enumerable:!0,configurable:!0,writable:!0,value:""}),(0,l.makeObservable)(Qa(r)),r}var r,i,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$a(e,t)}(t,e),r=t,(i=[{key:"onClick",value:function(e){var t,r=this;if(e===es.SELECTED)t=this.props.selectedSamples;else{var n=o().keyBy(this.props.selectedSamples,(function(e){return e.uniqueSampleKey}));t=this.props.allSamples.filter((function(e){return!n[e.uniqueSampleKey]}))}var i=t.map((function(e){return"".concat(e.studyId,":").concat(r.caseIdsMode===f.EU.SAMPLE?e.sampleId:e.patientId).concat(r.props.disableGrouping?"":" ".concat(Ua))}));this.caseIdsMode===f.EU.PATIENT&&(i=o().uniq(i)),this.content=i.join("\n"),this.validateContent=!1,this.validContent=this.content}},{key:"onChange",value:function(e){this.validContent=e,this.validateContent=!0}},{key:"onChartNameChange",value:function(e){this.chartName=e.currentTarget.value;var t=!this.props.isChartNameValid||this.props.isChartNameValid(this.chartName);this.chartNameValidation=t?{error:[],warning:[]}:{error:[{code:ja.INVALID,message:new Error("Custom data exists.")}],warning:[]}}},{key:"onAddChart",value:function(){this.props.onSubmit(this.newChartInfo)}},{key:"mainContent",value:function(){var e=this;return n.createElement("div",{className:Fa().body},n.createElement(ut.ButtonGroup,null,rs.map((function(t,r){return n.createElement(ut.Radio,{checked:t.value===e.caseIdsMode,onChange:function(t){e.caseIdsMode=Ha(t.target).attr("data-value"),e.validateContent=!0},inline:!0,"data-value":t.value},t.label)}))),n.createElement("span",null,n.createElement("div",{style:{display:"flex",justifyContent:"space-between",marginTop:5}},n.createElement("span",{className:Fa().selection,onClick:function(){e.onClick(es.SELECTED)}},n.createElement("i",{className:"fa fa-arrow-down",style:{marginRight:5}}),n.createElement("span",{className:Fa().selectionText},"currently selected")),n.createElement("span",{className:Fa().selection,onClick:function(){e.onClick(es.UNSELECTED)}},n.createElement("i",{className:"fa fa-arrow-down",style:{marginRight:5}}),n.createElement("span",{className:Fa().selectionText},"currently unselected")))),n.createElement("textarea",{className:"form-control",rows:5,value:this.content,placeholder:this.exampleData,onChange:function(t){e.content=t.currentTarget.value,o().delay((function(){e.onChange(e.content)}),500)},"data-test":"CustomCaseSetInput"}),this.props.disableGrouping&&n.createElement("div",{className:"alert alert-warning",style:{marginTop:"15px",marginBottom:"5px"}},n.createElement("i",{className:"fa fa-warning",style:{marginRight:3}}),"Submitting will clear current filters."),n.createElement("div",{className:Fa().operations},!this.props.disableGrouping&&n.createElement("input",{placeholder:"Title (optional)",style:{width:"200px"},type:"text",onInput:this.onChartNameChange,className:"form-control input-sm"}),n.createElement("button",{disabled:this.addChartButtonDisabled,className:"btn btn-primary btn-sm","data-test":"CustomCaseSetSubmitButton","data-event":(0,I.XO)({category:"studyPage",action:"customCaseSetSelection",label:this.props.queriedStudies.join(",")}),onClick:this.onAddChart},this.submitButtonText)),this.result.validationResult.error.concat(this.chartNameValidation.error).map((function(e){return n.createElement("div",{className:"alert alert-danger",role:"alert",style:{marginTop:"10px",marginBottom:"0"}},e.message.message)})),this.result.validationResult.warning.concat(this.chartNameValidation.warning).map((function(e){return n.createElement("div",{className:"alert alert-warning",role:"alert",style:{marginTop:"10px",marginBottom:"0"},"data-test":"ValidationResultWarning"},e.message.message)})))}},{key:"render",value:function(){return this.mainContent()}},{key:"sampleSet",get:function(){return o().keyBy(this.props.selectedSamples,(function(e){return"".concat(e.studyId,":").concat(e.sampleId)}))}},{key:"isSingleStudy",get:function(){return 1===this.props.queriedStudies.length}},{key:"result",get:function(){return function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0,s={error:[],warning:[]},l=qa(e);if(l.length>0&&t){var u,c,p=Ya(l,n,i,a,r);(u=s.warning).push.apply(u,Ba(p.warning)),(c=s.error).push.apply(c,Ba(p.error)),void 0!==p.updatedLines&&(l=p.updatedLines)}var d=void 0!==o().find(l,(function(e){return void 0!==e.value&&""!==e.value}));return s.error.length>0?{data:[],validationResult:s}:{data:za(l,r[0],n,i,d),validationResult:s}}(this.validContent,this.validateContent,this.props.queriedStudies,this.caseIdsMode,this.props.allSamples,this.isSingleStudy)}},{key:"newChartInfo",get:function(){var e=this.chartName?this.chartName:this.props.getDefaultChartName?this.props.getDefaultChartName():"";return{displayName:e,description:e,datatype:f.g.STRING,patientAttribute:this.caseIdsMode===f.EU.PATIENT,data:0===this.result.validationResult.error.length?this.result.data:[]}}},{key:"addChartButtonDisabled",get:function(){return!!this.props.disableSubmitButton||this.result.validationResult.error.length>0||0===this.newChartInfo.data.length||this.chartNameValidation.error.length>0}},{key:"exampleData",get:function(){var e=this.caseIdsMode===f.EU.SAMPLE?"sample_id":"patient_id";return"Example:\nstudy_id:".concat(e,"1").concat(this.props.disableGrouping?"":" value1","\nstudy_id:").concat(e,"2").concat(this.props.disableGrouping?"":" value2")}},{key:"dataFormatContent",get:function(){return"Each row must have two columns separated by space or tab:"+"\n1) study_id: ".concat(this.caseIdsMode===f.EU.SAMPLE?"sample_id":"patient_id"," and")+"\n2) custom data (currently only support categorical data)"}},{key:"submitButtonText",get:function(){return this.props.disableGrouping?"Filter to listed ".concat(this.caseIdsMode===f.EU.SAMPLE?"samples":"patients"):this.props.submitButtonText}}])&&Za(r.prototype,i),a&&Za(r,a),t}(n.Component);Object.defineProperty(ns,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{submitButtonText:"Submit",disableGrouping:!1}}),ts([l.observable.ref],ns.prototype,"chartName",void 0),ts([l.observable],ns.prototype,"showCaseIds",void 0),ts([l.observable],ns.prototype,"caseIdsMode",void 0),ts([l.observable],ns.prototype,"content",void 0),ts([l.observable],ns.prototype,"validContent",void 0),ts([l.computed],ns.prototype,"sampleSet",null),ts([l.computed],ns.prototype,"isSingleStudy",null),ts([l.computed],ns.prototype,"result",null),ts([l.computed],ns.prototype,"newChartInfo",null),ts([l.action.bound],ns.prototype,"onClick",null),ts([l.action.bound],ns.prototype,"onChange",null),ts([l.action.bound],ns.prototype,"onChartNameChange",null),ts([l.action.bound],ns.prototype,"onAddChart",null),ts([l.computed],ns.prototype,"addChartButtonDisabled",null),ts([l.computed],ns.prototype,"exampleData",null),ts([l.computed],ns.prototype,"dataFormatContent",null),ts([l.computed],ns.prototype,"submitButtonText",null);const is=ns=ts([a.observer],ns);function os(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function as(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ss(e,t){return!t||"object"!==cs(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ls(e){return(ls=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function us(e,t){return(us=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function cs(e){return(cs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ps=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":cs(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},ds=function(e){function t(){return os(this,t),ss(this,ls(t).apply(this,arguments))}var r,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&us(e,t)}(t,e),r=t,(i=[{key:"render",value:function(){return n.createElement("div",{className:"alert alert-success",style:{marginTop:"10px",marginBottom:"0"}},n.createElement("span",null,n.createElement("i",{className:"fa fa-md fa-check"})," ",this.props.message))}}])&&as(r.prototype,i),o&&as(r,o),t}(n.Component);const hs=ds=ps([a.observer],ds);var fs=r(44743),ms=r.n(fs),ys=r(38659),bs=r(35770),gs=r(93527);function vs(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ss(e){return(Ss=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Cs(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ts(e,t){return(Ts=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Es(e){return(Es="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ws=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":Es(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},As=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==Es(t)&&"function"!=typeof t?Cs(e):t}(this,Ss(t).call(this,e)),Object.defineProperty(Cs(r),"_selectedProfileOption",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Cs(r),"_oql",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Cs(r),"_genes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Cs(r),"_queryStr",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Cs(r),"genomicChartSelection",{enumerable:!0,configurable:!0,writable:!0,value:(0,bs.F)({await:function(){return[r.props.molecularProfileOptionsPromise]},render:function(){return 0===r.props.molecularProfileOptionsPromise.result.length?n.createElement("div",{style:{textAlign:"center"}},"No molecular profiles found"):n.createElement("div",{style:{width:r.props.containerWidth-20}},n.createElement(vo.Z,{inputGeneQuery:r._queryStr,validateInputGeneQuery:!1,callback:function(){r._oql=arguments.length<=0?void 0:arguments[0],r._genes=arguments.length<=1?void 0:arguments[1],r._queryStr=arguments.length<=2?void 0:arguments[2]},location:vo.e.DEFAULT,textBoxPrompt:"Enter gene symbols",textAreaHeight:"40px"}),r.hasOQL&&n.createElement("div",{className:st()("alert",ms().oqlerror)},n.createElement("span",{className:"fa fa-exclamation-circle"}),"OQL not allowed"),n.createElement("div",{style:{display:"flex",marginTop:"10px"}},n.createElement("div",{style:{flex:1,marginRight:15}},n.createElement(ys.default,{value:r.selectedOption,onChange:r.handleSelect,options:r.molecularProfileOptions,isClearable:!1,isSearchable:!1})),n.createElement("button",{disabled:r.isQueryInvalid||r.hasOQL,className:"btn btn-primary btn-sm","data-test":"GeneLevelSelectionSubmitButton",onClick:r.onAddChart},r.props.submitButtonText)))},renderPending:function(){return n.createElement("div",{style:{textAlign:"center",marginTop:"20px"}},n.createElement(Me.Z,{isLoading:!0}),"Calculating data availability...")},renderError:function(){return n.createElement("div",null,n.createElement(gs.Z,{message:"There was an error loading data. Please try again."}))}})}),(0,l.makeObservable)(Cs(r)),r}var r,i,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ts(e,t)}(t,e),r=t,(i=[{key:"onAddChart",value:function(){var e=this;if(void 0!==this.selectedOption){var t=this.validGenes.map((function(t){return{name:t.hugoGeneSymbol+": "+e.selectedOption.profileName,description:e.selectedOption.description,profileType:e.selectedOption.value,hugoGeneSymbol:t.hugoGeneSymbol}}));this.props.onSubmit(t)}}},{key:"handleSelect",value:function(e){e&&e.value&&(this._selectedProfileOption=e)}},{key:"render",value:function(){return this.genomicChartSelection.component}},{key:"selectedOption",get:function(){return void 0!==this._selectedProfileOption?this._selectedProfileOption:this.props.molecularProfileOptionsPromise.isComplete?this.molecularProfileOptions[0]:void 0}},{key:"isQueryInvalid",get:function(){return""===this._queryStr||void 0===this._oql||void 0===this._genes||!o().isUndefined(this._oql.error)||0!==this._genes.suggestions.length}},{key:"hasOQL",get:function(){return!this.isQueryInvalid&&o().some(this._oql.query,(function(e){return!1!==e.alterations}))}},{key:"validGenes",get:function(){return this.isQueryInvalid||this.hasOQL?[]:this._genes.found}},{key:"molecularProfileOptions",get:function(){return this.props.molecularProfileOptionsPromise.isComplete?this.props.molecularProfileOptionsPromise.result.map((function(e){return Object.assign(Object.assign({},e),{label:"".concat(e.label," (").concat(e.count," samples)"),profileName:e.label})})):[]}}])&&vs(r.prototype,i),a&&vs(r,a),t}(n.Component);Object.defineProperty(As,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{disableGrouping:!1}}),ws([l.observable],As.prototype,"_selectedProfileOption",void 0),ws([l.observable],As.prototype,"_oql",void 0),ws([l.observable],As.prototype,"_genes",void 0),ws([l.observable.ref],As.prototype,"_queryStr",void 0),ws([l.action.bound],As.prototype,"onAddChart",null),ws([l.action.bound],As.prototype,"handleSelect",null),ws([l.computed],As.prototype,"selectedOption",null),ws([l.computed],As.prototype,"isQueryInvalid",null),ws([l.computed],As.prototype,"hasOQL",null),ws([l.computed],As.prototype,"validGenes",null),ws([l.computed],As.prototype,"molecularProfileOptions",null);const Ps=As=ws([a.observer],As);var _s=r(17163),Is=r(55776);var Os=r(63656),ks=r.n(Os),Ds=r(74653);function Ns(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rs(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Gs(e,t,r){return t&&Rs(e.prototype,t),r&&Rs(e,r),e}function Ms(e,t){return!t||"object"!==js(t)&&"function"!=typeof t?Ls(e):t}function Fs(e){return(Fs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ls(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xs(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Bs(e,t)}function Bs(e,t){return(Bs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function js(e){return(js="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Vs,Us=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":js(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},qs=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))};!function(e){e.CUSTOM_DATA="Custom Data",e.CLINICAL="Clinical",e.GENOMIC="Genomic",e.GENE_SPECIFIC="Gene Specific"}(Vs||(Vs={}));var Ks=function(e){function t(e,r){var i;return Ns(this,t),i=Ms(this,Fs(t).call(this,e,r)),Object.defineProperty(Ls(i),"activeId",{enumerable:!0,configurable:!0,writable:!0,value:i.props.defaultActiveTab||f.E4.CLINICAL}),Object.defineProperty(Ls(i),"infoMessage",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(Ls(i),"tabsWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(Ls(i),"selectedGenericAssayProfileIdByType",{enumerable:!0,configurable:!0,writable:!0,value:l.observable.map({},{deep:!0})}),Object.defineProperty(Ls(i),"XvsYSelection",{enumerable:!0,configurable:!0,writable:!0,value:{x:void 0,y:void 0}}),Object.defineProperty(Ls(i),"tabsDivRef",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Ls(i),"genericAssayEntityOptionsReaction",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Ls(i),"XvsYClinicalAttributes",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.props.store.chartClinicalAttributes]},invoke:function(){var e=i.props.store.chartClinicalAttributes.result;return"true"!==localStorage.getItem("XvsYCategorical")&&(e=e.filter((function(e){return"NUMBER"===e.datatype}))),Promise.resolve(e)},default:[]})}),Object.defineProperty(Ls(i),"XvsYOptions",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.XvsYClinicalAttributes]},invoke:function(){return Promise.resolve(i.XvsYClinicalAttributes.result.map((function(e){return{value:e.clinicalAttributeId,label:e.displayName}})))},default:[]})}),Object.defineProperty(Ls(i),"dataCount",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[i.props.store.dataWithCount,i.props.store.selectedSamples]},invoke:function(){return qs(Ls(i),void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,f.lT)(this.props.store.dataWithCount.result,this.props.store.selectedSamples.result.length));case 1:case"end":return e.stop()}}),e,this)})))},default:{}})}),Object.defineProperty(Ls(i),"showAddNewChart",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Ls(i),"savingCustomData",{enumerable:!0,configurable:!0,writable:!0,value:!1}),(0,l.makeObservable)(Ls(i)),i.tabsDivRef=n.createRef(),i.genericAssayEntityOptionsReaction=(0,l.when)((function(){return!o().isEmpty(i.props.store.genericAssayProfileOptionsByType.result)}),(function(){return o().forEach(i.props.store.genericAssayProfileOptionsByType.result,(function(e,t){i.selectedGenericAssayProfileIdByType.set(t,e[0].value)}))})),i}return xs(t,e),Gs(t,[{key:"componentDidMount",value:function(){this.setTabsWidth(this.tabsDivRef.current)}},{key:"componentWillUnmount",value:function(){this.genericAssayEntityOptionsReaction()}},{key:"setTabsWidth",value:function(e){e&&(this.tabsWidth=e.offsetWidth)}},{key:"updateActiveId",value:function(e){this.activeId=e,this.resetInfoMessage()}},{key:"updateInfoMessage",value:function(e){this.infoMessage=e,setTimeout(this.resetInfoMessage,1e4)}},{key:"resetInfoMessage",value:function(){this.infoMessage=""}},{key:"onGenericAssaySubmit",value:function(e){this.infoMessage=function(e,t){var r="";if(1===e.length){var n=(0,f.XP)(e[0].genericAssayEntityId,e[0].profileType);r="".concat(e[0].name," ").concat(t.includes(n)?"is already":"has been"," added.")}else r="".concat(e.length," charts added");return r}(e,this.selectedAttrs);var t=o().groupBy(e,(function(e){return e.dataType}));o().isEmpty(t[L.QH.LIMITVALUE])||this.props.store.addGenericAssayContinuousCharts(t[L.QH.LIMITVALUE]),o().isEmpty(t[L.QH.BINARY])||this.props.store.addGenericAssayBinaryOrCategoricalCharts(t[L.QH.BINARY]),o().isEmpty(t[L.QH.CATEGORICAL])||this.props.store.addGenericAssayBinaryOrCategoricalCharts(t[L.QH.CATEGORICAL])}},{key:"onSelectGenericAssayProfileByType",value:function(e,t){this.selectedGenericAssayProfileIdByType.set(e,t)}},{key:"onAddAll",value:function(e){this.props.store.addCharts(this.selectedAttrs.concat(e));var t="".concat(e.length," chart").concat(e.length>1?"s":""," added");this.props.currentTab===Ge.rM.CLINICAL_DATA?this.updateInfoMessage("".concat(e.length," column").concat(e.length>1?"s":""," added to table and ").concat(t," in Summary tab")):this.props.currentTab===Ge.rM.SUMMARY?this.updateInfoMessage(t):this.updateInfoMessage("Added")}},{key:"onClearAll",value:function(e){this.props.store.updateChartsVisibility(o().reduce(this.selectedAttrs,(function(t,r){return e.includes(r)||t.push(r),t}),[]));var t="".concat(e.length," chart").concat(e.length>1?"s":""," removed");this.props.currentTab===Ge.rM.CLINICAL_DATA?this.updateInfoMessage("".concat(e.length," column").concat(e.length>1?"s":""," removed from table and ").concat(t," from Summary tab")):this.props.currentTab===Ge.rM.SUMMARY?this.updateInfoMessage(t):this.updateInfoMessage("Removed")}},{key:"onToggleOption",value:function(e){var t=this.props.store.chartMetaSet[e];if(void 0!==t){var r=A.$A[this.props.store.chartsType.get(e)];if(this.selectedAttrs.includes(e)){this.props.store.resetFilterAndChangeChartVisibility(e,!1);var n="";this.props.currentTab===Ge.rM.SUMMARY?n=" ".concat(r):this.props.currentTab===Ge.rM.CLINICAL_DATA&&(n=" column"),(0,I.L9)({category:"studyPage",action:"removeChart",label:e}),this.updateInfoMessage("".concat(t.displayName).concat(n," is removed"))}else{this.props.store.addCharts(this.selectedAttrs.concat([e]));var i="";this.props.currentTab===Ge.rM.SUMMARY?i=" as a ".concat(r):this.props.currentTab===Ge.rM.CLINICAL_DATA&&(i=" to table and as ".concat(r," in Summary tab")),this.updateInfoMessage("".concat(t.displayName," added").concat(i)),(0,I.L9)({category:"studyPage",action:"addChart",label:e})}}}},{key:"onToggleAddNewChart",value:function(){this.showAddNewChart=!this.showAddNewChart}},{key:"render",value:function(){var e=this;return n.createElement("div",{style:{display:"flex",flexDirection:"column"},ref:this.tabsDivRef},n.createElement(s.Kh,{unmountOnHide:!1,activeTabId:this.activeId,onTabClick:this.updateActiveId,className:"addChartTabs mainTabs"},n.createElement(s.l6,{key:0,id:f.E4.CLINICAL,linkText:Vs.CLINICAL,className:"addClinicalChartTab"},n.createElement(Ga.Z,{width:this.getTabsWidth,options:this.clinicalDataOptions,freqPromise:this.dataCount,onAddAll:this.onAddAll,onClearAll:this.onClearAll,onToggleOption:this.onToggleOption})),n.createElement(s.l6,{key:1,id:f.E4.GENOMIC,linkText:Vs.GENOMIC,hide:this.props.disableGenomicTab||0===this.genomicChartOptions.length,className:"addGenomicChartTab"},n.createElement(Ga.Z,{width:this.getTabsWidth,options:this.genomicChartOptions,freqPromise:this.dataCount,onAddAll:this.onAddAll,onClearAll:this.onClearAll,onToggleOption:this.onToggleOption})),n.createElement(s.l6,{key:2,id:f.E4.GENE_SPECIFIC,linkText:Vs.GENE_SPECIFIC,hide:this.hideGeneSpecificTab},n.createElement(Ps,{containerWidth:this.getTabsWidth,molecularProfileOptionsPromise:this.props.store.molecularProfileOptions,submitButtonText:"Add Chart",onSubmit:function(t){if(1===t.length){var r=(0,f.Xq)(t[0].hugoGeneSymbol,t[0].profileType);e.updateInfoMessage("".concat(t[0].name," ").concat(e.selectedAttrs.includes(r)?"is already":"has been"," added."))}else e.updateInfoMessage("".concat(t.length," charts added"));e.props.store.addGeneSpecificCharts(t)}}),this.geneSpecificChartOptions.length>0&&n.createElement("div",{style:{marginTop:10}},n.createElement(Ga.Z,{width:this.getTabsWidth,options:this.geneSpecificChartOptions,freqPromise:this.dataCount,onAddAll:this.onAddAll,onClearAll:this.onClearAll,onToggleOption:this.onToggleOption,hideControls:!0,firstColumnHeaderName:"Gene Specific Chart"}))),n.createElement(s.l6,{key:3,id:f.E4.CUSTOM_DATA,linkText:Vs.CUSTOM_DATA,hide:this.props.disableCustomTab,className:"custom"},n.createElement("div",{style:{width:this.getTabsWidth-20}},this.customChartDataOptions.length>0&&n.createElement("button",{className:"btn btn-primary btn-xs",onClick:this.onToggleAddNewChart},this.isAddNewChartWindowVisible?"Cancel":"+ Add new custom data"),this.isAddNewChartWindowVisible&&n.createElement(is,{allSamples:this.props.store.samples.result,selectedSamples:this.props.store.selectedSamples.result,submitButtonText:"Add Chart",queriedStudies:this.props.store.queriedPhysicalStudyIds.result,isChartNameValid:this.props.store.isChartNameValid,getDefaultChartName:this.props.store.getDefaultCustomChartName,disableSubmitButton:this.savingCustomData,onSubmit:function(t){e.showAddNewChart=!1,e.savingCustomData=!0,e.updateInfoMessage("Saving ".concat(t.displayName)),e.props.store.addCustomChart(t).then((function(){e.savingCustomData=!1,e.updateInfoMessage("".concat(t.displayName," has been added."))}))}}),n.createElement(n.Fragment,null,this.customChartDataOptions.length>0&&n.createElement(n.Fragment,null,n.createElement("hr",{style:{marginTop:10,marginBottom:10}}),n.createElement(Ga.Z,{width:this.getTabsWidth,options:this.customChartDataOptions,freqPromise:this.dataCount,onAddAll:this.onAddAll,onClearAll:this.onClearAll,onToggleOption:this.onToggleOption,hideControls:!0,firstColumnHeaderName:"Custom data",shareCharts:this.props.openShareCustomDataUrlModal,deleteChart:function(t){e.props.store.toggleCustomChartMarkedForDeletion(t)},restoreChart:function(t){e.props.store.toggleCustomChartMarkedForDeletion(t)},markedForDeletion:this.props.store.customChartGroupMarkedForDeletion})),this.notificationMessages.length>0&&n.createElement(n.Fragment,null,n.createElement("br",null),n.createElement("span",{className:"text-warning"},"Note: ",this.notificationMessages))))),n.createElement(s.l6,{id:"X_Vs_Y",linkText:n.createElement("span",null,"X vs Y",n.createElement("strong",{style:{marginLeft:5},className:"beta-text"},"Beta!")),key:4},n.createElement("div",{style:{display:"flex",flexDirection:"column"}},n.createElement("div",{style:{paddingBottom:5}},n.createElement(ys.default,{name:"x-vs-y-select-x",className:"xvsy-x-axis-selector",placeholder:"Select first clinical attribute",closeMenuOnSelect:!0,value:[this.XvsYSelection.x],isMulti:!1,isClearable:!1,options:this.XvsYOptions.result,onChange:(0,l.action)((function(t){e.XvsYSelection.x=t}))})),n.createElement("span",{style:{margin:"auto",marginBottom:6}},"vs."),n.createElement("div",{style:{paddingBottom:15}},n.createElement(ys.default,{name:"x-vs-y-select-y",className:"xvsy-y-axis-selector",placeholder:"Select second clinical attribute",closeMenuOnSelect:!0,value:[this.XvsYSelection.y],isMulti:!1,isClearable:!1,options:this.XvsYOptions.result,onChange:(0,l.action)((function(t){e.XvsYSelection.y=t}))})),this.addXvsYChartButton)),!this.hideGenericAssayTabs&&this.genericAssayTabs),this.showResetButton&&n.createElement("button",{style:{position:"absolute",top:14,right:18,zIndex:2},className:"btn btn-primary btn-xs",onClick:this.props.showResetPopup},"Reset charts"),this.infoMessage&&!this.savingCustomData&&n.createElement(hs,{message:this.infoMessage}),this.savingCustomData&&n.createElement("div",{className:"alert alert-info",style:{marginTop:"10px",marginBottom:"0"}},n.createElement("span",null,n.createElement("i",{className:"fa fa-spinner fa-spin"})," ",this.infoMessage)))}},{key:"getTabsWidth",get:function(){var e=this.tabsWidth+(this.showResetButton?70:0);return e>400?e:400}},{key:"showResetButton",get:function(){return this.props.store.isLoggedIn&&this.props.currentTab===Ge.rM.SUMMARY&&this.props.store.showResetToDefaultButton}},{key:"groupedChartMetaByDataType",get:function(){return o().chain(this.props.store.chartMetaSet).values().groupBy((function(e){return e.dataType})).value()}},{key:"genomicChartOptions",get:function(){var e=(0,f.Kj)(this.groupedChartMetaByDataType[f.E4.GENOMIC]||[],this.selectedAttrs,o().fromPairs(this.props.store.chartsType.toJSON()));return this.props.currentTab===Ge.rM.CLINICAL_DATA?e.filter((function(e){return e.chartType===A.oV.BAR_CHART||e.chartType===A.oV.PIE_CHART})):e}},{key:"geneSpecificChartOptions",get:function(){var e=(0,f.Kj)(this.groupedChartMetaByDataType[f.E4.GENE_SPECIFIC]||[],this.selectedAttrs,o().fromPairs(this.props.store.chartsType.toJSON()));return this.props.currentTab===Ge.rM.CLINICAL_DATA?e.filter((function(e){return e.chartType===A.oV.BAR_CHART||e.chartType===A.oV.PIE_CHART})):e}},{key:"genericAssayChartOptionsByGenericAssayType",get:function(){var e=this,t=o().groupBy(this.groupedChartMetaByDataType[f.E4.GENERIC_ASSAY]||[],(function(e){return e.genericAssayType}));return o().mapValues(t,(function(t){return(0,f.Kj)(t,e.selectedAttrs,o().fromPairs(e.props.store.chartsType.toJSON()))}))}},{key:"clinicalDataOptions",get:function(){return(0,f.Kj)(this.groupedChartMetaByDataType[f.E4.CLINICAL]||[],this.selectedAttrs,o().fromPairs(this.props.store.chartsType.toJSON()))}},{key:"customChartDataOptions",get:function(){return(0,f.Kj)(this.groupedChartMetaByDataType[f.E4.CUSTOM_DATA]||[],this.selectedAttrs,o().fromPairs(this.props.store.chartsType.toJSON()),this.props.store.isLoggedIn?this.props.store.showCustomDataSelectionUI?this.props.store.isSharedCustomData:void 0:this.props.store.isSharedCustomData)}},{key:"selectedAttrs",get:function(){return this.props.store.visibleAttributes.map((function(e){return e.uniqueKey}))}},{key:"hideGeneSpecificTab",get:function(){return this.props.disableGeneSpecificTab||!this.props.store.molecularProfileForGeneCharts.isComplete||this.props.store.molecularProfileForGeneCharts.isComplete&&0===this.props.store.molecularProfileForGeneCharts.result.length}},{key:"hideGenericAssayTabs",get:function(){return this.props.disableGenericAssayTabs||!this.props.store.genericAssayProfiles.isComplete||!this.props.store.genericAssayEntitiesGroupedByProfileId.isComplete||this.props.store.genericAssayProfiles.isComplete&&o().isEmpty(this.props.store.genericAssayProfiles.result)}},{key:"genericAssayTabs",get:function(){var e=this;return o().map(this.props.store.genericAssayProfileOptionsByType.result,(function(t,r){var i,a=((null===(i=t.find((function(t){return t.value===e.selectedGenericAssayProfileIdByType.get(r)})))||void 0===i?void 0:i.profileIds)||[]).reduce((function(t,r){return e.props.store.genericAssayEntitiesGroupedByProfileId.result[r].forEach((function(e){t[e.stableId]=e})),t}),{}),l=o().map(a,(function(e){return(0,ge.VV)(e,!1)})),u=e.genericAssayChartOptionsByGenericAssayType[r]&&e.genericAssayChartOptionsByGenericAssayType[r].length>0,c=t.map((function(e){return Object.assign(Object.assign({},e),{label:"".concat(e.label," (").concat(e.count," ").concat(e.patientLevel?"patients":"samples",")"),profileName:e.label})}));return n.createElement(s.l6,{key:r,id:r,linkText:(0,_s._y)(r)},n.createElement(Is.ZP,{containerWidth:e.getTabsWidth,molecularProfileOptions:c,submitButtonText:"Add Chart",genericAssayType:r,genericAssayEntityOptions:l,onChartSubmit:e.onGenericAssaySubmit,onSelectGenericAssayProfile:function(t){return e.onSelectGenericAssayProfileByType(r,t)}}),u&&n.createElement("div",{style:{marginTop:10}},n.createElement(Ga.Z,{width:e.getTabsWidth,options:e.genericAssayChartOptionsByGenericAssayType[r],freqPromise:e.dataCount,onAddAll:e.onAddAll,onClearAll:e.onClearAll,onToggleOption:e.onToggleOption,hideControls:!0,firstColumnHeaderName:"".concat((0,_s._y)(r)," Chart")})))}))}},{key:"existSharedCustomData",get:function(){return o().some(this.customChartDataOptions,(function(e){return e.isSharedChart}))}},{key:"notificationMessages",get:function(){var e,t,r,i=this,a=[];return this.props.store.customChartSet.size>0&&(this.existSharedCustomData&&a.push(n.createElement(n.Fragment,null,n.createElement("span",{className:st()((e={},t=ks().sharedChart,r=!0,t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e))},"Highlighted rows")," ","are shared custom data.")),!this.props.store.isLoggedIn&&this.props.store.appStore.isSocialAuthenticated?(a.length>0&&a.push(n.createElement("br",null)),a.push(n.createElement(n.Fragment,null,n.createElement("button",{className:"btn btn-default btn-xs",onClick:function(){return(0,Ds.U)(i.props.store.appStore)}},"Login")," to save custom data charts to your profile."))):this.existSharedCustomData&&(a.length>0&&a.push(n.createElement("br",null)),a.push(n.createElement(n.Fragment,null," Custom charts are saved to your profile"))),o().isEmpty(this.props.store.customChartGroupMarkedForDeletion)||(a.length>0&&a.push(n.createElement("br",null)),a.push(n.createElement("span",null,"Deleted charts will be permanently removed when this menu is closed. Any active filters based on deleted charts will also be removed.")))),a}},{key:"selectedCustomChartIds",get:function(){return this.customChartDataOptions.filter((function(e){return!!e.selected})).map((function(e){return e.key}))}},{key:"isAddNewChartWindowVisible",get:function(){return 0===this.customChartDataOptions.length||this.showAddNewChart}},{key:"addXvsYChartButton",get:function(){var e,t,r,i,o=this,a=!1;if(this.XvsYSelection.x&&this.XvsYSelection.y)if(this.XvsYSelection.x.value===this.XvsYSelection.y.value)a=!0,e="Please choose two different attributes.";else if(this.props.store.isXvsYChartVisible(this.XvsYSelection.x.value,this.XvsYSelection.y.value))a=!0,e="A chart with these attributes already exists";else{var s=this.props.store.clinicalAttributeIdToClinicalAttribute.result,u=s[this.XvsYSelection.x.value],c=s[this.XvsYSelection.y.value];"STRING"===u.datatype&&"STRING"===c.datatype?(a=!0,e="Can't add a chart with two categorical attributes (yet)."):"NUMBER"===u.datatype&&"STRING"===c.datatype||"STRING"===u.datatype&&"NUMBER"===c.datatype?(e="Add violin/box plot table",t="violin","STRING"===u.datatype?(r=u.clinicalAttributeId,i=c.clinicalAttributeId):(r=c.clinicalAttributeId,i=u.clinicalAttributeId)):(e="Add density plot",t="scatter")}else a=!0,e="Add Chart";return n.createElement("button",{className:"btn btn-primary btn-sm","data-test":"x-vs-y-submit-btn",disabled:a,onClick:a?void 0:(0,l.action)((function(){"scatter"===t?o.props.store.addXvsYScatterChart({xAttrId:o.XvsYSelection.x.value,yAttrId:o.XvsYSelection.y.value}):o.props.store.addXvsYViolinChart({categoricalAttrId:r,numericalAttrId:i}),o.updateInfoMessage("".concat(o.XvsYSelection.y.label," vs ").concat(o.XvsYSelection.x.label," added.")),o.XvsYSelection.x=void 0,o.XvsYSelection.y=void 0}))},e)}}]),t}(n.Component);Object.defineProperty(Ks,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{disableGenomicTab:!1,disableCustomTab:!1,disableGeneSpecificTab:!1,disableGenericAssayTabs:!1}}),Us([l.observable],Ks.prototype,"activeId",void 0),Us([l.observable],Ks.prototype,"infoMessage",void 0),Us([l.observable],Ks.prototype,"tabsWidth",void 0),Us([l.observable],Ks.prototype,"XvsYSelection",void 0),Us([l.action.bound],Ks.prototype,"setTabsWidth",null),Us([l.computed],Ks.prototype,"getTabsWidth",null),Us([l.computed],Ks.prototype,"showResetButton",null),Us([l.action.bound],Ks.prototype,"updateActiveId",null),Us([l.action.bound],Ks.prototype,"updateInfoMessage",null),Us([l.action.bound],Ks.prototype,"resetInfoMessage",null),Us([l.computed],Ks.prototype,"groupedChartMetaByDataType",null),Us([l.computed],Ks.prototype,"genomicChartOptions",null),Us([l.computed],Ks.prototype,"geneSpecificChartOptions",null),Us([l.computed],Ks.prototype,"genericAssayChartOptionsByGenericAssayType",null),Us([l.computed],Ks.prototype,"clinicalDataOptions",null),Us([l.computed],Ks.prototype,"customChartDataOptions",null),Us([l.computed],Ks.prototype,"selectedAttrs",null),Us([l.computed],Ks.prototype,"hideGeneSpecificTab",null),Us([l.computed],Ks.prototype,"hideGenericAssayTabs",null),Us([l.action.bound],Ks.prototype,"onGenericAssaySubmit",null),Us([l.action.bound],Ks.prototype,"onSelectGenericAssayProfileByType",null),Us([l.action.bound],Ks.prototype,"onAddAll",null),Us([m.default],Ks.prototype,"onClearAll",null),Us([l.action.bound],Ks.prototype,"onToggleOption",null),Us([l.computed],Ks.prototype,"genericAssayTabs",null),Us([l.computed],Ks.prototype,"existSharedCustomData",null),Us([l.computed],Ks.prototype,"notificationMessages",null),Us([l.computed],Ks.prototype,"selectedCustomChartIds",null),Us([l.observable],Ks.prototype,"showAddNewChart",void 0),Us([l.action.bound],Ks.prototype,"onToggleAddNewChart",null),Us([l.computed],Ks.prototype,"isAddNewChartWindowVisible",null),Us([l.observable],Ks.prototype,"savingCustomData",void 0),Us([l.computed],Ks.prototype,"addXvsYChartButton",null),Ks=Us([a.observer],Ks);var Ws=function(e){function t(e){var r;return Ns(this,t),r=Ms(this,Fs(t).call(this,e)),Object.defineProperty(Ls(r),"showTooltip",{enumerable:!0,configurable:!0,writable:!0,value:!1}),(0,l.makeObservable)(Ls(r)),r}return xs(t,e),Gs(t,[{key:"render",value:function(){var e=this;return n.createElement(_.ZD,{visible:this.showTooltip||this.props.store.showCustomDataSelectionUI,onVisibleChange:function(t){e.props.isShareLinkModalVisible||(e.showTooltip=!e.tabsLoading&&!!t,e.props.store.showCustomDataSelectionUI=!1,t||e.props.store.deleteMarkedCustomData())},trigger:["click"],placement:"bottomRight",destroyTooltipOnHide:!1,getTooltipContainer:function(){return document.getElementById("comparisonGroupManagerContainer")},overlay:function(){return n.createElement(Ks,{store:e.props.store,defaultActiveTab:e.props.defaultActiveTab,currentTab:e.props.currentTab,disableGenomicTab:e.props.disableGenomicTab,disableGeneSpecificTab:e.props.disableGeneSpecificTab,disableGenericAssayTabs:e.props.disableGenericAssayTabs,disableCustomTab:e.props.disableCustomTab,showResetPopup:e.props.showResetPopup,openShareCustomDataUrlModal:e.props.openShareCustomDataUrlModal})},overlayClassName:this.props.addChartOverlayClassName},n.createElement("button",{className:st()("btn btn-primary btn-sm",{active:this.showTooltip,disabled:this.tabsLoading}),style:{marginLeft:10},"aria-pressed":this.showTooltip,"data-event":(0,I.XO)({category:"studyPage",action:"addChartMenuOpen",label:this.props.store.studyIds.join(",")}),"data-test":"add-charts-button"},this.props.buttonText))}},{key:"tabsLoading",get:function(){return this.props.store.genericAssayProfileOptionsByType.isPending||this.props.store.molecularProfileOptions.isPending||this.props.store.genericAssayEntitiesGroupedByProfileId.isPending}}]),t}(n.Component);Us([l.observable],Ws.prototype,"showTooltip",void 0),Us([l.computed],Ws.prototype,"tabsLoading",null);const Ys=Ws=Us([a.observer],Ws);var zs=r(65497),Hs=r.n(zs);function Zs(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Xs(e){return(Xs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qs(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $s(e,t){return($s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Js(e){return(Js="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var el=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":Js(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},tl=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==Js(t)&&"function"!=typeof t?Qs(e):t}(this,Xs(t).call(this,e)),Object.defineProperty(Qs(r),"downloadingData",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Qs(r),"showDownloadErrorMessage",{enumerable:!0,configurable:!0,writable:!0,value:!1}),(0,l.makeObservable)(Qs(r)),r}var r,i,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$s(e,t)}(t,e),r=t,(i=[{key:"initiateDownload",value:function(){var e=this;this.downloadingData=!0,this.showDownloadErrorMessage=!1,this.props.store.getDownloadDataPromise().then((function(t){e.downloadingData=!1,Hs()(t,e.props.store.clinicalDataDownloadFilename)})).catch((function(){e.downloadingData=!1,e.showDownloadErrorMessage=!0}))}},{key:"openCases",value:function(){if(!o().isEmpty(this.props.store.selectedPatients)){var e=this.props.store.selectedPatients[0],t=o().map(this.props.store.selectedPatients,(function(e){return{patientId:e.patientId,studyId:e.studyId}})),r=(0,P.WU)(e.studyId,e.patientId,t);r.length>4500?window.open((0,P.WU)(e.studyId,e.patientId)).clientPostedData={navCaseIds:t}:window.open(r)}}},{key:"render",value:function(){return n.createElement("div",{className:st()(Bo().actionButtons,"btn-group")},n.createElement(_.ZD,{trigger:["hover"],placement:"top",overlay:n.createElement("span",null,"View selected cases")},n.createElement("button",{className:"btn btn-default btn-sm",disabled:!this.props.loadingComplete,onClick:this.openCases,"data-event":(0,I.XO)({category:"studyPage",action:"viewPatientCohort",label:this.props.store.queriedPhysicalStudyIds.result})},n.createElement("i",{className:"fa fa-user-circle-o"}))),n.createElement(_.ZD,{trigger:["click"],destroyTooltipOnHide:!0,overlay:this.virtualStudy,placement:"bottom"},n.createElement(_.ZD,{placement:"top",trigger:["hover"],overlay:n.createElement("span",null,this.virtualStudyButtonTooltip)},n.createElement("button",{className:"btn btn-default btn-sm",disabled:!this.props.loadingComplete},n.createElement("i",{className:"fa fa-bookmark"})))),n.createElement(_.ZD,{trigger:["hover"],placement:"top",overlay:n.createElement("span",null,this.downloadButtonTooltip)},n.createElement("button",{className:"btn btn-default btn-sm",disabled:!this.props.loadingComplete,onClick:this.initiateDownload,"data-event":(0,I.XO)({category:"studyPage",action:"dataDownload",label:this.props.store.queriedPhysicalStudyIds.result})},n.createElement(Le.If,{condition:this.downloadingData},n.createElement(Le.Then,null,n.createElement("i",{className:"fa fa-spinner fa-spin"})),n.createElement(Le.Else,null,n.createElement("i",{className:"fa fa-download"}))))))}},{key:"virtualStudyButtonTooltip",get:function(){return(this.props.appStore.isLoggedIn?"Save/":"")+"Share Virtual Study"}},{key:"downloadButtonTooltip",get:function(){return this.showDownloadErrorMessage?"An error occurred while downloading the data. Please try again.":"Download clinical data for the selected cases"}},{key:"virtualStudy",get:function(){return this.props.loadingComplete?n.createElement(Io.Z,{user:this.props.appStore.userName,name:this.props.store.isSingleVirtualStudyPageWithoutFilter?this.props.store.filteredVirtualStudies.result[0].data.name:void 0,description:this.props.store.isSingleVirtualStudyPageWithoutFilter?this.props.store.filteredVirtualStudies.result[0].data.description:void 0,studyWithSamples:this.props.store.studyWithSamples.result,selectedSamples:this.props.store.selectedSamples.result,filter:this.props.store.userSelections,attributesMetaSet:this.props.store.chartMetaSet,molecularProfileNameSet:this.props.store.molecularProfileNameSet.result||{},caseListNameSet:this.props.store.caseListNameSet.result||{}}):null}}])&&Zs(r.prototype,i),a&&Zs(r,a),t}(n.Component);el([l.observable],tl.prototype,"downloadingData",void 0),el([l.observable],tl.prototype,"showDownloadErrorMessage",void 0),el([m.default],tl.prototype,"initiateDownload",null),el([m.default],tl.prototype,"openCases",null),el([l.computed],tl.prototype,"virtualStudyButtonTooltip",null),el([l.computed],tl.prototype,"downloadButtonTooltip",null),el([l.computed],tl.prototype,"virtualStudy",null);const rl=tl=el([a.observer],tl);var nl=r(6790),il=r.n(nl),ol=r(18667),al=r(6097);function sl(e){return(sl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ll(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ul(e){return(ul=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function cl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pl(e,t){return(pl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var dl=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=function(e,t){return!t||"object"!==sl(t)&&"function"!=typeof t?cl(e):t}(this,ul(t).call(this,e))).render=r.render.bind(cl(r)),r}var r,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pl(e,t)}(t,e),r=t,(i=[{key:"render",value:function(){var e=this.props.color;return n.createElement("svg",{width:"12",height:"12",className:"case-label-header","data-test":"color-picker-icon"},n.createElement("rect",{width:"12",height:"12",fill:null==e?"#FFFFFF":e,stroke:"#3786c2","stroke-width":"4",cursor:"pointer"}),"#FFFFFF"===e&&n.createElement("line",{x1:"10",y1:"2",x2:"2",y2:"10",stroke:"red","stroke-width":"1"}))}}])&&ll(r.prototype,i),o&&ll(r,o),t}(n.Component);function hl(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function fl(e){return(fl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ml(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yl(e,t){return(yl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bl(e){return(bl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var gl=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":bl(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},vl=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==bl(t)&&"function"!=typeof t?ml(e):t}(this,fl(t).call(this,e)),Object.defineProperty(ml(r),"handleChangeComplete",{enumerable:!0,configurable:!0,writable:!0,value:function(e,t){e.hex===r.props.color?(r.props.onChangeGroupColor(r.props.group,void 0),r.props.store.flagDuplicateColorsForSelectedGroups(r.props.group.uid,void 0)):(r.props.onChangeGroupColor(r.props.group,e.hex),r.props.store.flagDuplicateColorsForSelectedGroups(r.props.group.uid,e.hex))}}),Object.defineProperty(ml(r),"buildColorChooserWidget",{enumerable:!0,configurable:!0,writable:!0,value:function(){return n.createElement(ut.Popover,{id:"popover-basic",onClick:function(e){e.stopPropagation(),e.preventDefault()}},n.createElement("div",null,n.createElement(al.iY,{colors:r.colorList,circleSize:20,circleSpacing:3,onChangeComplete:r.handleChangeComplete,color:r.props.color,width:"140px"})))}}),(0,l.makeObservable)(ml(r)),r}var r,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yl(e,t)}(t,e),r=t,(i=[{key:"onCheckboxClick",value:function(){this.props.store.toggleComparisonGroupSelected(this.props.group.uid),this.props.store.flagDuplicateColorsForSelectedGroups(this.props.group.uid,this.props.color)}},{key:"onRestoreClick",value:function(){this.props.restore(this.props.group)}},{key:"onDeleteClick",value:function(){this.props.delete(this.props.group)}},{key:"shareGroup",value:function(){this.props.shareGroup(this.props.group)}},{key:"onOverlayEnter",value:function(){this.props.store.numberOfVisibleColorChooserModals+=1}},{key:"onOverlayExit",value:function(){this.props.store.numberOfVisibleColorChooserModals-=1}},{key:"render",value:function(){var e,t,r,i,o=this.props.group;return e=this.props.markedForDeletion?n.createElement("span",{className:il().markedForDeletion},this.label):n.createElement("div",{className:il().groupItem,style:{display:"flex",alignItems:"center"}},n.createElement("input",{type:"checkbox",value:o.uid,checked:this.props.store.isComparisonGroupSelected(o.uid),onClick:this.onCheckboxClick}),this.label),n.createElement("div",{key:o.uid,"data-test":o.name,className:st()(il().groupRow,(t={},r=il().sharedGroup,i=this.props.group.isSharedGroup,r in t?Object.defineProperty(t,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[r]=i,t)),style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingBottom:4,paddingTop:4,minHeight:"35px"}},e,n.createElement("div",{className:il().groupLineItemActionButtons},!this.props.markedForDeletion&&n.createElement(n.Fragment,null,n.createElement(_.ZD,{overlay:"You have selected identical colors for compared groups."},n.createElement("span",null,this.props.markedWithWarningSign&&n.createElement("i",{className:"fa fa-warning",style:{cursor:"pointer",color:"#fad201",position:"relative",top:"1px",right:"2px"}}))),n.createElement(ut.OverlayTrigger,{containerPadding:40,trigger:"click",placement:"bottom",overlay:this.buildColorChooserWidget(),onEnter:this.onOverlayEnter,onExit:this.onOverlayExit,rootClose:!0},n.createElement(_.ZD,{overlay:"Optional: Select color for group to be used in group comparison. If no color is selected, a random color will be applied.",disabled:this.props.store.numberOfVisibleColorChooserModals>0},n.createElement("span",{style:{marginTop:2,marginRight:2}},n.createElement(dl,{color:this.props.color||"#FFFFFF"})))),n.createElement(_.ZD,{overlay:"Delete Group"},n.createElement("span",{onClick:this.onDeleteClick,"data-test":"deleteGroupButton"},n.createElement("i",{className:"fa fa-md fa-trash",style:{cursor:"pointer"}}))),n.createElement("span",{onClick:this.shareGroup},n.createElement("i",{className:"fa fa-share-alt",style:{cursor:"pointer"}}))),this.props.group.nonExistentSamples.length>0&&n.createElement(ol.Z,{tooltip:n.createElement(k.Mt,{samples:this.props.group.nonExistentSamples})}),this.props.markedForDeletion&&n.createElement("button",{style:{marginLeft:10},className:"btn btn-xs btn-default",onClick:this.onRestoreClick},"Restore")))}},{key:"label",get:function(){return n.createElement("span",{style:{display:"flex",alignItems:"center",whiteSpace:"nowrap"}},n.createElement(_.Ld,{text:this.props.group.name,maxLength:30})," (",(0,k.L3)((0,k.bt)(this.props.group),(0,k.Ll)(this.props.group)),")")}},{key:"colorList",get:function(){var e=f.DM.slice(0,20);return e.push(qt.$P),e.push(qt.P2),e.push(qt.sp),e.push(qt.au),e}}])&&hl(r.prototype,i),o&&hl(r,o),t}(n.Component);gl([m.default],vl.prototype,"onCheckboxClick",null),gl([m.default],vl.prototype,"onRestoreClick",null),gl([m.default],vl.prototype,"onDeleteClick",null),gl([m.default],vl.prototype,"shareGroup",null),gl([m.default],vl.prototype,"onOverlayEnter",null),gl([m.default],vl.prototype,"onOverlayExit",null),gl([l.computed],vl.prototype,"label",null),gl([l.computed],vl.prototype,"colorList",null),gl([l.action.bound],vl.prototype,"handleChangeComplete",void 0);const Sl=vl=gl([a.observer],vl);function Cl(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Tl(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function El(e){return(El=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Al(e,t){return(Al=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Pl(e){return(Pl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var _l=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":Pl(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},Il=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))},Ol=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==Pl(t)&&"function"!=typeof t?wl(e):t}(this,El(t).call(this,e)),Object.defineProperty(wl(r),"groupNameFilter",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(wl(r),"addGroupPanelOpen",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(wl(r),"_inputGroupName",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(wl(r),"addSamplesTargetGroupId",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(wl(r),"filteredGroups",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[r.props.store.comparisonGroups]},invoke:function(){return Promise.resolve(o().sortBy(r.props.store.comparisonGroups.result.filter((function(e){return new RegExp(r.groupNameFilter,"i").test(e.name)})),(function(e){return e.name.toLowerCase()})))}})}),Object.defineProperty(wl(r),"groupsSection",{enumerable:!0,configurable:!0,writable:!0,value:(0,bs.F)({await:function(){return[r.props.store.comparisonGroups,r.filteredGroups,r.props.store.selectedSamples]},render:function(){return r.props.store.comparisonGroups.result.length>0?n.createElement("div",{className:il().groupCheckboxes,"data-test":"group-checkboxes"},r.filteredGroups.result.length>0?r.filteredGroups.result.map((function(e){return n.createElement(Sl,{group:e,color:r.props.store.userGroupColors[e.uid],store:r.props.store,markedForDeletion:r.props.store.isComparisonGroupMarkedForDeletion(e.uid),markedWithWarningSign:r.props.store.isComparisonGroupMarkedWithWarningSign(e.uid),restore:r.restoreGroup,delete:r.deleteGroup,studyIds:r.props.store.studyIds,shareGroup:r.shareSingleGroup,onChangeGroupColor:r.onGroupColorChange})})):n.createElement("div",{className:il().noGroupsMessage},"No results for your current search.")):n.createElement("div",{className:il().noGroupsMessage},"Group comparison allows you to create custom groups and compare their clinical and genomic features. Use the button below to create groups based on selections.")},renderPending:function(){return n.createElement(Me.Z,{isLoading:!0})},renderError:function(){return n.createElement("div",{className:il().noGroupsMessage},n.createElement(gs.Z,{message:"There was an error loading saved groups. Please try again."}))}})}),Object.defineProperty(wl(r),"actionButtons",{enumerable:!0,configurable:!0,writable:!0,value:(0,bs.F)({await:function(){return[r.props.store.comparisonGroups]},render:function(){return r.props.store.comparisonGroups.result.length>0?n.createElement("div",{style:{marginTop:6}},r.compareButton,r.viewButton,r.shareButton):null}})}),(0,l.makeObservable)(wl(r)),r}var r,i,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Al(e,t)}(t,e),r=t,(i=[{key:"onChangeGroupNameFilter",value:function(e){this.groupNameFilter=e.target.value}},{key:"onChangeInputGroupName",value:function(e){this._inputGroupName=e.target.value}},{key:"showAddGroupPanel",value:function(){this.addGroupPanelOpen=!0;var e=o().reduce(Array.from(this.props.store.preDefinedCustomChartFilterSet.entries()),(function(e,t){var r=Cl(t,2),n=r[0],i=r[1];return e[n]=i.values.map((function(e){return e.value})),e}),{});this._inputGroupName=(0,k.xr)(this.props.store.filters,e,this.props.store.clinicalAttributeIdToDataType.result)}},{key:"cancelAddGroup",value:function(){this.addGroupPanelOpen=!1,this._inputGroupName="",this.addSamplesTargetGroupId=""}},{key:"deleteGroup",value:function(e){this.props.store.toggleComparisonGroupMarkedForDeletion(e.uid)}},{key:"selectAllFiltered",value:function(){var e=!0,t=!1,r=void 0;try{for(var n,i=this.filteredGroups.result[Symbol.iterator]();!(e=(n=i.next()).done);e=!0){var o=n.value;this.props.store.setComparisonGroupSelected(o.uid,!0)}}catch(e){t=!0,r=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw r}}this.props.store.flagDuplicateColorsForSelectedGroups(void 0,void 0)}},{key:"deselectAllFiltered",value:function(){var e=!0,t=!1,r=void 0;try{for(var n,i=this.filteredGroups.result[Symbol.iterator]();!(e=(n=i.next()).done);e=!0){var o=n.value;this.props.store.setComparisonGroupSelected(o.uid,!1),this.props.store.showComparisonGroupWarningSign(o.uid,!1)}}catch(e){t=!0,r=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw r}}}},{key:"restoreGroup",value:function(e){this.props.store.toggleComparisonGroupMarkedForDeletion(e.uid)}},{key:"shareSingleGroup",value:function(e){this.props.shareGroups([e])}},{key:"shareGroups",value:function(){var e=(0,F.Zd)(this.props.store.comparisonGroups.result||[],this.props.store);this.props.shareGroups(e)}},{key:"onSubmitNewGroup",value:function(){return Il(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r,n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.store.selectedSamples.isComplete?this.props.store.selectedSamples.result:void 0,e.next=3,O.Z.addGroup((0,F.$q)(this.inputGroupName,t,this.props.store.studyIds));case 3:r=e.sent,n=r.id,null!=(i=(0,qt.t)(this.inputGroupName))&&this.props.store.onGroupColorChange(n,i),this.props.store.notifyComparisonGroupsChange(),this.props.store.isLoggedIn||this.props.store.trackNewlyCreatedGroup(n),this.cancelAddGroup();case 10:case"end":return e.stop()}}),e,this)})))}},{key:"onGroupColorChange",value:function(e,t){return Il(this,void 0,void 0,regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:this.props.onGroupColorChange&&this.props.onGroupColorChange(e.uid,t);case 1:case"end":return r.stop()}}),r,this)})))}},{key:"componentWillUnmount",value:function(){this.props.store.deleteMarkedComparisonGroups()}},{key:"render",value:function(){return n.createElement("div",{className:il().comparisonGroupManager,style:{position:"relative"}},this.header,this.groupsSection.component,this.notificationMessages.length>0&&n.createElement(n.Fragment,null,n.createElement("br",null),n.createElement("i",{className:"text-warning"},"Note: ",this.notificationMessages)),this.actionButtons.component,n.createElement("hr",null),this.addGroupPanel)}},{key:"inputGroupName",get:function(){return this._inputGroupName}},{key:"header",get:function(){return n.createElement("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",marginTop:3,alignItems:"center",marginBottom:10}},n.createElement("div",{className:"btn-group",role:"group"},n.createElement("button",{className:"btn btn-default btn-xs",onClick:this.selectAllFiltered},"Select all ",this.filteredGroups.isComplete?"(".concat(this.filteredGroups.result.length,")"):""),n.createElement("button",{className:"btn btn-default btn-xs",onClick:this.deselectAllFiltered},"Deselect all")),n.createElement("input",{className:"form-control",style:{right:0,width:140,height:25},type:"text",placeholder:"Search..",value:this.groupNameFilter,onChange:this.onChangeGroupNameFilter}))}},{key:"viewButton",get:function(){var e=this;return this.props.store.comparisonGroups.isComplete&&this.props.store.comparisonGroups.result.length>0?n.createElement("button",{className:"btn btn-sm btn-default",disabled:0===(0,F.Zd)(this.props.store.comparisonGroups.result,this.props.store).length,style:{marginLeft:7},onClick:function(){e.props.store.clearAllFilters(),e.props.store.updateComparisonGroupsFilter()}},"Filter"):null}},{key:"shareButton",get:function(){return this.props.store.comparisonGroups.isComplete&&this.props.store.comparisonGroups.result.length>0?n.createElement("button",{className:"btn btn-sm btn-default",disabled:0===(0,F.Zd)(this.props.store.comparisonGroups.result,this.props.store).length,style:{marginLeft:7},onClick:this.shareGroups},"Share"):null}},{key:"allGroupNames",get:function(){return this.props.store.comparisonGroups.isComplete?this.props.store.comparisonGroups.result.map((function(e){return e.name})):void 0}},{key:"submitNewGroupDisabled",get:function(){return!(this.props.store.selectedSamples.isComplete?this.props.store.selectedSamples.result:void 0)||0===this.inputGroupName.length||!this.allGroupNames||this.allGroupNames.includes(this.inputGroupName)}},{key:"compareButton",get:function(){var e=this;if(this.props.store.comparisonGroups.isComplete){var t=(0,F.Zd)(this.props.store.comparisonGroups.result,this.props.store).length,r=t>k.EC||t<2,i="";return i=this.props.store.comparisonGroups.result.length>=2?r?"Select between 2 and ".concat(k.EC," groups to enable comparison."):"Open a comparison session with selected groups":"Create at least two groups to open a comparison session",n.createElement(_.ZD,{overlay:i},n.createElement("button",{className:"btn btn-sm btn-primary",disabled:r,"data-event":(0,I.XO)({action:"createCustomComparisonSession",label:this.props.store.comparisonGroups.result.length.toString(),category:"groupComparison"}),onClick:function(){return Il(e,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r,n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.open((0,P.ds)({phase:D.J.CREATING_SESSION}),"_blank"),e.next=3,(0,N.C)((function(){return!!t.routingStore}));case 3:return r=(0,F.Zd)(this.props.store.comparisonGroups.result,this.props.store),e.next=6,O.Z.addComparisonSession({groups:r,origin:this.props.store.studyIds});case 6:n=e.sent,i=n.id,(0,P.bf)(t,{comparisonId:i});case 9:case"end":return e.stop()}}),e,this)})))}},"Compare"))}return null}},{key:"addGroupPanel",get:function(){var e,t=this,r=this.props.store.selectedSamples.isComplete?this.props.store.selectedSamples.result:void 0;return e=this.addGroupPanelOpen?[n.createElement("div",{style:{display:"none",flexDirection:"row",justifyContent:"space-between",width:"100%",marginTop:3}},n.createElement("h5",null,"Add",r?" ".concat(r.length):""," ","selected samples"),n.createElement("button",{className:"btn btn-xs btn-default",style:{right:0,marginTop:-4},onClick:this.cancelAddGroup},"Cancel")),n.createElement("div",{style:{width:"100%",marginTop:7}},n.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%"}},n.createElement(_.ZD,{visible:this.allGroupNames&&this.allGroupNames.includes(this.inputGroupName),overlay:n.createElement("div",null,n.createElement("i",{className:"fa fa-md fa-exclamation-triangle",style:{color:"#BB1700",marginRight:5}}),n.createElement("span",null,k.Bj))},n.createElement("input",{className:"form-control",style:{marginRight:5},type:"text",placeholder:"Enter a name for your new group",value:this.inputGroupName,onChange:this.onChangeInputGroupName,onKeyPress:function(e){"Enter"!=e.key||t.submitNewGroupDisabled||t.onSubmitNewGroup()}})),n.createElement("button",{className:"btn btn-sm btn-primary",style:{width:58},onClick:this.onSubmitNewGroup,disabled:this.submitNewGroupDisabled},"Create")))]:n.createElement("button",{className:"btn btn-sm btn-primary","data-event":(0,I.XO)({action:"createCustomGroup",label:"",category:"groupComparison"}),"data-test":"create-new-group-btn",onClick:this.showAddGroupPanel,disabled:!r,style:{width:"100%"}},"Create new group from selected samples"," ",r?" (".concat(r.length,")"):""),n.createElement("div",{style:{width:"100%"}},e)}},{key:"existSharedGroups",get:function(){return this.props.store.comparisonGroups.result.filter((function(e){return e.isSharedGroup})).length>0}},{key:"notificationMessages",get:function(){var e,t,r,i=this,o=[];return this.props.store.comparisonGroups.result.length>0&&(this.existSharedGroups&&o.push(n.createElement(n.Fragment,null,n.createElement("span",{className:st()((e={},t=il().sharedGroup,r=!0,t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e))},"Highlighted rows")," ","are shared groups.")),!this.props.store.isLoggedIn&&this.props.store.appStore.isSocialAuthenticated?o.push(n.createElement(n.Fragment,null,n.createElement("br",null),"The groups above will not be saved without  ",n.createElement("button",{className:"btn btn-default btn-xs",onClick:function(){return(0,Ds.U)(i.props.store.appStore)}},"Login"),n.createElement("br",null))):this.existSharedGroups&&o.push(n.createElement(n.Fragment,null,"They have been saved to your profile."))),o}}])&&Tl(r.prototype,i),a&&Tl(r,a),t}(n.Component);_l([l.observable],Ol.prototype,"groupNameFilter",void 0),_l([l.observable],Ol.prototype,"addGroupPanelOpen",void 0),_l([l.observable],Ol.prototype,"_inputGroupName",void 0),_l([l.computed],Ol.prototype,"inputGroupName",null),_l([l.observable],Ol.prototype,"addSamplesTargetGroupId",void 0),_l([l.action.bound],Ol.prototype,"onChangeGroupNameFilter",null),_l([l.action.bound],Ol.prototype,"onChangeInputGroupName",null),_l([l.action.bound],Ol.prototype,"showAddGroupPanel",null),_l([l.action.bound],Ol.prototype,"cancelAddGroup",null),_l([l.action.bound],Ol.prototype,"deleteGroup",null),_l([l.action.bound],Ol.prototype,"selectAllFiltered",null),_l([l.action.bound],Ol.prototype,"deselectAllFiltered",null),_l([m.default],Ol.prototype,"restoreGroup",null),_l([m.default],Ol.prototype,"shareSingleGroup",null),_l([m.default],Ol.prototype,"shareGroups",null),_l([l.computed],Ol.prototype,"allGroupNames",null),_l([l.computed],Ol.prototype,"submitNewGroupDisabled",null),_l([l.action.bound],Ol.prototype,"onSubmitNewGroup",null),_l([l.action.bound],Ol.prototype,"onGroupColorChange",null),_l([l.computed],Ol.prototype,"existSharedGroups",null),_l([l.computed],Ol.prototype,"notificationMessages",null);const kl=Ol=_l([a.observer],Ol);var Dl=r(99549),Nl=r(90848),Rl=r(60727),Gl=r(83300),Ml=r(95497);function Fl(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ll(e){return(Ll=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Bl(e,t){return(Bl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function jl(e){return(jl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Vl=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":jl(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},Ul=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==jl(t)&&"function"!=typeof t?xl(e):t}(this,Ll(t).call(this,e,{tab:{isSessionProp:!1},resourceUrl:{isSessionProp:!1}})),(0,l.makeObservable)(xl(r)),r}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Bl(e,t)}(t,e),r=t,(n=[{key:"setTab",value:function(e){this.updateURL({},"".concat(Ml._.Study,"/").concat(e))}},{key:"setResourceUrl",value:function(e){this.updateURL({resourceUrl:e})}},{key:"tabId",get:function(){var e=new RegExp("".concat(Ml._.Study,"/(.+)")).exec(this.pathName);return e&&e[1]||Ge.rM.SUMMARY}}])&&Fl(r.prototype,n),i&&Fl(r,i),t}(Gl.Z);Vl([l.computed],Ul.prototype,"tabId",null);var ql=r(30256),Kl=r(2320);function Wl(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Yl(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function zl(e,t){return!t||"object"!==Ql(t)&&"function"!=typeof t?Zl(e):t}function Hl(e){return(Hl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Zl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xl(e,t){return(Xl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ql(e){return(Ql="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var $l=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":Ql(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},Jl="Files & Links",eu=function(e){function t(){var e;return Wl(this,t),e=zl(this,Hl(t).apply(this,arguments)),Object.defineProperty(Zl(e),"studyResources",{enumerable:!0,configurable:!0,writable:!0,value:(0,bs.F)({await:function(){return[e.props.store.studyResourceData,e.props.store.queriedPhysicalStudies]},render:function(){return e.props.store.studyResourceData.result.length>0?n.createElement("div",{className:"resourcesSection"},n.createElement("h4",{className:"blackHeader"},"Study Resources for"," ",e.props.store.queriedPhysicalStudies.result[0].name),o().sortBy(e.props.store.studyResourceData.result,(function(e){return parseFloat(e.resourceDefinition.priority)})).map((function(t){return n.createElement(Kl.Z,{resource:t,isTabOpen:e.props.store.isResourceTabOpen,openResource:e.props.openResource})}))):null}})}),e}var r,i,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xl(e,t)}(t,e),r=t,(i=[{key:"render",value:function(){return n.createElement("div",{className:"resourcesTab"},n.createElement(ql.Z,{title:Jl,isLoading:this.studyResources.isPending,className:"pull-left"}),n.createElement("br",null),n.createElement("br",null),n.createElement("div",null,this.studyResources.component))}}])&&Yl(r.prototype,i),a&&Yl(r,a),t}(n.Component);const tu=eu=$l([a.observer],eu);var ru=r(77906),nu=r.n(ru),iu=r(97513),ou=r(37395),au=r(7706),su=r(37687);function lu(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function uu(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cu(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function pu(e,t,r){return t&&cu(e.prototype,t),r&&cu(e,r),e}function du(e,t){return!t||"object"!==bu(t)&&"function"!=typeof t?hu(e):t}function hu(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fu(e){return(fu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mu(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yu(e,t)}function yu(e,t){return(yu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bu(e){return(bu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var gu=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":bu(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},vu=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))},Su=function(e){function t(){return uu(this,t),du(this,fu(t).apply(this,arguments))}return mu(t,e),pu(t,[{key:"render",value:function(){return n.createElement("div",{className:Bo().selectedInfo,"data-test":"selected-info"},n.createElement("strong",null,"Selected: "),n.createElement("strong",{"data-test":"selected-patients"},this.props.store.selectedPatients.length.toLocaleString())," ",n.createElement("strong",null,"patients")," | ",n.createElement("strong",{"data-test":"selected-samples"},this.props.store.selectedSamples.result.length.toLocaleString())," ",n.createElement("strong",null,"samples"))}}]),t}(n.Component);Su=gu([a.observer],Su);var Cu=function(e){function t(e){var r;uu(this,t),r=du(this,fu(t).call(this,e)),Object.defineProperty(hu(r),"urlWrapper",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(hu(r),"store",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(hu(r),"enableCustomSelectionInTabs",{enumerable:!0,configurable:!0,writable:!0,value:[Ge.rM.SUMMARY,Ge.rM.CLINICAL_DATA,Ge.rM.CN_SEGMENTS]}),Object.defineProperty(hu(r),"enableAddChartInTabs",{enumerable:!0,configurable:!0,writable:!0,value:[Ge.rM.SUMMARY,Ge.rM.CLINICAL_DATA]}),Object.defineProperty(hu(r),"toolbar",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(hu(r),"toolbarLeftUpdater",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(hu(r),"toolbarLeft",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(hu(r),"showCustomSelectTooltip",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(hu(r),"showAlterationFilterTooltip",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(hu(r),"showReturnToDefaultChartListModal",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(hu(r),"showBookmarkModal",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(hu(r),"shareLinkModal",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(hu(r),"getShareBookmarkUrl",{enumerable:!0,configurable:!0,writable:!0,value:Promise.resolve(null)}),Object.defineProperty(hu(r),"sharedGroups",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(hu(r),"shareCustomDataLinkModal",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(hu(r),"getShareCustomChartBookmarkUrl",{enumerable:!0,configurable:!0,writable:!0,value:Promise.resolve(null)}),Object.defineProperty(hu(r),"chartDataPromises",{enumerable:!0,configurable:!0,writable:!0,value:(0,_.$w)({await:function(){return[].concat(lu(o().values(r.store.clinicalDataBinPromises)),lu(o().values(r.store.clinicalDataCountPromises)),lu(o().values(r.store.genericAssayDataCountPromises)),[r.store.mutationProfiles,r.store.cnaProfiles,r.store.selectedSamples,r.store.molecularProfileSampleCounts,r.store.sampleTreatments,r.store.patientTreatments,r.store.patientTreatmentGroups,r.store.sampleTreatmentGroups])},invoke:function(){return vu(hu(r),void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,N._)(10);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}})}),Object.defineProperty(hu(r),"resourceTabs",{enumerable:!0,configurable:!0,writable:!0,value:(0,bs.F)({await:function(){return[r.store.resourceDefinitions,r.store.resourceIdToResourceData]},render:function(){var e=r.store.resourceDefinitions.result.filter((function(e){return r.store.isResourceTabOpen(e.resourceId)})),t=o().sortBy(e,(function(e){return e.priority})),i=r.store.resourceIdToResourceData.result;return t.reduce((function(e,t){var o=i[t.resourceId];return o&&o.length>0&&e.push(n.createElement(s.l6,{key:(0,Ge.f6)(t.resourceId),id:(0,Ge.f6)(t.resourceId),linkText:t.displayName,onClickClose:r.closeResourceTab},n.createElement(Rl.Z,{resourceData:i[t.resourceId],urlWrapper:r.urlWrapper}))),e}),[])}})}),Object.defineProperty(hu(r),"body",{enumerable:!0,configurable:!0,writable:!0,value:(0,bs.F)({await:function(){return[r.store.unknownQueriedIds,r.store.queriedPhysicalStudyIds]},render:function(){if(r.store.unknownQueriedIds.result.length&&0===r.store.queriedPhysicalStudyIds.result.length){var e=r.store.unknownQueriedIds.result.length>1?"Studies":"Study";return n.createElement(au.Z,{title:"Unknown/Unauthorized ".concat(e),body:"The following studies are unknown or you lack privileges to view them:\n                            ".concat(r.store.unknownQueriedIds.result.join(", "),"\n                            ")})}return r.content()}})}),(0,l.makeObservable)(hu(r)),r.urlWrapper=new Ul(r.props.routing),r.store=new Re(r.props.appStore,Ce.v4.sessionServiceIsEnabled(),r.urlWrapper);var i=r.urlWrapper.tabId&&(0,Ge.tz)(r.urlWrapper.tabId);if(i&&r.store.setResourceTabOpen(i,!0),(0,_.hZ)().studyPage=hu(r),!(0,_.hZ)().globalStores.routing.location.pathname.includes("/study"))return du(r);var a=e.routing.query,u=e.routing.location.hash;e.routing.location.hash="";var c=o().pick(a,["id","studyId","cancer_study_id","filterAttributeId","filterValues"]);c.filterJson=a.filters;var p=u||(0,_.hZ)().studyPageFilter;if(delete window.studyPageFilter,p){var d=(0,iu.parse)(p);d.filterJson&&(c.filterJson=d.filterJson),d.sharedGroups&&(c.sharedGroups=d.sharedGroups),d.sharedCustomData&&(c.sharedCustomData=d.sharedCustomData)}return o().isEqual(c,r.store.studyViewQueryFilter)||(r.store.updateStoreFromURL(c),r.store.studyViewQueryFilter=c),(0,_.XE)(r.store.queriedPhysicalStudyIds,(function(e){var t,n,i;(0,I.L9)({category:"studyPage",action:"studyPageLoad",label:e.join(",")+",",fieldsObject:(t={},n=I.lh.VirtualStudy,i=(r.store.filteredVirtualStudies.result.length>0).toString(),n in t?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i,t)})})),r}return mu(t,e),pu(t,[{key:"componentDidMount",value:function(){var e=this;this.props.routing.updateRoute({},"study/".concat(this.store.currentTab),!1,!0),this.toolbarLeftUpdater=setInterval((function(){e.toolbar&&(e.toolbarLeft=nu()(e.toolbar).position().left)}),500)}},{key:"toolbarRef",value:function(e){this.toolbar=e}},{key:"handleTabChange",value:function(e){this.urlWrapper.setTab(e)}},{key:"toggleBookmarkModal",value:function(){this.showBookmarkModal=!this.showBookmarkModal}},{key:"toggleShareLinkModal",value:function(){this.shareLinkModal=!this.shareLinkModal,this.sharedGroups=[]}},{key:"toggleShareCustomDataLinkModal",value:function(){this.shareCustomDataLinkModal=!this.shareCustomDataLinkModal}},{key:"openShareUrlModal",value:function(e){this.shareLinkModal=!0,this.sharedGroups=e;var t=e.map((function(e){return e.uid}));this.getShareBookmarkUrl=Promise.resolve({bitlyUrl:void 0,fullUrl:"".concat(window.location.protocol,"//").concat(window.location.host).concat(window.location.pathname).concat(window.location.search,"#sharedGroups=").concat(t.join(",")),sessionUrl:void 0})}},{key:"openShareCustomDataUrlModal",value:function(e){this.shareCustomDataLinkModal=!0,this.getShareCustomChartBookmarkUrl=Promise.resolve({bitlyUrl:void 0,fullUrl:"".concat(window.location.protocol,"//").concat(window.location.host).concat(window.location.pathname).concat(window.location.search,"#sharedCustomData=").concat(e.join(",")),sessionUrl:void 0})}},{key:"onBookmarkClick",value:function(){this.toggleBookmarkModal()}},{key:"openResource",value:function(e){this.store.setResourceTabOpen(e.resourceId,!0),this.urlWrapper.setTab((0,Ge.f6)(e.resourceId)),this.urlWrapper.setResourceUrl(e.url)}},{key:"closeResourceTab",value:function(e){var t=(0,Ge.tz)(e);t&&(this.store.setResourceTabOpen(t,!1),this.urlWrapper.tabId===(0,Ge.f6)(t)&&this.urlWrapper.setTab(Ge.rM.FILES_AND_LINKS))}},{key:"getBookmarkUrl",value:function(){return vu(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,Nl.k)(this.studyViewFullUrlWithFilter,(0,Ce.Ib)().bitly_access_token);case 2:return t=e.sent,e.abrupt("return",{bitlyUrl:t,fullUrl:this.studyViewFullUrlWithFilter,sessionUrl:void 0});case 4:case"end":return e.stop()}}),e,this)})))}},{key:"content",value:function(){var e=this;return n.createElement("div",{className:"studyView"},this.showBookmarkModal&&n.createElement(Dl.S,{onHide:this.toggleBookmarkModal,title:"Bookmark this filter",urlPromise:this.getBookmarkUrl()}),this.shareLinkModal&&n.createElement(Dl.S,{onHide:this.toggleShareLinkModal,title:this.sharedGroups.length>1?"Share ".concat(this.sharedGroups.length," Groups"):"Share Group",urlPromise:this.getShareBookmarkUrl,description:"Please send the following link to users with whom you want to share the selected group(s)."}),this.shareCustomDataLinkModal&&n.createElement(Dl.S,{onHide:this.toggleShareCustomDataLinkModal,title:"Share custom data",urlPromise:this.getShareCustomChartBookmarkUrl,description:"Please send the following link to users with whom you want to share the selected custom data"}),this.store.comparisonConfirmationModal,this.store.queriedSampleIdentifiers.isComplete&&this.store.invalidSampleIds.isComplete&&this.store.unknownQueriedIds.isComplete&&this.store.displayedStudies.isComplete&&this.store.queriedPhysicalStudies.isComplete&&this.store.queriedPhysicalStudies.result.length>0&&n.createElement("div",null,n.createElement(Ca,{store:this.store,onBookmarkClick:this.onBookmarkClick}),n.createElement("div",{className:Bo().mainTabs},n.createElement(s.Kh,{id:"studyViewTabs",activeTabId:this.store.currentTab,onTabClick:function(t){return e.handleTabChange(t)},className:"mainTabs",unmountOnHide:!1,getPaginationWidth:function(){return e.toolbarLeft},contentWindowExtra:n.createElement(su.v,{path:this.props.routing.location.pathname}),hrefRoot:(0,P.gN)("study")},n.createElement(s.l6,{key:0,id:Ge.rM.SUMMARY,linkText:_e.SUMMARY},n.createElement(yo,{store:this.store})),n.createElement(s.l6,{key:1,id:Ge.rM.CLINICAL_DATA,linkText:_e.CLINICAL_DATA,hide:0===this.store.selectedSamples.result.length},n.createElement(Qe,{store:this.store})),n.createElement(s.l6,{key:2,id:Ge.rM.HEATMAPS,linkText:_e.HEATMAPS,hide:0===this.store.MDACCHeatmapStudyMeta.result.length},n.createElement(Je.Z,{className:"mdacc-heatmap-iframe",url:"https://bioinformatics.mdanderson.org/TCGA/NGCHMPortal/?".concat(this.store.MDACCHeatmapStudyMeta.result[0])})),n.createElement(s.l6,{key:3,id:Ge.rM.CN_SEGMENTS,linkText:_e.CN_SEGMENTS,hide:this.store.hasCNSegmentData.isPending||!this.store.hasCNSegmentData.result},n.createElement(Ra,{store:this.store})),n.createElement(s.l6,{key:4,id:Ge.rM.FILES_AND_LINKS,linkText:Jl,hide:!this.shouldShowResources},n.createElement("div",null,n.createElement(tu,{store:this.store,openResource:this.openResource}))),this.resourceTabs.component),n.createElement("div",{ref:this.toolbarRef,className:Bo().absolutePanel},n.createElement(a.Observer,null,(function(){var t=n.createElement(Su,{store:e.store,appStore:e.props.appStore,loadingComplete:e.chartDataPromises.isComplete}),r=n.createElement(rl,{store:e.store,appStore:e.props.appStore,loadingComplete:e.chartDataPromises.isComplete});return n.createElement("div",{className:Bo().studyFilterResult},n.createElement(Le.If,{condition:e.store.selectedSamples.isComplete},n.createElement(Le.Then,null,t,r),n.createElement(Le.Else,null,n.createElement(Me.Z,{isLoading:!0,size:"small",className:Bo().selectedInfoLoadingIndicator}),r)))})),n.createElement("div",{id:"comparisonGroupManagerContainer",style:{display:"flex",position:"relative"}},this.enableCustomSelectionInTabs.includes(this.store.currentTab)&&n.createElement(n.Fragment,null,n.createElement(_.ZD,{visible:this.showCustomSelectTooltip,trigger:["click"],placement:"bottomLeft",onVisibleChange:function(t){return e.showCustomSelectTooltip=!!t},destroyTooltipOnHide:!0,overlay:function(){return n.createElement("div",{style:{width:"350px"}},n.createElement(is,{allSamples:e.store.samples.result,selectedSamples:e.store.selectedSamples.result,disableGrouping:!0,queriedStudies:e.store.queriedPhysicalStudyIds.result,onSubmit:function(t){e.showCustomSelectTooltip=!1,e.store.updateCustomSelect(t)}}))}},n.createElement("button",{className:st()("btn btn-primary btn-sm",{active:this.showCustomSelectTooltip}),"aria-pressed":this.showCustomSelectTooltip,"data-test":"custom-selection-button",style:{marginLeft:"10px"}},(0,f.Vj)("Custom Selection")))),(0,Ce.Ib)().skin_show_settings_menu&&n.createElement(_.ZD,{trigger:["click"],placement:"bottomLeft",overlay:n.createElement(ou.Z,{store:this.store,infoElement:n.createElement(f.aI,{includeCnaTable:this.store.hasCnaProfileData}),customDriverSourceName:(0,Ce.Ib)().oncoprint_custom_driver_annotation_binary_menu_label,showDriverAnnotationSection:this.store.doShowDriverAnnotationSectionInGlobalMenu,showTierAnnotationSection:this.store.doShowTierAnnotationSectionInGlobalMenu}),visible:this.showAlterationFilterTooltip,onVisibleChange:function(t){e.showAlterationFilterTooltip=!!t}},n.createElement("button",{"data-test":"AlterationFilterButton",style:{marginLeft:"10px"},className:"btn btn-primary btn-sm"},(0,f.Vj)("Alteration Filter"))),this.enableAddChartInTabs.includes(this.store.currentTab)&&n.createElement(Ys,{buttonText:this.addChartButtonText,store:this.store,currentTab:this.store.currentTab,defaultActiveTab:this.store.showCustomDataSelectionUI?f.E4.CUSTOM_DATA:f.E4.CLINICAL,addChartOverlayClassName:"studyViewAddChartOverlay",disableCustomTab:this.store.currentTab===Ge.rM.CLINICAL_DATA,disableGeneSpecificTab:this.store.currentTab===Ge.rM.CLINICAL_DATA,disableGenericAssayTabs:this.store.currentTab===Ge.rM.CLINICAL_DATA,showResetPopup:function(){e.showReturnToDefaultChartListModal=!0},openShareCustomDataUrlModal:this.openShareCustomDataUrlModal,isShareLinkModalVisible:this.shareCustomDataLinkModal}),n.createElement(ut.Modal,{bsSize:"small",show:this.showReturnToDefaultChartListModal,onHide:function(){e.showReturnToDefaultChartListModal=!1},keyboard:!0},n.createElement(ut.Modal.Header,{closeButton:!0},n.createElement(ut.Modal.Title,null,"Reset charts")),n.createElement(ut.Modal.Body,null,n.createElement("div",null,"Please confirm that you would like to replace the current charts with the default list.")),n.createElement(ut.Modal.Footer,null,n.createElement("button",{className:"btn btn-primary btn-sm",style:{marginTop:"10px",marginBottom:"0"},onClick:function(){e.store.resetToDefaultChartSettings(),e.showReturnToDefaultChartListModal=!1}},"Confirm"),n.createElement("button",{className:"btn btn-primary btn-sm",style:{marginTop:"10px",marginBottom:"0"},onClick:function(){e.showReturnToDefaultChartListModal=!1}},"Cancel"))),Ce.v4.sessionServiceIsEnabled()&&this.groupsButton)))))}},{key:"componentWillUnmount",value:function(){this.store.destroy(),clearInterval(this.toolbarLeftUpdater)}},{key:"render",value:function(){return n.createElement($e.X,{noMargin:!0,hideFooter:!0,className:"subhead-dark"},n.createElement(Me.Z,{size:"big",isLoading:this.store.queriedSampleIdentifiers.isPending||this.store.invalidSampleIds.isPending||this.body.isPending,center:!0}),this.body.component)}},{key:"shouldShowResources",get:function(){return!!this.store.resourceIdToResourceData.isComplete&&o().some(this.store.resourceIdToResourceData.result,(function(e){return e.length>0}))}},{key:"studyViewFullUrlWithFilter",get:function(){return"".concat(window.location.protocol,"//").concat(window.location.host).concat(window.location.pathname).concat(window.location.search,"#filterJson=").concat(JSON.stringify(this.store.filters))}},{key:"addChartButtonText",get:function(){return this.store.currentTab===Ge.rM.SUMMARY?(0,f.Vj)("Charts"):this.store.currentTab===Ge.rM.CLINICAL_DATA?(0,f.Vj)("Columns"):""}},{key:"groupsButton",get:function(){var e=this;return n.createElement(n.Fragment,null,n.createElement(_.ZD,{visible:this.store.showComparisonGroupUI,trigger:["click"],placement:"bottomLeft",destroyTooltipOnHide:!0,onPopupAlign:function(e){e.querySelector(".rc-tooltip-arrow").style.right="10px"},onVisibleChange:function(t){0!=e.store.numberOfVisibleColorChooserModals||e.shareLinkModal||(e.store.showComparisonGroupUI=!!t)},getTooltipContainer:function(){return document.getElementById("comparisonGroupManagerContainer")},overlay:n.createElement("div",{style:{width:350}},n.createElement(kl,{store:this.store,shareGroups:this.openShareUrlModal,onGroupColorChange:this.store.onGroupColorChange}))},n.createElement("button",{className:st()("btn btn-primary btn-xs",{active:this.store.showComparisonGroupUI}),id:"groupManagementButton","data-test":"groups-button","aria-pressed":this.store.showComparisonGroupUI,style:{marginLeft:"10px"},"data-event":(0,I.XO)({action:"openGroupManagement",label:"",category:"groupComparison"})},(0,f.Vj)("Groups"))))}}]),t}(n.Component);gu([l.observable],Cu.prototype,"toolbarLeft",void 0),gu([l.observable],Cu.prototype,"showCustomSelectTooltip",void 0),gu([l.observable],Cu.prototype,"showAlterationFilterTooltip",void 0),gu([l.observable],Cu.prototype,"showReturnToDefaultChartListModal",void 0),gu([m.default],Cu.prototype,"toolbarRef",null),gu([l.observable],Cu.prototype,"showBookmarkModal",void 0),gu([l.action.bound],Cu.prototype,"toggleBookmarkModal",null),gu([l.observable],Cu.prototype,"shareLinkModal",void 0),gu([l.action.bound],Cu.prototype,"toggleShareLinkModal",null),gu([l.action.bound],Cu.prototype,"toggleShareCustomDataLinkModal",null),gu([l.observable],Cu.prototype,"shareCustomDataLinkModal",void 0),gu([l.action.bound],Cu.prototype,"openShareUrlModal",null),gu([l.action.bound],Cu.prototype,"openShareCustomDataUrlModal",null),gu([m.default],Cu.prototype,"onBookmarkClick",null),gu([l.action.bound],Cu.prototype,"openResource",null),gu([l.action.bound],Cu.prototype,"closeResourceTab",null),gu([l.computed],Cu.prototype,"shouldShowResources",null),gu([l.computed],Cu.prototype,"studyViewFullUrlWithFilter",null),gu([l.computed],Cu.prototype,"addChartButtonText",null),gu([l.computed],Cu.prototype,"groupsButton",null);const Tu=Cu=gu([(0,a.inject)("routing","appStore"),a.observer],Cu)},9405:(e,t,r)=>{"use strict";r.d(t,{x:()=>p});var n=r(88034),i=r(58997);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){function t(){return a(this,t),l(this,u(t).apply(this,arguments))}var r,o,p;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(t,e),r=t,(o=[{key:"render",value:function(){var e=this;return n.createElement("a",{className:"dataset-table-download-link",style:{display:"block"},href:"https://cbioportal-datahub.s3.amazonaws.com/"+this.props.studyId+".tar.gz",download:!0,onClick:function(){return(0,i.L9)({category:"download",action:"study download",label:e.props.studyId})}},n.createElement("i",{className:"fa fa-download"}))}}])&&s(r.prototype,o),p&&s(r,p),t}(n.Component)},60727:(e,t,r)=>{"use strict";r.d(t,{Z:()=>T});var n=r(88034),i=r(27808),o=r(30256),a=r(64577),s=r(78566),l=r(93624),u=r.n(l),c=r(76127),p=r.n(c),d=r(65587),h=r(56719);function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var S=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":v(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},C=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==v(t)&&"function"!=typeof t?b(e):t}(this,y(t).call(this,e)),(0,s.makeObservable)(b(r)),r}var r,i,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(t,e),r=t,(i=[{key:"goToNextDatum",value:function(){this.isLastDatum||this.props.urlWrapper.setResourceUrl(this.props.resourceData[this.currentResourceIndex+1].url)}},{key:"goToPrevDatum",value:function(){this.isFirstDatum||this.props.urlWrapper.setResourceUrl(this.props.resourceData[this.currentResourceIndex-1].url)}},{key:"render",value:function(){var e=this.props.resourceData.length>1;return n.createElement("div",null,n.createElement(o.Z,{title:this.currentResourceDatum.resourceDefinition.displayName,isLoading:!1,className:"pull-left",style:{marginBottom:10}}),n.createElement("div",{style:{width:"100%",height:this.iframeHeight,display:"flex",alignItems:"center"}},e&&n.createElement("div",{className:p()(u().carouselButton,f({},u().active,!this.isFirstDatum)),onClick:this.goToPrevDatum},n.createElement("i",{style:{marginRight:15},className:"fa fa-4x fa-chevron-left"})),this.httpIframeWithHttpsPortal?n.createElement("div",null,n.createElement("span",null,"We can't show this URL in the portal. Please use the link below:"),n.createElement("br",null),n.createElement("a",{href:this.currentResourceDatum.url},this.currentResourceDatum.url)):n.createElement("iframe",{src:this.iframeUrl,style:{width:"100%",height:"100%"}}),e&&n.createElement("div",{className:p()(u().carouselButton,f({},u().active,!this.isLastDatum)),onClick:this.goToNextDatum},n.createElement("i",{style:{marginLeft:15},className:"fa fa-4x fa-chevron-right"}))))}},{key:"iframeHeight",get:function(){return a.Z.size.height-275}},{key:"currentResourceIndex",get:function(){var e=this;if(this.props.urlWrapper.query.resourceUrl){var t=this.props.resourceData.findIndex((function(t){return t.url===e.props.urlWrapper.query.resourceUrl}));return-1===t?0:t}return 0}},{key:"currentResourceDatum",get:function(){return this.props.resourceData[this.currentResourceIndex]}},{key:"isFirstDatum",get:function(){return 0===this.currentResourceIndex}},{key:"isLastDatum",get:function(){return this.currentResourceIndex===this.props.resourceData.length-1}},{key:"httpIframeWithHttpsPortal",get:function(){return"https:"===(0,d.hZ)().location.protocol&&"http:"===new URL(this.currentResourceDatum.url).protocol}},{key:"iframeUrl",get:function(){var e=(0,h.m)(this.currentResourceDatum.url),t=this.currentResourceDatum.url;switch(e){case"pdf":t=(0,h.r)(this.currentResourceDatum.url)}return t}}])&&m(r.prototype,i),l&&m(r,l),t}(n.Component);S([s.computed],C.prototype,"iframeHeight",null),S([s.computed],C.prototype,"currentResourceIndex",null),S([s.computed],C.prototype,"currentResourceDatum",null),S([s.action.bound],C.prototype,"goToNextDatum",null),S([s.action.bound],C.prototype,"goToPrevDatum",null),S([s.computed],C.prototype,"isFirstDatum",null),S([s.computed],C.prototype,"isLastDatum",null),S([s.computed],C.prototype,"httpIframeWithHttpsPortal",null),S([s.computed],C.prototype,"iframeUrl",null);const T=C=S([i.observer],C)},31294:(e,t,r)=>{"use strict";function n(e){setTimeout((function(){window.requestAnimationFrame(e)}),0)}r.d(t,{Z:()=>n})},25290:e=>{e.exports={portalWidth:"styles-module__portalWidth__1nrF_",framedImage:"styles-module__framedImage__30VqV",body:"styles-module__body__1rzI0",invalid:"styles-module__invalid__2aTxj",valid:"styles-module__valid__ayiQx",selection:"styles-module__selection__iEp5C",selectionText:"styles-module__selectionText__oWsS9",operations:"styles-module__operations__3fdLE"}},44743:e=>{e.exports={portalWidth:"styles-module__portalWidth__3vtVw",framedImage:"styles-module__framedImage__3P2Qv",oqlerror:"styles-module__oqlerror__1o_bc",operations:"styles-module__operations__2I3K7"}},63656:e=>{e.exports={portalWidth:"styles-module__portalWidth__1fUOQ",framedImage:"styles-module__framedImage__2d1Ka",modalHeader:"styles-module__modalHeader__JllNW",addChart:"styles-module__addChart__1wwdE",child:"styles-module__child__1RDTc",childContent:"styles-module__childContent__3qjw6",faCharC:"styles-module__faCharC__1Juo6",faCharG:"styles-module__faCharG__1M9-6",sharedChart:"styles-module__sharedChart__JehFS"}},31821:e=>{e.exports={portalWidth:"styles-module__portalWidth__18DKo",framedImage:"styles-module__framedImage__24p2j",header:"styles-module__header__1aeAb",name:"styles-module__name__1XFGq",draggable:"styles-module__draggable__3RmmQ",controls:"styles-module__controls__1BH85",menuToggle:"styles-module__menuToggle__1KWSD",item:"styles-module__item__2oGTK",menuItemIcon:"styles-module__menuItemIcon__1T8eb",disabledMenuItem:"styles-module__disabledMenuItem__18WAz",survivalIcon:"styles-module__survivalIcon__20yGX",clickable:"styles-module__clickable__2tZDi",undo:"styles-module__undo__1M88I",downloadControl:"styles-module__downloadControl___BLbx",dropdownHoverEffect:"styles-module__dropdownHoverEffect__30h85"}},70956:e=>{e.exports={portalWidth:"styles-module__portalWidth__1-dsc",framedImage:"styles-module__framedImage__1-X5s",chart:"styles-module__chart__RXir-",highlight:"styles-module__highlight__1DVtC",chartHeightOne:"styles-module__chartHeightOne__1EZ41",chartHeightTwo:"styles-module__chartHeightTwo__38Rdk",chartWidthOne:"styles-module__chartWidthOne__6k_oz",chartWidthTwo:"styles-module__chartWidthTwo__DZIFm",chartLoader:"styles-module__chartLoader__1WwZ2",chartError:"styles-module__chartError__21C0i",chartInnerWrapper:"styles-module__chartInnerWrapper__1ttrJ"}},68824:e=>{e.exports={portalWidth:"styles-module__portalWidth__21Wnc",framedImage:"styles-module__framedImage__2DLAM",main:"styles-module__main__6UjQ_",text:"styles-module__text__3EbPk",mostLeft:"styles-module__mostLeft__1HcgP",mostRight:"styles-module__mostRight__OHotS"}},28358:e=>{e.exports={portalWidth:"styles-module__portalWidth__2G9Ld",framedImage:"styles-module__framedImage__36jTC",rightPanel:"styles-module__rightPanel__1LNa2",summary:"styles-module__summary__3bP5G",description:"styles-module__description__3ShDq",submitQuery:"styles-module__submitQuery__3EV3t",iconGroup:"styles-module__iconGroup__1K9m4",studyLinks:"styles-module__studyLinks__ON9F9"}},2028:e=>{e.exports={portalWidth:"studySummaryTabStyles-module__portalWidth__E_ZYO",framedImage:"studySummaryTabStyles-module__framedImage__2SfLL",studyViewFlexContainer:"studySummaryTabStyles-module__studyViewFlexContainer__2qzDx",studyViewNoSamples:"studySummaryTabStyles-module__studyViewNoSamples__25ZnH",studyViewNoSamplesInner:"studySummaryTabStyles-module__studyViewNoSamplesInner__2CP0d",quickFilters:"studySummaryTabStyles-module__quickFilters__3jA-o"}},92576:e=>{e.exports={portalWidth:"styles-module__portalWidth__3RN1K",framedImage:"styles-module__framedImage__1q4ml",main:"styles-module__main__1M4Pn",content:"styles-module__content__-z-NW",delete:"styles-module__delete__3E7Yr"}},93624:e=>{e.exports={portalWidth:"styles-module__portalWidth__3mtfh",framedImage:"styles-module__framedImage__24LeD",carouselButton:"styles-module__carouselButton__35zgJ",active:"styles-module__active__xJZuN"}},80440:e=>{e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxNi4wLjQsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+DQo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB3aWR0aD0iMTguNzI5cHgiIGhlaWdodD0iOS41NTdweCIgdmlld0JveD0iMCAwIDE4LjcyOSA5LjU1NyIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMTguNzI5IDkuNTU3IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnPg0KCTxwYXRoIGQ9Ik0xLjg4OSw5LjM0NEwwLjM5MywwLjIxM2gxLjUxM2wwLjc4Myw1LjAzYzAuMDg2LDAuNTUsMC4xOTIsMS40NDcsMC4zMTgsMi42OWMwLjI5OC0wLjY0NywwLjY3OS0xLjM5LDEuMTQ0LTIuMjI3DQoJCWwzLjA1Mi01LjQ5NGgxLjY0M0wzLjYxNyw5LjM0NEgxLjg4OXoiLz4NCgk8cGF0aCBkPSJNOC4wOTQsNi4yMjNMOS42NSw2LjEyOGMwLDAuNDQ3LDAuMDY4LDAuODI5LDAuMjA2LDEuMTQ0YzAuMTM4LDAuMzE1LDAuMzkyLDAuNTczLDAuNzYxLDAuNzc0DQoJCWMwLjM3LDAuMiwwLjgwMSwwLjMwMSwxLjI5NCwwLjMwMWMwLjY4OCwwLDEuMjA0LTAuMTM4LDEuNTQ4LTAuNDEzczAuNTE2LTAuNTk5LDAuNTE2LTAuOTcyYzAtMC4yNy0wLjEwMy0wLjUyNC0wLjMxLTAuNzY1DQoJCWMtMC4yMTItMC4yNDEtMC43MjktMC41MzctMS41NTItMC44OXMtMS4zNDktMC42MDEtMS41NzctMC43NDRjLTAuMzg1LTAuMjM1LTAuNjc0LTAuNTEyLTAuODY5LTAuODMNCgkJQzkuNDczLDMuNDE2LDkuMzc1LDMuMDUsOS4zNzUsMi42MzhjMC0wLjcyMiwwLjI4Ny0xLjM0MSwwLjg2LTEuODU3YzAuNTcyLTAuNTE2LDEuMzc1LTAuNzc0LDIuNDA3LTAuNzc0DQoJCWMxLjE0NiwwLDIuMDE5LDAuMjY1LDIuNjE3LDAuNzk1YzAuNiwwLjUzLDAuOTEsMS4yMjgsMC45MzQsMi4wOTNsLTEuNTIyLDAuMTAzYy0wLjAyMi0wLjU1LTAuMjE4LTAuOTg1LTAuNTg0LTEuMzA3DQoJCUMxMy43MiwxLjM3MSwxMy4yMDEsMS4yMSwxMi41MywxLjIxYy0wLjUzOSwwLTAuOTU3LDAuMTIzLTEuMjU1LDAuMzdzLTAuNDQ3LDAuNTEzLTAuNDQ3LDAuOHMwLjEyOSwwLjUzOSwwLjM4NywwLjc1Ng0KCQljMC4xNzIsMC4xNDksMC42MTYsMC4zNzgsMS4zMzMsMC42ODhDMTMuNzQsNC4zNCwxNC40OSw0Ljc0NywxNC44LDUuMDQ1YzAuNDkzLDAuNDc2LDAuNzQsMS4wNTUsMC43NCwxLjczNg0KCQljMCwwLjQ1My0wLjE0LDAuODk3LTAuNDE3LDEuMzMzYy0wLjI3OCwwLjQzNi0wLjcwMiwwLjc4NC0xLjI3MiwxLjA0NUMxMy4yNzksOS40MiwxMi42MDcsOS41NSwxMS44MzQsOS41NQ0KCQljLTEuMDU1LDAtMS45NTEtMC4yNjEtMi42OTEtMC43ODJDOC40MDMsOC4yNDYsOC4wNTQsNy4zOTcsOC4wOTQsNi4yMjN6Ii8+DQoJPHBhdGggZD0iTTE2LjU5OCw5LjM0NGwwLjM2OS0xLjc2M2gxLjc2M2wtMC4zNzgsMS43NjNIMTYuNTk4eiIvPg0KPC9nPg0KPC9zdmc+DQo="}}]);